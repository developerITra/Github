Option Compare Database
Option Explicit
Dim NextNumber, newNextNumber, lettercounter As Integer
'Dim DocName As String
Dim opTrustee, opDebtor, Title, Chapter, AKA, LName, fName As String
                         
Private Function GetDCAttorneyname(NMorEmail As Integer)
Dim i As Integer

If NMorEmail = 0 Then
    For i = 0 To Forms!ForeclosureDetails!lstDCAtty.ListCount
        If i < Forms!ForeclosureDetails!lstDCAtty.ListCount - 1 Then
            If i < Forms!ForeclosureDetails!lstDCAtty.ListCount - 2 And Forms!ForeclosureDetails!lstDCAtty.Selected(i) Then
                GetDCAttorneyname = GetDCAttorneyname & vbNewLine & Forms!ForeclosureDetails!lstDCAtty.Column(1, i) & _
                ", Esq. (D.C. Bar # " & DLookup("DCBar", "Staff", "ID=" & Forms!ForeclosureDetails!lstDCAtty.Column(0, i)) & ")"
            End If
        End If
    Next i
ElseIf NMorEmail = 1 Then
        For i = 0 To Forms!ForeclosureDetails!lstDCAtty.ListCount
        If i < Forms!ForeclosureDetails!lstDCAtty.ListCount - 1 Then
            If i < Forms!ForeclosureDetails!lstDCAtty.ListCount - 2 And Forms!ForeclosureDetails!lstDCAtty.Selected(i) Then
                GetDCAttorneyname = GetDCAttorneyname & DLookup("EMail", "Staff", "ID=" & Forms!ForeclosureDetails!lstDCAtty.Column(0, i)) & vbNewLine
            End If
        End If
    Next i

End If

End Function
Private Sub BKConsTermTrustDebtor(DocName As String)

If DocName = "ConsentTerminating7" Then

    Select Case Forms![Print Consent Order Terminating 7]!optTrustee
        Case 0
             Select Case Forms![Print Consent Order Terminating 7]!optDebtor
                Case 0  ' defaulted
                    Title = "Order Terminating Automatic Stay"
                    opTrustee = "the debtor(s) having failed to respond"
                    opDebtor = vbNewLine & vbNewLine & "          ORDERED that the Motion for Relief from Automatic Stay be and it is hereby, entered by Default as to the Debtor(s); and be it further"
                Case 1  ' agreed
                    Title = "Consent Order Terminating Automatic Stay"
                    opTrustee = "the parties having reached an agreement"
                    opDebtor = ""
             End Select
    
        Case 1  ' filed report
            Select Case Forms![Print Consent Order Terminating 7]!optDebtor
                Case 0
                    Title = "Order Terminating Automatic Stay"
                    opTrustee = "the trustee having filed a report of no distribution, the debtor(s) having failed to respond"
                    opDebtor = vbNewLine & vbNewLine & "          ORDERED that the Motion for Relief from Automatic Stay be and it is hereby, entered by Default as to the Debtor(s); and be it further"
                Case 1
                    Title = "Consent Order Terminating Automatic Stay"
                    opTrustee = "the trustee having filed a report of no distribution, the parties having reached an agreement"
                    opDebtor = ""
            End Select
    
        Case 2  ' defaulted
            Select Case Forms![Print Consent Order Terminating 7]!optDebtor
                Case 0
                    Title = "Order Terminating Automatic Stay"
                    opTrustee = "the parties having failed to respond"
                    opDebtor = vbNewLine & vbNewLine & "          ORDERED that the Motion for Relief from Automatic Stay be and it is hereby, entered by Default as to the Debtor(s) and the Chapter 7 Trustee; and be it further"
                Case 1
                    Title = "Consent Order Terminating Automatic Stay as to Debtor and Default as to Chapter 7 Trustee"
                    opTrustee = "the trustee having failed to file an answer, the debtor(s) and movant having reached an agreement"
                    opDebtor = vbNewLine & vbNewLine & "          ORDERED that the Motion for Relief from Automatic Stay be an it is hereby, entered by Default as to the Chapter 7 Trustee; and be it further"
                End Select
    
        Case 3  ' agreed
            Select Case Forms![Print Consent Order Terminating 7]!optDebtor
                Case 0
                    Title = "Consent Order Terminating Automatic Stay as to Trustee and Default as to Debtor(s)"
                    opTrustee = "the trustee and movant having reached an agreement, the debtor(s) having failed to respond"
                    opDebtor = vbNewLine & vbNewLine & "          ORDERED that the Motion for Relief from Automatic Stay be and it is hereby, entered by Default as to the Debtor(s); and be it further"
                Case 1
                    Title = "Consent Order Terminating Automatic Stay"
                    opTrustee = "the parties having reached an agreement"
                    opDebtor = ""
            End Select
    End Select
    
ElseIf DocName = "ConsentTerminating7VAWD" Then
    
    Select Case Forms![Print Consent Order Terminating 7]!optTrustee
    
    Case 0  '   not a party
        Select Case Forms![Print Consent Order Terminating 7]!optDebtor
            Case 0  ' defaulted
                Title = "Order Terminating Automatic Stay"
                opTrustee = "the debtor(s) having failed to respond"
                opDebtor = vbNewLine & vbNewLine & "          ORDERED that the Motion for Relief from Automatic Stay be and it is hereby, entered by Default as to the Debtor(s); and be it further"
            Case 1  ' agreed
                Title = "Consent Order Terminating Automatic Stay"
                opTrustee = "the parties having reached an agreement"
                opDebtor = ""
        End Select

    Case 1  ' filed report
        Select Case Forms![Print Consent Order Terminating 7]!optDebtor
            Case 0
                Title = "Order Terminating Automatic Stay"
                opTrustee = "the trustee having filed a report of no distribution, the debtor(s) having failed to respond"
                opDebtor = vbNewLine & vbNewLine & "          ORDERED that the Motion for Relief from Automatic Stay be and it is hereby, entered by Default as to the Debtor(s); and be it further"
            Case 1
                Title = "Consent Order Terminating Automatic Stay"
                opTrustee = "the trustee having filed a report of no distribution, the parties having reached an agreement"
                opDebtor = ""
        End Select

    Case 2  ' defaulted
        Select Case Forms![Print Consent Order Terminating 7]!optDebtor
            Case 0
                Title = "Order Terminating Automatic Stay"
                opTrustee = "the parties having failed to respond"
                opDebtor = vbNewLine & vbNewLine & "          ORDERED that the Motion for Relief from Automatic Stay be and it is hereby, entered by Default as to the Debtor(s) and the Chapter 7 Trustee; and be it further"
            Case 1
                Title = "Consent Order Terminating Automatic Stay as to Debtor and Default as to Chapter 7 Trustee"
                opTrustee = "the trustee having failed to file an answer, the debtor(s) and movant having reached an agreement"
                opDebtor = vbNewLine & vbNewLine & "          ORDERED that the Motion for Relief from Automatic Stay be an it is hereby, entered by Default as to the Chapter 7 Trustee; and be it further"
            End Select

    Case 3  ' agreed
        Select Case Forms![Print Consent Order Terminating 7]!optDebtor
            Case 0
                Title = "Consent Order Terminating Automatic Stay as to Trustee and Default as to Debtor(s)"
                opTrustee = "the trustee and movant having reached an agreement, the debtor(s) having failed to respond"
                opDebtor = vbNewLine & vbNewLine & "          ORDERED that the Motion for Relief from Automatic Stay be and it is hereby, entered by Default as to the Debtor(s); and be it further"
            Case 1
                Title = "Consent Order Terminating Automatic Stay"
                opTrustee = "the parties having reached an agreement"
                opDebtor = ""
        End Select

  End Select
  
ElseIf DocName = "ConsentTerminating7VAED" Then
  
  Select Case Forms![Print Consent Order Terminating 7]!optTrustee
    
    Case 0  '   not a party
        Select Case Forms![Print Consent Order Terminating 7]!optDebtor
            Case 0  ' defaulted
                Title = "Order Terminating Automatic Stay"
                opTrustee = "the debtor(s) having failed to respond"
                opDebtor = vbNewLine & vbNewLine & "          ORDERED that the Motion for Relief from Automatic Stay be and it is hereby, entered by Default as to the Debtor(s); and be it further"
            Case 1  ' agreed
                Title = "Consent Order Terminating Automatic Stay"
                opTrustee = "the parties having reached an agreement"
                opDebtor = ""
        End Select

    Case 1  ' filed report
        Select Case Forms![Print Consent Order Terminating 7]!optDebtor
            Case 0
                Title = "Order Terminating Automatic Stay"
                opTrustee = "the trustee having filed a report of no distribution, the debtor(s) having failed to respond"
                opDebtor = vbNewLine & vbNewLine & "          ORDERED that the Motion for Relief from Automatic Stay be and it is hereby, entered by Default as to the Debtor(s); and be it further"
            Case 1
                Title = "Consent Order Terminating Automatic Stay"
                opTrustee = "the trustee having filed a report of no distribution, the parties having reached an agreement"
                opDebtor = ""
        End Select

    Case 2  ' defaulted
        Select Case Forms![Print Consent Order Terminating 7]!optDebtor
            Case 0
                Title = "Order Terminating Automatic Stay"
                opTrustee = "the parties having failed to respond"
                opDebtor = vbNewLine & vbNewLine & "          ORDERED that the Motion for Relief from Automatic Stay be and it is hereby, entered by Default as to the Debtor(s) and the Chapter 7 Trustee; and be it further"
            Case 1
                Title = "Consent Order Terminating Automatic Stay as to Debtor and Default as to Chapter 7 Trustee"
                opTrustee = "the trustee having failed to file an answer, the debtor(s) and movant having reached an agreement"
                opDebtor = vbNewLine & vbNewLine & "          ORDERED that the Motion for Relief from Automatic Stay be an it is hereby, entered by Default as to the Chapter 7 Trustee; and be it further"
            End Select

    Case 3  ' agreed
        Select Case Forms![Print Consent Order Terminating 7]!optDebtor
            Case 0
                Title = "Consent Order Terminating Automatic Stay as to Trustee and Default as to Debtor(s)"
                opTrustee = "the trustee and movant having reached an agreement, the debtor(s) having failed to respond"
                opDebtor = vbNewLine & vbNewLine & "          ORDERED that the Motion for Relief from Automatic Stay be and it is hereby, entered by Default as to the Debtor(s); and be it further"
            Case 1
                Title = "Consent Order Terminating Automatic Stay"
                opTrustee = "the parties having reached an agreement"
                opDebtor = ""
        End Select
End Select
ElseIf DocName = "ConsentTerminatingWD13" Then
    If Chapter = 13 Then
         Select Case Forms![Print Consent Order Terminating 13]!optTrustee
            Case 0
                opTrustee = "the parties having reached an agreement,"
            Case 1
                opTrustee = "the trustee having filed a report of no distribution, the parties having reached an agreement, "
            Case 2
                opTrustee = "the trustee having failed to file an answer, the debtor(s) and movant having reached an agreement, "
            Case 3
                opTrustee = "the parties having reached an agreement,"
        End Select
    ElseIf Chapter = 11 Then
         Select Case Forms![Print Consent Order Terminating 11]!optTrustee
        Case 0
                opTrustee = "the parties having reached an agreement,"
            Case 1
                opTrustee = "the trustee having filed a report of no distribution, the parties having reached an agreement, "
            Case 2
                opTrustee = "the trustee having failed to file an answer, the debtor(s) and movant having reached an agreement, "
            Case 3
                opTrustee = "the parties having reached an agreement,"
        End Select
    End If
End If
End Sub
Private Function GetNextLetter() As String
Dim strAlpha As String
Dim t As String

strAlpha = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
'If LetterCounter = 0 Then
'    LetterCounter = 1
'Else
'End If
 
    t = Mid(strAlpha, lettercounter, 1)
   
    GetNextLetter = t
    lettercounter = lettercounter + 1

End Function
Private Function GetNextNumber() As String

GetNextNumber = Space$(10) & NextNumber & ".  "
NextNumber = NextNumber + 1

End Function

Private Function GetNewNextNumber() As String

GetNewNextNumber = Space$(10) & newNextNumber & ".  "
newNextNumber = newNextNumber + 1

End Function

Private Function AssignmentInfo() As String

    Select Case Forms!BankruptcyDetails!AssignBy
        Case 1              ' DOT
           
                Select Case Forms!BankruptcyDetails!AssignByDOT
                
                    Case 1      ' assignment  'Me!Subform1.Form.RecordSource
                                    
                        AssignmentInfo = Forms!BankruptcyDetails.Form.sfrmBKLoanInfo!OriginalBeneficiary & " assigned its interest to " & Forms![case list]!Investor
                    Case 2      ' merger
                        AssignmentInfo = Trim$(Forms!BankruptcyDetails!OMergerInfo) & " is now the beneficiary of the Deed of Trust due to merger."
                End Select
        
        Case 2   ' note   'Me!Subform1.Form.RecordSource
            AssignmentInfo = "The Promissory Note has been transferred from " & Forms!BankruptcyDetails.Form.sfrmBKLoanInfo!OriginalBeneficiary & " to " & Forms![case list]!Investor
                   
    If Right$(AssignmentInfo, 1) <> "." Then AssignmentInfo = AssignmentInfo & "."
    
    End Select

If IsNull(Right$(AssignmentInfo, 1)) Then AssignmentInfo = ""

End Function

Private Sub FillField(WordDocument As Word.Document, FieldName As String, Replacement As String)
Dim ReplacementData As String, ReplacementString As String, FindData As String, ChunkBegins As Integer, ChunkSize As Integer
'test
ReplacementString = RemoveLF(Replacement)

If Len(ReplacementString) > 200 Then    ' divide into chunks
    FindData = FieldName
    ChunkBegins = 1
    Do While ChunkBegins < Len(ReplacementString)
        ChunkSize = 200
        If ChunkBegins + ChunkSize > Len(ReplacementString) Then
            ChunkSize = Len(ReplacementString) - ChunkBegins + 1
        End If
        Do While Mid$(ReplacementString, ChunkSize, 1) = "^"    ' don't split a 'symbol'
            ChunkSize = ChunkSize - 1
        Loop
        ReplacementData = Mid$(ReplacementString, ChunkBegins, ChunkSize) & "<<<<More>>>>"
        GoSub Replace
        FindData = "<<More>>"
        ChunkBegins = ChunkBegins + ChunkSize
    Loop
    ReplacementData = ""    ' remove last <<More>> tag
    GoSub Replace
Else
    FindData = FieldName
    ReplacementData = ReplacementString
    GoSub Replace
End If
Exit Sub

Replace:
Dim rngStory As Word.Range, lngJunk As Long, oShp As Shape

' This may be needed work around a bug with certain headers/footers.
' But the side effect is to create headers and footers that take up space (making the margins look taller.)
''lngJunk = WordDocument.Sections(1).Headers(1).Range.StoryType

'Iterate through all story types in the current document
For Each rngStory In WordDocument.StoryRanges
    'Iterate through all linked stories
    Do
        With rngStory.Find
            .ClearFormatting
            .Replacement.ClearFormatting
            .Text = "<<" & FindData & ">>"
            .Replacement.Text = ReplacementData
            .Execute Replace:=wdReplaceAll
        End With
        On Error Resume Next
        If rngStory.ShapeRange.Count > 0 Then
            For Each oShp In rngStory.ShapeRange
                If oShp.TextFrame.HasText Then
                    With oShp.TextFrame.TextRange.Find
                        .ClearFormatting
                        .Replacement.ClearFormatting
                        .Text = "<<" & FindData & ">>"
                        .Replacement.Text = ReplacementData
                        .Execute Replace:=wdReplaceAll
                    End With
                End If
            Next
        End If
        On Error GoTo 0
        'Get next linked story (if any)
        Set rngStory = rngStory.NextStoryRange
    Loop Until rngStory Is Nothing
Next

Return
End Sub

Private Sub FillFieldSOTNationsVA(WordDocument As Word.Document, FieldName As String, Replacement As String)

Dim ReplacementData As String, ReplacementString As String, FindData As String, ChunkBegins As Integer, ChunkSize As Integer
'test
ReplacementString = RemoveLF(Replacement)
ReplacementString = Replace(Replacement, "CName", "")    'Remove the cname attached at the company name

If Len(ReplacementString) > 200 Then    ' divide into chunks
    FindData = FieldName
    ChunkBegins = 1
    Do While ChunkBegins < Len(ReplacementString)
        ChunkSize = 200
        If ChunkBegins + ChunkSize > Len(ReplacementString) Then
            ChunkSize = Len(ReplacementString) - ChunkBegins + 1
        End If
        Do While Mid$(ReplacementString, ChunkSize, 1) = "^"    ' don't split a 'symbol'
            ChunkSize = ChunkSize - 1
        Loop
        ReplacementData = Mid$(ReplacementString, ChunkBegins, ChunkSize) & "<<<<More>>>>"
        GoSub Replace
        FindData = "<<More>>"
        ChunkBegins = ChunkBegins + ChunkSize
    Loop
    ReplacementData = ""    ' remove last <<More>> tag
    GoSub Replace
Else
    FindData = FieldName
    ReplacementData = ReplacementString
    GoSub Replace
End If
Exit Sub

Replace:
Dim rngStory As Word.Range, lngJunk As Long, oShp As Shape

' This may be needed work around a bug with certain headers/footers.
' But the side effect is to create headers and footers that take up space (making the margins look taller.)
''lngJunk = WordDocument.Sections(1).Headers(1).Range.StoryType

If WordDocument = "Deed of Appointment NationStar VA.doc" And Left(FieldName, 4) = "Item" And NextNumber = 75 And InStr(Trim(Replacement), "CName") = 0 Or _
    (WordDocument = "Assignment SLS.doc" And NextNumber = 75) Then    ' NextNumber here is served as JurisdictionID   Mei
        For Each rngStory In WordDocument.StoryRanges
            Do
                With rngStory.Find
                    .ClearFormatting
                    .Replacement.ClearFormatting
                    .Text = "<<" & FindData & ">>"
                    If InStr(ReplacementData, ":") > 0 Then
                        Dim Grantorname, GrantAKA, GLName As String
                        GrantAKA = Replace([ReplacementData], ":", "")
                        Grantorname = Left(Trim([ReplacementData]), InStr([ReplacementData], ":") - 1)    'Grantor's name remains
                        GLName = Right(Grantorname, InStr(Grantorname, " ") + 2)            '???
                        .Replacement.Text = GrantAKA
                        .Execute Replace:=wdReplaceAll
                        .Text = GLName
                        .Replacement.Text = GLName
                        .Replacement.Font.Underline = wdUnderlineSingle
                        .Execute Replace:=wdReplaceAll
                        .Text = LName
                        .Replacement.Text = LName
                        .Replacement.Font.Underline = wdUnderlineSingle
                        .Execute Replace:=wdReplaceAll
                    Else
                        .Replacement.Text = ReplacementData
    '                    .Replacement.Font.Underline = wdUnderlineSingle
                        .Execute Replace:=wdReplaceAll
                        .Text = Right(Trim([ReplacementData]), Len(Trim([ReplacementData])) - InStr(1, [ReplacementData], " "))
                        .Replacement.Text = Right(Trim([ReplacementData]), Len(Trim([ReplacementData])) - InStr(1, [ReplacementData], " "))
                        .Replacement.Font.Underline = wdUnderlineSingle
                        .Execute Replace:=wdReplaceAll
                    End If
           
                End With
                On Error Resume Next
                If rngStory.ShapeRange.Count > 0 Then
                    For Each oShp In rngStory.ShapeRange
                        If oShp.TextFrame.HasText Then
                            With oShp.TextFrame.TextRange.Find
                                .ClearFormatting
                                .Replacement.ClearFormatting
                                .Text = "<<" & FindData & ">>"
                                .Replacement.Text = ReplacementData
                                .Execute Replace:=wdReplaceAll
                            End With
                        End If
                    Next
                End If
                On Error GoTo 0
                'Get next linked story (if any)
                Set rngStory = rngStory.NextStoryRange
            Loop Until rngStory Is Nothing
        Next
  
   
Else        'just underline the merging field     7/27/17

        For Each rngStory In WordDocument.StoryRanges
            'Iterate through all linked stories
            Do
                With rngStory.Find
                    .ClearFormatting
                    .Replacement.ClearFormatting
                    .Text = "<<" & FindData & ">>"
'                    .Replacement.Text = Replace([ReplacementData], ":", "")
                    .Replacement.Text = ReplacementData
                    .Replacement.Font.Underline = wdUnderlineSingle
                    .Execute Replace:=wdReplaceAll
                End With
                On Error Resume Next
                If rngStory.ShapeRange.Count > 0 Then
                    For Each oShp In rngStory.ShapeRange
                        If oShp.TextFrame.HasText Then
                            With oShp.TextFrame.TextRange.Find
                                .ClearFormatting
                                .Replacement.ClearFormatting
                                .Text = "<<" & FindData & ">>"
                                .Replacement.Text = ReplacementData
                                .Replacement.Font.Underline = wdUnderlineSingle
                                .Execute Replace:=wdReplaceAll
                            End With
                        End If
                    Next
                End If
                On Error GoTo 0
                'Get next linked story (if any)
                Set rngStory = rngStory.NextStoryRange
            Loop Until rngStory Is Nothing
        Next
End If

Return
End Sub

Private Sub FillFieldUnderline(WordDocument As Word.Document, FieldName As String, Replacement As String)
Dim rngStory As Word.Range
Dim arryReplacement() As String
Dim allNames As String
Dim i, N, j As Integer
Dim rsCompany As Recordset
Dim bCompany As Boolean

Set rsCompany = CurrentDb.OpenRecordset("Select Company, First, Last, AKA from Names where Mortgagor = true and FileNumber = " & Forms![case list]!FileNumber, dbOpenSnapshot)
rsCompany.MoveLast
N = rsCompany.RecordCount
rsCompany.MoveFirst
  
For Each rngStory In WordDocument.StoryRanges
    With rngStory.Find
                    .ClearFormatting
                    .Replacement.ClearFormatting
                    .Text = "<<" & FieldName & ">>"
                     For j = 1 To N
                       If Not IsNull(rsCompany!Company) Then
                            allNames = allNames & rsCompany!Company & "CName" & ", "
                       Else
                            allNames = allNames & rsCompany!First & " " & rsCompany!Last & Nz(rsCompany!AKA, "") & ", "
                       End If
                       rsCompany.MoveNext
'                       j = j + 1
                      Next
                    allNames = Replace(allNames, "and", ",")
                    allNames = Left(Trim(allNames), Len(Trim(allNames)) - 1)
                    .Replacement.Text = Replace(Trim(allNames), "CName", "")
                    .Execute Replace:=wdReplaceAll
              
                    arryReplacement = Split(allNames, ",")
'                    .Replacement.Text = arryReplacement()
                    
                    For i = 0 To UBound(arryReplacement)
                     
                      If Right(arryReplacement(i), 5) <> "CName" Then  'underline the Last name
                              If InStr(arryReplacement(i), "AKA") > 0 Or InStr(arryReplacement(i), "nka") > 0 Then
                                If InStr(arryReplacement(i), "AKA") > 0 Then
                                    allNames = Trim(Left(arryReplacement(i), InStr(arryReplacement(i), "aka") - 2))
                                Else
                                    allNames = Trim(Left(arryReplacement(i), InStr(arryReplacement(i), "nka") - 2))
                                End If
                                
                                allNames = Replace(allNames, Left(allNames, InStrRev(allNames, " ")), "")       'Get the Last name
                                .Text = allNames & " "    'underline only the last name  before nka, the same last name after nka is excluded.  OMG! Mei
                                .Replacement.Text = allNames & " "
                                .Replacement.Font.Underline = wdUnderlineSingle
                                .Execute Replace:=wdReplaceAll
        '                        .Text = " nk"
        '                        .Replacement.ClearFormatting
        '                        .Replacement.Text = " nk"
        '                        .Execute Replace:=wdReplaceAll
                              Else
                                .Text = Right(Trim(arryReplacement(i)), Len(Trim(arryReplacement(i))) - InStrRev(Trim(arryReplacement(i)), " "))
                                .Replacement.Text = Right(Trim(arryReplacement(i)), Len(Trim(arryReplacement(i))) - InStrRev(Trim(arryReplacement(i)), " "))
                                .Replacement.Font.Underline = wdUnderlineSingle
                                .Execute Replace:=wdReplaceAll
                             End If
                      End If
                    Next
                
    End With
    Exit For
Next
    
End Sub

Private Sub SaveDoc(WordDoc As Word.Document, FileNumber As Long, filename As String)
Dim Filespec As String

Filespec = DocLocation & DocBucket(FileNumber) & "\" & FileNumber & "\" & filename
Do Until Dir$(Filespec) = ""
    filename = InputBox$(filename & " already exists, please enter another name:", , filename)
    If Len(filename) > 0 Then
        If UCase$(Right$(filename, 4)) <> ".DOC" Then filename = filename & ".doc"
        Filespec = DocLocation & DocBucket(FileNumber) & "\" & FileNumber & "\" & filename
    Else
        Exit Sub
    End If
Loop
WordDoc.SaveAs Filespec

End Sub

Private Sub SaveDocNew(WordDoc As Word.Document, FileNumber As Long, filename As String)
Dim Filespec As String

Filespec = DocLocation & DocBucket(FileNumber) & "\" & FileNumber & "\" & filename

If Dir$(DocLocation & DocBucket(FileNumber) & "\" & FileNumber & "\" & filename) <> "" Then
            MsgBox FileNumber & " already exists.", vbCritical
            Exit Sub
End If

WordDoc.SaveAs Filespec

End Sub
Private Sub UploadWordDoc(FileNumber As Long, filename As String)
Dim selecteddoctype As Long
Dim DocDate As Date
Dim strsql As String
Dim strSQLValues As String
        
strsql = ""
strSQLValues = ""
DocDate = Now
selecteddoctype = 0

DoCmd.SetWarnings False
               
'    strSQLValues = FileNumber & "," & selecteddoctype & ",'" & "" & "'," & GetStaffID() & ",'" & DocDate & "','" & Replace(Filename, "'", "''") & "','" & Replace(newfilename, "'", "''") & "'," & 1
'    strsql = "Insert Into DocIndex (FileNumber,DocTitleID,DocGroup,StaffID,DateStamp,Filespec,Notes,Doctype) VALUES (" & strSQLValues & ")"

    strSQLValues = FileNumber & "," & selecteddoctype & ",'" & "" & "'," & GetStaffID() & ",'" & DocDate & "','" & Replace(filename, "'", "''") & "','" & Replace(filename, "'", "''") & "'"
    strsql = "Insert Into DocIndex (FileNumber,DocTitleID,DocGroup,StaffID,DateStamp,Filespec,Notes) VALUES (" & strSQLValues & ")"
    DoCmd.RunSQL (strsql)
    
    strsql = ""
    strsql = "Insert Into DocumentSuport (DocName,FormatID) VALUES ('" & filename & "' , 1)"
    
    DoCmd.RunSQL (strsql)
        
    DoCmd.SetWarnings True
End Sub

Public Sub OpenFrm(Doc As String, PrintTo As Integer)
    DoCmd.OpenForm "GetDocType", , , , , acDialog, Doc & "|" & PrintTo & "|0"
End Sub

Public Sub Doc_OwnershipAffidavitMDHC(KeepOpen As Boolean)

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")

Call OpenDocAsSaved("Note Ownership Affidavit MDHC")

Set WordDoc = WordObj.Documents.Open(EMailPath & "Note Ownership Affidavit MDHC", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "Investor2", IIf(d![ClientID] = 385, d![Investor2], d![Investor])
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "NoteOwner", FetchNoteOwner(d!LoanType, IIf(d![ClientID] = 385, d![Investor2], d![Investor]), d![FCdetails.State])
FillField WordDoc, "Noteholders", GetNamesMD(0, 2, "Noteholder=True")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, d!LongClientName & " as Attorney in Fact for ", "") & d!Investor
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID)
FillField WordDoc, "FHLMCWording", IIf(d!LoanType = 5 Or d!LoanType = 4, ", and " & IIf(d![ClientID] = 385, d![Investor2], d![Investor]) & " is the holder of the Note having been transferred to " & IIf(d![ClientID] = 385, d![Investor2], d![Investor]) & " for the purposes of enforcement and conducting this foreclosure action", "")
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 464, "")
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ____________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ____________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: __________________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Note Ownership Affidavit MDHC.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Note Ownership Affidavit MDHC.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_StatementOfDebtWithFiguresOcwen(KeepOpen As Boolean)

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset, dd As Recordset      ' data
Dim i As Integer, itemcount As Integer, TotalItems As Currency, itemsFields As String
Dim InterestFrom As String
Dim InterestTo As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String
templateName = "Statement of Debt Figures Ocwen"
templateName = templateName '& ".doc"

InterestFrom = InputBox("Interest From")
InterestTo = InputBox("Interest To")

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

WordObj.Visible = False
If MsgBox("Is There A Loan Mod? ", vbYesNo) = vbYes Then
FillField WordDoc, "Mod", ", MODIFIED by Agreement effective " & Format(InputBox(" Effective Date?   Format mm/dd/yyyy"), "mmmm d, yyyy") & " with an amended principal balance of " & Format(InputBox(" Amended Principal Balance? "), "Currency")
Else
FillField WordDoc, "Mod", ""
End If
WordObj.Visible = True

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber

FillField WordDoc, "Investor", IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for ", "") & d!Investor

FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", IIf(d!CaseTypeID = 8, d!MonitorTrusteeAddress, FirmShortAddress(vbCr))
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
'FillField WordDoc, "455Only", IIf(D![ClientID] = 455, ", and continuing each month thereafter with probable future advancements made by the mortgagee, and that the Plaintiff(s) has\have the right to foreclose;", ", and continuing each month thereafter, and that the Plaintiff(s) has\have the right to foreclose;")
FillField WordDoc, "Liber", d![Liber]
FillField WordDoc, "Folio", d![Folio]
FillField WordDoc, "LPIdate", Format$(d![LPIDate], "mmmm d, yyyy")
FillField WordDoc, "LPIdate+1", Format$(d![LPIDate] + 1, "mmmm d, yyyy")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
'FillField WordDoc, "PaidStr", IIf((Nz(D![RemainingPBal], 0) > Nz(D![OriginalPBal], 0)), "Additional Interest", "Paid on principal")
'FillField WordDoc, "Paid", Format$(D!OriginalPBal - D!RemainingPBal, "Currency")
FillField WordDoc, "RemainingPBal", Format$(d!RemainingPBal, "Currency")
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 223, "")
'FillField WordDoc, "diem", IIf(D![LoanType] = 3, IIf(D![ClientID] <> 531, "Per Monthly Interest: ", "Per Diem Interest: "), "Per Diem Interest: ")
'FillField WordDoc, "txtbalanc", IIf(D![ClientID] = 361, "Unpaid Principal Balance", "Remaining Balance Due")
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ______________", "")

TotalItems = 0
itemsFields = ""

Set dd = CurrentDb.OpenRecordset("SELECT Desc, Amount FROM StatementOfDebt WHERE FileNumber=" & d![CaseList.FileNumber] & " ORDER BY StatementOfDebt.Sort_Desc DESC;", dbOpenSnapshot)
If dd.EOF Then      ' no extra lines  'More like Not an empty recordset you mean
    FillField WordDoc, "Line_Items", ""
Else
    dd.MoveLast
    itemcount = dd.RecordCount
    ' Make enough lines
    For i = 1 To itemcount
        itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
    Next i
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
    FillField WordDoc, "Line_Items", itemsFields
    dd.MoveFirst
    i = 1
    Do While Not dd.EOF
        FillField WordDoc, "Item" & i, IIf(dd!Desc = "Interest", "Interest at " & Format$(Forms![Print Statement of Debt]!InterestRate, "#0.000%") & " for " & [InterestFrom] & " to " & [InterestTo] & vbTab & Format$(Nz(dd!Amount, 0), "Currency"), dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency"))
        'FillField WordDoc, "Item" & i, dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency")
        TotalItems = TotalItems + Nz(dd!Amount, 0)
        dd.MoveNext
        i = i + 1
       
    Loop
End If
dd.Close

FillField WordDoc, "BalDueDate", IIf(IsNull([Forms]![Print Statement of Debt]![txtDueDate]), "______________", Format$([Forms]![Print Statement of Debt]![txtDueDate], "mmmm d"", ""yyyy"))
FillField WordDoc, "BalanceDue", Format$(d!RemainingPBal + TotalItems, "Currency")
FillField WordDoc, "PerDiemInterest", IIf(IsNull(d!PerDiem), "$_____________", Format$(d!PerDiem, "Currency"))
FillField WordDoc, "InterestRate", IIf(IsNull(d!InterestRate), "____________ %", Format(d!InterestRate, "#0.000") & "%")
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", IIf(IsNull(d!NotaryLocation), "STATE OF ______________:" & vbCr & "COUNTY OF ____________ :", d!NotaryLocation)

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Statement of Debt with Figures Ocwen.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Statement of Debt with Figures Ocwen.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_Ad_MD(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Ad MD")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Ad MD", False)
WordObj.Visible = True

'FillField WordDoc, "firmAdd", FirmAddress()

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then
        FillField WordDoc, "FirmAdd", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "FirmAdd", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then
        FillField WordDoc, "FirmAdd", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
                  DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID =2")
End If
FillField WordDoc, "firmPhone", FirmPhone()
FillField WordDoc, "TrusteeWord", UCase$(TrusteeWord(d![CaseList.FileNumber], 0))
FillField WordDoc, "Property", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & vbCr & d!City & ", " & d![FCdetails.State] & ", " & FormatZip(d!ZipCode)
FillField WordDoc, "Mortgagors", IIf(IsNull(d!OriginalMortgagors), MortgagorNames(d![CaseList.FileNumber], 2), d!OriginalMortgagors & " assumed by " & MortgagorNames(d![CaseList.FileNumber], 2))
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "LiberFolio", LiberFolio(d!Liber, d!Folio, d![FCdetails.State])
FillField WordDoc, "Jurisdiction", d!Jurisdiction & ", " & d![FCdetails.State]
FillField WordDoc, "SaleLocation", d!SaleLocation
FillField WordDoc, "SaleDate", Format$(d!Sale, "mmmm d, yyyy")
FillField WordDoc, "SaleTime", Format$(d!SaleTime, "h:nn AM/PM")
FillField WordDoc, "Ownership", IIf(d!Leasehold = 1, "LEASEHOLD", "FEE-SIMPLE")
FillField WordDoc, "GroundRent", IIf(d!Leasehold = 1, "subject to annual ground rent of " & Format$(d!GroundRentAmount, "Currency") & ", payable " & d!GroundRentPayable & ", ", "")
FillField WordDoc, "DOTWord", DOTWord(d!DOT)
FillField WordDoc, "PriorLien", IIf(d!LienPosition <= 1, "", "          The property will be sold subject to a prior mortgage, the amount to be announced at the time of sale." & vbCr)
FillField WordDoc, "IRSLiens", IIf(d!IRSLiens, "The property will be sold subject to a 120 day right of redemption by the Internal Revenue Service.  ", "")
FillField WordDoc, "Deposit", Format$(d!Deposit, "Currency")
FillField WordDoc, "Trustees", trusteeNames(d![CaseList.FileNumber], 2)

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Ad MD.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Ad MD.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub
Public Sub doc_SOTAffidavitMD(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qrySOTAffFCDocsLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("SOT Affidavit MD")
Set WordDoc = WordObj.Documents.Open(EMailPath & "SOT Affidavit MD.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName] '& vbct StopBySarab
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), " ", ", " & d![Fair Debt] & ", ") & d!City & ", " & d![FCdetails.State] & " " & Format(d!ZipCode)

    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "UpperJurisdiction", UCase$(d![Jurisdiction] & ", " & d![LongState])
FillField WordDoc, "CourtCaseNumber", IIf(IsNull(d!CourtCaseNumber), "", d!CourtCaseNumber)
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3)
'FillField WordDoc, "FirmShortAddress", FirmShortAddress()
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "TrusteeNames2", trusteeNamesCPTF(0, 3) & TrusteeWord(0, 0)
FillField WordDoc, "firmAddress", IIf((IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 1), FirmAddress(), _
                IIf([Forms]![foreclosurePrint]![cboOfficeLocation] = 2, FirmAddressVA(), DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
                                DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")))
FillField WordDoc, "firmphone", IIf((IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 1), FirmPhone(), FirmPhoneVA())
WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "SOT Affidavit MD.doc.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "SOT Affidavit MD.doc.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub
Public Sub Doc_Ad_VA(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Ad VA_New")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Ad VA_New.doc", False)
WordObj.Visible = True

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then
        FillField WordDoc, "FirmAddr", "Rosenberg & Associates, LLC" & vbCr & "(Attorney for the Secured Party)" & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "FirmAddr", DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then
        FillField WordDoc, "FirmAddr", DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                  DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
End If

FillField WordDoc, "Property", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!City & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode)
FillField WordDoc, "DOTWord", DOTWord(d!DOT)
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "LiberFolio", LiberFolio(d!Liber, d!Folio, d![FCdetails.State])
FillField WordDoc, "Req", IIf(IsNull(d![Rerecorded]), "", " and re-recorded at " & LiberFolio(d!Liber2, d!Folio2, d![FCdetails.State], 0, 1) & ",") & IIf(IsNull(d![LoanMod]), "", " and a Loan Modification recorded on " & Format$(d![LoanModRecorded], "mmmm d, yyyy") & " " & LiberFolio(d![LiberLoanMod], d![FolioLoanMod], d![FCdetails.State], 0, 0, 1) & ",")
'FillField WordDoc, "Mod",
FillField WordDoc, "Jurisdiction", d!Jurisdiction & ", " & d![FCdetails.State]
FillField WordDoc, "OriginalBalance", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "TrusteeWord", UCase$(TrusteeWord(d![CaseList.FileNumber], 0))
FillField WordDoc, "Trustees", trusteeNames(d![CaseList.FileNumber], 2)
FillField WordDoc, "SaleLocation", Nz(d!SaleLocation)
FillField WordDoc, "SaleDate", Format$(d!Sale, "mmmm d, yyyy")
FillField WordDoc, "SaleTime", Format$(d!SaleTime, "h:nn AM/PM")
FillField WordDoc, "ShortLegal", IIf(d![UseFullLegal] = True, d![LegalDescription], d![ShortLegal])
FillField WordDoc, "PriorLien", IIf(d!LienPosition <= 1, "", "The property will be sold subject to " & IIf(d!LienPosition = 2, "a prior mortgage, the amount", "prior mortgages, the amounts") & " to be announced at the time of sale." & vbCr)
FillField WordDoc, "IRSLiens", IIf(d!IRSLiens, "The property will be sold subject to a 120 day right of redemption by the Internal Revenue Service.  ", "")
FillField WordDoc, "Deposit", Format$(d!Deposit, "Currency")
FillField WordDoc, "Contact", DLookup("sValue", "DB", "Name='ContactPhone'")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Ad VA.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Ad VA.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_Ad_DC(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data


Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
'Set WordDoc = WordObj.Documents.Open(EMailPath & "Ad DC.doc", False)
Call OpenDocAsSaved("DC Sale ad")
Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Sale ad.doc", False)
WordObj.Visible = True

FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
FillField WordDoc, "LegalDescription", d!LegalDescription
FillField WordDoc, "TrusteeWord", UCase$(TrusteeWord(d![CaseList.FileNumber], 0))
FillField WordDoc, "VendorAddr", DLookup("StreetAddress", "Vendors", "ID=222") & vbCr & DLookup("City", "Vendors", "ID=222") & ", " & DLookup("State", "Vendors", "ID=222") & " " & DLookup("Zipcode", "Vendors", "ID=222") & _
                " " & DLookup("PhoneNum", "Vendors", "ID=222")
FillField WordDoc, "SaleLocation", d!SaleLocation
FillField WordDoc, "VendorPh", DLookup("PhoneNum", "Vendors", "ID=222")
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!City & ", " & d![FCdetails.State] & ", " & FormatZip(d!ZipCode)
'FillField WordDoc, "DOTRecorded", Format$(d!DOTrecorded, "mmmm d, yyyy")
FillField WordDoc, "DoTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "Liber", d!Liber
'FillField WordDoc, "Docket", Format$(d!Docket, "mmmm d, yyyy")
FillField WordDoc, "SaleDate", Format$(d!Sale, "dddd, mmmm d, yyyy")
FillField WordDoc, "SaleTime", Format$(d!SaleTime, "h:nn AM/PM")
'FillField WordDoc, "TaxID", d!TaxID
'FillField WordDoc, "IRSLiens", IIf(d!IRSLiens, "The property will be sold subject to a 120 day right of redemption by the Internal Revenue Service.  ", "")
'FillField WordDoc, "PriorLien", IIf(d!LienPosition <= 1, "", "The property will be sold subject to a prior mortgage, the amount to be announced at the time of sale.  ")
FillField WordDoc, "Deposit", Format$(d!Deposit, "Currency")
FillField WordDoc, "TrusteeName", trusteeNames(d![CaseList.FileNumber], 2)
FillField WordDoc, "Month", Format(Date, "mmmm")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Ad DC.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Ad DC.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub
 Public Sub doc_SCRANotice90Day(KeepOpen As Boolean)
 
 Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
 Set WordObj = CreateObject("Word.Application")
 Call OpenDocAsSaved("SCRA NOTICE 90-Day")
 'Set WordDoc = WordObj.Documents.Open(EMailPath & "SCRA NOTICE 90-Day.doc", False)
 Set WordDoc = WordObj.Documents.Open(EMailPath & "SCRA NOTICE 90-Day.doc", False)

 WordObj.Visible = True
 
 FillField WordDoc, "loginName", GetLoginName()
 End Sub

Public Sub Doc_DebtDispute(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRptDebtDisputeWrd WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "There's no record for this file."
    Exit Sub
End If

Dim templateName As String
templateName = "Debt Dispute Timely"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

FillField WordDoc, "date", Format(Date, "mmmm dd, yyyy")
FillField WordDoc, "Requestor", [Forms]![frmDebtDispute]![txtRequestor]
FillField WordDoc, "RequestorAddr", [Forms]![frmDebtDispute]![txtrequestorAddr]
FillField WordDoc, "PrimaryName", [Forms]![ForeclosureDetails]![PrimaryFirstName] & " " & [Forms]![ForeclosureDetails]![PrimaryLastName] & IIf(Not IsNull([Forms]![ForeclosureDetails]![SecondaryFirstName]), vbCr & [Forms]![ForeclosureDetails]![SecondaryFirstName] & " " & [Forms]![ForeclosureDetails]![SecondaryLastName], "")
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", d![Fair Debt]) & vbCr & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "LoanNo", d!LoanNumber
FillField WordDoc, "FileNumber", d!FileNumber
FillField WordDoc, "Doc", IIf([Forms]![frmDebtDispute]![frameDoc] = 1, "Promissory Note", IIf([Forms]![frmDebtDispute]![frameDoc] = 2, "Deed of Trust", "Promissory Note and Deed of Trust"))
FillField WordDoc, "Client", d!LongClientName
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "OrigBeneficiary", Nz(d!OriginalBeneficiary, "___________________")
FillField WordDoc, "BeneficiaryAddr", [Forms]![frmDebtDispute]![txtOrigBenefAddr]
FillField WordDoc, "LosMitPhone", Nz(d!LossMitPhone, "___________________")


WordObj.Selection.HomeKey wdStory, wdMove
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_DebtDisputeUntime(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRptDebtDisputeWrd WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "There's no record for this file."
    Exit Sub
End If

Dim templateName As String
templateName = "Debt Dispute UnTimely"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

FillField WordDoc, "date", Format(Date, "mmmm dd, yyyy")
FillField WordDoc, "Requestor", [Forms]![frmDebtDispute]![txtRequestor]
FillField WordDoc, "RequestorAddr", [Forms]![frmDebtDispute]![txtrequestorAddr]
FillField WordDoc, "PrimaryName", [Forms]![ForeclosureDetails]![PrimaryFirstName] & " " & [Forms]![ForeclosureDetails]![PrimaryLastName] & IIf(Not IsNull([Forms]![ForeclosureDetails]![SecondaryFirstName]), vbCr & [Forms]![ForeclosureDetails]![SecondaryFirstName] & " " & [Forms]![ForeclosureDetails]![SecondaryLastName], "")
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", d![Fair Debt]) & vbCr & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "LoanNo", d!LoanNumber
FillField WordDoc, "FileNumber", d!FileNumber
FillField WordDoc, "Doc", IIf([Forms]![frmDebtDispute]![frameDoc] = 1, "Promissory Note", IIf([Forms]![frmDebtDispute]![frameDoc] = 2, "Deed of Trust", "Promissory Note and Deed of Trust"))
FillField WordDoc, "Client", d!LongClientName
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "OrigBeneficiary", d!OriginalBeneficiary
FillField WordDoc, "BeneficiaryAddr", [Forms]![frmDebtDispute]![txtOrigBenefAddr]
FillField WordDoc, "LosMitPhone", d!LossMitPhone


WordObj.Selection.HomeKey wdStory, wdMove
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_Declaration(KeepOpen As Boolean) ' 02/05/16

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, sd1, sd2 As Recordset
Dim itemsFields As String, i, j, itemcount As Integer, TotalItems1, TotalItems2, Tamount As Currency

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRptDeclarationWord WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
Set sd1 = CurrentDb.OpenRecordset("SELECT * FROM FailedPayment where FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
Set sd2 = CurrentDb.OpenRecordset("SELECT * FROM PostPetitionPayments WHERE FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If sd1.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers in sd1"
    Exit Sub
End If

If sd2.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers in sd2"
    Exit Sub
End If

Dim templateName As String
templateName = "Declaration" ' & ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

'margin address:
    If [Forms]![BankruptcyPrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

 FillField WordDoc, "DistrictName", UCase$(d![Name])
 FillField WordDoc, "DistrictsLocation", d![Location]
 FillField WordDoc, "DebtorNames", UCase$(DebtorNames(0, 3))
 FillField WordDoc, "plural", IIf(CountNames(d![FileNumber], "BKDebtor = True And (BKOwner=True Or BKMortgagor=True)") > 1, "s", "")
 FillField WordDoc, "CourtCaseNumber", d!CaseNo
 FillField WordDoc, "BKchapter", Nz(d![BKdetails.Chapter])
 FillField WordDoc, "Investor", UCase$(d![Investor])
 FillField WordDoc, "InvestorAdd", d!InvestorAddress
 FillField WordDoc, "Address", GetAddresses(0, 4, IIf(d![BKdetails.Chapter] = 13, "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)")) _
        & IIf(d![BKdetails.Chapter] = 7, vbCr & vbCr & "and" & vbNewLine & vbNewLine & FormatName("", UCase$(Nz(d![First])), UCase$(Nz(d![Last])), ", CHAPTER 7 TRUSTEE", d![Address], d![Address2], d![BKTrustees.City], d![BKTrustees.State], d![Zip]), "")
 FillField WordDoc, "DeclarationName", IIf(IsNull([Forms]![Print Declaration].[NameI]), "____________________", [Forms]![Print Declaration].[NameI])
 FillField WordDoc, "DeclarationTitle", IIf(IsNull([Forms]![Print Declaration].[TitleI]), "____________________", [Forms]![Print Declaration].[TitleI])
 FillField WordDoc, "Investor", Nz(d!Investor)
 FillField WordDoc, "BorrowersNames", BrowersNamesBK(d![FileNumber], 2, "Borrower=True")
 FillField WordDoc, "DOTDate", Format$(d![DOTdate], "mmmm dd"", ""yyyy")
 FillField WordDoc, "OriginalBeneficiary", Nz(d![OriginalBeneficiary])
 FillField WordDoc, "OriginalPBal", Format$(d![OriginalPBal], "Currency")
 FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), " ", ", " & d![Fair Debt] & ", ") & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
 FillField WordDoc, "endorsed", Nz([Forms]![Print Declaration]![Endorsed])
 FillField WordDoc, "AsOfDate", Format$(d![AsOfDate], "mmmm dd"", ""yyyy")
 FillField WordDoc, "RemainingPBal", Format(d![RemainingPBal], "Currency")
 'FillField WordDoc, "TotFailedPetitionPay", Format(([FailedPaymentSub].[Report].[TotalFialdPayment] + [PostPetitionPaymentsSub].[Report].[TotalPostPetition]), "Currency")
 'FillField WordDoc, "FailedPayment", Format([FailedPaymentSub].[Report].[TotalFialdPayment],"Currency")
 FillField WordDoc, "Paragrph11", IIf((Not IsNull([Forms]![Print Declaration].[TxtExhibit]) Or [Forms]![Print Declaration]![chExhibit]), "11. Attached hereto as Exhibit " & [Forms]![Print Declaration]![TxtExhibit] & " is a postpetition payment history.", "")

' If sd1.EOF Then      ' no extra lines
'    FillField WordDoc, "NumMissed", ""
'Else
    sd1.MoveLast
    itemcount = sd1.RecordCount
    ' Make enough lines
    For i = 1 To itemcount
        itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
    Next i
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
    FillField WordDoc, "NumMissed", itemsFields
    sd1.MoveFirst
    i = 1
    Do While Not sd1.EOF
        FillField WordDoc, "Item" & i, sd1!NumMissed & vbTab & sd1!FromD & vbTab & sd1!ToD & vbTab & Format$(sd1!PandI, "currency") & vbTab & _
            Format$(sd1!Escrow, "Currency") & vbTab & Format$(sd1!MontlyP, "Currency") & vbTab & Format$(sd1!TotalP, "Currency") & vbNewLine _
            & "________________________________________________________________________________"
        TotalItems1 = TotalItems1 + Nz(sd1!TotalP, 0)
        sd1.MoveNext
        i = i + 1
    Loop
    FillField WordDoc, "tamt", Format$(TotalItems1, "currency")
    FillField WordDoc, "balance", "(" & Format([Forms]![BankruptcyDetails]![sfrmFailedPayment].[Form]![sfrmSusbandBalance].[Form]![SusBalancee], "Currency") & ")"
'End If

    itemcount = 0
    itemsFields = ""
    
    sd2.MoveLast
    itemcount = sd2.RecordCount
        For j = 1 To itemcount
        itemsFields = itemsFields & "<<Item" & j & ">>" & vbCr
    Next j
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
    FillField WordDoc, "Desc", itemsFields
    
    sd2.MoveFirst
    j = 1
    Do While Not sd2.EOF
        FillField WordDoc, "item" & j, vbTab & Format$(sd2!Descrip, "currency") & vbTab & Format$(sd2!Amount, "Currency") & vbNewLine & _
            "________________________________________________________________________________"
        TotalItems2 = TotalItems2 + Nz(sd2!Amount, 0)
        sd2.MoveNext
        j = j + 1
    Loop
    
    FillField WordDoc, "Total", Format$(TotalItems2, "currency")
    
sd1.Close
sd2.Close
 
 If IsNull([Forms]![Print Declaration].[ExcutedDate]) Then
    FillField WordDoc, "ExcutedDate", "___ day of _____, ____ ."
 Else
    FillField WordDoc, "ExcutedDate", IIf(IsNull([Forms]![Print Declaration].[ExcutedDate]), "___ day of _____, ____ .", NumSuffix(Format$([Forms]![Print Declaration].[ExcutedDate], "dd")) & " day of " & Format$([Forms]![Print Declaration].[ExcutedDate], "mmmm") & ", " & Format$([Forms]![Print Declaration].[ExcutedDate], "yyyy"))
 End If
 
 FillField WordDoc, "TotFailedPetitionPay", Format(TotalItems2 + TotalItems1, "currency")
 FillField WordDoc, "FailedPayment", Format(TotalItems1, "currency")
 FillField WordDoc, "Name", "/s/ " & IIf(IsNull(Forms![Print Declaration].NameI), "", Forms![Print Declaration].NameI)
 FillField WordDoc, "Title", IIf(IsNull(Forms![Print Declaration].NameI), "Name: " & vbCr & "Title:", Forms![Print Declaration].NameI & vbCr & "Title: " & Forms![Print Declaration]!TitleI)

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & templateName
'Call SaveDoc(WordDoc, d![FileNumber], templateName)
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub
Public Sub Doc_SOTSelectDC(KeepOpen As Boolean, State)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

If State = "DC" Then
    Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
ElseIf State = "VA" Then
    Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRptSOTSelectVA WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
End If

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String
If State = "DC" Then
    templateName = "SOT Select Dc"
ElseIf State = "VA" Then
    templateName = "SOT Select VA"
End If
Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", d![Fair Debt]) & vbNewLine & d!City & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode)
'WordDoc.Bookmarks("APTNum").Select
'WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

'margin address:
    If (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "VA") Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation])) _
                    Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2") & vbCr & FirmPhoneVA()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "MD") Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1") & vbCr & FirmPhone()
        FillField WordDoc, "firmAddr", FirmAddress()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3") & vbCr & FirmPhone()
        FillField WordDoc, "firmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
'FillField WordDoc, "firmAddr", FirmAddressVA()
FillField WordDoc, "FileNo", "File Number: " & d![CaseList.FileNumber]
FillField WordDoc, "DOTdate", Format(d!DOTdate, "mmmm d"", ""yyyy")
FillField WordDoc, "Mortgagors", IIf(d![JurisdictionID] = 153, MortgagorNamesCaps(d![CaseList.FileNumber], 2, 1), MortgagorNamesCaps(d![CaseList.FileNumber], 2, 2))
FillField WordDoc, "OriginalTrustee", d!OriginalTrustee
FillField WordDoc, "OriginalBeneficiary", d!OriginalBeneficiary
FillField WordDoc, "TrusteeNames", trusteeNames(0, 2)
 
If State = "DC" Then
    FillField WordDoc, "FirmAddr", FirmAddressVA()
    FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
    FillField WordDoc, "Liber", d!Liber
    FillField WordDoc, "Liber2", IIf(IsNull(d!Rerecorded), ", ", ", and re-recorded as Instrument Number " & d![Liber2] & ", ")
    FillField WordDoc, "taxID", d!TaxID
Else
    FillField WordDoc, "FirmAddr", FirmShortAddressVA()
    FillField WordDoc, "MERS", IIf(d!MERS, "Mortgage Electronic Registration Systems, Inc. (MERS) as nominee for ", "")
    FillField WordDoc, "LiberFolio", IIf(IsNull([DOTrecorded]), "", IIf(Not IsNull(d![Liber]) And Not IsNull(d![Folio]), " in Book " & d![Liber] & " and Page " & d![Folio], " as Instrument " & d![Liber]))
    FillField WordDoc, "DOTRecorded", Format$(d![DOTrecorded], "mmmm dd"", ""yyyy")
    FillField WordDoc, "Jurisdiction", d!Jurisdiction
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", " and re-recorded on " & Format$(d![Rerecorded], "mmmm dd"", ""yyyy ") & _
                    IIf((Not IsNull(d![Liber2]) And Not IsNull(d![Folio2])), " in Book " & d![Liber2] & " and Page " & d![Folio2] & ",", " as Instrument " & d![Liber2] & ","))
    FillField WordDoc, "FrimVAAdd", FirmShortAddressVAOneLine()
    FillField WordDoc, "taxID", IIf(d![JurisdictionID] = 56, "Tax Map Number: ", "Tax ID: ") & d![TaxID]
End If

FillField WordDoc, "InvestorAIF", d![Investor] & IIf(d![AIF] = True, ", by Select Portfolio Servicing, Inc., as attorney-in-fact ", "")

WordObj.Selection.HomeKey wdStory, wdMove
WordDoc.ActiveWindow.View = wdPrintView

Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_DeedApp(KeepOpen As Boolean) ' Deed of Appointment VA/MD
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String
templateName = "Deed of Appointment"
If (d![FCdetails.State] = "VA") And d![ClientID] <> 404 Then        'Bogman VA has its owe file
  templateName = "SOT VA"
ElseIf (d![FCdetails.State] = "MD") And d![ClientID] = 523 Then
    templateName = "SOT Ditech MD"                  'templateName & " Green Tree"
End If

'If d![ClientID] = 345 Then
'  templateName = templateName & " Kondaur"         'use SOT or SOT VA for Konduar  3/14/16
If d!ClientID = 466 And d![FCdetails.State] = "MD" Then 'SELECT
    templateName = templateName & " Select"
ElseIf (d![ClientID] = 334 Or d![ClientID] = 477) Then
  templateName = templateName & " Saxon"
'ElseIf d![ClientID] = 87 Then
'  templateName = templateName & " PNC"
ElseIf d![ClientID] = 258 And d![FCdetails.State] = "MD" Then
    templateName = templateName & " Green Tree"

ElseIf d![ClientID] = 404 Then
  templateName = templateName & " Bogman"
ElseIf (d![ClientID] = 451 And Trim(UCase$(d!Investor)) Like "LPP*" And d![FCdetails.State] = "VA") Then
    templateName = templateName & " Dove LPP"
ElseIf (d![ClientID] = 451 And Trim(UCase$(d!Investor)) Like "LPP*" And d![FCdetails.State] = "MD") Then
    templateName = templateName & " Dove LPP"
ElseIf d![ClientID] = 451 Or (d!ClientID = 634 And d![FCdetails.State] = "MD") Then   '01/14/16 addCDA-Dove
    templateName = templateName & " Dove"

End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True
'
'If d!ClientID = 451 Then
'    WordDoc.Bookmarks("LastName").Select
'    WordDoc.Bookmarks("LastName").Range.Text = d![PrimaryLastName]
'End If

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

'margin address:
If d![FCdetails.State] = "MD" Then
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
        FillField WordDoc, "FirmPh", FirmPhoneVA()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
        FillField WordDoc, "FirmPh", FirmPhone()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
        FillField WordDoc, "FirmPh", FirmPhone()
    End If
Else
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
        FillField WordDoc, "FirmPh", FirmPhoneVA()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
        FillField WordDoc, "FirmPh", FirmPhone()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
        FillField WordDoc, "FirmPh", FirmPhone()
    End If
End If
    
If (d![FCdetails.State] = "VA") Then
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
        FillField WordDoc, "FirmPh", FirmPhoneVA()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
        FillField WordDoc, "FirmPh", FirmPhone()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
        FillField WordDoc, "FirmPh", FirmPhone()
    End If
End If

If d!ClientID = 532 Or d!ClientID = 466 Then
    FillField WordDoc, "Barcode", ""
Else
    FillField WordDoc, "Barcode", IIf(d!ClientID <> 634, IIf(d!ClientID <> 444, AddDocPreIndex(d![CaseList.FileNumber], 226, ""), ""), "")
End If

FillField WordDoc, "PrimaryLName", Nz(d!PrimaryLastName)   '01/14/16

If d!JurisdictionID = 56 And d![FCdetails.State] = "VA" Then
    FillField WordDoc, "Tax", "Tax Map Number:"
Else
    FillField WordDoc, "Tax", "Tax ID #:"
End If

If d![FCdetails.State] = "MD" Then
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Liber " & d![Liber2] & ", Folio " & d![Folio2])

ElseIf (d![FCdetails.State] = "VA") Then
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", IIf(IsNull(d![Folio2]), ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & _
    " at Instrument Number " & d![Liber2], ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Liber " & IIf(IsNull(d![Liber2]), " ", d![Liber2]) & ", Folio " & d![Folio2]))
'ElseIf d!JurisdictionID = 6 Then  'Calvert County
'    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Book " & d![Liber2] & ", Page " & d![Folio2])
ElseIf d![FCdetails.State] = "DC" Then

     FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Instrument Number " & d![Liber2])

End If

FillField WordDoc, "upto", IIf(d!ClientID = 567, "up to ", "")
FillField WordDoc, "LoanNumber", d!LoanNumber


If d!JurisdictionID = 153 Then 'Accomack VA
       FillField WordDoc, "OriginalTrustee", UCase$(d!OriginalTrustee)
    'FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, d!LongClientName & " as Attorney in Fact for ", "") & UCase$(d!Investor)
'    FillField WordDoc, "DCPUF", IIf(d![ClientID] = 593 And ([Forms]![ForeclosurePrint]![txtDesignatedAttorney] = 3 Or [Forms]![ForeclosurePrint]![txtDesignatedAttorney] = 0), _
'                    UCase("By: Rosenberg & Associates, LLC as attorney in fact"), "")

    FillField WordDoc, "InvestorAIF", IIf((d!AIF = True And d!ClientID = 373), d!Investor & ", by BSI Financial Services as attorney in fact", _
        IIf((d![AIF] = True And d![ClientID] = 523), IIf(d![FCdetails.State] = "MD", "Ditech Financial LLC, as servicer for " & d![Investor], d![Investor] & ", by Ditech Financial LLC f/k/a Green Tree Servicing LLC"), _
        IIf((d![AIF] = True And d![ClientID] = 527), d![Investor] & ", By Rushmore Loan Management Services LLC as its appointed Attorney in Fact", _
        IIf((d![AIF] = True And d![ClientID] = 557), d![Investor] & " by Caliber Home Loans, Inc., as its attorney in fact", _
        IIf((d!AIF = True And d!ClientID = 532), UCase$(d![Investor]) & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", _
        IIf((d![AIF] = True And (d![ClientID] = 605 Or d![ClientID] = 662)), d![LongClientName] & " as Servicer for " & UCase$(d![Investor]), _
        IIf((d![AIF] = True And d![ClientID] = 567 And d![FCdetails.State] = "VA"), "Nationstar Mortgage LLC as attorney-in-fact for " & d![Investor], _
        IIf(d!ClientID = 451, IIf(InStr(d!Investor, "LPP") <> 0, UCase("LPP Mortgage, Inc., f/k/a LPP Mortgage, Ltd."), d!Investor), _
        IIf(d![AIF] = True And d!ClientID <> 73, d![LongClientName] & " as Attorney in Fact for " & UCase$(d![Investor]), _
                                UCase$(d![Investor])))))))))) & IIf(d!ClientID = 73, ", By Carrington Mortgage Services, LLC as Attorney in Fact and Servicing Agent", "")
    
    FillField WordDoc, "OriginalBeneficiary", UCase$((d!OriginalBeneficiary) & IIf((d!ClientID = 451 And d!MERS = -1), ", its successors and assigns", ""))
    FillField WordDoc, "AssumedBy", IIf(IsNull(d!OriginalMortgagors), "", "assumed by " & UCase$(MortgagorNamesCaps(0, 2, 2))) & " "
    FillField WordDoc, "MortgagorNames", IIf(IsNull(d!OriginalMortgagors), UCase$(MortgagorNamesCaps(0, 2, 2)), UCase$(IIf(IsNull(d!OriginalMortgagors), " ", d!OriginalMortgagors)))
    FillField WordDoc, "TrusteeNames", UCase$(trusteeNames(0, 2))
'    FillField WordDoc, "Investor", UCase$(d!Investor)
    FillField WordDoc, "Investor", IIf(d!ClientID = 451, IIf(InStr(d!Investor, "LPP") <> 0, UCase("LPP Mortgage, Inc., f/k/a LPP Mortgage, Ltd."), UCase$(d!Investor)), UCase$(d!Investor))
Else
    FillField WordDoc, "OriginalTrustee", d!OriginalTrustee
    FillField WordDoc, "InvestorAIF", _
    IIf(d![ClientID] = 634 And d![FCdetails.State] = "MD", _
        "The Community Development Administration of the" & vbCr & "Department of Housing and Community" _
         & vbCr & "Development for the State of Maryland" & vbCr & "By: Dovenmuehle Mortgage Inc., its attorney-in-fact", _
    IIf((d![ClientID] = 518 And (d![JurisdictionID] = 1 Or d![FCdetails.State] = "MD") And d!LoanType = 4), _
        "Federal National Mortgage Association (""Fannie Mae""), a corporation organized and existing under the laws of the United States of America, beneficiary, by Seterus, Inc., its Attorney-in-Fact ", _
    IIf((d![AIF] = True And d![ClientID] = 523), IIf(d![FCdetails.State] = "MD", "Ditech Financial LLC, as servicer for " & d![Investor], d![Investor] & ", by Ditech Financial LLC f/k/a Green Tree Servicing LLC"), _
    IIf((d![AIF] = True And d![ClientID] = 527), d![Investor] & ", By Rushmore Loan Management Services LLC as its appointed Attorney in Fact", _
    IIf((d!AIF = True And d!ClientID = 373), d!Investor & ", by BSI Financial Services as attorney in fact", _
    IIf((d!AIF = True And d!ClientID = 557), d!Investor & " by Caliber Home Loans, Inc., as its attorney in fact", _
    IIf((d![AIF] = True And d![ClientID] = 523), IIf(d!JurisdictionID = 1 Or d![FCdetails.State] = "VA" Or d![FCdetails.State] = "MD", d![Investor] & ", By Ditech Financial LLC f/k/a Green Tree Servicing LLC", d![Investor] & " by Green Tree Servicing LLC as servicer"), _
    IIf((d![AIF] = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", _
    IIf((d![AIF] = True And (d![ClientID] = 605 Or d![ClientID] = 662)), d![LongClientName] & " as Servicer for " & d![Investor], _
    IIf((d![AIF] = True And d!ClientID = 466), d![Investor] & ", by Select Portfolio Servicing, Inc., as attorney-in-fact", _
    IIf((d![AIF] = True And d!ClientID = 73 And d![FCdetails.State] = "MD"), d![Investor] & ", By Carrington Mortgage Services, LLC as Attorney in Fact and Servicing Agent", _
    IIf((d![AIF] = True And d![ClientID] = 567), "Nationstar Mortgage LLC as attorney-in-fact for " & d![Investor], _
    IIf(d![AIF] = True And d!ClientID <> 73, d![LongClientName] & " as Attorney in Fact for " & d![Investor], _
    IIf(d!ClientID = 451, IIf(InStr(d!Investor, "LPP") <> 0, "LPP Mortgage, Inc., f/k/a LPP Mortgage, Ltd.", d!Investor), _
    IIf(d!AIF = True And d!ClientID = 73, d![Investor] & ", By Carrington Mortgage Services, LLC as Attorney in Fact and Servicing Agent", d!Investor)))))))))))))))
    
    FillField WordDoc, "OriginalBeneficiary", d!OriginalBeneficiary & IIf(((d!ClientID = 451 Or (d!ClientID = 634 And d![FCdetails.State] = "MD")) And d!MERS = -1), ", its successors and assigns", "")
    FillField WordDoc, "AssumedBy", IIf(IsNull(d!OriginalMortgagors), "", "assumed by " & MortgagorNamesCaps(0, 2, 2)) & " "
    FillField WordDoc, "MortgagorNames", IIf(IsNull(d!OriginalMortgagors), MortgagorNamesCaps(0, 2, 2), d!OriginalMortgagors)
    FillField WordDoc, "TrusteeNames", trusteeNames(0, 2)
    FillField WordDoc, "Investor", IIf(d!ClientID = 451, IIf(InStr(d!Investor, "LPP") <> 0, "LPP Mortgage, Inc., f/k/a LPP Mortgage, Ltd.", d!Investor), d!Investor)
End If
    FillField WordDoc, "DCPUF", IIf(d![ClientID] = 593 And ([Forms]![foreclosurePrint]![txtDesignator] = 3 Or [Forms]![foreclosurePrint]![txtDesignator] = 1), _
                    "By: Rosenberg & Associates, LLC as attorney in fact", "")
Dim desAttny As String
'If IsNull([Forms]![ForeclosurePrint]![Attorney].Column(1)) Then
'    desAttny = " "
'Else
'    If d![FCdetails.State] <> "VA" Then
'        desAttny = Replace([Forms]![ForeclosurePrint]![Attorney].Column(1), ", Esq.", "")
'    Else
'        desAttny = Forms!ForeclosurePrint!txtClientContact
'    End If
'End If

If d!ClientID = 593 Then
        If Forms!foreclosurePrint!txtDesignator = 1 Then
'            If d![FCdetails.State] = "VA" Then
            desAttny = Forms!foreclosurePrint!txtClientContact

        ElseIf Forms!foreclosurePrint!txtDesignator = 3 Then
                If d![FCdetails.State] <> "VA" Then
                    desAttny = Replace([Forms]![foreclosurePrint]![Attorney].Column(1), ", Esq.", "")
                Else
                
'                 desAttny = " (name) " & Replace([Forms]![ForeclosurePrint]![Attorney].Column(1), ", Vice President", "")
                    desAttny = Replace([Forms]![foreclosurePrint]![Attorney].Column(1), ", Vice President", "")
                End If
        Else
            desAttny = ""
        End If
Else
End If

FillField WordDoc, "InvestorName2", IIf(d![ClientID] = 593, IIf(desAttny = "", "(Name)______________________", desAttny), _
        " (name) " & IIf((d![ClientID] = 523 Or d![ClientID] = 258) And d![FCdetails.State] = "MD", "", Split(ReportArgs, "|")(0)))

If d![ClientID] = 593 Then
'    If d![FCdetails.State] <> "VA" Then
            FillField WordDoc, "InvestorTitle2", IIf(desAttny <> "", "Attorney", "(Title)_____________________")
'    Else
'        FillField WordDoc, "InvestorTitle2", Nz(Split(ReportArgs, "|")(1))
'    End If
Else
    FillField WordDoc, "InvestorTitle2", " (title) " & IIf((d![ClientID] = 523 Or d![ClientID] = 258) And d![FCdetails.State] = "MD", "", Split(ReportArgs, "|")(1))
End If
FillField WordDoc, "InvestorName", IIf(d![ClientID] = 593 And [Forms]![foreclosurePrint]![txtDesignator] <> 0, desAttny, _
        IIf((d![ClientID] = 523 Or d![ClientID] = 258) And d![FCdetails.State] = "MD", "", Split(ReportArgs, "|")(0)))
FillField WordDoc, "InvestorTitle", IIf(d![ClientID] = 593 And [Forms]![foreclosurePrint]![txtDesignatedAttorney] = 3, IIf(d!JurisdictionID = 153, "Attorney", "Attorney"), IIf((d![ClientID] = 523 Or d![ClientID] = 258) And d![FCdetails.State] = "MD", "", Split(ReportArgs, "|")(1)))
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "DotRecorded", Format$(d!DOTrecorded, "mmmm d, yyyy")

FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "LongState", Nz(d!LongState)
FillField WordDoc, "LiberFolio", LiberFolio(d!Liber, d!Folio, d![FCdetails.State], d![JurisdictionID])
FillField WordDoc, "Liber", Nz(d!Liber)
FillField WordDoc, "Folio", Nz(d!Folio)
FillField WordDoc, "LegalDescription", d!LegalDescription
FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "ftPropAddr", IIf(d!ClientID = 523, "SOT - " & d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode]), "")
FillField WordDoc, "TaxID", Nz(d!TaxID)
FillField WordDoc, "upto", IIf(d!ClientID = 567, " up to ", "")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "MDInstrPrepared", IIf(d![FCdetails.State] = "VA", "", "This instrument was prepared under the supervision of " & Nz(d!AttorneyName) & ", an attorney admitted to practice before the Court of Appeals of Maryland.")
FillField WordDoc, "MDSignLine", IIf(d![FCdetails.State] = "VA", "", "_________________________________")
FillField WordDoc, "MDAttorney", IIf(d![FCdetails.State] = "VA", "", Nz(d!AttorneyName))
    
FillField WordDoc, "NotaryLocation", IIf(d!ClientID = 97, "STATE OF LOUISIANA" & vbNewLine & "PARISH OF OUACHITA", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID))
FillField WordDoc, "NotaryName", FetchNotaryName(Forms!foreclosurePrint!NotaryID, False)
FillField WordDoc, "NotaryExpires", IIf(IsNull([Forms]![foreclosurePrint]![NotaryID]), "", Format(FetchNotaryExpiration(Forms!foreclosurePrint!NotaryID), "mmmm dd"", ""yyyy"))
'FillField WordDoc, "FirmAddress", IIf((d![FCdetails.State] = "VA"), "Commonwealth Trustees, LLC" & vbCr & "c/o Rosenberg & Associates, LLC" & vbCr & "8601 Westwood Center Drive, Suite 255" & vbCr & "Vienna, VA 22182", FirmAddress(vbCr))
'office location
    If (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "VA") _
        Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "DC") Then
        FillField WordDoc, "FirmAddress", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "MD") Then  'MD
        FillField WordDoc, "FirmAddress", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "FirmAddress", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "boa1", IIf(d![ClientID] = 446, "", "and, being duly sworn")
'FillField WordDoc, "boa2", IIf(d![ClientID] = 446, "National Association.", IIf(d![ClientID] = 385 Or d![ClientID] = 567, "company.", IIf([d!clientID] = 87, "association.", "corporation.")))
FillField WordDoc, "BOA2", IIf(d![ClientID] = 446 Or d!ClientID = 97, " National Association.", IIf(d![ClientID] = 385 Or d![ClientID] = 567, " company.", IIf(d![ClientID] = 87, " association.", " corporation.")))
'FillField WordDoc, "MERS", IIf(d![MERS] = -1, "Mortgage Electronic Registration Systems Inc. (MERS) solely as nominee for ", "")

If d!ClientID = 466 Then
    FillField WordDoc, "MERS", IIf(d![MERS] = -1, "Mortgage Electronic Registration Systems Inc. (MERS) solely as nominee for " & d![OriginalBeneficiary], d![OriginalBeneficiary])
ElseIf d!ClientID = 634 Or d!ClientID = 451 Then 'CDA-Dove  01/13/16  added DOVE 6/14/17
    FillField WordDoc, "MERS", IIf(d![MERS] = -1, "Mortgage Electronic Registration Systems Inc. (MERS) as nominee for ", "")
Else
    FillField WordDoc, "MERS", IIf(d![MERS] = -1, "Mortgage Electronic Registration Systems Inc. (MERS) solely as nominee for ", "")
End If

If d!ClientID = 523 Then
    FillField WordDoc, "Holder", "beneficiary of the Deed of Trust"
    FillField WordDoc, "FinalLanguage", "WHEREAS, party of the first part has been appointed with authority to enforce the note; and"
Else
    FillField WordDoc, "Holder", "holder of the Note"
    FillField WordDoc, "FinalLanguage", "WHEREAS, " & _
    IIf(Forms!ForeclosureDetails!LoanType = 5, "Federal Home Loan Mortgage Corporation is the owner of the note secured by said Deed of Trust and appointed the party of the first part with authority to hold, collect and enforce the note; and ", _
    IIf(Forms!ForeclosureDetails!LoanType = 4, "Federal National Mortgage Association is the owner of the note secured by said Deed of Trust and appointed the party of the first part with authority to hold, collect and enforce the note; and ", _
     "the party of the first part is the holder of the Note secured by said Deed of Trust; and,"))
End If
WordObj.Selection.HomeKey wdStory, wdMove
WordDoc.ActiveWindow.View = wdPrintView

If d![ClientID] = 567 And d![FCdetails.State] = "DC" Then
    'WordDoc.SaveAs EMailPath & "SOT Champ DC" & d![CaseList.FileNumber] & ".doc"
    'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "SOT Champ DC" & d![CaseList.FileNumbe    r] & ".doc ")
ElseIf d![ClientID] = 634 And d![FCdetails.State] = "MD" Then       '01/14/16
    'WordDoc.SaveAs EMailPath & "SOT CDA Dove MD" & d![CaseList.FileNumber] & ".doc"
    'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "SOT CDA Dove MD" & d![CaseList.FileNumber] & ".doc ")
ElseIf d![ClientID] = 567 And d![FCdetails.State] = "VA" And d!JurisdictionID <> 153 Then
    'WordDoc.SaveAs EMailPath & "SOT Champ VA" & d![CaseList.FileNumber] & ".doc"
    'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "SOT Champ VA" & d![CaseList.FileNumber] & ".doc ")
ElseIf d![ClientID] = 567 And d!JurisdictionID = 153 Then
    'WordDoc.SaveAs EMailPath & "SOT Champ VA - Accomack" & d![CaseList.FileNumber] & ".doc"
   ' Call SaveDoc(WordDoc, d![CaseList.FileNumber], "SOT Champ VA - Accomack" & d![CaseList.FileNumber] & ".doc ")
ElseIf d![ClientID] = 523 And d![FCdetails.State] = "DC" Then
    'WordDoc.SaveAs EMailPath & "SOT DITECH DC" & d![CaseList.FileNumber] & ".doc"
    'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "SOT DITECH DC" & d![CaseList.FileNumber] & ".doc ")
ElseIf d![ClientID] = 523 And d![FCdetails.State] = "MD" Then
    'WordDoc.SaveAs EMailPath & "SOT DITECH MD" & d![CaseList.FileNumber] & ".doc"
    'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "SOT DITECH MD" & d![CaseList.FileNumber] & ".doc ")
ElseIf d![ClientID] = 523 And d![FCdetails.State] = "VA" Then
   ' WordDoc.SaveAs EMailPath & "SOT DITECH VA" & d![CaseList.FileNumber] & ".doc"
   ' Call SaveDoc(WordDoc, d![CaseList.FileNumber], "SOT DITECH VA" & d![CaseList.FileNumber] & ".doc ")
ElseIf d![ClientID] = 451 And d![JurisdictionID] = 153 Then
   ' WordDoc.SaveAs EMailPath & "SOT Dove VA Accomack" & d![CaseList.FileNumber] & ".doc"
   ' Call SaveDoc(WordDoc, d![CaseList.FileNumber], "SOT Dove VA Accomack" & d![CaseList.FileNumber] & ".doc ")
ElseIf d![JurisdictionID] = 153 Then
   ' WordDoc.SaveAs EMailPath & "SOT Accomack" & d![CaseList.FileNumber] & ".doc"
   ' Call SaveDoc(WordDoc, d![CaseList.FileNumber], "SOT Accomack" & d![CaseList.FileNumber] & ".doc ")
ElseIf d![ClientID] = 451 And d![FCdetails.State] = "VA" Then
   ' WordDoc.SaveAs EMailPath & "SOT Dove VA" & d![CaseList.FileNumber] & ".doc"
   ' Call SaveDoc(WordDoc, d![CaseList.FileNumber], "SOT Dove VA" & d![CaseList.FileNumber] & ".doc ")
ElseIf d![ClientID] = 451 And d![FCdetails.State] = "DC" Then
    'WordDoc.SaveAs EMailPath & "SOT Dove DC " & d![CaseList.FileNumber] & ".doc"
ElseIf d![ClientID] = 451 And d![FCdetails.State] = "MD" Then
    'WordDoc.SaveAs EMailPath & "SOT Dove MD" & d![CaseList.FileNumber] & ".doc"
   ' Call SaveDoc(WordDoc, d![CaseList.FileNumber], "SOT Dove MD" & d![CaseList.FileNumber] & ".doc ")
ElseIf d![FCdetails.State] = "MD" Or d![FCdetails.State] = "DC" Then
   ' WordDoc.SaveAs EMailPath & "Substitution of Trustees" & d![CaseList.FileNumber] & ".doc"
   ' Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Substitution of Trustees" & d![CaseList.FileNumber] & ".doc ")
ElseIf d![FCdetails.State] = "VA" Then
   ' WordDoc.SaveAs EMailPath & "Substitution of Trustees VA" & d![CaseList.FileNumber] & ".doc"
   ' Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Substitution of Trustees VA" & d![CaseList.FileNumber] & ".doc ")
End If

'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_LostNoteAffidavitPNC(KeepOpen As Boolean, OpenArg As String)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Lost Note Affidavit PNC")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Lost Note Affidavit PNC.doc", False)

WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

'margin address:
    If d![FCdetails.State] = "DC" Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
'FillField WordDoc, "MortgagorNames", IIf(IsNull(d![OriginalMortgagors]), MortgagorNames(0, 2), d![OriginalMortgagors] & ", assumed by " & MortgagorNames(0, 2))
FillField WordDoc, "PROPERTYADD", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "LongState", d!LongState
FillField WordDoc, "Liber", Nz(d![Liber])
FillField WordDoc, "folio", Nz(d!Folio)
FillField WordDoc, "Rerecorded", IIf(IsNull(d![Rerecorded]), ". ", ", and re-recorded at Book " & d![Liber2] & ", Page " & d![Folio2])

FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)

If OpenArg = "1" Then

    FillField WordDoc, "Option4", "A non-original copy of the Note is attached as Exhibit A which is the most recent copy known by me to be part of PNC's computerized records.  Exhibit A reflects that the Note was made and executed by " & _
        Replace(BrowersNamesV2(d![CaseList.FileNumber], 2), "Estate of ", "") & " in the principal amount of " & Format$(d![OriginalPBal], "Currency") & " on " & _
         Format$(d!DOTdate, "mmmm d, yyyy") & ", with the obligation to be secured by property located at " & d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![FCdetails.State] & _
         " " & FormatZip(d![ZipCode]) & ".  I have separately reviewed the financial terms of the loan and the property address as recorded in PNC’s computerized records and, based on that review, said information as stated here and in Exhibit A is consistent with PNC’s computerized records. "
Else
    FillField WordDoc, "Option4", "PNC's computerized records reflect the Note's terms are as follows:" & vbCr & vbCr & _
        "Date of Note:   ____________________        Maturity Date: ____________________" & vbCr & vbCr & _
        "Original Lender listed in Security Instrument: __________________________" & vbCr & vbCr & _
        "Principal: ________________________" & vbCr & vbCr & _
        Chr(91) & " " & Chr(93) & " Interest rate (fixed percentage): _________   " & vbCr & vbCr & _
        Chr(91) & " " & Chr(93) & " Interest rate (variable): A variable rate starting at ____%, never to rise above ____%, never to go below ____%, and the current interest rate as of ___________________ (the last change date) is ____%." & vbCr & vbCr & _
        "Borrower(s): _____________________________________________________" & vbCr & vbCr & _
        "Property Address: ________________________________________________________"
End If

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Lost Note Affidavit PNC.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Lost Note Affidavit PNC.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_LostNoteAffidavit(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")

If d![ClientID] = 451 And InStr(d!Investor, "LPP") <> 0 Then
    Call OpenDocAsSaved("Lost Note Affidavit Dove")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Lost Note Affidavit Dove.doc", False)
Else
    Call OpenDocAsSaved("Lost Note Affidavit")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Lost Note Affidavit.doc", False)

End If
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & Nz(", " & d![Fair Debt], "")
'WordDoc.Bookmarks("APTNum").Select
'WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

'margin address:
    If d![FCdetails.State] = "DC" Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
'
'FillField WordDoc, "Barcode", IIf(d!ClientID = 634 Or d!ClientID = 532, "", IIf(d!ClientID = 444 And d![FCdetails.State] = "MD", "", AddDocPreIndex(d![CaseList.FileNumber], 152, "")))
FillField WordDoc, "DitechFooter", "Lost Note Affidavit - " & d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d!City & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "AIFDove", "LPP Mortgage, Inc., f/k/a LPP Mortgage, Ltd."
'FillField WordDoc, "OriginalMortgagors", IIf(IsNull([OriginalMortgagors]), MortgagorNames(0, 2), D![OriginalMortgagors] & ", assumed by " & MortgagorNames(0, 2))
                                        'IIf(IsNull(D!OriginalMortgagors), "", "Original Mortgagors " & D!OriginalMortgagors)
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "DOTStr", IIf(d!DOT, "Deed of Trust", "Mortgage")
FillField WordDoc, "MortgagorsStr", IIf(IsNull(d!OriginalMortgagors), MortgagorNames(0, 2), d!OriginalMortgagors)
FillField WordDoc, "MortgagorNames", IIf(IsNull(d![OriginalMortgagors]), MortgagorNames(0, 2), d![OriginalMortgagors] & ", assumed by " & MortgagorNames(0, 2))
FillField WordDoc, "Investor", d!Investor

If d!ClientID = 532 Then 'SElene
    FillField WordDoc, "InvestorAIF", IIf((d![AIF] = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", d![Investor])

ElseIf d!ClientID = 523 Then 'Greentree
    FillField WordDoc, "InvestorAIF", IIf((d![AIF] = True And d![ClientID] = 523), d![Investor] & " by Green Tree Servicing LLC as servicer", d![Investor])
ElseIf d!ClientID = 73 Then 'And d![FCdetails.State] = "VA" Then
    FillField WordDoc, "InvestorAIF", IIf(d!AIF = True And d![FCdetails.State] = "VA", d!Investor & ", By Carrington Mortgage Services, LLC as Attorney in Fact and Servicing Agent", d!Investor)
ElseIf d!ClientID = 567 Then
'    If d![FCdetails.State] = "VA" Then
        FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, "Nationstar Mortgage LLC as attorney-in-fact for " & d!Investor, d!Investor)
'    ElseIf d![FCdetails.State] = "MD" Then
'        FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, "Nationstar Mortgage LLC d/b/a Champion Mortgage Company of Texas as attorney-in-fact for " & d!Investor, d!Investor)
'    End If
ElseIf d!ClientID = 557 Then
     FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, d!Investor & " by Caliber Home Loans, Inc., as its attorney in fact", d!Investor)
ElseIf d!ClientID = 527 Then 'Rashmore   7/11/17
    FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, d!Investor & ", By Rushmore Loan Management Services LLC as its appointed Attorney in Fact", d!Investor)
Else
    FillField WordDoc, "InvestorAIF", IIf((d!AIF = True And d!ClientID = 373), d!Investor & ", by BSI Financial Services as attorney in fact", IIf((d![AIF] = True And d![ClientID] = 523), d![Investor] & " by Green Tree Servicing LLC as servicer", IIf((d![AIF] = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf((d![AIF] = True And d![ClientID] = 605), d![LongClientName] & " as Servicer for ", IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for ", "")))) & d![Investor])

End If
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "LongState", Nz(d!LongState)
FillField WordDoc, "LiberFolio", LiberFolio(d!Liber, d!Folio, d![FCdetails.State], d![JurisdictionID])
FillField WordDoc, "OriginalPBalWords", CurrencyWords(d!OriginalPBal)
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "InterestRate", Format(d!InterestRate, "#0.000")
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID) ' & " ss.IIf(IsNull(D!NotaryLocation), "STATE OF ______________:" & vbCr & "COUNTY OF ____________ :", D!NotaryLocation)
FillField WordDoc, "FirmAddress", FirmAddress(vbCr)
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
'FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 154, "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Lost Note Affidavit.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Lost Note Affidavit.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_AssignmentofBid(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryAssignBidWord WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Assignment of Bid")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Assignment of Bid.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & vbCr & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])

'margin address:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
    FillField WordDoc, "Bidname", Nz(d!BidName, "_______________")
    FillField WordDoc, "DOTDate", Format$(d![DOTdate], "mmmmm dd, yyyy")
    FillField WordDoc, "Primaryname", d![PrimaryFirstName] & " " & Nz(d!PrimaryLastName, "________")
    FillField WordDoc, "DOTRecorded", Format(d![DOTrecorded], "mmmmm dd, yyyy")
    FillField WordDoc, "LiberFolio", LiberFolio(d![Liber], d![Folio], d![FCdetails.State], d![JurisdictionID])
    FillField WordDoc, "Jurisdiction", d!Jurisdiction & ", " & d![LongState]
    FillField WordDoc, "LegalDesc", Nz(d!LegalDescription)
    FillField WordDoc, "PropterAddr", d!PropertyAddress & IIf(IsNull(d![Fair Debt]), " ", ", " & d![Fair Debt] & ", ") & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
    FillField WordDoc, "purchaser", Nz(d!Purchaser)
    FillField WordDoc, "SaleDt", Format(d![Sale], "mmmm dd, yyyy")
    
    WordObj.Selection.HomeKey wdStory, wdMove
    Set WordObj = Nothing
    d.Close
       
End Sub

Public Sub Doc_AssignmentSOTVASpecialized(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCdocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("SOT VA Specialized")
Set WordDoc = WordObj.Documents.Open(EMailPath & "SOT VA Specialized.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

'margin address:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "TaxID", IIf(d!JurisdictionID = 56, "Tax Map Number:", "Tax ID#:") & IIf(IsNull(d!TaxID), "", d!TaxID)
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "TrusteeNames", trusteeNames(0, 2)
FillField WordDoc, "InvestorAddress", RemoveLF(d!InvestorAddress)
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), " ", ", " & d![Fair Debt] & ", ") & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "MortgagorNames", IIf(IsNull(d![OriginalMortgagors]), MortgagorNamesCaps(0, 2, 2), d![OriginalMortgagors])
FillField WordDoc, "OriginalBeneficiary", IIf(d!MERS = True, "in which Mortgage Electronic Registration Systems, Inc. (MERS) is named original beneficiary as nominee for " & d!OriginalBeneficiary & ", original named lender, ", d!OriginalBeneficiary & " is named original lender ")
FillField WordDoc, "OriginalTrustee", IIf(IsNull(d![OriginalTrustee]), "", d![OriginalTrustee])

FillField WordDoc, "LiberFolio", LiberFolio(d![Liber], d![Folio], d![FCdetails.State], d![JurisdictionID])
FillField WordDoc, "rerecorded", IIf(IsNull(d![Rerecorded]), "", IIf((Not IsNull(d!Liber2) And IsNull(d!Folio2)), ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d"", ""yyyy") & " at Instrument Number " & d![Liber2], ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d"", ""yyyy") & " at Book " & d![Liber2] & ", Page " & d![Folio2]))

FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "LongState", d!LongState
FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, d![Investor] & " by Specialized Loan Servicing LLC, its attorney-in-fact", d![Investor])
FillField WordDoc, "DOTdate", Format$(d![DOTdate], "mmmm d"", ""yyyy")
FillField WordDoc, "OriginalMortgagors", IIf(IsNull([OriginalMortgagors]), "", "assumed by " & MortgagorNamesCaps(0, 2, 2))

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "SOT VA Specialized.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "SOT VA Specialized.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_AssignmentSLS(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rsMortgagors As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Assignment SLS")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Assignment SLS.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

'margin address:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

    If Forms![Print Assignment]!txtGrntor = 1 Then
        If Not IsNull(Forms![case list]!MINnumber) Then
            FillField WordDoc, "MIN", "MIN: "
            FillField WordDoc, "MINNo", Forms![case list]!MINnumber
        Else
            FillField WordDoc, "MIN", "MIN: " & ""
            FillField WordDoc, "MINNo", ""
        End If
    Else
        FillField WordDoc, "MIN", ""
        FillField WordDoc, "MINNo", ""
    End If
 
FillField WordDoc, "Tax", IIf(d!JurisdictionID = 56, "Tax Map Number: ", "Tax ID Number: ")
FillField WordDoc, "TaxID", Nz(d!TaxID)
FillField WordDoc, "MERSPh", IIf(Forms![Print Assignment]!txtGrntor = 1, "MERS Phone Number: ", "")
FillField WordDoc, "MERSPHNo", IIf(Forms![Print Assignment]!txtGrntor = 1, "1-888-679-6377", "")    ' is it saved in our DB and used somewhere else? Mei 7/20/17
FillField WordDoc, "Grantor", Nz(Forms![Print Assignment]!Grantor, "__________________")
FillField WordDoc, "asNominee", IIf(Forms![Print Assignment]!txtGrntor = 1, " as nominee for " & UCase(d!OriginalBeneficiary) & ", its successors and assigns", "")
FillField WordDoc, "originalBeneficiary", Nz(d!OriginalBeneficiary, "____________")
FillField WordDoc, "GrantorAddress", IIf(Forms![Print Assignment]!txtGrntor = 1, Forms![Print Assignment]!GrantorAddress, "c/o " & d!LongClientName & ", " & OneLine(d!InvestorAddress))
FillField WordDoc, "CO", IIf(d!Investor = d!LongClientName, "", "c/o " & d!LongClientName & ", ")
FillField WordDoc, "InvestorAddress", OneLine(d!InvestorAddress)
'If (d![FCdetails.State] = "VA") Then
'    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", IIf(IsNull(d![Folio2]), ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & _
'    " at Instrument Number " & d![Liber2] & ". ", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " in Book " & d![Liber2] & ", Page " & d![Folio2] & "."))
''ElseIf d!Jurisdiction = 6 Then  'Calvert County
''    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Page " & d![Liber2] & ", Book " & d![Folio2])
'Else 'MD or DC
'    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), ".", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " in Book " & d![Liber2] & ", at Page " & d![Folio2] & ".")
'End If

If (d![FCdetails.State] = "VA") Then
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", IIf(IsNull(d![Folio2]), ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & _
    " at Instrument Number " & d![Liber2] & ". ", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " in Book " & d![Liber2] & ", Page " & d![Folio2]))
'ElseIf d!Jurisdiction = 6 Then  'Calvert County
'    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Page " & d![Liber2] & ", Book " & d![Folio2])
ElseIf (d![FCdetails.State] = "DC") Then
     FillField WordDoc, "ReRecorded", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Instrument Number " & d![Liber2] & "."
Else 'MD or DC
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Book " & d![Liber2] & ", Page " & d![Folio2]) & "."
End If

'FillField WordDoc, "Grantee", Forms![Print Assignment]!Grantee

'FillField WordDoc, "GranteeAddress", Forms![Print Assignment]!GranteeAddress
FillField WordDoc, "Investor", UCase(d![Investor])
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
'FillField WordDoc, "MoneyText", IIf(d![ClientID] = 97, ".", ", all sums of money due and to become due thereon.")

'FillField WordDoc, "LiberFolio", IIf(IsNull(d!Folio) And Not IsNull(d!Liber), "as Instrument Number " & d!Liber, " in Book " & d!Liber & ", at Page " & d!Folio)
If (d![FCdetails.State] = "VA") Then
    FillField WordDoc, "LiberFolio", IIf(IsNull(d!Folio) And Not IsNull(d!Liber), "as Instrument Number " & d!Liber, "in Book " & d!Liber & ", Page " & d!Folio)
ElseIf (d![FCdetails.State] = "DC") Then
    FillField WordDoc, "LiberFolio", "as Instrument Number " & Nz(d!Liber, "")
Else
    FillField WordDoc, "LiberFolio", "in Book" & Nz(" " & d!Liber, "") & ", Page " & Nz(d!Folio, "")
End If
'FillField WordDoc, "LegalDescription", d!LegalDescription
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "RecordedDate", Format$(d!DOTrecorded, "mmmm d, yyyy")


If d!JurisdictionID = 153 Then      'Accomack VA   underline
    FillFieldSOTNationsVA WordDoc, "Mortgagors", IIf(IsNull(d!OriginalMortgagors), MortgagorNamesCaps(0, 2, 2), d!OriginalMortgagors)
ElseIf d!JurisdictionID = 75 Then       'Rockingham va   underline Last name
    FillFieldUnderline WordDoc, "Mortgagors", IIf(IsNull(d!OriginalMortgagors), "", d!OriginalMortgagors)
Else
    FillField WordDoc, "Mortgagors", IIf(IsNull(d!OriginalMortgagors), MortgagorNamesCaps(0, 2, 2), d!OriginalMortgagors)
End If

FillField WordDoc, "jurisdictionwithState", IIf(d!JurisdictionID = 1, d!Jurisdiction, d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "MERSsig", IIf(Forms![Print Assignment]!txtGrntor = 0, "By Specialized Loan Servicing LLC, its attorney-in-fact", "")
FillField WordDoc, "LLC", IIf(Forms![Print Assignment]!txtGrntor = 1, "Corporation", "LLC")
'FillField WordDoc, "OriginalPBalWords", CurrencyWords(d!OriginalPBal)
'FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
'FillField WordDoc, "tax", IIf(d![FCdetails.State] = "VA", "Tax Map Number:", "Tax ID Number:")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Assignment.doc"

'If (d![FCdetails.State] = "VA") Then
 '   Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Assignment VA.doc")
'Else
'    Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Assignment.doc")
'End If

'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_Assignment(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryAssignment WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Assignment")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Assignment.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

'margin address:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

    If Forms![Print Assignment]!txtGrntor = 1 Then
        If Not IsNull(Forms![case list]!MINnumber) Then
            FillField WordDoc, "MIN", "MIN: "
            FillField WordDoc, "MINNo", Forms![case list]!MINnumber
        Else
            FillField WordDoc, "MIN", "MIN: " & ""
            FillField WordDoc, "MINNo", ""
        End If
    Else
        FillField WordDoc, "MIN", ""
        FillField WordDoc, "MINNo", ""
    End If

FillField WordDoc, "DitechFooter", "Assignment - " & d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!City & ", " & d![State] & " " & FormatZip(d!ZipCode)
FillField WordDoc, "MERSPh", IIf(Forms![Print Assignment]!txtGrntor = 1, "MERS Phone Number: ", "")
FillField WordDoc, "mPhNo", IIf(Forms![Print Assignment]!txtGrntor = 1, "1-888-679-6377", "")
FillField WordDoc, "Grantor", Nz(Forms![Print Assignment]!Grantor, "_____________________")
FillField WordDoc, "asNominee", IIf(Forms![Print Assignment]!txtGrntor = 1, " as nominee for " & UCase(d!OriginalBeneficiary) & ", its successors and assigns, ", "")
'FillField WordDoc, "originalBeneficiary", d!OriginalBeneficiary
'FillField WordDoc, "Mortgagor", IIf(IsNull(d!OriginalMortgagors), MortgagorNamesCaps(0, 2, 2), d!OriginalMortgagors)
If d!JurisdictionID = 153 Then      'Accomack VA   underline
    FillFieldSOTNationsVA WordDoc, "Mortgagor", IIf(IsNull(d!OriginalMortgagors), MortgagorNamesCaps(0, 2, 2), d!OriginalMortgagors)
ElseIf d!JurisdictionID = 75 Then       'Rockingham va   underline Last name
    FillFieldUnderline WordDoc, "Mortgagor", IIf(IsNull(d!OriginalMortgagors), "", d!OriginalMortgagors)
Else
    FillField WordDoc, "Mortgagor", IIf(IsNull(d!OriginalMortgagors), MortgagorNamesCaps(0, 2, 2), d!OriginalMortgagors)
End If
'FillField WordDoc, "GrantorAddress", IIf(Forms![Print Assignment]!txtGrntor = 1, Forms![Print Assignment]!GrantorAddress, Forms![Print Assignment]!GrantorAddress)
FillField WordDoc, "GrantorAddress", Forms![Print Assignment]!GrantorAddress
FillField WordDoc, "Grantee", Forms![Print Assignment]!Grantee
FillField WordDoc, "GranteeAddress", Forms![Print Assignment]!GranteeAddress
FillField WordDoc, "OriginalTrustee", d!OriginalTrustee
FillField WordDoc, "MortgageDate", Nz(Format$(d!DOTdate, "mmmm dd, yyyy"), "_________________")
FillField WordDoc, "OriginalPBalWords", CurrencyWords(d!OriginalPBal)
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "RecordedDate", Format$(d!DOTrecorded, "mmmm d, yyyy")
If (d![State] = "VA") Then
    FillField WordDoc, "LiberFolio", IIf(IsNull(d!Folio) And Not IsNull(d!Liber), "as Instrument Number " & d!Liber, "in Book " & d!Liber & ", Page " & d!Folio)
ElseIf (d![State] = "DC") Then
    FillField WordDoc, "LiberFolio", "as Instrument Number " & Nz(d!Liber, "")
Else
    FillField WordDoc, "LiberFolio", "in Book" & Nz(" " & d!Liber, "") & ", Page " & Nz(d!Folio, "")
End If

If (d![State] = "VA") Then
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", IIf(IsNull(d![Folio2]), ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & _
    " at Instrument Number " & d![Liber2], ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " in Book " & d![Liber2] & ", Page " & d![Folio2]))
'ElseIf d!Jurisdiction = 6 Then  'Calvert County
'    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Page " & d![Liber2] & ", Book " & d![Folio2])
ElseIf (d![State] = "DC") Then
     FillField WordDoc, "ReRecorded", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Instrument Number " & d![Liber2]
Else 'MD
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Book " & d![Liber2] & ", Page " & d![Folio2])
End If

FillField WordDoc, "jurisdictionwithState", IIf(d!JurisdictionID = 1, d!Jurisdiction, d!Jurisdiction & ", " & d!LongState)
'FillField WordDoc, "Grantor", Forms![Print Assignment]!Grantor
'FillField WordDoc, "Grantee", Forms![Print Assignment]!Grantee
'FillField WordDoc, "GrantorAddress", Forms![Print Assignment]!GrantorAddress
'FillField WordDoc, "GranteeAddress", Forms![Print Assignment]!GranteeAddress
'FillField WordDoc, "Investor", d![OriginalTrustee]
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
'FillField WordDoc, "MoneyText", IIf(d![ClientID] = 97, ".", ", all sums of money due and to become due thereon.")
FillField WordDoc, "tax", IIf(d!JurisdictionID = 56, "Tax Map Number:", "Tax ID Number:")
FillField WordDoc, "TaxID", Nz(d!TaxID)
'FillField WordDoc, "LiberFolio", LiberFolio(d!Liber, d!Folio, d![FCdetails.State], d!JurisdictionID)
FillField WordDoc, "LegalDescription", d!LegalDescription
'FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
'FillField WordDoc, "DOTRecorded", d!DOTrecorded
'FillField WordDoc, "Jurisdiction", d!Jurisdiction
'FillField WordDoc, "LongState", d!LongState


WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Assignment.doc"

'If (d![FCdetails.State] = "VA") Then
 '   Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Assignment VA.doc")
'Else
'    Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Assignment.doc")
'End If

'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_AssignmentRecordingCoverLetter(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT CaseList.FileNumber, FCdetails.PropertyAddress, FCdetails.City, FCdetails.State, FCdetails.ZipCode, FCdetails.TaxID, JurisdictionList.State AS JurState, JurisdictionList.Jurisdiction, JurisdictionList.CourtAddress " & _
"FROM (CaseList LEFT JOIN FCdetails ON CaseList.FileNumber = FCdetails.FileNumber) INNER JOIN JurisdictionList ON CaseList.JurisdictionID = JurisdictionList.JurisdictionID WHERE [FCdetails.Current]=True and CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Assignment Recording Cover Letter")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Assignment Recording Cover Letter.doc", False)
'Set WordDoc = WordObj.Documents.Open(EMailPath & "Military Affidavit Dove.doc", False)
WordObj.Visible = True

FillField WordDoc, "date", Format(Now(), "mmmm d"", ""yyyy")
FillField WordDoc, "JurAddress", IIf(d![JurState] <> "DC", "Circuit Court for " & d![Jurisdiction], d![Jurisdiction] & " Government ") & vbNewLine & d![CourtAddress]
FillField WordDoc, "FileNumber", Forms![case list]!FileNumber
FillField WordDoc, "TaxID", IIf(IsNull(d!TaxID), "", d!TaxID)
FillField WordDoc, "Borrowers", GetNames(d![FileNumber], 10, "Noteholder=true")
FillField WordDoc, "chkAmt", Format(DLookup("Amount", "Fees", "FeeType='FC-Assign' and State='" & d![State] & "'"), "Currency")
FillField WordDoc, "LoginName", Forms!Main!txtLoginName
FillField WordDoc, "FirmName", FirmName("MD")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Assignment Recording CoverLetter.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Assignment Recording CoverLetter.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

'Marco
Public Sub Doc_MilitaryAffidavitMD(KeepOpen As Boolean, ActiveDuty As Boolean) ' Military Affidavit MD
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim fName As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")

If (ActiveDuty = True) Then
       
   fName = "Military Affidavit Active"
   
Else
    If (d![ClientID] = 451 And Trim(UCase$(d!Investor)) Like "LPP MORTGAGE*" And d![FCdetails.State] = "MD" And Forms!foreclosurePrint!txtDesignator <> 3) Then
        fName = "Military Affidavit Dove"
    ElseIf d!ClientID = 404 Then
        fName = "Military Affidavit Bogman"
    ElseIf (d!ClientID = 328 And Forms!foreclosurePrint!txtDesignator = 3) Then  'A Designated attoryney was selected.  #1272
        fName = "Military Affidavit"
    ElseIf d!ClientID = 328 Then
        fName = "Military Affidavit SPLS"
    Else
        fName = "Military Affidavit"
    End If
End If

Call OpenDocAsSaved(fName & " MD")
Set WordDoc = WordObj.Documents.Open(EMailPath & fName & " MD.doc", False) ' oh why you little....
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

'margin address:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
FillField WordDoc, "Barcode", IIf((d!ClientID = 634) Or (d!ClientID = 444 And d![FCdetails.State] = "MD"), "", AddDocPreIndex(d![CaseList.FileNumber], 152, ""))
FillField WordDoc, "designatorDate", IIf([Forms]![foreclosurePrint]![txtDesignator] = 3, "Date: " & Format(Date, "mmmm d, yyyy") & vbCr & "info@rosenberg-assoc.com", "")
FillField WordDoc, "MortgagorBorrowerNames", BorrowerMorgagorNamesOneSSN(d![CaseList.FileNumber], CopyNoR())
FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber

'FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(2) = 3, IIf(D![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), Forms![Case List]!Investor)
'FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(2) = 3, IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for ", "")) & IIf(d!ClientID = 531, "M&T Bank as Servicer for " & Forms![Case List]!Investor, " " & Forms![Case List]!Investor)
FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(2) = 3, IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), IIf((d!AIF = True And d!ClientID = 373), d!Investor & ", by BSI Financial Services as attorney in fact", IIf((d![AIF] = True And d![ClientID] = 523), d![Investor] & " by Green Tree Servicing LLC as servicer", IIf(d!ClientID = 531, "M&T Bank as Servicer for " & Forms![case list]!Investor, IIf((d![AIF] = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf((d![AIF] = True And d![ClientID] = 605), d![LongClientName] & " as Servicer for " & d!Investor, IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for " & Forms![case list]!Investor, Forms![case list]!Investor)))))))
'Polo

FillField WordDoc, "ActiveDuty", ActiveDutyNames(0, 20)
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
'FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then
    FillField WordDoc, "FirmShortAddress", DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
    FillField WordDoc, "FirmShortAddress", DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then
        FillField WordDoc, "FirmShortAddress", DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                  DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID =2")
End If

FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", IIf(Split(ReportArgs, "|")(2) = 3, IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), (Split(ReportArgs, "|")(1)))
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID)
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)


FillField WordDoc, "only328client", IIf((d!ClientID = 328 And Forms!foreclosurePrint!txtDesignator = 3), "", IIf(d![ClientID] = 328, d![Investor] & " has been proven to be the real party in interest and has the right to foreclose the subject property.", ""))

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & Fname & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], Fname & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_MilitaryAffidavitActive(KeepOpen As Boolean, strState As String) ' Military Affidavit Active VA
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim fName As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")

If (d![FCdetails.State] = "MD") Then
    If d!ClientID = 404 Then
        fName = "Military Affidavit Active Bogman"
    ElseIf (d![ClientID] = 451 And Trim(UCase$(d!Investor)) Like "LPP MORTGAGE*" And d![FCdetails.State] = "MD" And Forms!foreclosurePrint!txtDesignator <> 3) Then
        fName = "Military Affidavit Active Dove MD"
    Else
        fName = "Military Affidavit Active MD"
    End If
ElseIf (d![ClientID] = 451 And Trim(UCase$(d!Investor)) Like "LPP MORTGAGE*" And d![FCdetails.State] = "VA" And Forms!foreclosurePrint!txtDesignator <> 3) Then
  fName = "Military Affidavit Active Dove"
Else
  fName = "Military Affidavit Active"

End If

Call OpenDocAsSaved(fName)
Set WordDoc = WordObj.Documents.Open(EMailPath & fName & ".doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

'margin address:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Or (d![FCdetails.State] = "DC" And IsNull([Forms]![foreclosurePrint]![cboOfficeLocation])) Or (d![FCdetails.State] = "VA" And IsNull([Forms]![foreclosurePrint]![cboOfficeLocation])) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (strState = "MD" And IsNull([Forms]![foreclosurePrint]![cboOfficeLocation])) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "Barcode", IIf(d!ClientID = 634 Or d!ClientID = 451, "", IIf(d!ClientID = 444 And d![FCdetails.State] = "MD", "", AddDocPreIndex(d![CaseList.FileNumber], 152, "")))
FillField WordDoc, "designatorDate", IIf([Forms]![foreclosurePrint]![txtDesignator] = 3, "Date: " & Format(Date, "mmmm d, yyyy") & vbCr & "info@rosenberg-assoc.com", "")
FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
'FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(2) = 3, "Substitute Trustee", D!Investor)
FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(2) = 3, IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), IIf((d!AIF = True And d!ClientID = 373), d!Investor & ", by BSI Financial Services as attorney in fact", IIf((d![AIF] = True And d![ClientID] = 523), d![Investor] & " by Green Tree Servicing LLC as servicer", IIf((d![AIF] = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for ", "") & IIf(d!ClientID = 531, "M&T Bank as Servicer for " & Forms![case list]!Investor, " " & Forms![case list]!Investor)))))
FillField WordDoc, "ActiveDuty", ActiveDutyNames(0, 20)
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID)
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "only328client", IIf((d!ClientID = 328 And Forms!foreclosurePrint!txtDesignator = 3), "", IIf(d![ClientID] = 328, d![Investor] & " has been proven to be the real party in interest and has the right to foreclose the subject property.", ""))
FillField WordDoc, "only328client2", IIf((d!ClientID = 328 And Forms!foreclosurePrint!txtDesignator = 3), "", IIf(d![ClientID] = 328, "Subscribed and affirmed before me in the county of Douglas, State of Colorado, this _____ day of ________, 20____ .", ""))
FillField WordDoc, "only328client3", IIf((d!ClientID = 328 And Forms!foreclosurePrint!txtDesignator = 3), "", IIf(d![ClientID] = 328, "____________________________", ""))
FillField WordDoc, "only328client4", IIf((d!ClientID = 328 And Forms!foreclosurePrint!txtDesignator = 3), "", IIf(d![ClientID] = 328, "(Notary's official Signature)", ""))
FillField WordDoc, "only328client5", IIf((d!ClientID = 328 And Forms!foreclosurePrint!txtDesignator = 3), "", IIf(d![ClientID] = 328, "____________________________", ""))
FillField WordDoc, "only328client6", IIf((d!ClientID = 328 And Forms!foreclosurePrint!txtDesignator = 3), "", IIf(d![ClientID] = 328, "(Commission Expiration)", ""))

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & Fname & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Military Affidavit Active" & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_MilitaryAffidavit(KeepOpen As Boolean) 'VA Military Affidavits
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
If (d![ClientID] = 451 And Trim(UCase$(d!Investor)) Like "LPP MORTGAGE*" And d![FCdetails.State] = "VA" And Forms!foreclosurePrint!txtDesignator <> 3) Then
    Call OpenDocAsSaved("Military Affidavit Dove")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Military Affidavit Dove.doc", False)
Else
    Call OpenDocAsSaved("Military Affidavit")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Military Affidavit.doc", False)
End If
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

FillField WordDoc, "designatorDate", IIf([Forms]![foreclosurePrint]![txtDesignator] = 3, "Date: " & Format(Date, "mmmm d, yyyy"), "")
FillField WordDoc, "MortgagorBorrowerNames", BorrowerMorgagorNamesOneSSN(d![CaseList.FileNumber], CopyNoR())
FillField WordDoc, "OriginalMortgagors", IIf(IsNull(d!OriginalMortgagors), "", "Original Mortgagors " & d!OriginalMortgagors)
FillField WordDoc, "LoanNumber", d!LoanNumber
'FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(2) = 3, IIf(Forms![ForeclosureDetails]!State = "DC", "Substitute Trustee", "Commonwealth Trustees, LLC"), Forms![Case List]!Investor)
'AIF Changes
'FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(2) = 3, IIf(Forms![ForeclosureDetails]!State = "DC", "Substitute Trustee", "Commonwealth Trustees, LLC"), IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for ", "")) & IIf(d!ClientID = 531, "M&T Bank as Servicer for " & Forms![Case List]!Investor, Forms![Case List]!Investor)
'FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(2) = 3, IIf(Forms![ForeclosureDetails]!state = "DC", "Substitute Trustee", "Commonwealth Trustees, LLC"), IIf((d![AIF] = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for ", "")) & IIf(d!ClientID = 531, "M&T Bank as Servicer for " & Forms![Case List]!Investor, Forms![Case List]!Investor))
FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(2) = 3, IIf(Forms![ForeclosureDetails]!State = "DC", "Substitute Trustee", "Commonwealth Trustee, LLC"), IIf((d!AIF = True And d!ClientID = 373), d!Investor & ", by BSI Financial Services as attorney in fact", IIf((d![AIF] = True And d![ClientID] = 523), d![Investor] & " by Green Tree Servicing LLC as servicer", IIf(d!ClientID = 531, "M&T Bank as Servicer for " & Forms![case list]!Investor, IIf((d![AIF] = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf((d![AIF] = True And d![ClientID] = 605), d![LongClientName] & " as Servicer for " & d!Investor, IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for " & Forms![case list]!Investor, Forms![case list]!Investor)))))))

FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", IIf(IsNull(d!NotaryLocation), "STATE OF ______________:" & vbCr & "COUNTY OF ____________ :", d!NotaryLocation)
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "only328client", IIf(d![ClientID] = 328, d![Investor] & " has been proven to be the real party in interest and has the right to foreclose the subject property.", "")
FillField WordDoc, "Barcode", IIf(d!ClientID = 634 Or d!ClientID = 451, "", AddDocPreIndex(d![CaseList.FileNumber], 152, ""))

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Military Affidavit.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Military Affidavit.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_MilitaryAffidavitDC(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Military Affidavit DC")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Military Affidavit DC.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

FillField WordDoc, "designatorDate", IIf([Forms]![foreclosurePrint]![txtDesignator] = 3, "Date: " & Format(Date, "mmmm d, yyyy"), "")
FillField WordDoc, "MortgagorBorrowerNames", BorrowerMorgagorNamesOneSSN(d![CaseList.FileNumber], CopyNoR())
FillField WordDoc, "OriginalMortgagors", IIf(IsNull(d!OriginalMortgagors), "", "Original Mortgagors " & d!OriginalMortgagors)
FillField WordDoc, "LoanNumber", d!LoanNumber
'FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(2) = 3, IIf(D![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), Forms![Case List]!Investor)
'FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(2) = 3, IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for ", "")) & Forms![Case List]!Investor
'FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(2) = 3, IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), IIf((d![AIF] = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for ", "")) & Forms![Case List]!Investor)
FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(2) = 3, IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), IIf(d!ClientID = 531, "M&T Bank as Servicer for " & Forms![case list]!Investor, IIf((d![AIF] = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for " & Forms![case list]!Investor, Forms![case list]!Investor))))

FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", IIf(Split(ReportArgs, "|")(2) = 3, IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), (Split(ReportArgs, "|")(1)))
FillField WordDoc, "NotaryLocation", IIf(IsNull(d!NotaryLocation), "STATE OF ______________:" & vbCr & "COUNTY OF ____________ :", d!NotaryLocation)
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "only328client", IIf(d![ClientID] = 328, d![Investor] & " has been proven to be the real party in interest and has the right to foreclose the subject property.", "")
FillField WordDoc, "Barcode", IIf(d!ClientID = 634 Or d!ClientID = 451, "", AddDocPreIndex(d![CaseList.FileNumber], 152, ""))

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Military Affidavit DC.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Military Affidavit.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_NoteOwnershipAffidavit(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If d!ClientID = 404 Then
    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Note Ownership Affidavit Bogman")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Note Ownership Affidavit Bogman.doc", False)
    WordObj.Visible = True
ElseIf (d![ClientID] = 451 And Trim(UCase$(d!Investor)) Like "LPP*" And d![FCdetails.State] = "MD") Then
    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Note Ownership Affidavit Dove LPP")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Note Ownership Affidavit Dove LPP.doc", False)
    WordObj.Visible = True
ElseIf d!ClientID = 451 Then
    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Note Ownership Affidavit Dove")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Note Ownership Affidavit Dove.doc", False)
    WordObj.Visible = True
    
ElseIf d!ClientID = 328 Then 'SLS
    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Note Ownership Affidavit SLS")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Note Ownership Affidavit SLS.doc", False)
    WordObj.Visible = True
Else
    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Note Ownership Affidavit")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Note Ownership Affidavit.doc", False)
    WordObj.Visible = True
End If

If d!ClientID = 451 Then
    WordDoc.Bookmarks("LastName").Select
    WordDoc.Bookmarks("LastName").Range.Text = d![PrimaryLastName]
End If

'margin address:
    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation])) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
If d!ClientID <> 404 And d!ClientID <> 451 Then
    FillField WordDoc, "Barcode", ""
Else
    FillField WordDoc, "Barcode", IIf((d!ClientID = 444 Or d!ClientID = 634 Or d!ClientID = 451) And d![FCdetails.State] = "MD", "", AddDocPreIndex(d![CaseList.FileNumber], 464, ""))
End If
FillField WordDoc, "DE", IIf(d![FCdetails.State] = "MD", "e", "d")
FillField WordDoc, "CDAfooter", IIf(d!ClientID = 634, d![PrimaryLastName] & vbTab & "Affidavit of Note Ownership", "")
FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "Investor2", IIf(d![ClientID] = 385, d![Investor2], d![Investor])
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "LoanTypewords", IIf(d!LoanType = 5, "Federal Home Loan Mortgage Corporation ", IIf(d!LoanType = 4, "Federal National Mortgage Association ", "")) & _
 IIf(d!LoanType = 5 Or d!LoanType = 4, "has authorized Specialized Loan Servicing LLC to be the holder of the debt instrument for the purpose of conducting this foreclosure action. ", "")

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "NoteOwner", FetchNoteOwner(d!LoanType, IIf(d![ClientID] = 385, d![Investor2], d![Investor]), d![FCdetails.State])
FillField WordDoc, "Noteholders", GetNamesMD(0, 2, "Noteholder=True")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "inOrUpto", IIf(d!ClientID = 567, ", up to", " in")
'FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, d!LongClientName & " as Attorney in Fact for ", "") & d!Investor

'If d!ClientID = 328 Then 'SPLS
'    FillField WordDoc, "InvestorAIF", "Specialized Loan Servicing LLC, as servicer for secured party"
'ElseIf d!ClientID = 605 Then
'    FillField WordDoc, "InvestorAIF", IIf(d![AIF] = True, d![LongClientName] & " as Servicer for ", "") & d![Investor]
'ElseIf d!ClientID = 73 Then
'    FillField WordDoc, "InvestorAIF", IIf(d![AIF] = True And d![FCdetails.State] = "MD", d![Investor] & ", By Carrington Mortgage Services, LLC as Attorney in Fact and Servicing Agent", d![Investor])
'ElseIf d!ClientID = 523 Then
'    FillField WordDoc, "InvestorAIF", IIf(d![AIF] = True, d![Investor] & ", by Ditech Financial LLC f/k/a Green Tree Servicing LLC", d![Investor])
'ElseIf d!ClientID = 567 Then
'    FillField WordDoc, "InvestorAIF", IIf(d![AIF] = True, IIf(d![FCdetails.State] = "MD", "Nationstar Mortgage LLC d/b/a Champion Mortgage Company of Texas as attorney-in-fact for ", d![LongClientName] & " as Attorney in Fact for "), "") & d!Investor
'Else
'    FillField WordDoc, "InvestorAIF", IIf((d!AIF = True And d!ClientID = 373), d!Investor & ", by BSI Financial Services as attorney in fact", IIf((d![AIF] = True And d![ClientID] = 523), d![Investor] & " by Green Tree Servicing LLC as servicer", IIf((d![AIF] = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for ", "") & d![Investor])))
'End If

FillField WordDoc, "InvestorAIF", IIf(d!ClientID = 634, "The Community Development Administration of the Department of Housing and Community Development for the State of Maryland " & vbCr & _
"By: Dovenmuehle Mortgage Inc., its attorney-in-fact", "") & _
    IIf(d!ClientID = 634, "", _
    IIf(d!ClientID = 328, IIf((d!LoanType = 5 Or d!LoanType = 4), "", IIf(d!Investor = "Specialized Loan Servicing LLC", "", ", as servicer for secured party")), _
    IIf(d![AIF] = True, IIf(d![ClientID] = 373, d![Investor] & ", by BSI Financial Services as attorney in fact", _
    IIf(d![ClientID] = 527 And d![FCdetails.State] = "MD", d!Investor & ", By Rushmore Loan Management Services LLC as its appointed Attorney in Fact", _
    IIf(d![ClientID] = 567, "Nationstar Mortgage LLC as attorney-in-fact for " & d![Investor], _
    IIf(d![ClientID] = 557 And d![FCdetails.State] = "MD", d![Investor] & " by Caliber Home Loans, Inc., as its attorney in fact", _
    IIf(d![ClientID] = 523, d![Investor] & ", by Ditech Financial LLC f/k/a Green Tree Servicing LLC", _
    IIf(d![ClientID] = 532, d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", _
    IIf(d![ClientID] = 605 Or (d![ClientID] = 662 And d![FCdetails.State] = "MD"), d![LongClientName] & " as Servicer for " & d!Investor, _
    IIf((d![ClientID] = 73 And d![FCdetails.State] = "MD"), d![Investor] & ", By Carrington Mortgage Services, LLC as Attorney in Fact and Servicing Agent", _
        d![LongClientName] & " as Attorney in Fact for " & d![Investor])))))))), d!Investor)))

FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "nonCDALine", IIf(d!ClientID = 634, "", "________________________________")
FillField WordDoc, "CDANAme", IIf(d!ClientID = 634, "Name: __________________________", "")
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID)
FillField WordDoc, "FHLMCWording", IIf(d!LoanType = 4 And d!ClientID = 518 And d![FCdetails.State] = "MD", "", IIf(d!LoanType = 5 Or d!LoanType = 4, ", and " & IIf(d![ClientID] = 385, d![Investor2], d![Investor]) & " is the holder of the Note having been transferred to " & IIf(d![ClientID] = 385, d![Investor2], d![Investor]) & " for the purposes of enforcement and conducting this foreclosure action", ""))
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
'FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "Address: ____________________", "") & vbCr
'FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "               ____________________", "")
'FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "Phone No.: __________________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Note Ownership Affidavit.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Note Ownership Affidavit.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_MD7_105Affidavit(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

'NextNumber = 3

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If Forms![case list]!ClientID = 531 Then
    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("MD 7-105 Affidavit MDHC")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "MD 7-105 Affidavit MDHC.doc", False)
ElseIf Forms![case list]!ClientID = 404 Then    'Bogman
    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("MD 7-105 Affidavit Bogman")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "MD 7-105 Affidavit Bogman.doc", False)
ElseIf (d![ClientID] = 451 And Trim(UCase$(d!Investor)) Like "LPP MORTGAGE*" And d![FCdetails.State] = "MD" And Forms!foreclosurePrint!txtDesignator <> 3) Then
    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("MD 7-105 Affidavit Dove")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "MD 7-105 Affidavit Dove.doc", False)
Else
    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("MD 7-105 Affidavit")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "MD 7-105 Affidavit.doc", False)
End If
WordObj.Visible = True

'margin address:
    If (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "VA") _
                    Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "DC") Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "MD") Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
WordDoc.Bookmarks("ProjectName").Select
WordDoc.Bookmarks("ProjectName").Range.Text = d![PrimaryDefName]

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber

FillField WordDoc, "Investor", IIf([Forms]![foreclosurePrint]![txtDesignator] = 3, "", _
IIf(d!ClientID = 634, "The Community Development Administration of the Department of Housing and Community Development for the State of Maryland" & vbCr & _
    "By: Dovenmuehle Mortgage Inc., its attorney-in-fact", _
IIf((d![AIF] = True And d![ClientID] = 373), d![Investor] & ", by BSI Financial Services as attorney in fact", _
IIf((d![AIF] = True And d![ClientID] = 557 And d![FCdetails.State] = "MD"), d![Investor] & " by Caliber Home Loans, Inc., as its attorney in fact", _
IIf((d![AIF] = True And d![ClientID] = 527 And d![FCdetails.State] = "MD"), d![Investor] & ", By Rushmore Loan Management Services LLC as its appointed Attorney in Fact", _
IIf((d![AIF] = True And d![ClientID] = 567), "Nationstar Mortgage LLC as attorney-in-fact for " & d![Investor], _
IIf((d![AIF] = True And [Forms]![foreclosurePrint]![txtDesignator] <> 3 And d![ClientID] = 523), d![Investor] & ", by Ditech Financial LLC f/k/a Green Tree Servicing LLC", _
IIf((d![AIF] = True And d![ClientID] = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", _
IIf((d![AIF] = True And d![ClientID] = 605), d![LongClientName] & " as Servicer for " & d![Investor], _
IIf(d![AIF] = True And d![ClientID] <> 73, d![LongClientName] & " as Attorney in Fact for " & d![Investor], _
IIf(d![AIF] = True And d![ClientID] = 73 And d![FCdetails.State] = "MD", d![Investor] & ", By Carrington Mortgage Services, LLC as Attorney in Fact and Servicing Agent", d![Investor])))))))))))

FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
'FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then
    FillField WordDoc, "FirmShortAddress", DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
    FillField WordDoc, "FirmShortAddress", DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then
        FillField WordDoc, "FirmShortAddress", DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                  DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID =2")
End If

FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "NOI", Format$(d!NOI, "mmmm d, yyyy")
FillField WordDoc, "DateofDefault", Format$(d!DateOfDefault, "mmmm d, yyyy")
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "DefaultType", IIf(d!TypeOfDefault = 2, "The mortgage loan is in default because " & d!OtherDefault, "Said defendant(s) did not make the monthly mortgage payments and are in default under the terms of the " & DOTWord(d!DOT))
FillField WordDoc, "NextNo4", IIf(d!ClientID = 567 And d![FCdetails.State] = "MD", "", "(4) The Appointment of Substitute Trustees provided is a true and accurate copy.")
FillField WordDoc, "NextNo5", IIf(d!ClientID = 567 And d![FCdetails.State] = "MD", "(4) ", "(5) ")
FillField WordDoc, "NextNo6", IIf(d!ClientID = 567 And d![FCdetails.State] = "MD", "(5) ", "(6) ")
FillField WordDoc, "NextNo7", IIf(d!ClientID = 567 And d![FCdetails.State] = "MD", "(6) ", "(7) ")
FillField WordDoc, "line", IIf([Forms]![foreclosurePrint]![txtDesignator] <> 3 And d!ClientID = 634, "", "_____________________________________")
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "CDAName", IIf([Forms]![foreclosurePrint]![txtDesignator] = 3, "", IIf(d!ClientID = 634, "Name: _______________________________", ""))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID)
FillField WordDoc, "CDAFooter", IIf([Forms]![foreclosurePrint]![txtDesignator] = 3, "", IIf(d!ClientID = 634, Nz(d!PrimaryLastName) & vbTab & "NOI Affidavit", ""))

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "MD 7-105 Affidavit.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "MD 7-105 Affidavit.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_LossMitigationPre(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim textfinal As String


Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If
 
Dim templateName As String
Dim BankName As String

If (d![ClientID] = 6 Or d![ClientID] = 556) Then
  templateName = "Loss Mitigation - Preliminary Wells"
ElseIf d!ClientID = 446 Then
  templateName = "Loss Mitigation - Preliminary BOA"
ElseIf d!ClientID = 451 Then
    If d![FCdetails.State] = "MD" And InStr(d!Investor, "LPP") <> 0 Then
       
            templateName = "Loss Mitigation - Preliminary Dove LPP"
    Else
            templateName = "Loss Mitigation - Preliminary Dove"
    End If
ElseIf d!ClientID = 97 Then
 templateName = "Loss Mitigation - Preliminary JP"
Else
templateName = "Loss Mitigation Preliminary"
End If


If d![ClientID] = 6 Then
    BankName = "Loss Mitigation Preliminary Wells Fargo Bank"
ElseIf d![ClientID] = 556 Then
    BankName = "Loss Mitigation Preliminary Wells Fargo Home Mortgage"
ElseIf d!ClientID = 446 Then
    BankName = "Loss Mitigation Preliminary Bank of America"
ElseIf d!ClientID = 451 Then
    BankName = "Loss Mitigation Preliminary Dove"
ElseIf d!ClientID = 97 Then  'jp
    BankName = "Loss Mitigation - Preliminary JP"
    
Else
    BankName = templateName
End If


Set WordObj = CreateObject("Word.Application")
 Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
WordObj.Visible = True

If d!ClientID = 451 Then
    WordDoc.Bookmarks("LastName").Select
    WordDoc.Bookmarks("LastName").Range.Text = d![PrimaryLastName]
End If

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
'
If d!ClientID = 532 Then
    FillField WordDoc, "Barcode", ""
Else
    FillField WordDoc, "Barcode", IIf((d!ClientID = 444 Or d!ClientID = 634 Or d!ClientID = 451) And d![FCdetails.State] = "MD", "", AddDocPreIndex(d![CaseList.FileNumber], 1484, ""))
End If
FillField WordDoc, "CDAfooter", IIf(d!ClientID = 634, d![PrimaryLastName] & vbTab & "Preliminary Loss Mitigation Affidavit", "")

'margin office location:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
FillField WordDoc, "DitechFooter", IIf(d!ClientID = 523, "PLMA - " & d!PropertyAddress & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d!City & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode), "")
FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "fillingdate", IIf(Not IsNull(d![Docket]), Format(d![Docket], "mm/d/yyyy"), "_____________________ ")
'FillField WordDoc, "borrower", MortgagorNamesOneline(d![CaseList.FileNumber], 2)
FillField WordDoc, "Borrower", MortgagorNames(0, 20)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "Carrington", IIf(d!ClientID = 73 And d![FCdetails.State] = "MD", "By: " & d!Investor & IIf(d!AIF, ", By Carrington Mortgage Services, LLC as Attorney in Fact and Servicing Agent", ""), "")

FillField WordDoc, "CourtCaseNumber", IIf(d!ClientID = 97, "____________________", IIf(Not IsNull(d![CourtCaseNumber]), d![CourtCaseNumber], " _____________________ "))
FillField WordDoc, "NameAffianit", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "Print Name and Title of Affiant", "Name")
FillField WordDoc, "TitleAffiaitOrInvestor", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "", "Title of Affiant")
FillField WordDoc, "Line", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "", "______________________________")
FillField WordDoc, "Investor", IIf(d![ClientID] = 6 Or d![ClientID] = 556, d!Investor, "")
FillField WordDoc, "Resurgent", IIf(d![ClientID] = 543 Or d![ClientID] = 605, "By: New Penn Financial, LLC d/b/a Shellpoint Mortgage Servicing", "")
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 1484, "")

FillField WordDoc, "AffSignature", IIf(d!ClientID = 634, "", "_____________________________" & vbTab & "_____________________________" & vbCr & "Signature of Affiant" & vbTab & "Date")
FillField WordDoc, "NameLine", IIf(d!ClientID = 634, "", "_____________________________" & vbCr & "Name")
FillField WordDoc, "AffTitleLine", IIf(d!ClientID = 634, "", "_____________________________" & vbCr & "Title of Affiant")
FillField WordDoc, "CDASig", IIf(d!ClientID = 634, "The Community Development Administration of the Department of Housing and Community Development for the State of Maryland            By: Dovenmuehle Mortgage Inc., its attorney-in-fact", "")
FillField WordDoc, "CDALine1", IIf(d!ClientID = 634, "By:____________________________________", "")
FillField WordDoc, "CDALine2", IIf(d!ClientID = 634, "Name:__________________________________", "")
FillField WordDoc, "CDALine3", IIf(d!ClientID = 634, "Title:__________________________________", "")
FillField WordDoc, "CDALine4", IIf(d!ClientID = 634, "Date:__________________________________", "")

    FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "Address: ____________________________", "")
    FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "              " & " ____________________________", "")
    FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "Phone No.: __________________________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Loss Mitigation Preliminary" & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Loss Mitigation Preliminary" & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_LossMitigationFinalJP(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim templateName As String
Dim BankName As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
templateName = "Loss Mitigation - Final JP"
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

'margin office location:
    If (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "VA") Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "DC") _
                    Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "MD") Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

'FillField WordDoc, "CourtCaseNumber", IIf((IsNull(d![CourtCaseNumber]) Or d![CourtCaseNumber] = ""), " _____________________ ", d![CourtCaseNumber])
'FillField WordDoc, "fillingdate", IIf(IsNull(d![Docket]), "_____________________ ", Format(d![Docket], "mm/d/yyyy"))
FillField WordDoc, "borrower", MortgagorNamesOneline(d![CaseList.FileNumber], 2)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Loss Mitigation Final JP.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Loss Mitigation Final JP.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_LossMitigationFinal(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim templateName As String
Dim BankName As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If (d![ClientID] = 6 Or d![ClientID] = 556) Then
  templateName = "Loss Mitigation - Final Wells"
ElseIf d!ClientID = 446 Then
    templateName = "Loss Mitigation - Final BOA"
ElseIf d!ClientID = 328 Then
    templateName = "Loss Mitigation - Final SPLS"
ElseIf d!ClientID = 451 Then
    If d![FCdetails.State] = "MD" And InStr(d!Investor, "LPP") <> 0 Then
            templateName = "Loss Mitigation - Final Dove LPP"
    Else
            templateName = "Loss Mitigation - Final Dove"
    End If
Else

templateName = "Loss Mitigation - Final"
End If

If d![ClientID] = 6 Then
    BankName = "Loss Mitigation Final Wells Fargo Bank"
ElseIf d![ClientID] = 556 Then
    BankName = "Loss Mitigation Final Wells Fargo Home Mortgage"
ElseIf d!ClientID = 446 Then
    BankName = "Loss Mitigation Final Bank of America"
ElseIf d!ClientID = 328 Then
    BankName = "Loss Mitigation Final SPLS"
ElseIf d!ClientID = 451 Then
    BankName = "Loss Mitigation Final Dove"
Else
BankName = "Loss Mitigation - Final"
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
WordObj.Visible = True

If d!ClientID = 451 Then
    WordDoc.Bookmarks("LastName").Select
    WordDoc.Bookmarks("LastName").Range.Text = d!PrimaryLastName
End If

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
'If d!ClientID = 532 Then
'    FillField WordDoc, "Barcode", ""
'Else
'    FillField WordDoc, "Barcode", IIf((d!ClientID = 444 Or d!ClientID = 634 Or d!ClientID = 451) And d![FCdetails.State] = "MD", "", AddDocPreIndex(d![CaseList.FileNumber], 1345, ""))
'End If

FillField WordDoc, "borrower", MortgagorNames(0, 2)
Dim FDebt As String
FDebt = Nz([Forms]![ForeclosureDetails]![Fair Debt])
FillField WordDoc, "PropertyAddress", [Forms]![ForeclosureDetails]![PropertyAddress] & IIf(Len(FDebt & "") = 0, "", ", " & FDebt) & ", " & [Forms]![ForeclosureDetails]![City] & ", " & [Forms]![ForeclosureDetails]![State] & " " & FormatZip([Forms]![ForeclosureDetails]![ZipCode])
FillField WordDoc, "fillingdate", IIf(IsNull([Forms]![ForeclosureDetails]![Docket]) Or [Forms]![ForeclosureDetails]![Docket] = "", "__________________", Format([Forms]![ForeclosureDetails]![Docket], "mm/dd/yyyy"))
FillField WordDoc, "CourtCaseNumber", IIf(IsNull(Forms!ForeclosureDetails!CourtCaseNumber) Or Forms!ForeclosureDetails!CourtCaseNumber = "", "____________________", Forms!ForeclosureDetails!CourtCaseNumber)

FillField WordDoc, "CDAfooter", IIf(d!ClientID = 634, d![PrimaryLastName] & vbTab & "Final Loss Mitigation Affidavit", _
     IIf(d!ClientID = 523, "FLMA - " & d!PropertyAddress & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode]), ""))
'margin office location:
    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

'FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
'FillField WordDoc, "LoanNumber", d!LoanNumber
'FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
'FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
'FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
'FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
'FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
'FillField WordDoc, "City", d!City
'FillField WordDoc, "State", d![FCdetails.State]
'FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", IIf(Not IsNull(d![CourtCaseNumber]), d![CourtCaseNumber], " _____________________ ")
'FillField WordDoc, "NameAffianit", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "Print Name and Title of Affiant", "Name")
'FillField WordDoc, "TitleAffiaitOrInvestor", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "", "Title of Affiant")
'FillField WordDoc, "Line", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "", "______________________________")
FillField WordDoc, "Investor", IIf(d![ClientID] = 6 Or d![ClientID] = 556, d![Investor], "")
FillField WordDoc, "Resurgent", IIf(d![ClientID] = 543 Or d![ClientID] = 605, "By: New Penn Financial, LLC d/b/a Shellpoint Mortgage Servicing", "")

FillField WordDoc, "fillingdate", IIf(Not IsNull(d![Docket]), Format(d![Docket], "mm/d/yyyy"), "_____________________ ")
'FillField WordDoc, "borrower", MortgagorNamesOneline(d![CaseList.FileNumber], 2)
'FillField WordDoc, "Borrower", MortgagorNames(0, 20)

'If Not d!ClientID = 446 Then FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "AffSignature", IIf(d!ClientID = 634, "", "_____________________________________" & vbTab & "_____________________________" & vbCr & "Signature of Affiant" & vbTab & "Date")
FillField WordDoc, "NameLine", IIf(d!ClientID = 634, "", "_____________________________________" & vbCr & "Print Name and Title of Affiant")
'FillField WordDoc, "AffTitleLine", IIf(d!ClientID = 634, "", "_____________________________" & vbCr & "")
FillField WordDoc, "Carrington", IIf((d!ClientID = 73 And d![FCdetails.State] = "MD"), "By: " & d!Investor & IIf(d!AIF, "By Carrington Mortgage Services, LLC as Attorney in Fact and Servicing Agent", ""), "")
FillField WordDoc, "CDASig", IIf(d!ClientID = 634, "The Community Development Administration of the Department of Housing and Community Development for the State of Maryland            By: Dovenmuehle Mortgage Inc., its attorney-in-fact", "")
FillField WordDoc, "CDALine1", IIf(d!ClientID = 634, "By:____________________________________", "")
FillField WordDoc, "CDALine2", IIf(d!ClientID = 634, "Name:__________________________________", "")
FillField WordDoc, "CDALine3", IIf(d!ClientID = 634, "Title:__________________________________", "")
FillField WordDoc, "CDALine4", IIf(d!ClientID = 634, "Date:__________________________________", "")

    FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "Address: ____________________________", "")
    FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "              " & "____________________________", "")
    FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "Phone No.: __________________________", "")


WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & BankName & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], BankName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_StatementOfDebt(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String
templateName = "Statement of Debt"

If (d![ClientID] = 157) Then
  templateName = templateName & " Cenlar"
ElseIf d!ClientID = 404 Then
  templateName = templateName & " Bogman"
ElseIf (d![ClientID] = 451 And Trim(UCase$(d!Investor)) Like "LPP MORTGAGE*" And d![FCdetails.State] = "MD") Then
  templateName = templateName & " Dove"
ElseIf d![ClientID] = 451 Then
    templateName = templateName & " Dove"
End If
'templateName = templateName & ".doc"           '7/27/16 don't need .doc at this time

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True
'margin address:
    If (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "VA") _
                    Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "DC") Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "MD") Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

WordObj.Visible = False
If MsgBox("Is There A Loan Mod? ", vbYesNo) = vbYes Then
FillField WordDoc, "Mod", ", MODIFIED by Agreement effective " & Format(InputBox(" Effective Date?   Format mm/dd/yyyy"), "mmmm d, yyyy") & " with an amended principal balance of " & Format(InputBox(" Amended Principal Balance? "), "Currency")
Else
FillField WordDoc, "Mod", ""
End If

If d!JurisdictionID = 6 Then  'Calvert County
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Book " & d![Liber2] & ", Page " & d![Folio2])
Else 'MD or DC
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Liber " & d![Liber2] & ", Folio " & d![Folio2])
End If

WordObj.Visible = True
FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber

FillField WordDoc, "Investor", IIf([Forms]![foreclosurePrint]![txtDesignatedAttorney] = 0, IIf(d![AIF] = True, IIf(d![ClientID] = 373, d![Investor] & ", by BSI Financial Services as attorney in fact", _
    IIf(d![ClientID] = 557 And d![FCdetails.State] = "MD", d![Investor] & " by Caliber Home Loans, Inc., as its attorney in fact", _
    IIf(d![ClientID] = 532, d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", _
    IIf(d![ClientID] = 605, d![LongClientName] & " as Servicer for " & d!Investor, _
    IIf((d![ClientID] = 73 And d![FCdetails.State] = "MD"), d![Investor] & ", By Carrington Mortgage Services, LLC as Attorney in Fact and Servicing Agent", _
        d![LongClientName] & " as Attorney in Fact for " & d![Investor]))))), d!Investor), "")

FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", IIf(d!CaseTypeID = 8, d!MonitorTrusteeAddress, FirmShortAddress(vbCr))
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

'FillField WordDoc, "BalanceDue", IIf((d![ClientID] = 451 And d![FCdetails.State] = "MD"), "Unpaid Principal Balance Due", "Remaining Balance Due")
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "Liber", LiberFolio(d![Liber], d![Folio], d![FCdetails.State], d![JurisdictionID])
FillField WordDoc, "LPIdate", Format$(d![LPIDate], "mmmm d, yyyy")
FillField WordDoc, "LPIdate+1", Format$(d![LPIDate] + 1, "mmmm d, yyyy")
FillField WordDoc, "LPdM", DateAdd("m", -1, d![LPIDate])
FillField WordDoc, "Remaining", IIf(((d![ClientID] = 451 Or d![ClientID] = 634) And d![FCdetails.State] = "MD"), "Unpaid Principal", "Remaining")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "PaidStr", IIf((Nz(d![RemainingPBal], 0) > Nz(d![OriginalPBal], 0)), "Additional Interest", "Paid on principal")
FillField WordDoc, "Paid", Format$(d!OriginalPBal - d!RemainingPBal, "Currency")
FillField WordDoc, "RemainingPBal", Format$(d!RemainingPBal, "Currency")
FillField WordDoc, "InterestRate", IIf(IsNull(d!InterestRate), "____________ %", Format$(d!InterestRate, "#.000%"))
Dim MDBar, MDAttny As String     '8/1/16 Mei
If Not IsNull([Forms]![foreclosurePrint]![Attorney].Column(0)) Then
MDBar = DLookup("MDBar", "Staff", "ID =" & [Forms]![foreclosurePrint]![Attorney].Column(0))
MDAttny = [Forms]![foreclosurePrint]![Attorney].Column(1)
End If
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0)) & IIf([Forms]![foreclosurePrint]![txtDesignatedAttorney] = 3, _
                    IIf(d![FCdetails.State] = "MD", IIf(IsNull(MDBar), "", ", CPTF # " & MDBar), ""), "")
FillField WordDoc, "opt3", IIf([Forms]![foreclosurePrint]![txtDesignatedAttorney] = 3, IIf(d![FCdetails.State] = "MD", _
            IIf(IsNull(MDBar), "", MDAttny & " CPTF #: " & MDBar), ""), "its Authorized Signer")
FillField WordDoc, "SubTrus", IIf([Forms]![foreclosurePrint]![txtDesignatedAttorney] = 3 And d![FCdetails.State] = "MD", "Title: Substitute Trustee", "")
FillField WordDoc, "Investor", IIf([Forms]![foreclosurePrint]![txtDesignatedAttorney] = 3 And d![FCdetails.State] = "MD", "", _
                            "LPP MORTGAGE LTD., a Texas limited partnership By: Property Acceptance Corporation, its sole general partner By:")
If d!ClientID = 404 Then   'Bogman
    FillField WordDoc, "InvestorBG", IIf([Forms]![foreclosurePrint]![txtDesignatedAttorney] = 0, _
                "Bogman Inc. as Attorney in Fact for " & vbCr & _
                "Maryland Department of Housing and " & vbCr & _
                "Community Development, Community" & vbCr & _
                "Development Administration", "")
End If
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
If d!ClientID = 532 Or (d!ClientID = 328 And d![FCdetails.State] = "MD") Then
    FillField WordDoc, "Barcode", ""
Else
FillField WordDoc, "Barcode", IIf((d!ClientID = 634 Or d!ClientID = 451) And d![FCdetails.State] = "MD", "", AddDocPreIndex(d![CaseList.FileNumber], 223, ""))
End If
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "Address: ________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "               ________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "Phone No.: ______________", "")

WordObj.Selection.HomeKey wdStory, wdMove
If d!ClientID = 523 Then
   ' WordDoc.SaveAs EMailPath & "Statement of Debt Ditech.doc"
   ' Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Statement of Debt Ditech.doc")
Else
  '  WordDoc.SaveAs EMailPath & "Statement of Debt.doc"
  '  Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Statement of Debt.doc")
End If

'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_StatementOfDebtFigures(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range

Dim d As Recordset, dd As Recordset      ' data
Dim i As Integer, itemcount As Integer, TotalItems As Currency, itemsFields As String
Dim InterestFrom As String
Dim InterestTo As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String
templateName = "Statement of Debt Figures"

If (d![ClientID] = 157) Then
  templateName = templateName & " Cenlar"
ElseIf (d![ClientID] = 451 And Trim(UCase$(d!Investor)) Like "LPP*" And d![FCdetails.State] = "MD") Then
    templateName = templateName & " Dove-LPP"
ElseIf (d![ClientID] = 451) Or d![ClientID] = 634 Then
    templateName = templateName & " Dove"
ElseIf d!ClientID = 404 Then
    templateName = templateName & " Bogman"
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)

WordObj.Visible = True

InterestFrom = InputBox("Interest From")
InterestTo = InputBox("Interest To")

If d!ClientID = 451 Then
WordDoc.Bookmarks("LastName").Select
WordDoc.Bookmarks("LastName").Range.Text = d!PrimaryLastName
End If
WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])



'margin address:
    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "LNAme", IIf(d!ClientID = 451 Or d!ClientID = 634, Nz(d!PrimaryLastName), "")
    
WordObj.Visible = False
If MsgBox("Is There A Loan Mod? ", vbYesNo) = vbYes Then
FillField WordDoc, "Mod", " MODIFIED by Agreement effective " & Format(InputBox(" Effective Date?   Format mm/dd/yyyy"), "mmmm d, yyyy") & " with an amended principal balance of " & Format(InputBox(" Amended Principal Balance? "), "Currency")
Else
FillField WordDoc, "Mod", ""
End If
WordObj.Visible = True

'If d!ClientID = 532 Then    'Selene
'    FillField WordDoc, "Barcode", ""
'Else
'    FillField WordDoc, "Barcode", IIf(d![FCdetails.State] = "MD", AddDocPreIndex(d![CaseList.FileNumber], 223, ""), "")
'End If


If d!JurisdictionID = 6 Then  'Calvert County
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Book " & d![Liber2] & ", Page " & d![Folio2])
Else 'MD or DC
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Liber " & d![Liber2] & ", Folio " & d![Folio2])
End If

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber  ' Test

FillField WordDoc, "Investor", IIf(d!ClientID = 634, "The Community Development Administration of the Department of Housing and Community Development for the State of Maryland" & vbCr & "By: Dovenmuehle Mortgage Inc., its attorney-in-fact", _
    IIf(d![AIF] = True, IIf(d![ClientID] = 373, d![Investor] & ", by BSI Financial Services as attorney in fact", _
    IIf(d![ClientID] = 557 And d![FCdetails.State] = "MD", d![Investor] & " by Caliber Home Loans, Inc., as its attorney in fact", _
    IIf(d![ClientID] = 527 And d![FCdetails.State] = "MD", d!Investor & ", By Rushmore Loan Management Services LLC as its appointed Attorney in Fact", _
    IIf(d![ClientID] = 523 And d![FCdetails.State] = "MD", d![Investor] & ", by Ditech Financial LLC f/k/a Green Tree Servicing LLC", _
    IIf(d![ClientID] = 523 And d![FCdetails.State] <> "MD", d![Investor] & " by Green Tree Servicing LLC as servicer", _
    IIf(d![ClientID] = 532, d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", _
    IIf(d![ClientID] = 605 Or (d![ClientID] = 662 And d![FCdetails.State] = "MD"), d![LongClientName] & " as Servicer for " & d!Investor, _
    IIf((d![ClientID] = 73 And d![FCdetails.State] = "MD"), d![Investor] & ", By Carrington Mortgage Services, LLC as Attorney in Fact and Servicing Agent", _
        d![LongClientName] & " as Attorney in Fact for " & d![Investor])))))))), d!Investor))

FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", IIf(d!CaseTypeID = 8, d!MonitorTrusteeAddress, FirmShortAddress(vbCr))
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "455Only", IIf(d![ClientID] = 455, ", and continuing each month thereafter with probable future advancements made by the mortgagee, and that the Plaintiff(s) has\have the right to foreclose;", ", and continuing each month thereafter, and that the Plaintiff(s) has\have the right to foreclose;")
FillField WordDoc, "Liber", LiberFolio(d![Liber], d![Folio], d![FCdetails.State], d![JurisdictionID])
FillField WordDoc, "LPIdate", Format$(d![LPIDate], "mmmm d, yyyy")
FillField WordDoc, "LPIdate+1", Format$(d![LPIDate] + 1, "mmmm d, yyyy")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "PaidStr", IIf((Nz(d![RemainingPBal], 0) > Nz(d![OriginalPBal], 0)), "Additional Interest", "Paid on principal")
FillField WordDoc, "Paid", Format$(d!OriginalPBal - d!RemainingPBal, "Currency")
FillField WordDoc, "RemainingPBal", Format$(d!RemainingPBal, "Currency")
FillField WordDoc, "diem", IIf(d![LoanType] = 3, IIf(d![ClientID] <> 531, "Per Monthly Interest: ", "Per Diem Interest: "), "Per Diem Interest: ")
'FillField WordDoc, "txtbalanc", IIf(d![ClientID] = 361, "Unpaid Principal Balance", "Remaining Balance Due")
FillField WordDoc, "txtbalanc", IIf(d![ClientID] = 361, "Unpaid Principal Balance", IIf(d![ClientID] = 451 Or d![ClientID] = 634, IIf(d![FCdetails.State] = "MD", "Unpaid Principal Balance Due", "Principal Balance Due"), "Remaining Balance Due"))
FillField WordDoc, "CDAName", IIf(d![ClientID] = 634, "Name: __________________________", "")
'FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "Address: ________________", "")
'FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "               ________________", "")
'FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "Phone No.: ______________", "")

TotalItems = 0
itemsFields = ""
Set dd = CurrentDb.OpenRecordset("SELECT Desc, Amount FROM StatementOfDebt WHERE FileNumber=" & d![CaseList.FileNumber] & " ORDER BY Timestamp;", dbOpenSnapshot)
If dd.EOF Then      ' no extra lines
    FillField WordDoc, "Line_Items", ""
Else
    dd.MoveLast
    itemcount = dd.RecordCount
    ' Make enough lines
    For i = 1 To itemcount
        itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
    Next i
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
    FillField WordDoc, "Line_Items", itemsFields
    dd.MoveFirst
    i = 1
    Do While Not dd.EOF
        FillField WordDoc, "Item" & i, IIf(dd!Desc = "Interest", "Interest from " & Format(InterestFrom, "mm/dd/yyyy") & " to " & Format(InterestTo, "mm/dd/yyyy"), dd!Desc) & _
                                            vbTab & Format$(Nz(dd!Amount, 0), "Currency")
        TotalItems = TotalItems + Nz(dd!Amount, 0)
        dd.MoveNext
        i = i + 1
    Loop
End If
dd.Close

FillField WordDoc, "BalDueDate", IIf(IsNull([Forms]![Print Statement of Debt]![txtDueDate]), "______________", Format$([Forms]![Print Statement of Debt]![txtDueDate], "mmmm d"", ""yyyy"))
FillField WordDoc, "BalanceDue", Format$(d!RemainingPBal + TotalItems, "Currency")
FillField WordDoc, "PerDiemInterest", IIf(IsNull(d!PerDiem), "$_____________", Format$(d!PerDiem, "Currency"))
'FillField WordDoc, "InterestRate", IIf(IsNull(d!InterestRate), "____________ %", Format$(d!InterestRate, "#.000%"))
FillField WordDoc, "InterestRate", IIf(IsNull(d!InterestRate), "____________ %", Format$(d!InterestRate, "#0.000") & "%")
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "CDAName", IIf(d!ClientID = 634, "Name: _____________________________", "")
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", IIf(IsNull(d!NotaryLocation), "STATE OF ______________:" & vbCr & "COUNTY OF ____________ :", d!NotaryLocation)

FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "Address: ________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "               ________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3 And (d![ClientID] <> 634 And d![ClientID] <> 451), "Phone No.: ______________", "")

WordObj.Selection.HomeKey wdStory, wdMove
If d!ClientID = 523 Then
   ' WordDoc.SaveAs EMailPath & "Statement of Debt with figures Ditech.doc"
   ' Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Statement of Debt with figures Ditech.doc")
Else
  '  WordDoc.SaveAs EMailPath & "Statement of Debt with figures.doc"
   ' Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Statement of Debt with figures.doc")
End If

'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_OrderGrantingRelief(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim FileNumber As Long, Judge As String, CoDebtor As Boolean, AffDate As String, AffInfo As String, Debtorsplural As Boolean

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRptBKorderGrantingReliefWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("OrderGrantingRelief")
Set WordDoc = WordObj.Documents.Open(EMailPath & "OrderGrantingRelief.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![CaseList.FileNumber])
WordDoc.Bookmarks("AttorneyInfo").Select
If d!ID = 6 Or d!ID = 7 Then   'need attorney VA bar# for these two districts. 12/5/16
    WordDoc.Bookmarks("AttorneyInfo").Range.Text = [Forms]![BankruptcyPrint]![cbxAttorney].Column(0) & vbCr & "VA Bar #: " & Nz(DLookup("VABar", "Staff", "ID =" & [Forms]![BankruptcyPrint]![cbxAttorney].Column(1)))
Else
WordDoc.Bookmarks("AttorneyInfo").Range.Text = ""                 '"Diane Rosenberg" & vbCr & "VA Bar 35237"
End If

    If [Forms]![BankruptcyPrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

Judge = Right$(UCase$(d!CaseNo), 3)
CoDebtor = (GetNames(0, 1, "BKCoDebtor=True") <> "" And d![Chapter] = 13)
If Not IsNull(d![3rdAff]) Then
    AffDate = Format$(d![3rdAff], "mmmm d, yyyy")
Else
    If Not IsNull(d![2ndAff]) Then
        AffDate = Format$(d![2ndAff], "mmmm d, yyyy")
    Else
        If Not IsNull(d![Affidavit]) Then
            AffDate = Format$(d![Affidavit], "mmmm d, yyyy")
        End If
    End If
End If
If AffDate = "" Then
    AffInfo = ""
Else
    AffInfo = "an Affidavit of Default having been sent on " & AffDate & ", no response or funds having been received, "
End If
Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (BKOwner=True OR BKMortgagor=True)") > 1)

FillField WordDoc, "Header", _
    IIf(d![Districts.State] <> "VA", vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr, "") & _
    "IN THE UNITED STATES BANKRUPTCY COURT" & vbCr & _
    "FOR THE " & UCase$(d!Name) & vbCr & _
    d!Location
FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")
FillField WordDoc, "InvestorAddr", UCase$(d!Investor) & vbCr & RemoveLF(d!InvestorAddress)
FillField WordDoc, "Respondents", _
    GetAddresses(0, 4, _
        IIf(d![Chapter] = 13, _
            "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
            "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"), vbCr) & _
    IIf(d![Chapter] = 7, _
        vbCr & vbCr & "and" & vbCr & vbCr & FormatName("", _
                                                        UCase$(Nz(d!First)), _
                                                        UCase$(Nz(d!Last)), _
                                                        ", CHAPTER 7 TRUSTEE", _
                                                        d![BKTrustees.Address], _
                                                        d!Address2, _
                                                        d![BKTrustees.City], _
                                                        d![BKTrustees.State], _
                                                        FormatZip(d!Zip), _
                                                        vbCr), _
        "")
FillField WordDoc, "capTrustee", IIf(d![Chapter] = 13 And (d!District = 6 Or d!District = 7), UCase([Forms]![BankruptcyDetails]![Trustee].Column(2)), "")
FillField WordDoc, "Tail", IIf(d![Chapter] = 13 And (d!District = 6 Or d!District = 7), vbTab & vbCr & "Trustee", "")
FillField WordDoc, "More", IIf(d![Chapter] = 13 And (d!District = 6 Or d!District = 7), "and" & vbCr, "")

FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![Chapter]
FillField WordDoc, "capTrustee", IIf(d![Chapter] = 13 And (d!District = 6 Or d!District = 7), [Forms]![BankruptcyDetails]![Trustee].Column(2), "")
FillField WordDoc, "Caption", IIf(Judge = "RGM" And d!RealEstate, _
    "ORDER TERMINATING AUTOMATIC STAY AS TO " & UCase$(Nz(d!PropertyAddress)), _
    "ORDER GRANTING RELIEF FROM AUTOMATIC STAY")
If Judge = "RGM" Then
    FillField WordDoc, "RGM", IIf(IsNull(d!modify), _
                                  "", _
                                  "a Consent Order having been entered on " & Format$(d!modify, "mmmm d, yyyy") & ", ") & _
                              AffInfo
Else
    FillField WordDoc, "RGM", ""
End If
If d![Districts.State] = "VA" Then
    FillField WordDoc, "OrderDate", ", it is this " & OrderDate()
    FillField WordDoc, "JudgeSignature", "________________________________" & vbCr & "United States Bankruptcy Judge"
    FillField WordDoc, "Submitted", "Respectfully Submitted:"
    If Forms!BankruptcyPrint!chElectronicSignature Then
        FillField WordDoc, "ElectronicSignature", "/s/ " & Forms!BankruptcyPrint!cbxAttorney
    Else
        FillField WordDoc, "ElectronicSignature", "_______________________________"
    End If
    FillField WordDoc, "AttorneySignature", Forms!BankruptcyPrint!cbxAttorney
    FillField WordDoc, "End", ""
Else
    FillField WordDoc, "OrderDate", ""
    FillField WordDoc, "JudgeSignature", ""
    FillField WordDoc, "Submitted", ""
    FillField WordDoc, "ElectronicSignature", ""
    FillField WordDoc, "AttorneySignature", ""
    FillField WordDoc, "End", "End of Order"
End If
FillField WordDoc, "DistrictName", d!Name
FillField WordDoc, "CoDebtor", IIf(CoDebtor, " and 1301", "")
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "Action", IIf(d!RealEstate, _
                                  "the foreclosure sale against the real property and improvements known as " & d!PropertyAddress & IIf(Len(Forms!BankruptcyDetails!sfrmPropAddr!Apt & "") = 0, "", ", " & Forms!BankruptcyDetails!sfrmPropAddr!Apt) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode]), _
                                  "repossession and sale of the " & d!PropertyDesc)
If Not d!RealEstate Then
    FillField WordDoc, "Rule4001", "ORDERED that the ten (10) day stay of Rule 4001(a)(3) be, and it is hereby, waived and the terms of this Order are immediately enforceable; and be it further" & vbCr & vbCr & vbTab
Else
    FillField WordDoc, "Rule4001", ""
End If
FillField WordDoc, "DebtorPossessive", "Debtor" & IIf(Debtorsplural, "'s", "s'")
FillField WordDoc, "Carrington", IIf(d![ClientID] = 73, "Be it further ordered that Carrington Mortgage Services LLC, is allowed to communicate " & _
    "with the borrowers once Relief from the Automatic Stay is Granted and that all communications sent by Secured Creditor in connection with proceeding " & _
    "against the property including, but not limited to, notices required by state law and communications to offer and provide information with regard to a " & _
    "potential Forbearance Agreement, Loan Modification, Refinance Agreement, Loss Mitigation Agreement, or other Loan Workout, may be sent directly to Debtors.", "")
FillField WordDoc, "CC1", Forms!BankruptcyPrint!cbxAttorney & vbCr & FirmAddress(vbCr) & vbCr & vbCr & BKService(0, vbCr)
FillField WordDoc, "CC2", FormatName("", _
                                    d!First, _
                                    d!Last & ", Trustee", _
                                    "", _
                                    d![BKTrustees.Address], _
                                    d!Address2, _
                                    d![BKTrustees.City], _
                                    d![BKTrustees.State], _
                                    d!Zip, _
                                    vbCr) & _
                            vbCr & vbCr & _
                            d!FirstName & " " & d!LastName & IIf(IsNull(d!LastName), "", ", Esquire") & _
                            IIf(IsNull(d!BKAttorneyFirm), _
                                "", _
                                vbCr & d!BKAttorneyFirm & vbCr & RemoveLF(d!BKAttorneyAddress))

FillField WordDoc, "DocFormat", IIf(d![DocumentFormat] = 1, "Local Rule 9022-1(C) Certification", "")
FillField WordDoc, "DocFormat2", IIf(d![DocumentFormat] = 1, "The foregoing order was endorsed by and/or served upon all necessary parties pusuant to Local Rule 9022-1(C).", "")
WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Order Granting Relief.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Order Granting Relief.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
Set d = Nothing

End Sub

Public Sub Doc_FinalOrderTerminating(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim FileNumber As Long, Judge As String, CoDebtor As Boolean, AffDate As String, AffInfo As String, Debtorsplural As Boolean

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBKdocsWordFinalOrderTerminating WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Final Order Terminating")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Final Order Terminating.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![CaseList.FileNumber])
WordDoc.Bookmarks("AttorneyInfo").Select
WordDoc.Bookmarks("AttorneyInfo").Range.Text = "Diane Rosenberg" & vbCr & "VA Bar 35237"

    If [Forms]![BankruptcyPrint]![cboOfficeLocation] = 2 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    

Judge = Right$(UCase$(d!CaseNo), 3)
CoDebtor = (GetNames(0, 1, "BKCoDebtor=True") <> "" And d![BKdetails.Chapter] = 13)
If Not IsNull(d![3rdAff]) Then
    AffDate = Format$(d![3rdAff], "mmmm d, yyyy")
Else
    If Not IsNull(d![2ndAff]) Then
        AffDate = Format$(d![2ndAff], "mmmm d, yyyy")
    Else
        If Not IsNull(d![Affidavit]) Then
            AffDate = Format$(d![Affidavit], "mmmm d, yyyy")
        End If
    End If
End If
If AffDate = "" Then
    AffInfo = ""
Else
    AffInfo = "an Affidavit of Default having been sent on " & AffDate & ", no response or funds having been received, "
End If
Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (BKOwner=True OR BKMortgagor=True)") > 1)

FillField WordDoc, "Header", _
    IIf(d![Districts.State] <> "VA", vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr, "") & _
    "IN THE UNITED STATES BANKRUPTCY COURT" & vbCr & _
    "FOR THE " & UCase$(d!Name) & vbCr & _
    d!Location
FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & "(s)" 'IIf(DebtorsPlural, "s", "")
FillField WordDoc, "InvestorAddr", UCase$(d!Investor) ' & vbCr & RemoveLF(D!InvestorAddress)

FillField WordDoc, "Respondents", UCase$(GetNames(0, 3, IIf(d![BKdetails.Chapter] = 13, "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"))) & IIf(d![BKdetails.Chapter] = 7, " AND " & UCase$(Nz(d![First])) & " " & UCase$(Nz(d![Last])) & ", CHAPTER 7 TRUSTEE", "") & ""

FillField WordDoc, "PropertyAddress", UCase$(d![PropertyAddress])
FillField WordDoc, "Modify", Format$(d![modify], "mmmm d"", ""yyyy")
FillField WordDoc, "Districts", d![Name]
FillField WordDoc, "section", IIf(GetNames(0, 1, "BKCoDebtor=True") <> "" And d![BKdetails.Chapter] = 13, "Sections 362(d) and 1301", "Section 362(d)")
FillField WordDoc, "section2", IIf(d![RealEstate], "commence foreclosure proceeding " & IIf(d![FCdetails.State] = "MD", "in the Circuit Court for " & d![Jurisdiction] & IIf(IsNull(d![LongState]), "", ", " & d![LongState]) & ", ", "") & "against the real property and improvements " & IIf(IsNull(d![ShortLegal]), "", "with a legal description of """ & d![ShortLegal] & """ also ") & "known as " & d![PropertyAddress] & ", " & IIf(IsNull(d![Fair Debt]), "", d![Fair Debt] & ", ") & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode]) & " and be it further " & _
 vbCr & vbCr & "        ORDERED that the successful purchasers, be and they are hereby allowed to obtain possession of the Subject Property pursuant to state law;", "proceed with repossession and sale of the " & d![PropertyDesc])
FillField WordDoc, "sign1", IIf(Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & Forms!BankruptcyPrint!cbxAttorney, "")
'FillField WordDoc, "sign2", Forms!BankruptcyPrint!cbxAttorney & " " & vbCr & FirmAddress() & vbCr & " VA Bar No. 35237 " & vbCr & FirmPhone()
If Not IsNull([Forms]![BankruptcyPrint]![cbxAttorney].Column(1)) Then
    FillField WordDoc, "sign2", Forms!BankruptcyPrint!cbxAttorney & " " & vbCr & FirmAddress() & vbCr & _
    IIf(IsNull(([Forms]![BankruptcyPrint]![cbxAttorney].Column(1))), "", FetchBarNumber([Forms]![BankruptcyPrint]![cbxAttorney].Column(1), [Forms]![BankruptcyDetails]![District].Column(4), "BK")) & vbCr & FirmPhone()
Else
    FillField WordDoc, "sign2", Forms!BankruptcyPrint!cbxAttorney & " " & vbCr & FirmAddress() & vbCr & ""
End If
FillField WordDoc, "Part2", FormatName("", d![First], d![Last], ", Trustee", d![Address], d![Address2], d![BKTrustees.City], d![BKTrustees.State], d![Zip])
FillField WordDoc, "cbxAttorney", Forms!BankruptcyPrint!cbxAttorney
FillField WordDoc, "Part3", IIf(IsNull(d![AttorneyLastName]), "", d![AttorneyFirstName] & " " & d![AttorneyLastName] & ", Esquire " & IIf(IsNull(d![AttorneyFirm]), "", d![AttorneyFirm] & "") & d![AttorneyAddress])
FillField WordDoc, "FirmAddress", FirmAddress()
FillField WordDoc, "BKService", BKService(d![CaseList.FileNumber], vbCr)

'FillField WordDoc, "Respondents", _
'    GetAddresses(0, 4, _
'        IIf(D![BKdetails.Chapter] = 13, _
'            "(BKDebtor=True OR BKCoDebtor=True) AND (Owner=True OR Mortgagor=True)", _
'            "BKDebtor=True AND (Owner=True OR Mortgagor=True)"), vbCr) & _
'    IIf(D![BKdetails.Chapter] = 7, _
'        vbCr & vbCr & "and" & vbCr & vbCr & FormatName("", _
'                                                        UCase$(Nz(D!First)), _
'                                                        UCase$(Nz(D!Last)), _
'                                                        ", CHAPTER 7 TRUSTEE", _
'                                                        D!Address, _
'                                                        D!Address2, _
'                                                        D![BKTrustees.City], _
'                                                        D![BKTrustees.State], _
'                                                        D!Zip, _
'                                                        vbCr), _
'        "")
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "Caption", IIf(Judge = "RGM" And d!RealEstate, _
    "ORDER TERMINATING AUTOMATIC STAY AS TO " & UCase$(Nz(d!PropertyAddress)), _
    "ORDER GRANTING RELIEF FROM AUTOMATIC STAY")
If Judge = "RGM" Then
    FillField WordDoc, "RGM", IIf(IsNull(d!modify), _
                                  "", _
                                  "a Consent Order having been entered on " & Format$(d!modify, "mmmm d, yyyy") & ", ") & _
                              AffInfo
Else
    FillField WordDoc, "RGM", ""
End If
If d![Districts.State] = "VA" Then
    FillField WordDoc, "OrderDate", ", it is this " & OrderDate()
    FillField WordDoc, "JudgeSignature", "________________________________" & vbCr & "United States Bankruptcy Judge"
    FillField WordDoc, "Submitted", "Respectfully Submitted:"
    If Forms!BankruptcyPrint!chElectronicSignature Then
        FillField WordDoc, "ElectronicSignature", "/s/ " & Forms!BankruptcyPrint!cbxAttorney
    Else
        FillField WordDoc, "ElectronicSignature", "_______________________________"
    End If
    FillField WordDoc, "AttorneySignature", Forms!BankruptcyPrint!cbxAttorney
    FillField WordDoc, "End", ""
Else
    FillField WordDoc, "OrderDate", ""
    FillField WordDoc, "JudgeSignature", ""
    FillField WordDoc, "Submitted", ""
    FillField WordDoc, "ElectronicSignature", ""
    FillField WordDoc, "AttorneySignature", ""
    FillField WordDoc, "End", "End of Order"
End If
FillField WordDoc, "DistrictName", d!Name
FillField WordDoc, "CoDebtor", IIf(CoDebtor, " and 1301", "")
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "Action", IIf(d!RealEstate, _
                                  "the foreclosure sale against the real property and improvements known as " & d!PropertyAddress & IIf(Len(Forms!BankruptcyDetails!sfrmPropAddr!Apt & "") = 0, "", ", " & Forms!BankruptcyDetails!sfrmPropAddr!Apt) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode]), _
                                  "repossession and sale of the " & d!PropertyDesc)
If Not d!RealEstate Then
    FillField WordDoc, "Rule4001", "ORDERED that the ten (10) day stay of Rule 4001(a)(3) be, and it is hereby, waived and the terms of this Order are immediately enforceable; and be it further" & vbCr & vbCr & vbTab
Else
    FillField WordDoc, "Rule4001", ""
End If
FillField WordDoc, "DebtorPossessive", "Debtor" & "(s)" ' IIf(DebtorsPlural, "'s", "s'")
FillField WordDoc, "CC1", Forms!BankruptcyPrint!cbxAttorney & vbCr & FirmAddress(vbCr) & vbCr & vbCr & BKService(0, vbCr)
FillField WordDoc, "CC2", FormatName("", _
                                    d!First, _
                                    d!Last & ", Trustee", _
                                    "", _
                                    d!Address, _
                                    d!Address2, _
                                    d![BKTrustees.City], _
                                    d![BKTrustees.State], _
                                    d!Zip, _
                                    vbCr) & _
                            vbCr & vbCr & _
                            d!FirstName & " " & d!LastName & IIf(IsNull(d!LastName), "", ", Esquire") & _
                            IIf(IsNull(d!BKAttorneyFirm), _
                                "", _
                                vbCr & d!BKAttorneyFirm & vbCr & RemoveLF(d!BKAttorneyAddress))

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Final Order Terminating.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Final Order Terminating.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
Set d = Nothing
End Sub

Public Sub Doc_ConsentModifying13(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim FileNumber As Long, Judge As String, CoDebtor As Boolean, AffDate As String, AffInfo As String, Debtorsplural As Boolean

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBKDocsWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("ConsentModifying13")
Set WordDoc = WordObj.Documents.Open(EMailPath & "ConsentModifying13.doc", False)
WordObj.Visible = True
WordObj.ScreenUpdating = False
WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("AttorneyInfo").Select
WordDoc.Bookmarks("AttorneyInfo").Range.Text = "Diane Rosenberg" & vbCr & "VA Bar 35237"

Judge = Right$(UCase$(d!CaseNo), 3)
CoDebtor = (GetNames(0, 1, "BKCoDebtor=True") <> "" And d![BKdetails.Chapter] = 13)


'If Not IsNull(d![3rdAff]) Then
'    AffDate = Format$(d![3rdAff], "mmmm d, yyyy")
'Else
'    If Not IsNull(d![2ndAff]) Then
'        AffDate = Format$(d![2ndAff], "mmmm d, yyyy")
'    Else
'        If Not IsNull(d![Affidavit]) Then
'            AffDate = Format$(d![Affidavit], "mmmm d, yyyy")
'        End If
'    End If
'End If
'If AffDate = "" Then
'    AffInfo = ""
'Else
'    AffInfo = "an Affidavit of Default having been sent on " & AffDate & ", no response or funds having been received, "
'End If
Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (Owner=True OR Mortgagor=True)") > 1)

FillField WordDoc, "Header", _
    IIf(d![Districts.State] <> "VA", vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr, "") & _
    "IN THE UNITED STATES BANKRUPTCY COURT" & vbCr & _
    "FOR THE " & UCase$(d!Name) & vbCr & _
    d!Location
FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")
FillField WordDoc, "InvestorAddr", UCase$(d!Investor) & vbCr & RemoveLF(d!InvestorAddress)
FillField WordDoc, "Respondents", _
    GetAddresses(0, 4, _
        IIf(d![BKdetails.Chapter] = 13, _
            "(BKDebtor=True OR BKCoDebtor=True) AND (Owner=True OR Mortgagor=True)", _
            "BKDebtor=True AND (Owner=True OR Mortgagor=True)"), vbCr) & _
    IIf(d![BKdetails.Chapter] = 7, _
        vbCr & vbCr & "and" & vbCr & vbCr & FormatName("", _
                                                        UCase$(Nz(d!First)), _
                                                        UCase$(Nz(d!Last)), _
                                                        ", CHAPTER 7 TRUSTEE", _
                                                        d!Address, _
                                                        d!Address2, _
                                                        d![BKTrustees.City], _
                                                        d![BKTrustees.State], _
                                                        d!Zip, _
                                                        vbCr), _
        "")
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]

FillField WordDoc, "Caption", IIf(d!Judge = "RGM" And d!RealEstate, "CONSENT ORDER  AS TO " & UCase$(d!PropertyAddress), "CONSENT ORDER MODIFYING AUTOMATIC STAY")

Select Case Forms![Print Consent Order Modifying]!optTrustee
    Case 1
        FillField WordDoc, "TrusteeAction", "the trustee having filed a report of no distribution, "
    Case 2
        FillField WordDoc, "TrusteeAction", "the trustee having failed to file an answer, "
End Select

FillField WordDoc, "ThisDate", IIf(d![Districts.State] <> "VA", "", ", it is this " & OrderDate())

FillField WordDoc, "District", d!districts.Name

FillField WordDoc, "CoDebtorSection", IIf(CoDebtor, " and 1301", "")

FillField WordDoc, "Action", IIf(d!RealEstate, "commence foreclosure proceeding " & IIf(d![FCdetails.State] = "MD", "in the Circuit Court for " & d!Jurisdiction & IIf(IsNull(d!LongState), "", ", " & d!LongState) & ", ", "") & "against the real property and improvements " & IIf(IsNull(d!ShortLegal), "", "with a legal description of """ & d!ShortLegal & """ also ") & "known as " & d!PropertyAddress & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode) & " and to allow the successful purchaser to obtain possession of same", "proceed with repossession and sale of the " & d!PropertyDesc)

FillField WordDoc, "OrderWording", IIf(d!Judge = "RGM", "ORDERED that the Debtor shall:", "ORDERED that the above Order be and it is hereby, stayed provided that the Debtor:")

FillField WordDoc, "ConsentPaymentAmount", Format$(d!ConsentPaymentAmount, "Currency")

FillField WordDoc, "PaymentType", IIf(d!RealEstate, "mortgage", "monthly")

FillField WordDoc, "ConsentPaymentDate", Format$(d!ConsentPaymentDate, "mmmm d, yyyy")

FillField WordDoc, "NoteType", IIf(d!RealEstate, "Promissory Note secured by the " & DOTWord(d!DOT) & " on the above referenced property", d!PropertyContract)

FillField WordDoc, "ConsentPaymentInfo", d!ConsentPaymentInfo

FillField WordDoc, "2A", IIf(IsNull(d!Consent2A), "", "^p2A. " & d!Consent2A)

FillField WordDoc, "AndAttorney", IIf(IsNull(d!AttorneyLastName), "", "and Debtor's attorney ")

FillField WordDoc, "RGM1", IIf(d!Judge = "RGM", "", ", without further order of court")

FillField WordDoc, "RGM2", IIf(d!Judge = "RGM", "^pIf any amount required in Paragraph 2 is not paid timely, Movant's attorney shall mail notice to the Debtor" & _
                        IIf(IsNull(d!AttorneyLastName), "", ", Debtor's attorney") & " and Chapter 13 Trustee, and shall file an Order of Termination of Automatic " & _
                        "Stay against the Subject Property described above; and be it further^p" & _
                        "ORDERED that a default in the payment of a regularly scheduled mortgage payment as listed in Paragraph 1 shall be governed by the attached addendum.", "")

If d![Districts.State] = "VA" Then
    FillField WordDoc, "JudgeSignature", "________________________________" & vbCr & "United States Bankruptcy Judge"
    FillField WordDoc, "Submitted", "Respectfully Submitted:"
    If Forms!BankruptcyPrint!chElectronicSignature Then
        FillField WordDoc, "ElectronicSignature", "/s/ Diane S. Rosenberg"
    Else
        FillField WordDoc, "ElectronicSignature", "_______________________________"
    End If
    FillField WordDoc, "AttorneySignature", "Diane S. Rosenberg"
    FillField WordDoc, "End", ""
Else
    FillField WordDoc, "OrderDate", ""
    FillField WordDoc, "JudgeSignature", ""
    FillField WordDoc, "Submitted", ""
    FillField WordDoc, "ElectronicSignature", ""
    FillField WordDoc, "AttorneySignature", ""
    FillField WordDoc, "End", "End of Order"
End If

WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
'WordDoc.SaveAs EMailPath & "Order Granting Relief.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Order Granting Relief.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub mik_test()
  Call Doc_ConsentModifyingReliefVA(True)
End Sub

Public Sub Doc_ConsentModifyingReliefVA(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim FileNumber As Long, Judge As String, CoDebtor As Boolean, CoDebtorName As String, AffDate As String, AffInfo As String, Debtorsplural As Boolean, SumRepaymentAmount As Currency, ParagraphNum As Integer, CourtCity As String, FillYear As String

FileNumber = Forms![case list]!FileNumber

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBKDocsWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("ConsentModifyingVA")
Set WordDoc = WordObj.Documents.Open(EMailPath & "ConsentModifyingVA.doc", False)
WordObj.Visible = True
'WordObj.ScreenUpdating = False
WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![CaseList.FileNumber])
WordDoc.Bookmarks("AttorneyInfo").Select
WordDoc.Bookmarks("AttorneyInfo").Range.Text = Forms!BankruptcyPrint!cbxAttorney & vbCr & "VA Bar " & DLookup("VABar", "Staff", "ID =" & Forms!BankruptcyPrint!cbxAttorney.Column(1))

'margin address:
    If Forms!BankruptcyPrint!![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf Forms!BankruptcyPrint![cboOfficeLocation] = 1 Or IsNull(Forms!BankruptcyPrint![cboOfficeLocation]) Then  'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf Forms!BankruptcyPrint![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

Judge = Right$(UCase$(d!CaseNo), 3)
CoDebtor = (GetNames(0, 1, "BKCoDebtor=True") <> "" And d![BKdetails.Chapter] = 13)


Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (BKOwner=True OR BKMortgagor=True)") > 1)

FillField WordDoc, "Header", _
    IIf(d![Districts.State] <> "VA", vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr, "") & _
    "IN THE UNITED STATES BANKRUPTCY COURT" & vbCr & _
    "FOR THE " & UCase$(d!Name) & vbCr & _
    d!Location
FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")
FillField WordDoc, "InvestorAddr", UCase$(d!Investor) & vbCr & RemoveLF(d!InvestorAddress)
FillField WordDoc, "Respondents", _
    GetAddresses(0, 4, _
        IIf(d![BKdetails.Chapter] = 13, _
            "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
            "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"), vbCr) & _
    IIf(d![BKdetails.Chapter] = 7, _
        vbCr & vbCr & "and" & vbCr & vbCr & FormatName("", _
                                                        UCase$(Nz(d!First)), _
                                                        UCase$(Nz(d!Last)), _
                                                        ", CHAPTER 7 TRUSTEE", _
                                                        d![BKTrustees.Address], _
                                                        d!Address2, _
                                                        d![BKTrustees.City], _
                                                        d![BKTrustees.State], _
                                                        d!Zip, _
                                                        vbCr), _
        "")
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]

FillField WordDoc, "Caption", "CONSENT ORDER MODIFYING AUTOMATIC STAY"
FillField WordDoc, "Hearing", IIf(IsNull(d![Hearing]), "____________", Format(d![Hearing], "mmmm d, yyyy"))
FillField WordDoc, "Investor", d![Investor]
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(Len(Forms!BankruptcyDetails!sfrmPropAddr!Apt & "") = 0, "", ", " & Forms!BankruptcyDetails!sfrmPropAddr!Apt) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "ShortLegalName", Nz(d![ShortLegal])

FillField WordDoc, "ConsentPayment", Format$(Nz(d![ConsentPaymentAmount], 0), "Currency")
FillField WordDoc, "ConsentPaymentDate", Format$(d![ConsentPaymentDate], "mmmm d, yyyy")
FillField WordDoc, "LatePaymentAmount", Format$(Nz(d![ConsentLateChargesAmount], 0), "Currency")

FillField WordDoc, "RepaymentTermsDetails", RepaymentItemList(FileNumber)
FillField WordDoc, "MakePaymentsTo", d![ConsentOrderPaymentTo]
FillField WordDoc, "CurrentDate", Format$(Date, "mmmm d, yyyy")
SumRepaymentAmount = Nz(DSum("[RepaymentAmount]", "[BKRepaymentTerms]", "[FileNumber] = " & FileNumber), 0)
FillField WordDoc, "TotalRepaymentAmount", Format$(SumRepaymentAmount, "Currency")

ParagraphNum = 7

If (CoDebtor = True) Then  ' Co-debtors exists
  ParagraphNum = ParagraphNum + 1
  CoDebtorName = GetNames(0, 1, "BKCoDebtor=True")
  FillField WordDoc, "List8Text", vbCr & ParagraphNum & ".           Relief is granted as to " & CoDebtorName & ", the co-debtor, from the automatic stay " & _
                                                    "imposed by 1301(a) to the same extent and on the same terms and conditions as granted as to the debtor."
End If


If (Judge = "FJS") Or (Trim(d![Last] = "Stackhouse, Jr.")) Then
  ParagraphNum = ParagraphNum + 1
  If (ParagraphNum = 9) Then
    FillField WordDoc, "List9Text", vbCr & ParagraphNum & ".            The source of funds to make the cure payment is: " & d![SourceofFundsCurePayments] & "."
  Else
    FillField WordDoc, "List8Text", ParagraphNum & ".            The source of funds to make the cure payment is: " & d![SourceofFundsCurePayments] & "."
  End If

End If

' blank out those fields that are not needed
If (ParagraphNum = 7) Then
  FillField WordDoc, "List8Text", ""
  FillField WordDoc, "List9Text", ""
ElseIf (ParagraphNum = 8) Then
  FillField WordDoc, "List9Text", ""
End If

CourtCity = Mid(d![Districts.Display], InStr(1, d![Districts.Display], "VA") + 3)
FillField WordDoc, "CourtCity", CourtCity
FillYear = "___________________, " & DatePart("yyyy", Date)

FillField WordDoc, "YearDate", FillYear

FillField WordDoc, "JudgeSignature", "________________________________" & vbCr & "United States Bankruptcy Judge"
    
FillField WordDoc, "ElectronicSignatureMovantCounsel", "/s/ " & Forms!BankruptcyPrint!cbxAttorney
FillField WordDoc, "MovantCounsel", Forms!BankruptcyPrint!cbxAttorney
FillField WordDoc, "DebtorCounsel", "_______________________________" & vbCr & Forms!BankruptcyDetails!AttorneyFirstName & " " & Forms!BankruptcyDetails!AttorneyFirstName & ", Esquire"
FillField WordDoc, "DebtorCounselName", Forms!BankruptcyDetails![AttorneyFirstName] & " " & Forms!BankruptcyDetails![AttorneyLastName] & ", Esquire"
FillField WordDoc, "Chapter13Trustee", "_______________________________" & vbCr & Trim(d![First] & " " & d![Last])
FillField WordDoc, "Chapter13TrusteeName", Trim(d![First] & " " & d![Last])
FillField WordDoc, "DebtorName", DebtorNames(0, 3, vbCr)

FillField WordDoc, "End", ""
WordObj.ScreenUpdating = True

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Order Modifying Relief.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Order Modifying Relief.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Function RepaymentItemList(FileNumber As Long) As String

Dim rstRepaymentTerms As Recordset
Dim i As Integer

i = 0
Set rstRepaymentTerms = CurrentDb.OpenRecordset("SELECT * FROM BKRepaymentTerms WHERE FileNumber=" & FileNumber & " ORDER BY RepaymentDate;", dbOpenSnapshot)
Do While Not rstRepaymentTerms.EOF
    i = i + 1
    RepaymentItemList = RepaymentItemList & Format$(rstRepaymentTerms!RepaymentAmount, "Currency") & " on or before " & Format$(rstRepaymentTerms!RepaymentDate, "mmmm d, yyyy") & vbCr
    rstRepaymentTerms.MoveNext
Loop

rstRepaymentTerms.Close

If (i = 0) Then
  RepaymentItemList = "No Repayment Terms indicated."
End If

End Function

Public Sub Doc_ConsentGrantRelief(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim FileNumber As Long, Judge As String, CoDebtor As Boolean, CoDebtorName As String, AffDate As String, AffInfo As String, Debtorsplural As Boolean, SumRepaymentAmount As Currency, ParagraphNum As Integer, CourtCity As String

FileNumber = Forms![case list]!FileNumber

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBKDocsWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Order Granting Relief VA")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Order Granting Relief VA.doc", False)
WordObj.Visible = True
WordObj.ScreenUpdating = False
WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![CaseList.FileNumber])
WordDoc.Bookmarks("AttorneyInfo").Select
WordDoc.Bookmarks("AttorneyInfo").Range.Text = Forms!BankruptcyPrint!cbxAttorney & vbCr & "VA Bar " & DLookup("VABar", "Staff", "ID =" & Forms!BankruptcyPrint!cbxAttorney.Column(1))

'margin address:
    If Forms!BankruptcyPrint!![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf Forms!BankruptcyPrint![cboOfficeLocation] = 1 Or IsNull(Forms!BankruptcyPrint![cboOfficeLocation]) Then  'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf Forms!BankruptcyPrint![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

Judge = Right$(UCase$(d!CaseNo), 3)
CoDebtor = (GetNames(0, 1, "BKCoDebtor=True") <> "" And d![BKdetails.Chapter] = 13)


Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (BKOwner=True OR BKMortgagor=True)") > 1)

FillField WordDoc, "Header", _
    IIf(d![Districts.State] <> "VA", vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr, "") & _
    "IN THE UNITED STATES BANKRUPTCY COURT" & vbCr & _
    "FOR THE " & UCase$(d!Name) & vbCr & _
    d!Location
FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")
FillField WordDoc, "InvestorAddr", UCase$(d!Investor) & vbCr & RemoveLF(d!InvestorAddress)
FillField WordDoc, "Respondents", _
    GetAddresses(0, 4, _
        IIf(d![BKdetails.Chapter] = 13, _
            "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
            "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"), vbCr) & _
    IIf(d![BKdetails.Chapter] = 7, _
        vbCr & vbCr & "and" & vbCr & vbCr & FormatName("", _
                                                        UCase$(Nz(d!First)), _
                                                        UCase$(Nz(d!Last)), _
                                                        ", CHAPTER 7 TRUSTEE", _
                                                        d![BKTrustees.Address], _
                                                        d!Address2, _
                                                        d![BKTrustees.City], _
                                                        d![BKTrustees.State], _
                                                        d!Zip, _
                                                        vbCr), _
        "")
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]

FillField WordDoc, "Caption", "ORDER GRANTING RELIEF FROM STAY"
FillField WordDoc, "Investor", d![Investor]
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(Len(Forms!BankruptcyDetails!sfrmPropAddr!Apt & "") = 0, "", ", " & Forms!BankruptcyDetails!sfrmPropAddr!Apt) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode)
FillField WordDoc, "ShortLegal", Nz(d![LegalDescription])

FillField WordDoc, "CurrentDate", Format$(Date, "mmmm d, yyyy")
FillField WordDoc, "CurrentDateDay", DatePart("d", Date)
FillField WordDoc, "CurrentDateMonthYear", Format$(Date, "mmmm, yyyy")

CourtCity = Mid(d![Districts.Display], InStr(1, d![Districts.Display], "VA") + 3)
FillField WordDoc, "CourtCity", CourtCity

FillField WordDoc, "Carrington", IIf(d![ClientID] = 73, "Be it further ordered that Carrington Mortgage Services LLC, is allowed to communicate " & _
    "with the borrowers once Relief from the Automatic Stay is Granted and that all communications sent by Secured Creditor in connection with proceeding " & _
    "against the property including, but not limited to, notices required by state law and communications to offer and provide information with regard to a " & _
    "potential Forbearance Agreement, Loan Modification, Refinance Agreement, Loss Mitigation Agreement, or other Loan Workout, may be sent directly to Debtors.", "")

FillField WordDoc, "JudgeSignature", "________________________________" & vbCr & "United States Bankruptcy Judge"
    
FillField WordDoc, "MovantCounsel", [Forms]![BankruptcyPrint]![cbxAttorney]
FillField WordDoc, "DebtorCounsel", d!BKAttorneyFirm & ", Esquire"
'If (d![BKdetails.Chapter] = 7) Then
'  FillField WordDoc, "Chapter7Trustee", Trim(UCase$(Nz(d!First)) & " " & UCase$(Nz(d!Last)))
'Else
'  FillField WordDoc, "Chapter7Trustee", ""
'End If
FillField WordDoc, "Chapter7Trustee", d![BKTrustees.Display]
FillField WordDoc, "DebtorName", UCase$(DebtorNames(0, 3, vbCr))

FillField WordDoc, "ElectronicSignature", IIf([Forms]![BankruptcyPrint]![chElectronicSignature], "/s/ " & [Forms]![BankruptcyPrint]![cbxAttorney], "")
FillField WordDoc, "AttorneySignature", [Forms]![BankruptcyPrint]![cbxAttorney]
FillField WordDoc, "CouncelName", [Forms]![BankruptcyDetails]![AttorneyFirstName] & " " & [Forms]![BankruptcyDetails]![AttorneyLastName] & ", Esq."
FillField WordDoc, "End", ""

WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
'WordDoc.SaveAs EMailPath & "Order Granting Relief.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Order Granting Relief.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_GreenTreeLossMitigation(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim FileNumber As Long, Judge As String, CoDebtor As Boolean, CoDebtorName As String, AffDate As String, AffInfo As String, Debtorsplural As Boolean, SumRepaymentAmount As Currency, ParagraphNum As Integer, CourtCity As String

FileNumber = Forms![case list]!FileNumber

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBKDocsWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("GreenTreeLossMitigationPackage")
Set WordDoc = WordObj.Documents.Open(EMailPath & "GreenTreeLossMitigationPackage.doc", False)
WordObj.Visible = True

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Green Tree Loss Mitigation.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Green Tree Loss Mitigation.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_MilitaryAffidavitNoSSN(KeepOpen As Boolean) 'Military Affidavit No SSN VA/DC
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim MName As String
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCdocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If (d![ClientID] = 451 And Trim(UCase$(d!Investor)) Like "LPP MORTGAGE*" And d![FCdetails.State] = "VA" And Forms!foreclosurePrint!txtDesignator <> 3) Then
  MName = "Military Affidavit - No SSN Dove"
ElseIf (d![FCdetails.State] = "VA") Then
  MName = "Military Affidavit - No SSN"
Else
  MName = "Military Affidavit - No SSNDC"
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(MName)
Set WordDoc = WordObj.Documents.Open(EMailPath & MName & ".doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth " & vbCr & "Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & " & vbCr & "Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & " & vbCr & "Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "MortgagorBorrowerNames", BorrowerMorgagorNamesOneNoSSN(d![CaseList.FileNumber], CopyNoR())
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "OriginalMortgagors", IIf(IsNull(d!OriginalMortgagors), "", "Original Mortgagors " & d!OriginalMortgagors)
FillField WordDoc, "LoanNumber", d!LoanNumber
'FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(3) = 3, IIf(Forms![Foreclosuredetails]!State = "DC", IIf(D![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), "Commonwealth Trustees, LLC"), IIf(D![AIF] = True, D![LongClientName] & " as Attorney in Fact for ", "")) & Forms![Case List]!Investor
'FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(3) = 3, IIf(Forms![Foreclosuredetails]!State = "DC", IIf(D![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), "Commonwealth Trustees, LLC"), IIf(D![AIF] = True, D![LongClientName] & " as Attorney in Fact for ", "")) & IIf(D!ClientID = 531, "M&T Bank as Servicer for " & D![Investor], D![Investor])
'FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(3) = 3, IIf(Forms![Foreclosuredetails]!State = "DC", IIf(D![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), "Commonwealth Trustees, LLC"), IIf(D![AIF] = True, D![LongClientName] & " as Attorney in Fact for ", "") & IIf(D!ClientID = 531, "M&T Bank as Servicer for " & D![Investor], D![Investor]))
'FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(3) = 3, IIf(Forms![ForeclosureDetails]!State = "DC", IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), "Commonwealth Trustees, LLC"), IIf((d!AIF = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for ", ""))) & IIf(d!ClientID = 531, "M&T Bank as Servicer for " & Forms![Case List]!Investor, Forms![Case List]!Investor)
'FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(3) = 3, IIf(Forms![ForeclosureDetails]!State = "DC", IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), "Commonwealth Trustees, LLC"), IIf((d!AIF = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for ", IIf(d!ClientID = 531, "M&T Bank as Servicer for " & Forms![Case List]!Investor, Forms![Case List]!Investor))))
FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(3) = 3, IIf(d![FCdetails.State] = "VA", "Commonwealth Trustees, LLC", IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee")), IIf((d!AIF = True And d!ClientID = 373), d!Investor & ", by BSI Financial Services as attorney in fact", IIf((d![AIF] = True And d![ClientID] = 523), d![Investor] & " by Green Tree Servicing LLC as servicer", IIf((d![AIF] = True And d![ClientID] = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf((d![AIF] = True And d![ClientID] = 605), d![LongClientName] & " as Servicer for " & d!Investor, IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for " & d!Investor, IIf(d![ClientID] = 531, "M&T Bank as Servicer for " & d![Investor], d![Investor]))))))) & ""

FillField WordDoc, "designatorDate", IIf([Forms]![foreclosurePrint]![txtDesignator] = 3, "Date: " & Format(Date, "mmmm d, yyyy"), "")

FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", IIf(Forms![ForeclosureDetails]!State = "DC", IIf(Split(ReportArgs, "|")(3) = 3, IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), (Split(ReportArgs, "|")(1))), (Split(ReportArgs, "|")(1)))

FillField WordDoc, "NotaryLocation", IIf(IsNull(d!NotaryLocation), "STATE OF______________" & vbCr & "COUNTY OF ____________ :", d!NotaryLocation)
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "only328client", IIf(d![ClientID] = 328, d![Investor] & " has been proven to be the real party in interest and has the right to foreclose the subject property.", "")

FillField WordDoc, "Barcode", IIf(d!ClientID = 451 Or d!ClientID = 634, "", AddDocPreIndex(d![CaseList.FileNumber], 152, ""))

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & MName
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], MName)
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub
Public Sub Doc_MilitaryAffidavitNoSSNMD(KeepOpen As Boolean) 'Military Affidavit NoSSN MD
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim fName As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")

If d!ClientID = 404 Then
    fName = "Military Affidavit - No SSNMD Bogman"
ElseIf (d![ClientID] = 451 And Trim(UCase$(d!Investor)) Like "LPP MORTGAGE*" And d![FCdetails.State] = "MD" And Forms!foreclosurePrint!txtDesignator <> 3) Then
    fName = "Military Affidavit - No SSNMD Dove"
Else
  fName = "MilitaryAffidavit-NoSSNMD" 'SA
  'Military Affidavit - No SSNMD
End If

Call OpenDocAsSaved(fName)
Set WordDoc = WordObj.Documents.Open(EMailPath & fName & ".doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth " & vbCr & "Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & " & vbCr & "Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & " & vbCr & "Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "Barcode", IIf(d!ClientID = 634 Or d!ClientID = 451, "", IIf(d!ClientID = 444 And d![FCdetails.State] = "MD", "", AddDocPreIndex(d![CaseList.FileNumber], 152, "")))
FillField WordDoc, "designatorDate", IIf([Forms]![foreclosurePrint]![txtDesignator] = 3, "Date: " & Format(Date, "mmmm d, yyyy") & vbCr & "info@rosenberg-assoc.com", "")
FillField WordDoc, "MortgagorBorrowerNames", BorrowerMorgagorNamesOneNoSSN(d![CaseList.FileNumber], CopyNoR())
FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(3) = 3, IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), IIf((d!AIF = True And d!ClientID = 373), d!Investor & ", by BSI Financial Services as attorney in fact", IIf((d![AIF] = True And d![ClientID] = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf((d![AIF] = True And d![ClientID] = 523), d![Investor] & " by Green Tree Servicing LLC as servicer", IIf((d![AIF] = True And d![ClientID] = 605), d![LongClientName] & " as Servicer for " & d![Investor], IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for " & d![Investor], IIf((d!ClientID = 328 And Forms!foreclosurePrint!txtDesignator = 3), "", IIf(d![ClientID] = 531, "M&T Bank as Servicer for " & [Forms]![case list]![Investor], " " & [Forms]![case list]![Investor]))))))))
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
'FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then
    FillField WordDoc, "FirmShortAddress", DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
    FillField WordDoc, "FirmShortAddress", DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then
        FillField WordDoc, "FirmShortAddress", DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                  DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID =2")
End If

FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", IIf(Split(ReportArgs, "|")(3) = 3, IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), (Split(ReportArgs, "|")(1)))
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID)
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "only328client", IIf((d!ClientID = 328 And Forms!foreclosurePrint!txtDesignator = 3), "", IIf(d![ClientID] = 328, d![Investor] & " has been proven to be the real party in interest and has the right to foreclose the subject property.", ""))
FillField WordDoc, "only328client2", IIf((d!ClientID = 328 And Forms!foreclosurePrint!txtDesignator = 3), "", IIf(d![ClientID] = 328, "Subscribed and affirmed before me in the county of Douglas, State of Colorado, this _____ day of ________, 20____ .", ""))
FillField WordDoc, "only328client3", IIf((d!ClientID = 328 And Forms!foreclosurePrint!txtDesignator = 3), "", IIf(d![ClientID] = 328, "____________________________", ""))
FillField WordDoc, "only328client4", IIf((d!ClientID = 328 And Forms!foreclosurePrint!txtDesignator = 3), "", IIf(d![ClientID] = 328, "(Notary's official Signature)", ""))
FillField WordDoc, "only328client5", IIf((d!ClientID = 328 And Forms!foreclosurePrint!txtDesignator = 3), "", IIf(d![ClientID] = 328, "____________________________", ""))
FillField WordDoc, "only328client6", IIf((d!ClientID = 328 And Forms!foreclosurePrint!txtDesignator = 3), "", IIf(d![ClientID] = 328, "(Commission Expiration)", ""))

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & Fname & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], Fname & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_LossMitigationPreliminaryNationStar(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Loss Mitigation Prelim Nation star")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Loss Mitigation Prelim Nation star.doc", False)
'Loss Mitigation - Preliminary-Nation-Star-MD.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: __________________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               __________________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: _________________________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Loss Mitigation - Preliminary-Nation-Star-MD.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Loss Mitigation - Preliminary-Nation-Star-MD.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_LossMitigationFinalNationStarMD(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If d![ClientID] = 385 And d![FCdetails.State] = "MD" Then
    Set WordObj = CreateObject("Word.Application")
    'Set WordDoc = WordObj.Documents.Open(EMailPath & "Loss Mitigation - Final-Nation-Star-MD.doc", False)   Mei 10-5-15
    Call OpenDocAsSaved("Loss Mitigation Final Nation Star")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Loss Mitigation Final Nation Star.doc", False)
    WordObj.Visible = True
End If

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

'margin address:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "client", d!LongClientName
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
'Mei 10-05_15
FillField WordDoc, "fillingdate", IIf(Not IsNull(d![Docket]), Format(d![Docket], "mm/d/yyyy"), "_____________________ ")
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 1484, "")
FillField WordDoc, "Investor", IIf(d![ClientID] = 385 And d![Investor] = d!LongClientName, "          Nationstar maintains records for the loan that is secured by the mortgage or deed of trust being foreclosed in this action. ", _
"          Nationstar services and maintains records on behalf of " & d![Investor] & ", the secured party to the mortgage or deed of trust being foreclosed in this action.")

FillField WordDoc, "Prior Servicer", IIf(Forms![Prior Servicer]!ChPrior, "           Before the servicing of this loan transferred to Nationstar, " & [Forms]![Prior Servicer]![TxtPriorServicer] & _
" (Prior Servicer) was the servicer for the loan and it maintained the loan servicing records.  When Nationstar began servicing this loan, Prior Servicer's records for the loan were integrated and boarded into Nationstar's systems," & _
" such that Prior Servicer's records, including the collateral file, payment histories, communication logs, default letters, information," & _
"and documents concerning the Loan are now integrated into Nationstar's business records.  Nationstar maintains quality control and " & _
"verification procedures as part of the boarding process to ensure the accuracy of the boarded records.  It is the regular business practice " & _
"of Nationstar to integrate prior servicers' records into Nationstar's business records and to rely upon those boarded records in providing " & _
"its loan servicing functions.  These Prior Servicer records have been integrated and are relied upon by Nationstar as part of Nationstar's " & _
"business records.", "")

FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ___________________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ___________________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: _________________________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Loss Mitigation - Final-Nation-Star-MD.doc"
'WordDoc.SaveAs EMailPath & "Loss Mitigation Final Nationstar.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Loss Mitigation Final Nationstar.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_LossMitigationFinalPNC(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Loss Mitigation - Final PNC")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Loss Mitigation - Final PNC.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

'margin office location:
    If (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "VA") Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "DC") _
                    Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "MD") Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "Docket", Nz(Format(d!Docket, "mm/d/yyyy"))
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ______________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Loss Mitigation - Final PNC.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Loss Mitigation - Final PNC.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_LossMitigationPrelimPNC(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Loss Mitigation - Prelim PNC")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Loss Mitigation - Prelim PNC.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

'margin office location:
    If (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "VA") Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "DC") _
                    Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "MD") Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "Docket", Nz(Format(d!Docket, "mm/d/yyyy"))
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ______________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Loss Mitigation - Prelim PNC.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Loss Mitigation - Prelim PNC.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_StatementOfDebtFiguresMDCDMT(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset, dd As Recordset      ' data
Dim i As Integer, itemcount As Integer, TotalItems As Currency, itemsFields As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String

templateName = "Statement of Debt Figures MDCDMT"

'If (D![ClientID] = 157) Then
  'TemplateName = TemplateName & " Cenlar"
'End If
templateName = templateName '& ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

WordObj.Visible = False
If MsgBox("Is There A Loan Mod? ", vbYesNo) = vbYes Then
FillField WordDoc, "Mod", ", MODIFIED by Agreement effective " & Format(InputBox(" Effective Date?   Format mm/dd/yyyy"), "mmmm d, yyyy") & " with an amended principal balance of " & Format(InputBox(" Amended Principal Balance? "), "Currency")
Else
FillField WordDoc, "Mod", ""
End If
WordObj.Visible = True

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", IIf(d![ClientID] = 456, d!Investor, "M&T Bank As Servicer for Maryland Department of Housing and Community Development, Community Development Administration")

If (d![FCdetails.State] = "VA") Then
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", IIf(IsNull(d![Folio2]), ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & _
    " at Instrument Number " & d![Liber2], ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " in Book " & d![Liber2] & ", Page " & d![Folio2]))
ElseIf d!JurisdictionID = 6 Then  'Calvert County
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Book " & d![Liber2] & ", Page " & d![Folio2])
Else 'MD or DC
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Liber " & d![Liber2] & ", Folio " & d![Folio2])
End If

FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", IIf(d!CaseTypeID = 8, d!MonitorTrusteeAddress, FirmShortAddress(vbCr))
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "Liber", LiberFolio(d![Liber], d![Folio], d![FCdetails.State], d![JurisdictionID])
FillField WordDoc, "LastPaymentApplied", Format$(d![LPIDate], "mmmm d, yyyy")
FillField WordDoc, "LastPayment", Format$(d![LPIDate] + 1, "mmmm d, yyyy")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "PaidStr", IIf((Nz(d![RemainingPBal], 0) > Nz(d![OriginalPBal], 0)), "Additional Interest", "Paid on principal")
FillField WordDoc, "Paid", Format$(d!OriginalPBal - d!RemainingPBal, "Currency")
FillField WordDoc, "RemainingPBal", Format$(d!RemainingPBal, "Currency")
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 223, "")
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ______________", "")

TotalItems = 0
itemsFields = ""
Set dd = CurrentDb.OpenRecordset("SELECT Desc, Amount FROM StatementOfDebt WHERE FileNumber=" & d![CaseList.FileNumber] & " ORDER BY Timestamp;", dbOpenSnapshot)
If dd.EOF Then      ' no extra lines
    FillField WordDoc, "Line_Items", ""
Else
    dd.MoveLast
    itemcount = dd.RecordCount
    ' Make enough lines
    For i = 1 To itemcount
        itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
    Next i
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
    FillField WordDoc, "Line_Items", itemsFields
    dd.MoveFirst
    i = 1
    Do While Not dd.EOF
        FillField WordDoc, "Item" & i, dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency")
        TotalItems = TotalItems + Nz(dd!Amount, 0)
        dd.MoveNext
        i = i + 1
    Loop
End If
dd.Close

FillField WordDoc, "BalDueDate", IIf(IsNull([Forms]![Print Statement of Debt]![txtDueDate]), "______________", Format$([Forms]![Print Statement of Debt]![txtDueDate], "mmmm d"", ""yyyy"))
FillField WordDoc, "BalanceDue", Format$(d!RemainingPBal + TotalItems, "Currency")
FillField WordDoc, "PerDiemInterest", IIf(d!LoanType = 3, "", IIf(IsNull(d!PerDiem), "$_____________", Format$(d!PerDiem, "Currency")))
FillField WordDoc, "Dime", IIf(d!LoanType = 3, "", "Per Diem Interest:")
FillField WordDoc, "InterestRate", IIf(IsNull(d!InterestRate), "____________ %", Format(d!InterestRate, "#0.000") & "%")
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", IIf(IsNull(d!NotaryLocation), "STATE OF ______________:" & vbCr & "COUNTY OF ____________ :", d!NotaryLocation)

WordObj.Selection.HomeKey wdStory, wdMove
If d!ClientID = 531 Then
  '  WordDoc.SaveAs EMailPath & "Statement of Debt with Figures MDCDMT.doc"
   ' Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Statement of Debt with Figures MDCDMT.doc")
Else
   ' WordDoc.SaveAs EMailPath & "Statement of Debt with Figures M&T.doc"
    'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Statement of Debt with Figures M&T.doc")
End If
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close


End Sub

Public Sub Doc_StatementOfDebtWithFiguresBOA(KeepOpen As Boolean)

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset, dd As Recordset      ' data
Dim i As Integer, itemcount As Integer, TotalItems As Currency, amountInterest As Currency, itemsFields As String, j As Integer
Dim K As Recordset
Dim Rresult As Long
Dim InterestFrom As String
Dim InterestTo As String

'Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![Case List]!FileNumber, dbOpenSnapshot)
Set d = CurrentDb.OpenRecordset("Select * FROM qryFCStmtofDebtBOAWord WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String
templateName = "Statement of Debt Figures BOA"

If (d![ClientID] = 157) Then
  templateName = templateName & " Cenlar"
End If
templateName = templateName '& ".doc"


Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProjectName").Select
WordDoc.Bookmarks("ProjectName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

WordObj.Visible = False
If IsNull(d!LoanMod) = False Then
    FillField WordDoc, "Mod", " and modified by Loan Modification Agreement executed on " & Format$(d![LoanMod], "mmmm d, yyyy") & " and recorded on " & Format$(d!LoanModRecorded, "mmmm d, yyyy") & IIf(IsNull(d![LiberLoanMod] = True), "", " in Liber " & _
    d![LiberLoanMod] & " at Folio " & d![FolioLoanMod])
Else
    FillField WordDoc, "Mod", ""
End If

InterestFrom = InputBox("Interest From")
InterestTo = InputBox("Interest To")

WordObj.Visible = True

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", d!Investor

FillField WordDoc, "owner", IIf(d![LoanType] = 4, "Federal National Mortgage Association is the owner", _
IIf(d![LoanType] = 5, "Federal Home Loan Mortgage Corporation is the owner", d![Investor] & " is the owner"))

FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", IIf(d!CaseTypeID = 8, d!MonitorTrusteeAddress, FirmShortAddress(vbCr))
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "Liber", LiberFolio(d![Liber], d![Folio], d![FCdetails.State], d![JurisdictionID])
FillField WordDoc, "namefcin", IIf(d![Investor] <> d![LongClientName], "who services the loan which is the subject of this proceeding", "as an officer of BANA")
FillField WordDoc, "LastPaymentApplied", Format$(d![DateOfDefault], "mmmm d, yyyy")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "PaidStr", IIf((Nz(d![RemainingPBal], 0) > Nz(d![OriginalPBal], 0)), "Additional Interest", "Paid on principal")
FillField WordDoc, "Paid", Format$(d!OriginalPBal - d!RemainingPBal, "Currency")
'FillField WordDoc, "PBalance", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "RemainingPBal", Format$(d!RemainingPBal, "Currency")
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 223, "")
FillField WordDoc, "DateAsOf", Forms![Print Statement of Debt]!txtDueDate
FillField WordDoc, "DateEffective", Forms![Print Statement of Debt]!txtDueDate + 1

FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Phone Number:", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "1-866-467-8090", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Address:", "")
FillField WordDoc, "AnneArundel4", IIf(d![JurisdictionID] = 3, "4200 Amon Carter Blvd", "")
FillField WordDoc, "AnneArundel5", IIf(d![JurisdictionID] = 3, "Fort Worth, Texas 76155", "")

FillField WordDoc, "DateBalance", IIf(IsNull(Forms![Print Statement of Debt]!txtDueDate), "______________", Format$(Forms![Print Statement of Debt]!txtDueDate, "mmmm d"", ""yyyy"))
FillField WordDoc, "RT", "asdfadsf"
FillField WordDoc, "ReRecorded", IIf(IsNull(d!Rerecorded), "", "re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " in Liber " & d![Liber2] & " at Folio " & d![Folio2] & ", ")

TotalItems = 0
amountInterest = 0
itemsFields = ""

'Set dd = CurrentDb.OpenRecordset("SELECT Desc, TempSortId, Amount FROM QryStatementOfDebtWithFigurersBOA WHERE FileNumber=" & d![CaseList.FileNumber] & " ORDER BY TempSortId DESC;", dbOpenSnapshot)
Set dd = CurrentDb.OpenRecordset("select * from statementofdebt where filenumber=" & d![CaseList.FileNumber] & " ORDER BY Sort_Desc ASC;", dbOpenDynaset, dbSeeChanges)
If dd.EOF Then      ' no extra lines
    FillField WordDoc, "Line_Items", ""
Else
    dd.MoveLast
    itemcount = dd.RecordCount
    
    ' Make enough lines
    For i = 1 To itemcount
        itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
    Next i
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
    FillField WordDoc, "Line_Items", itemsFields & " "
    
    dd.MoveFirst
    i = 1

     Do While Not dd.EOF
     '   FillField WordDoc, "Item" & i, IIf(dd!Desc = "Interest Due", "Interest Due from " & InterestFrom & " to " & InterestTo & _
     '   " @ " & IIf(Forms![Print Statement of Debt]!chVarRate = 0, Format(Forms![Print Statement of Debt]!InterestRate, "#.000%"), _
     '   " variable rate(s)"), dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency"))
        If dd!Desc = "Interest Due" Then
            FillField WordDoc, "Item" & i, "Interest Due from " & InterestFrom & " to " & InterestTo & " @ " & IIf(Forms![Print Statement of Debt]!chVarRate = 0, Format(Forms![Print Statement of Debt]!InterestRate, "#0.000") & "%", " variable rate(s)")
        ElseIf dd!Desc = "Escrow Balance Credit" Then
            FillField WordDoc, "Item" & i, dd!Desc & "                                            " & Format$(Nz(dd!Amount, 0), "Currency")
        ElseIf dd!Desc = "Payment Advance - Principal/Interest/Escrow" Then
            FillField WordDoc, "Item" & i, dd!Desc & "        " & Format$(Nz(dd!Amount, 0), "Currency")
        ElseIf dd!Desc = "Unapplied Funds Credit" Then
            FillField WordDoc, "Item" & i, dd!Desc & "                                           " & Format$(Nz(dd!Amount, 0), "Currency")
        ElseIf dd!Desc = "Credits" Then
            FillField WordDoc, "Item" & i, dd!Desc & vbTab & "                                           " & Format(DSum("[Amount]", "qryBOASOD", "[Credit] = True AND [FileNumber] =" & Forms![case list]!FileNumber & ""), "Currency")
        Else
            FillField WordDoc, "Item" & i, dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency")
        End If
        dd.MoveNext
        i = i + 1
    Loop
End If
    
 dd.Close
 
  Set K = CurrentDb.OpenRecordset("SELECT Desc, Amount FROM StatementOfDebt WHERE FileNumber=" & d![CaseList.FileNumber], dbOpenSnapshot)
  j = 1
  Do While Not K.EOF
   If K!Desc = "Interest Amount" Then
   amountInterest = amountInterest + Format$(Nz(K!Amount, 0), "Currency")
   End If
      
   TotalItems = TotalItems + Nz(K!Amount, 0)
   K.MoveNext
   j = j + 1
  Loop
  K.Close

FillField WordDoc, "BalDueDate", IIf(IsNull([Forms]![Print Statement of Debt]![txtDueDate]), "______________", Format$([Forms]![Print Statement of Debt]![txtDueDate], "mmmm d"", ""yyyy"))
FillField WordDoc, "BalanceDue", Format$(d!RemainingPBal + TotalItems, "Currency")
FillField WordDoc, "PerDiemInterest", IIf(IsNull(d!PerDiem), "$_____________", Format$(d!PerDiem, "Currency"))
FillField WordDoc, "InterestRate", IIf(IsNull(d!InterestRate), "____________ %", Format$(d!InterestRate, "#0.000") & "%")
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", IIf(IsNull(d!NotaryLocation), "STATE OF ______________:" & vbCr & "COUNTY OF ____________ :", d!NotaryLocation)
FillField WordDoc, "amountInterest$", Format$(amountInterest, "Currency")
FillField WordDoc, "jurisdiction", d!Jurisdiction
FillField WordDoc, "dotdate#", Format$(d![DOTdate], "mmmm d, yyyy")
FillField WordDoc, "liberT", d![Liber]
FillField WordDoc, "folioT", d![Folio]
FillField WordDoc, "lpidate", d!LPIDate
FillField WordDoc, "MortgagorNamesintext", MortgagorNamesIntext(0, 2, 0, 0, -1)
'FillField WordDoc, "lpidate#", D![LPIDate]
FillField WordDoc, "lastmonth", LastMonth(d![LPIDate])

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Statement of Debt Figures BOA.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Statement of Debt Figures BOA.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_OwnershipAffidavitBOA(KeepOpen As Boolean)

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Note Ownership Affidavit BOA")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Note Ownership Affidavit BOA.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "NoteOwner", FetchNoteOwner(d!LoanType, d!Investor, d![FCdetails.State])
FillField WordDoc, "namefcin", IIf(d![Investor] <> d![LongClientName], "who services the loan which is the subject of this proceeding", "as an officer of BANA")
FillField WordDoc, "Noteholders", GetNamesMD(0, 2, "Noteholder=True")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, d!LongClientName & " as Attorney in Fact for ", "") & d!Investor
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID)
FillField WordDoc, "FHLMCWording", IIf(d!LoanType = 5 Or d!LoanType = 4, ", and " & d!Investor & " is the holder of the Note having been transferred to " & d!Investor & " for the purposes of enforcement and conducting this foreclosure action", "")
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "jurisdiction", d!Jurisdiction
FillField WordDoc, "dotdate", Format(d![DOTdate], "mmmm d, yyyy")
FillField WordDoc, "FetchNoteOwnerT", FetchNoteOwner(d![LoanType], d![Investor], d![FCdetails.State])
FillField WordDoc, "CurrentT", IIf(d![LoanType] = 5, "", "current ")
FillField WordDoc, "Loantext", IIf(d![LoanType] = 1 Or d![LoanType] = 2 Or d![LoanType] = 3, "", "For purposes of foreclosure, the Note or other debt instrument is held by " & d![Investor] & ".")
FillField WordDoc, "Investor", d![Investor]

FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Phone Number:", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "1-866-467-8090", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Address:", "")
FillField WordDoc, "AnneArundel4", IIf(d![JurisdictionID] = 3, "4200 Amon Carter Blvd", "")
FillField WordDoc, "AnneArundel5", IIf(d![JurisdictionID] = 3, "Fort Worth, Texas 76155", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Note Ownership Affidavit BOA.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Note Ownership Affidavit BOA.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_OwnershipAffidavitOcwen(KeepOpen As Boolean)

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Note Ownership Affidavit Ocwen")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Note Ownership Affidavit Ocwen.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "NoteOwner", FetchNoteOwner(d!LoanType, d!Investor, d![FCdetails.State])
FillField WordDoc, "namefcin", IIf(d![Investor] <> d![LongClientName], "who services the loan which is the subject of this proceeding", "as an officer of BANA")
FillField WordDoc, "Noteholders", GetNamesMD(0, 2, "Noteholder=True")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, d!LongClientName & " as Attorney in Fact for ", "") & d!Investor
'FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
'FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID)
FillField WordDoc, "FHLMCWording", IIf(d!LoanType = 5 Or d!LoanType = 4, ", and " & d!Investor & " is the holder of the Note having been transferred to " & d!Investor & " for the purposes of enforcement and conducting this foreclosure action", "")
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "jurisdiction", d!Jurisdiction
FillField WordDoc, "dotdate", Format(d![DOTdate], "mmmm d, yyyy")
FillField WordDoc, "FetchNoteOwnerT", FetchNoteOwner(d![LoanType], d![Investor], d![FCdetails.State])
FillField WordDoc, "CurrentT", IIf(d![LoanType] = 5, "", "current ")
FillField WordDoc, "Loantext", IIf(d![LoanType] = 1 Or d![LoanType] = 2 Or d![LoanType] = 3, "", "For purposes of foreclosure, the Note or other debt instrument is held by " & d![Investor] & ".")
FillField WordDoc, "Investor", d![Investor]
FillField WordDoc, "Loaner", IIf(d!LoanType = 5, "I HEREBY CERTIFY that Federal Home Loan Mortgage Corp. (“FHLMC” is the owner of the debt instrument secured by the Mortgage or Deed of Trust which is the subject of the instant foreclosure action, and has authorized Ocwen Loan Servicing, LLC to be the noteholder for purposes of this foreclosure action.", _
"I HEREBY CERTIFY that " & d![Investor] & " is the owner of the debt instrument secured by the Mortgage or Deed of Trust which is the subject of the instant foreclosure action.")
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ______________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Note Ownership Affidavit Ocwen.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Note Ownership Affidavit Ocwen.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_BOACoverSheet(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Note Ownership Affidavit Cover letter BOA")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Note Ownership Affidavit Cover letter BOA.doc", False)
    WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

FillField WordDoc, "ClientLoanT", Forms!ForeclosureDetails!LoanNumber
FillField WordDoc, "MortgagorNameT", MortgagorNames(0, 3)
FillField WordDoc, "PropertyAddressT", Forms!ForeclosureDetails!PropertyAddress & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt]) & ", " & Forms!ForeclosureDetails!City & ", " & Forms!ForeclosureDetails!State & " " & FormatZip(Forms!ForeclosureDetails!ZipCode)

FillField WordDoc, "ContactNameT", IIf([Forms]![ForeclosureDetails]![State] = "VA", GetLoginName() & vbCrLf & vbCrLf & vbTab & vbTab & "Return the executed documents to:" _
& vbCrLf & vbTab & vbTab & "Rosenberg & Associates" & vbCrLf & vbTab & vbTab & "ATTN: Sale Setting Team" & vbCrLf & vbTab & vbTab & "8601 Westwood Center Dr, Suite 255" & vbCrLf & vbTab & vbTab & "Vienna, VA 22182", _
IIf([Forms]![foreclosurePrint]![chAssignment] = -1, GetLoginName() & vbCrLf & vbCrLf & vbTab & vbTab & "Return the executed Assignment to:" _
& vbCrLf & vbTab & vbTab & "Rosenberg & Associates" & vbCrLf & vbTab & vbTab & "ATTN: Assignments Department" & vbCrLf & vbTab & vbTab & "8601 Westwood Center Dr, Suite 255" & vbCrLf & vbTab & vbTab & "Vienna, VA 22182" _
, GetLoginName() & vbCrLf & vbCrLf & vbTab & vbTab & "Return the executed documents to:" & vbCrLf & vbTab & vbTab & "Rosenberg & Associates" & vbCrLf & vbTab & vbTab & "ATTN: Docketing Team" & vbCrLf _
& vbTab & vbTab & "4340 East West Highway, Suite 600" & vbCrLf & vbTab & vbTab & "Bethesda, MD 20814"))

FillField WordDoc, "DateofUpload", Format$(Now(), "mmmm d, yyyy")

FillField WordDoc, "Disclaimer2", IIf(Forms![case list]!State = "MD", trusteeNames(0, 2) & ", the substitute trustees listed, are employees of the attorney firm", "")
'FillField WordDoc, "Disclaimer", IIf(Not IsNull(Forms![Print Assignment]!cboBOANoteLocation), Forms![Print Assignment]!cboBOANoteLocation.Column(0), IIf(Forms!ForeclosureDetails!DocBackOrigNote = -1, "The firm is in possession of the original note", "The firm is NOT in possession of the original note"))

FillField WordDoc, "Disclaimer", IIf(Forms!ForeclosureDetails!DocBackOrigNote = -1, "The firm is in possession of the original note", "The firm is NOT in possession of the original note")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Note Ownership Affidavit Cover letter.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Note Ownership Affidavit Cover letter.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub DOC_VACorrectiveDeed(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("VA Corrective Deed")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "VA Corrective Deed.doc", False)
    WordObj.Visible = True
    
    'WordDoc.Bookmarks("Property").Select
    'WordDoc.Bookmarks("Property").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
    'WordDoc.Bookmarks("PropertyAdd").Select
    'WordDoc.Bookmarks("PropertyAdd").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
'    WordDoc.Bookmarks("File").Select      ' use this method for bookmarks in header/footer
'    WordDoc.Bookmarks("File").Range.Text = d![CaseList.FileNumber]
    WordDoc.Bookmarks("AssessedValue").Select
    WordDoc.Bookmarks("AssessedValue").Range.Text = Nz(Format(d!AssessedValue, "Currency"))
    WordDoc.Bookmarks("FileNumber").Select
    WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
'    WordDoc.Bookmarks("Atty").Select
'    WordDoc.Bookmarks("Atty").Range.Text = d!NameVA
    WordDoc.Bookmarks("VABar").Select
    WordDoc.Bookmarks("VABar").Range.Text = Nz(d!VABar)
    
    'margin address:
    If (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "VA") _
                    Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "DC") Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
      FillField WordDoc, "FileNumber", Nz(d![CaseList.FileNumber], "")
    FillField WordDoc, "TAXID", Nz(d!TaxID, "")
    FillField WordDoc, "MortgagorNames", MortgagorNamesCaps(d![CaseList.FileNumber], 2, 2)
    FillField WordDoc, "Purchasers", Nz(UCase(d!Purchaser), "")
    FillField WordDoc, "PurchaserAddress", OneLine(d!PurchaserAddress)
    'FillField WordDoc, "AssessedValue", Format(d!AssessedValue, "currency")
    FillField WordDoc, "DOTDATE", d!DOTdate
    FillField WordDoc, "LiberFolio", IIf((Not IsNull(d![Folio])), "Deed Book " & d![Liber] & ", Page " & d![Folio], "Instrument # " & d![Liber]) & _
        IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d"", ""yyyy") & " " & LiberFolio(d![Liber2], d![Folio2], d![JurisdictionList.State]))
    FillField WordDoc, "Jurisdiction", d!Jurisdiction
    FillField WordDoc, "OriginalTrustee", d!OriginalTrustee
    FillField WordDoc, "OriginalPBal", Format(d!OriginalPBal, "currency")
    FillField WordDoc, "OriginalBeneficiary", d!OriginalBeneficiary
    FillField WordDoc, "DeedAppRecorded", Format(d![DeedAppRecorded], "mmmm dd"", ""yyyy")
    FillField WordDoc, "DeedAppliberFolio", IIf((Not IsNull(d![DeedAppFolio])), "Deed Book " & d![DeedAppLiber] & ", Page " & d![DeedAppFolio], "Instrument # " & d![DeedAppLiber])
    FillField WordDoc, "SaleTime", Format(d!SaleTime, "Medium Time")
    FillField WordDoc, "Sale", Format(d![Sale], "mmmm dd"", ""yyyy")
    If Not IsNull(d!CourtAddress) Then
        FillField WordDoc, "CourtAddress", IIf(IsNull(d!CourtAddress), "", Replace(d!CourtAddress, vbCr, " "))
    Else
         FillField WordDoc, "CourtAddress", "____________________"
    End If
    FillField WordDoc, "SalePrice", Format(d![SalePrice], "Currency")
    FillField WordDoc, "RecordDeed", Format(d![RecordDeed], "mmmm dd"", ""yyyy")
    FillField WordDoc, "RecordLiberFolio", IIf((Not IsNull(d![RecordDeedFolio])), "Deed Book " & d![RecordDeedLiber] & ", Page " & d![RecordDeedFolio], "Instrument # " & d![RecordDeedLiber])
    'corrective reasons:
    FillField WordDoc, "CorrectiveReasons", "we are recording this Corrective and Confirmatory Substitute Trustees' Deed because " & IIf([Forms]![frmCorrectiveReasons]![Frame10].[Value] = 1, "the Consideration was erronrously cited as " & Format([Forms]![frmCorrectiveReasons]![txtAmt], "Currency"), _
        IIf([Forms]![frmCorrectiveReasons]![Frame10].[Value] = 2, "there was an error in the Legal Description", _
        IIf([Forms]![frmCorrectiveReasons]![Frame10].[Value] = 3, "a Scriveners error occurred", _
        IIf([Forms]![frmCorrectiveReasons]![Frame10].[Value] = 4, "the Grantee/Grantor was erroneously cited", _
        IIf([Forms]![frmCorrectiveReasons]![Frame10].[Value] = 5, "the Address of the Grantee was erroneously cited", _
        IIf([Forms]![frmCorrectiveReasons]![Frame10].[Value] = 6, [Forms]![frmCorrectiveReasons]![txtOther], "")))))) & ""
    FillField WordDoc, "LegalDescription", d!LegalDescription
    FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![LongState] & " " & FormatZip(d![ZipCode])
    FillField WordDoc, "AttorneyName", Nz(d!AttorneyName, "")
    FillField WordDoc, "vabar", Nz(d!VABar)
    FillField WordDoc, "state", d![FCdetails.State]
    FillField WordDoc, "StaffName", IIf(IsNull([Forms]![foreclosurePrint]![NotaryID]), " Public Notary ", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True))
    FillField WordDoc, "NotaryExpires", IIf(IsNull([Forms]![foreclosurePrint]![NotaryID]), "", Format(FetchNotaryExpiration(Forms!foreclosurePrint!NotaryID), "mmmm dd"", ""yyyy"))
    FillField WordDoc, "NotaryState", IIf(IsNull(d!NotaryState), "", UCase(d![NotaryState]))
    FillField WordDoc, "NotaryCounty", IIf(IsNull(d!NotaryCounty), "", UCase(d![NotaryCounty]))
    If (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation])) Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "return To", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then   'MD
        FillField WordDoc, "return To", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "return To", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "VA Corrective Deed.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "VA Corrective Deed.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
    
End Sub

Public Sub doc_MDCorrectiveDeed(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("MD corrective Deed")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "MD corrective Deed.doc", False)
    WordObj.Visible = True
      
'margin address:
    If (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "VA") _
                    Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "DC") Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "MD") Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
    WordDoc.Bookmarks("FileNumber").Select
    WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
'    WordDoc.Bookmarks("ProName").Select
'    WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
'    WordDoc.Bookmarks("PropertyAddress").Select
'    WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]

    FillField WordDoc, "trusteeNames", trusteeNames(0, 2)
    FillField WordDoc, "Purchaser", Nz(d!Purchaser, "")
    FillField WordDoc, "PurchaserAddress", OneLine(d!PurchaserAddress)
    FillField WordDoc, "MortgagorNames", MortgagorNames(d![CaseList.FileNumber], 2)
    FillField WordDoc, "DOTDATE", Format(d!DOTdate, "mmmm dd, yyyy")
    FillField WordDoc, "Liber", Nz(d![Liber], "")
    FillField WordDoc, "Folio", Nz(d![Folio], "")
    FillField WordDoc, "Jurisdiction", d!Jurisdiction
    FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
    FillField WordDoc, "OriginalTrustee", d!OriginalTrustee
    FillField WordDoc, "OriginalPBal", Format(d!OriginalPBal, "currency")
    FillField WordDoc, "OriginalBeneficiary", d!OriginalBeneficiary
    FillField WordDoc, "DeedAppRecorded", Format(d![DeedAppRecorded], "mmmm dd"", ""yyyy")
    FillField WordDoc, "SaleTime", Format(d!SaleTime, "Medium Time")
    FillField WordDoc, "Sale", Format(d![Sale], "mmmm dd"", ""yyyy")
    FillField WordDoc, "Newspaper", Nz(d!Newspaper)
    FillField WordDoc, "CourtAddress", Replace(d!CourtAddress, vbCr, " ")
    FillField WordDoc, "SaleRat", Format(d![SaleRat], "mmmm dd, yyyy")
    FillField WordDoc, "SalePrice", Format(d![SalePrice], "Currency")
    FillField WordDoc, "RecordDeed", Format(d![RecordDeed], "mmmm dd"", ""yyyy")
    FillField WordDoc, "RecordDeedFolio", Nz(d![RecordDeedFolio])
    FillField WordDoc, "RecordDeedLiber", Nz(d![RecordDeedLiber])
    FillField WordDoc, "TrusteeNames2", trusteeNames(d![CaseList.FileNumber], 3)
    FillField WordDoc, "FirmPhone", FirmPhone()
    'corrective reasons:
    FillField WordDoc, "CorrectiveReasons", IIf([Forms]![frmCorrectiveReasons]![Frame10].[Value] = 1, "because the consideration was erronrously cited as " & Format([Forms]![frmCorrectiveReasons]![txtAmt], "Currency"), _
        IIf([Forms]![frmCorrectiveReasons]![Frame10].[Value] = 2, "to correct an error in the Legal Description", _
        IIf([Forms]![frmCorrectiveReasons]![Frame10].[Value] = 3, "as a scriveners error occurred", _
        IIf([Forms]![frmCorrectiveReasons]![Frame10].[Value] = 4, "as the Grantee/Grantor was erroneously cited", _
        IIf([Forms]![frmCorrectiveReasons]![Frame10].[Value] = 5, "as the Address of the Grantee was erroneously cited", _
        IIf([Forms]![frmCorrectiveReasons]![Frame10].[Value] = 6, "because of " & [Forms]![frmCorrectiveReasons]![txtOther] & " reason", "")))))) & ""
    FillField WordDoc, "FeeSimple", IIf(d![Leasehold] = 0, "Fee Simple", "Leasehold")
    FillField WordDoc, "LegalDescription", d!LegalDescription
    FillField WordDoc, "StaffName", IIf(IsNull([Forms]![foreclosurePrint]![NotaryID]), " Public Notary ", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True))
    FillField WordDoc, "NotaryExpires", IIf(IsNull([Forms]![foreclosurePrint]![NotaryID]), "", Format(FetchNotaryExpiration(Forms!foreclosurePrint!NotaryID), "mmmm dd"", ""yyyy"))
    
    If Not IsNull([Forms]![foreclosurePrint]![NotaryID]) Then
        FillField WordDoc, "NotaryState", UCase(DLookup("NotaryState", "Staff", "ID=" & [Forms]![foreclosurePrint]![NotaryID]))
        FillField WordDoc, "NotaryCounty", UCase(DLookup("NotaryCounty", "Staff", "ID=" & [Forms]![foreclosurePrint]![NotaryID]))
    Else
        FillField WordDoc, "NotaryState", ""
        FillField WordDoc, "NotaryCounty", ""
    End If
       
    FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![LongState] & " " & FormatZip(d![ZipCode])
    FillField WordDoc, "AttorneyName", Nz(d!AttorneyName, "")
    FillField WordDoc, "TaxID", Nz(d!TaxID)
    
    If (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "VA") Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "ReturnAddress", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "MD") Then  'MD
        FillField WordDoc, "ReturnAddress", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "ReturnAddress", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "MD Corrective Deed.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "MD Corrective Deed.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_BOACoverSheetAssignment(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Note Ownership Affidavit Cover letter BOA")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Note Ownership Affidavit Cover letter BOA.doc", False)
    WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

FillField WordDoc, "ClientLoanT", Forms!ForeclosureDetails!LoanNumber
FillField WordDoc, "MortgagorNameT", MortgagorNames(0, 3)
FillField WordDoc, "PropertyAddressT", Forms!ForeclosureDetails!PropertyAddress & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt]) & ", " & Forms!ForeclosureDetails!City & ", " & Forms!ForeclosureDetails!State & " " & FormatZip(Forms!ForeclosureDetails!ZipCode)

FillField WordDoc, "ContactNameT", IIf([Forms]![ForeclosureDetails]![State] = "VA", GetLoginName() & vbCrLf & vbCrLf & vbTab & vbTab & "Return the executed documents to:" _
& vbCrLf & vbTab & vbTab & "Rosenberg & Associates" & vbCrLf & vbTab & vbTab & "ATTN: Sale Setting Team" & vbCrLf & vbTab & vbTab & "8601 Westwood Center Dr, Suite 255" & vbCrLf & vbTab & vbTab & "Vienna, VA 22182", _
IIf([Forms]![foreclosurePrint]![chAssignment] = -1, GetLoginName() & vbCrLf & vbCrLf & vbTab & vbTab & "Return the executed Assignment to:" _
& vbCrLf & vbTab & vbTab & "Rosenberg & Associates" & vbCrLf & vbTab & vbTab & "ATTN: Assignments Department" & vbCrLf & vbTab & vbTab & "8601 Westwood Center Dr, Suite 255" & vbCrLf & vbTab & vbTab & "Vienna, VA 22182" _
, GetLoginName() & vbCrLf & vbCrLf & vbTab & vbTab & "Return the executed documents to:" & vbCrLf & vbTab & vbTab & "Rosenberg & Associates" & vbCrLf & vbTab & vbTab & "ATTN: Docketing Team" & vbCrLf _
& vbTab & vbTab & "4340 East West Highway, Suite 600" & vbCrLf & vbTab & vbTab & "Bethesda, MD 20814"))

FillField WordDoc, "DateofUpload", Format$(Now(), "mmmm d, yyyy")

FillField WordDoc, "Disclaimer2", IIf(Forms![case list]!State = "MD", trusteeNames(0, 2) & ", the substitute trustees listed, are employees of the attorney firm", "")
FillField WordDoc, "Disclaimer", IIf(Not IsNull(Forms![Print Assignment]!cboBOANoteLocation), Forms![Print Assignment]!cboBOANoteLocation.Column(0), IIf(Forms!ForeclosureDetails!DocBackOrigNote = -1, "The firm is in possession of the original note", "The firm is NOT in possession of the original note"))

'FillField WordDoc, "Disclaimer", IIf(Forms!ForeclosureDetails!DocBackOrigNote = -1, "The firm is in possession of the original note", "The firm is NOT in possession of the original note")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Note Ownership Affidavit Cover letter.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Note Ownership Affidavit Cover letter.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_45DayNoteOwnershipAffidavitBOA(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Note Ownership Affidavit 45 days BOA")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Note Ownership Affidavit 45 days BOA.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "NoteOwner", FetchNoteOwner(d!LoanType, d!Investor, d![FCdetails.State])
FillField WordDoc, "Noteholders", GetNamesMD(0, 2, "Noteholder=True")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "DateOfDefault", Format$(d!DateOfDefault, "mmmm d, yyyy")
FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, d!LongClientName & " as Attorney in Fact for ", "") & d!Investor
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "namefcin", IIf(d![Investor] <> d![LongClientName], "who services the loan which is the subject of this proceeding", "as an officer of BANA")
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID)
FillField WordDoc, "FHLMCWording", IIf(d!LoanType = 5 Or d!LoanType = 4, ", and " & d!Investor & " is the holder of the Note having been transferred to " & d!Investor & " for the purposes of enforcement and conducting this foreclosure action", "")
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 592, "")
FillField WordDoc, "ifstatmd", IIf(d![FCdetails.State] = "MD", "________________  ", Format$(d![NOI], "mmmm d, yyyy"))
FillField WordDoc, "jurisdiction", d![Jurisdiction]

FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Phone Number:", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "1-866-467-8090", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Address:", "")
FillField WordDoc, "AnneArundel4", IIf(d![JurisdictionID] = 3, "4200 Amon Carter Blvd", "")
FillField WordDoc, "AnneArundel5", IIf(d![JurisdictionID] = 3, "Fort Worth, Texas 76155", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Note Ownership Affidavit 45 days BOA.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Note Ownership Affidavit 45 days BOA.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub DOC_LoanModOrder(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim FileNumber As Long

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBKdocsWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Loan Modification Order")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Loan Modification Order.doc", False)
WordObj.Visible = True
WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![CaseList.FileNumber])

'margin office location:
    If ([Forms]![BankruptcyPrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
FillField WordDoc, "Header", "FOR THE " & UCase$(d![Name])
FillField WordDoc, "District", Nz(d![Location])
FillField WordDoc, "Debtor", UCase$(DebtorNames(0, 3))
FillField WordDoc, "CaseNo", Nz(d!CaseNo)
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "Investor", UCase$(d![Investor])
FillField WordDoc, "DistrictsName", d![Name]
FillField WordDoc, "DistrictsLocation", d![Location]
FillField WordDoc, "Service", BKService([FileNumber])
FillField WordDoc, "TrusteeName", d![First] & " " & d![Last]
FillField WordDoc, "TrusteeAddress", d![BKTrustees.Address] & vbCr & d![BKTrustees.City] & ", " & d![BKTrustees.State] & " " & FormatZip(d!Zip)
FillField WordDoc, "AttorneyName", d![FirstName] & " " & d![LastName] & ", Esquire"
FillField WordDoc, "AttorneyFirm", Nz(d![AttorneyFirm])
FillField WordDoc, "AttorneyAddress", d![BKAttorneys.Address]         'd!BKAttorneyAddress
FillField WordDoc, "AttorneysAddress2", d![BKAttorneyStZip]

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Loan Modification Order" & d![CaseList.FileNumber] & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Loan Modification Order" & d![CaseList.FileNumber] & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub DOC_LoanModOrderVA(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, d2 As Recordset
Dim i As Integer
Dim FileNumber As Long

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBKdocsWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Loan Modification Order VA")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Loan Modification Order VA.doc", False)
WordObj.Visible = True
WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![CaseList.FileNumber])

'margin office location:
    If ([Forms]![BankruptcyPrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
FillField WordDoc, "Header", "FOR THE " & UCase$(d![Name])
FillField WordDoc, "District", Nz(d![Location])
FillField WordDoc, "Debtor", UCase$(DebtorNames(0, 3))
FillField WordDoc, "CaseNo", Nz(d!CaseNo)
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "Investor", UCase$(d![Investor])
FillField WordDoc, "DistrictsName", d![Name]
FillField WordDoc, "DistrictsLocation", d![Location]
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "LegalDescription", d!LegalDescription

Dim itemTags As String
Set d2 = CurrentDb.OpenRecordset("SELECT DISTINCTROW ID, FileNumber, Indicator, Detail FROM BKSecuredPaymentDetails where FileNumber = " & FileNumber, dbOpenSnapshot)

If Not d2.EOF Then
    d2.MoveLast
    For i = 1 To d2.RecordCount
        itemTags = itemTags & "<<item" & i & ">>" & vbCr
    Next
    itemTags = Left$(itemTags, Len(itemTags) - 1)
    
    FillField WordDoc, "IndicAndDetails", itemTags

      d2.MoveFirst
      i = 1
    Do While Not d2.EOF
        FillField WordDoc, "item" & i, Nz(d2!Indicator, "") & vbTab & d2!Detail
        d2.MoveNext
        i = i + 1
    Loop
End If
d2.Close

FillField WordDoc, "ElectronicSignature", IIf(Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & Forms!BankruptcyPrint!cbxAttorney, "")
FillField WordDoc, "AttorneySignature", [Forms]![BankruptcyPrint]![cbxAttorney]
FillField WordDoc, "AttorneyName", d![FirstName] & " " & d![LastName] & ", Esquire"
FillField WordDoc, "Attorney", [Forms]![BankruptcyPrint]![cbxAttorney]
FillField WordDoc, "FirmAddress", FirmShortAddress()
FillField WordDoc, "FirmPhone", FirmPhone()
FillField WordDoc, "TrusteeName", d![First] & " " & d![Last]
FillField WordDoc, "TrusteeAddress", d![BKTrustees.Address] & vbCr & d![BKTrustees.City] & ", " & d![BKTrustees.State] & " " & FormatZip(d!Zip)
FillField WordDoc, "AttorneyName", d![FirstName] & " " & d![LastName] & ", Esquire"
FillField WordDoc, "AttorneyFirm", Nz(d![AttorneyFirm])
FillField WordDoc, "AttorneyAddress", d![BKAttorneys.Address] & vbCr & d![BKAttorneyStZip]
FillField WordDoc, "BKService", BKService([FileNumber])

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Loan Modification Order VA" & d![CaseList.FileNumber] & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Loan Modification Order VA" & d![CaseList.FileNumber] & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub DOC_MotionforLoanModification(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, d2, d3 As Recordset
Dim FileNumber As Long, Debtorsplural As Boolean
Dim i As Integer, itemcount As Integer, TotalItems As Currency, itemsFields As String

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBKdocsWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)
Set d2 = CurrentDb.OpenRecordset("SELECT DISTINCTROW ID, FileNumber, PaymentAmount, PaymentDate, InterestRate FROM BKSecuredPaymentTerms where FileNumber = " & FileNumber, dbOpenSnapshot)
Set d3 = CurrentDb.OpenRecordset("SELECT DISTINCTROW ID, FileNumber, Indicator, Detail FROM BKSecuredPaymentDetails where FileNumber = " & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Motion for Loan Modification")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Motion for Loan Modification.doc", False)
WordObj.Visible = True
'WordObj.ScreenUpdating = False
WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![CaseList.FileNumber])

'margin office location:
    If ([Forms]![BankruptcyPrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "Header", IIf(d![Districts.State] <> "VA", "", "") & " FOR THE " & UCase$(d![Name])
FillField WordDoc, "District", Nz(d![Location])
FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3))
FillField WordDoc, "CaseNo", Nz(d!CaseNo)
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "Investor", UCase$(d![Investor])
FillField WordDoc, "Respondents", GetNames(0, 3, "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)")
FillField WordDoc, "chpt7", IIf(d![BKdetails.Chapter] = 7, vbCr & "and" & vbCr & vbCr & UCase$(Nz(d![First])) & " " & UCase$(Nz(d![Last])) & ", CHAPTER 7 TRUSTEE", "")
FillField WordDoc, "Investor2", d![Investor]
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "LegalDescription", d!LegalDescription
FillField WordDoc, "SecuredClaimAmt", Nz(Format(d![SecuredClaimAmt], "Currency"))
FillField WordDoc, "TrusteeName", d![First] & " " & d![Last]
FillField WordDoc, "TrusteeAddress", d!Address & vbCr & d![BKTrustees.City] & ", " & d![BKTrustees.State] & " " & FormatZip(d!Zip)
Dim itemTags As String

If Not d2.EOF Then
    d2.MoveLast
    For i = 1 To d2.RecordCount
      itemTags = itemTags & "<<item" & i & ">>" & vbCr
    Next i
    itemTags = Left$(itemTags, Len(itemTags) - 1) ' remove trailing CR
        
    FillField WordDoc, "PaymentAmt", itemTags

    d2.MoveFirst
     i = 1
     Do While Not d2.EOF
        FillField WordDoc, "item" & i, Format(d2!PaymentAmount, "currency") & " plus escrow beginning " & Format(d2![PaymentDate], "Medium Date") & _
            " at an interest rate of " & Format(d2![InterestRate], "0.000%")
        d2.MoveNext
        i = i + 1
     Loop
         
End If
d2.Close

itemTags = ""
If Not d3.EOF Then
    d3.MoveLast
    For i = 1 To d3.RecordCount
        itemTags = itemTags & "<<item" & i & ">>" & vbCr
    Next
    itemTags = Left(itemTags, Len(itemTags) - 1)
     
    FillField WordDoc, "IndicAndDetails", itemTags
    
    d3.MoveFirst
    i = 1
    Do While Not d3.EOF
        FillField WordDoc, "item" & i, Nz(d3!Indicator, "") & vbTab & d3!Detail
        d3.MoveNext
        i = i + 1
    Loop
End If
d3.Close

FillField WordDoc, "SecuredClaimAffTerms", IIf(d![SecuredClaimAffTerms] = -1, "X", "__")
FillField WordDoc, "SecuredClaimAffTermsNo", IIf(d![SecuredClaimAffTerms] = 0, "X", "__")
FillField WordDoc, "date", MonthName(Month(Now())) & " " & Format(Date, "dd"", ""yyyy")
FillField WordDoc, "ElectronicSignature", IIf(Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & Forms!BankruptcyPrint!cbxAttorney, "")
FillField WordDoc, "AttorneySignature", [Forms]![BankruptcyPrint]![cbxAttorney]
FillField WordDoc, "BarNo", IIf(IsNull([Forms]![BankruptcyPrint]![cbxAttorney].Column(1)), "", FetchBarNumber([Forms]![BankruptcyPrint]![cbxAttorney].Column(1), [Forms]![BankruptcyDetails]![District].Column(4), "BK"))
FillField WordDoc, "firmAddress", FirmShortAddress()
FillField WordDoc, "MDNOTICE", IIf(Forms!BankruptcyDetails!District.Column(4) = "VA", "", "NOTICE OF OPPORTUNITY TO REQUEST A HEARING TO CREDITORS AND PARTIES IN INTEREST")
FillField WordDoc, "MDNoticeDetails", IIf(Forms!BankruptcyDetails!District.Column(4) = "VA", "", "          You are notified of the filing of the foregoing Motion requesting Court authority to modify the terms of an existing secured loan for real property. " & _
    "Any interested party objecting to the loan modification must file an objection with the United States Bankruptcy Court for the " & _
    IIf(Forms!BankruptcyDetails!District.Column(4) = "MD", "District of Maryland ", "District of Columbia ") & "within twenty-one (21) days after the date of this motion. " & _
    "You are further notified that unless an objection is filed, the Court may grant the motion without a hearing.")
FillField WordDoc, "BKService", BKService(FileNumber)
FillField WordDoc, "Date2", ThisDate(Date)
FillField WordDoc, "TrusteeName", d![First] & " " & d![Last]
FillField WordDoc, "TrusteeAdd", d!Address & vbCr & d![BKTrustees.City] & ", " & d![BKTrustees.State] & " " & FormatZip(d!Zip)
FillField WordDoc, "AttorneyName", d![FirstName] & " " & d![LastName] & ", Esquire"
FillField WordDoc, "AttorneyFirmName", Nz(d![AttorneyFirm])
FillField WordDoc, "AttAddr", d!BKAttorneyAddress

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Motion for Loan Modification" & d![CaseList.FileNumber] & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Motion for Loan Modification" & d![CaseList.FileNumber] & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_StatementOfDebtWithFiguresJP(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset, dd As Recordset      ' data
Dim i As Integer, itemcount As Integer, TotalItems As Currency, amountInterest As Currency, itemsFields As String, j As Integer
Dim K As Recordset
Dim Rresult As Long

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String
templateName = "Statement of Debt Figures JP"

'If (D![ClientID] = 157) Then
'  TemplateName = TemplateName & " Cenlar"
'End If
templateName = templateName '& ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

'margin office location:
    If (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "VA") Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "DC") _
                    Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "MD") Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "owner", IIf(d![LoanType] = 4, "holder", IIf(d![LoanType] = 5, "holder", "owner"))
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", IIf(d!CaseTypeID = 8, d!MonitorTrusteeAddress, FirmShortAddress(vbCr))
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ","
FillField WordDoc, "dotdate", Nz(d!DOTdate)
FillField WordDoc, "LPIDate", Nz(d!LPIDate)
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "BorrowerNames", BorrowerNames(0)
'FillField WordDoc, "Item2", IIf(Forms!ForeclosureDetails!LienPosition <> 1, "The Note and Mortgage, (and modification agreement where applicable) are collectively referred to as the " & Chr(34) & "Loan Documents." & Chr(34), "")
'FillField WordDoc, "Item5", IIf(Forms!ForeclosureDetails!LienPosition <> 1, "5.  As of " & " __________ (unless specified otherwise below), Plaintiff seeks to recover the following itemized sums of money that are due and owing under the Loan Documents, exclusive of attorney's fees and costs in this action:", "5. The Borrower owes, as of " & " __________ " & "," & " following itemized sums of money, exclusive of costs and expenses that the borrower owes: ")
'FillField WordDoc, "Liber", LiberFolio(D![Liber], D![Folio], D![FCdetails.State], D![JurisdictionID])
'FillField WordDoc, "LastPaymentApplied", Format$(D![DateOfDefault], "mmmm d, yyyy")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
'FillField WordDoc, "PaidStr", IIf((Nz(D![RemainingPBal], 0) > Nz(D![OriginalPBal], 0)), "Additional Interest", "Paid on principal")
'FillField WordDoc, "Paid", Format$(D!OriginalPBal - D!RemainingPBal, "Currency")
FillField WordDoc, "RemainingPBal", Format$(d!RemainingPBal, "Currency")
'FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 223, "")
'FillField WordDoc, "DateAsOf", Forms![Print Statement of Debt]!txtDueDate
'FillField WordDoc, "DateEffective", Forms![Print Statement of Debt]!txtDueDate + 1
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ______________________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ______________________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ____________________________", "")

'FillField WordDoc, "DateBalance", IIf(IsNull(Forms![Print Statement of Debt]!txtDueDate), "______________", Format$(Forms![Print Statement of Debt]!txtDueDate, "mmmm d"", ""yyyy"))

TotalItems = 0
amountInterest = 0
itemsFields = ""
Set dd = CurrentDb.OpenRecordset("SELECT Desc,  Sort_Desc, Amount FROM StatementOfDebt WHERE FileNumber=" & d![CaseList.FileNumber], dbOpenSnapshot)
If dd.EOF Then      ' no extra lines
    FillField WordDoc, "Line_Items", ""
Else

    dd.MoveFirst
    i = 1
    Do While Not dd.EOF
        FillField WordDoc, "Item" & i, IIf(dd!Sort_Desc = 1, "", IIf(dd!Desc = "Escrow", "", IIf(dd!Amount <> 0, Format(dd!Amount, "Currency"), "$___________")))
        'TotalItems = TotalItems + Nz(dd!Amount, 0)
        dd.MoveNext
        i = i + 1
    Loop
End If
 dd.Close
 
  Set K = CurrentDb.OpenRecordset("SELECT Desc, Amount FROM StatementOfDebt WHERE FileNumber=" & d![CaseList.FileNumber], dbOpenSnapshot)
  j = 1
  Do While Not K.EOF
   If K!Desc = "Interest" Then
   amountInterest = amountInterest + Format$(Nz(K!Amount, 0), "Currency")
   End If
      
   TotalItems = TotalItems + Nz(K!Amount, 0)
   K.MoveNext
   j = j + 1
  Loop
  K.Close

FillField WordDoc, "BalanceDue", Format$(d!RemainingPBal + TotalItems, "Currency")
FillField WordDoc, "PerDiemInterest", IIf(IsNull(d!PerDiem), "$_____________", Format$(d!PerDiem, "Currency"))
'FillField WordDoc, "InterestRate", IIf(IsNull(D!InterestRate), "____________ %", Format$(D!InterestRate, "#.000%"))
'FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
'FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
'FillField WordDoc, "NotaryLocation", IIf(IsNull(D!NotaryLocation), "STATE OF ______________:" & vbCr & "COUNTY OF ____________ :", D!NotaryLocation)
FillField WordDoc, "amountInterest$", Format$(amountInterest, "Currency")
FillField WordDoc, "jurisdiction", d!Jurisdiction
FillField WordDoc, "dotdate#", d![DOTdate]
'FillField WordDoc, "liberT", D![Liber]
'FillField WordDoc, "folioT", D![Folio]
FillField WordDoc, "lpidate", d!LPIDate
FillField WordDoc, "LPIdate+1", DateAdd("d", 1, d![LPIDate])
FillField WordDoc, "MortgagorNamesintext", MortgagorNamesIntext(0, 2, 0, 0, -1)
'FillField WordDoc, "lpidate#", D![LPIDate]
FillField WordDoc, "lastmonth", LastMonth(d![LPIDate])

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Statement of Debt Figures JP.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Statement of Debt Figures JP.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_DeedOfAppointmentChase(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String

'TemplateName = "Deed of Appointment Chase MD"
If (d![FCdetails.State] = "MD") Then
 templateName = "Deed of Appointment Chase MD"
Else
templateName = "Deed of Appointment Chase VA"
End If
'End If
'If D![ClientID] = 345 Then
'  TemplateName = TemplateName & " Kondaur"
'ElseIf (D![ClientID] = 334 Or D![ClientID] = 477) Then
'  TemplateName = TemplateName & " Saxon"
'ElseIf D![ClientID] = 87 Then
'  TemplateName = TemplateName & " PNC"
'
'End If

'templateName = templateName & ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

If d![FCdetails.State] = "MD" Then
    'Do nothing'
    'Ticket 823 only provide FileNumber in Margin
    WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
    WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
Else
    WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
    WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
    WordDoc.Bookmarks("ProName").Select
    WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
    WordDoc.Bookmarks("PropertyAddress").Select
    WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
    WordDoc.Bookmarks("APTNUM").Select
    WordDoc.Bookmarks("APTNUM").Range.Text = Nz(d![Fair Debt])
End If

'office locations:
    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Or (d![FCdetails.State] = "VA" And IsNull([Forms]![foreclosurePrint]![cboOfficeLocation])) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (d![FCdetails.State] = "MD" And IsNull([Forms]![foreclosurePrint]![cboOfficeLocation])) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

If (d![FCdetails.State] = "VA") Then
    FillField WordDoc, "reRecorded", IIf(IsNull(d![Rerecorded]), "", IIf(IsNull(d![Folio2]), ", and re-recorded " & Format$(d![Rerecorded], "mmmm d, yyyy") & _
    " in Instrument Number " & d![Liber2] & ", ", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " in Book " & d![Liber2] & ", at Page " & d![Folio2] & ", "))
Else 'MD or DC
    FillField WordDoc, "reRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " in Deed/Book " & d![Liber2] & ", page " & d![Folio2] & ",")
End If

FillField WordDoc, "firmAddr", FirmShortAddressOneLine()
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "TrusteeNames", trusteeNames(0, 2)
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "MortgagorNames", IIf(IsNull(d!OriginalMortgagors), MortgagorNamesCaps(0, 2, 2), d!OriginalMortgagors)
'FillField WordDoc, "AssumedBy", IIf(IsNull(D!OriginalMortgagors), "", "assumed by " & MortgagorNamesCaps(0, 2, 2)) & " "
FillField WordDoc, "Jurisdiction", d!Jurisdiction
'FillField WordDoc, "LongState", Nz(D!LongState)
FillField WordDoc, "Liber", d!Liber
FillField WordDoc, "Filio", IIf(IsNull(d!Folio), "", d!Folio)
'FillField WordDoc, "LegalDescription", D!LegalDescription
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "TaxID", Nz(d!TaxID)
FillField WordDoc, "OriginalTrustee", d!OriginalTrustee
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "OriginalBeneficiary", d!OriginalBeneficiary
FillField WordDoc, "Book", IIf(IsNull(d!Folio), _
" in Book  N/A , at Page N/A or Instrument/Recording" & IIf(d![FCdetails.State] = "MD", " No.", " Number ") _
& d!Liber, " in Book " & d!Liber & ", at Page " & d!Folio & " or Instrument/Recording" & IIf(d![FCdetails.State] = "MD", " No. N/A", " Number N/A"))
FillField WordDoc, "DoTrecorded", Format$(d!DOTrecorded, "mmmm d"", ""yyyy")
'FillField WordDoc, "MDInstrPrepared", IIf(D![FCdetails.State] = "VA", "", "This instrument was prepared under the supervision of " & D!AttorneyName & ", an attorney admitted to practice before the Court of Appeals of Maryland.")
'FillField WordDoc, "MDSignLine", IIf(D![FCdetails.State] = "VA", "", "_________________________________")
'FillField WordDoc, "MDAttorney", IIf(D![FCdetails.State] = "VA", "", D!AttorneyName)
'FillField WordDoc, "InvestorAIF", IIf(D!AIF = True, D!LongClientName & " as Attorney in Fact for ", "") & D!Investor
'FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
'FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
'FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!ForeclosurePrint!NotaryID)
'FillField WordDoc, "NotaryName", FetchNotaryName(Forms!ForeclosurePrint!NotaryID, False)
'FillField WordDoc, "FirmAddress", IIf(D![FCdetails.State] = "VA", "Commonwealth Trustees, LLC" & vbCr & "c/o Rosenberg & Associates, LLC" & vbCr & "8601 Westwood Center Drive, Suite 255" & vbCr & "Vienna, VA 22182", FirmAddress(vbCr))
'FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!ForeclosurePrint!NotaryID, True)
'FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 226, "")

'FillField WordDoc, "FinalLanguage", "WHEREAS, " & _
IIf(Forms!foreclosuredetails!LoanType = 5, "Federal Home Loan Mortgage Corporation is the owner of the note secured by said Deed of Trust and appointed the party of the first part with authority to hold, collect and enforce the note; and", _
IIf(Forms!foreclosuredetails!LoanType = 4, "Federal National Mortgage Association is the owner of the note secured by said Deed of Trust and appointed the party of the first part with authority to hold, collect and enforce the note; and", _
 "the party of the first part is the owner and holder of the Note secured by said Deed of Trust; and,"))

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & templateName & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], templateName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub


Public Sub Doc_OwnershipAffidavitChase(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")

'#1226 MC 10/15/2014
'If d!JurisdictionID = 3 Then
'    Set WordDoc = WordObj.Documents.Open(EMailPath & "Note Ownership Affidavit JP Anne.doc", False)
'Else
    Call OpenDocAsSaved("Note Ownership Affidavit JP")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Note Ownership Affidavit JP.doc", False)
'End If
'/#1226

WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)

    If (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "VA") _
                    Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "DC") Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "MD") Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
'FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 464, "")
'#1226 MC 10/15/2014
'FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: _______________________", "")
'FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               _______________________", "")
'FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: _____________________", "")
'/#1226

Dim Text5, Text1, Text3, Text4 As String
Text5 = "that  Federal Home Loan Mortgage Corporation is the owner of the loan evidenced by the Note, that  " & d![LongClientName] & " is the servicer of the loan evidenced by the Note and that the copy of the Note filed in this foreclosure case is a true and accurate copy. "
Text4 = "that  Federal National Mortgage Association is the owner of the loan evidenced by the Note, that " & d![LongClientName] & " is the servicer of the loan evidenced by the Note, and that the copy of the Note filed in this foreclosure action is a true and accurate copy."
Text1 = "that " & d![Investor] & " is the owner of the loan evidenced by the Note that is the subject of this foreclosure action and that the copy of the Note filed in this foreclosure case is a true and  accurate copy."
Text3 = "that " & d![LongClientName] & " is the owner of the loan evidenced by the Note that is the subject of this foreclosure action, as demonstrated by the fact that it is the holder of the Note."

FillField WordDoc, "budytext", IIf(Forms!ForeclosureDetails!LoanType = 5, Text5, IIf(Forms!ForeclosureDetails!LoanType = 4, Text4, IIf(Forms!ForeclosureDetails!LoanType = 1 Or Forms!ForeclosureDetails!LoanType = 2 Or Forms!ForeclosureDetails!LoanType = 3, Text1, Text3)))

FillField WordDoc, "filenumber", d![CaseList.FileNumber]
WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Note Ownership Affidavit JP.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Note Ownership Affidavit JP.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_DeedofAppointmentWells(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
'Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsLite WHERE CaseList.FileNumber=" & Forms![Case List]!FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If
Dim templateName As String
Dim BankName As String

If Forms![ForeclosureDetails]!State = "MD" Then
templateName = "Deed of Appointment WellsMD"
Else
templateName = "Deed of Appointment WellsVA"
End If

If Forms![case list]!ClientID = 6 Then BankName = "Deed of Appointment-Wells Fargo Bank NA"
If Forms![case list]!ClientID = 556 Then BankName = "Deed of Appointment-Wells Fargo Home Mortgage"

templateName = templateName '& ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)

WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

FillField WordDoc, "bankName", d!LongClientName
FillField WordDoc, "BankAddress", d!BankStreet
FillField WordDoc, "BankCity", d!BankCity
FillField WordDoc, "BankState", d!BankState
FillField WordDoc, "BankZipCod", FormatZip(d!BankZipcode)
FillField WordDoc, "Tax", d!TaxID
FillField WordDoc, "Addy", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)

FillField WordDoc, "DOTdate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 20)
FillField WordDoc, "originaltrustee", d!OriginalTrustee
FillField WordDoc, "OriginalBeneficiary", d!OriginalBeneficiary
FillField WordDoc, "DOTrecorded", Format$(d!DOTrecorded, "mmmm d, yyyy")

FillField WordDoc, "Jurisdiction", d!Jurisdiction

'FillField WordDoc, "JurisdictionMD", IIf(D![Jurisdiction] = "Baltimore City", "City of Baltimore", "County of " & D![Jurisdiction])
FillField WordDoc, "JurisdictionMD", IIf(d![Jurisdiction] = "Baltimore City", "City of Baltimore", IIf(d![JurisdictionID] <> 18, "County of " & Replace(d![Jurisdiction], " County", ""), "County of " & Replace(d![Jurisdiction], "'s County", "")))

FillField WordDoc, "Folio", d!Folio
FillField WordDoc, "Liber", d!Liber

'FillField WordDoc, "Folio2", d!Folio2
'FillField WordDoc, "Liber2", d!Liber2
FillField WordDoc, "Rerecorded", IIf(IsNull(d![Rerecorded]) = True, "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " in Liber " & d![Liber2] & " at Folio " & d![Folio2]) & ", "

FillField WordDoc, "N/AFoilo", IIf(IsNull(d![Folio]), ", under Instrument Number " & d![Liber] & ", in book N/A, page N/A", ", under Instrument Number N/A, in book " & d![Liber] & ", " & "page " & d![Folio])
FillField WordDoc, "FCdetails.State", d![FCdetails.State]
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "TrusteeNames", IIf(Forms![ForeclosureDetails]!State = "MD", trusteeNames(0, 2), "Commonwealth Trustees, LLC")
FillField WordDoc, "investor", d![Investor]
FillField WordDoc, "investorMD", IIf(d![Investor] <> "Wells Fargo Bank, N.A.", "authorized agent of " & d![Investor], d![Investor])
FillField WordDoc, "LegalDescription", d!LegalDescription

'FillField WordDoc, "trusteeType", IIf(Forms!foreclosureDetails!Option221, "Successor Trustee ", "Substitute Trustee ")
FillField WordDoc, "trusteeList", getTrustees(Forms!ForeclosureDetails!lstTrustees, Forms!ForeclosureDetails!lstTrustees)

FillField WordDoc, "Text27", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & _
", " & d!City & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode)

FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 226, "")
'If Page = 1 Then Call DrawBarcode(Me, AddDocPreIndex([FileNumber], 464, ""), 450, 4000, True)

FillField WordDoc, "filenumber", d![CaseList.FileNumber]
WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & BankName & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], BankName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_DeedofAppointmentWellsVA(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If
Dim templateName As String
Dim BankName As String

templateName = "Deed of Appointment WellsVA"

If Forms![case list]!ClientID = 6 Then BankName = "Deed of Appointment-Wells Fargo Bank NA"
If Forms![case list]!ClientID = 556 Then BankName = "Deed of Appointment-Wells Fargo Home Mortgage"

templateName = templateName '& ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)

WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]

FillField WordDoc, "addressVA", FirmShortAddressVA()
FillField WordDoc, "bankName", d!LongClientName
FillField WordDoc, "BankAddress", d!BankStreet
FillField WordDoc, "BankCity", d!BankCity
FillField WordDoc, "BankState", d!BankState
FillField WordDoc, "BankZipCod", FormatZip(d!BankZipcode)
FillField WordDoc, "Tax", d!TaxID

FillField WordDoc, "Property", d!PropertyAddress
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)

FillField WordDoc, "DOTdate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 100)
FillField WordDoc, "originaltrustee", d!OriginalTrustee
FillField WordDoc, "OriginalBeneficiary", d!OriginalBeneficiary
FillField WordDoc, "DOTrecorded", Format$(d!DOTrecorded, "mmmm d, yyyy")
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "N/AFolio", IIf(IsNull(d![Folio]), ", under Instrument Number " & d![Liber] & ", in book N/A, page N/A", ", under Instrument Number N/A, in book " & d![Liber] & ", " & "page " & d![Folio])
FillField WordDoc, "FCdetails.State", d![FCdetails.State]
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "TrusteeNames", IIf(Forms![ForeclosureDetails]!State = "MD", trusteeNames(0, 2), "Commonwealth Trustees, LLC")
FillField WordDoc, "investor", d![Investor]
'FillField WordDoc, "LegalDescription", D!LegalDescription

'fillField WordDoc, "Text27", D!PropertyAddress & ", " & D!City & ", " & D![FCdetails.State] & " " & FormatZip(D!ZipCode)
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 226, "")
'If Page = 1 Then Call DrawBarcode(Me, AddDocPreIndex([FileNumber], 464, ""), 450, 4000, True)
FillField WordDoc, "filenumber", d![CaseList.FileNumber]

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & BankName & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], BankName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_DeedofAppointmentWellsVASelect(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If
Dim templateName As String
Dim BankName As String

templateName = "Deed of Appointment WellsVA Select"

If Forms![case list]!ClientID = 6 Then BankName = "Deed of Appointment-Wells Fargo Bank NA"
If Forms![case list]!ClientID = 556 Then BankName = "Deed of Appointment-Wells Fargo Home Mortgage"

templateName = templateName '& ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)

WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

FillField WordDoc, "reRecorded", IIf(IsNull(d![Rerecorded]), "", IIf(IsNull(d![Folio2]), " and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & _
" under Instrument Number " & d![Liber2], ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " in Book " & d![Liber2] & ", Page " & d![Folio2]))
 
FillField WordDoc, "LoanMod", IIf(IsNull(d![LoanMod]), "", IIf(IsNull(d![FolioLoanMod]), " modified and recorded on " & Format$(d![LoanMod], "mmmm d, yyyy") & " as Instrument No. " & d![LiberLoanMod] & _
" in the office of the Register of Deeds of " & d![Jurisdiction] & ", " & d![FCdetails.State] & ", ", " modified and recorded on " & Format$(d![LoanMod], "mmmm d, yyyy") & " in Book " & d![LiberLoanMod] & ", Page " & d![FolioLoanMod] & ","))

FillField WordDoc, "addressVA", FirmShortAddressVA()
FillField WordDoc, "bankName", d!LongClientName
FillField WordDoc, "BankAddress", d!BankStreet
FillField WordDoc, "BankCity", d!BankCity
FillField WordDoc, "BankState", d!BankState
FillField WordDoc, "BankZipCod", FormatZip(d!BankZipcode)
'FillField WordDoc, "Tax", d!TaxID
FillField WordDoc, "Tax", IIf(d![JurisdictionID] = 56, "Tax Map Number " & d![TaxID], "Tax ID No: " & d![TaxID])
FillField WordDoc, "Property", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)

FillField WordDoc, "DOTdate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "Mortgagors", MortgagorNames(0, 20)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 100)
FillField WordDoc, "originaltrustee", d!OriginalTrustee
FillField WordDoc, "OriginalBeneficiary", d!OriginalBeneficiary
FillField WordDoc, "DOTrecorded", Format$(d!DOTrecorded, "mmmm d, yyyy")
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "N/AFolio", IIf(IsNull(d![Folio]), ", under Instrument Number " & d![Liber] & ", in book N/A, page N/A", ", under Instrument Number N/A, in book " & d![Liber] & ", " & "page " & d![Folio])
FillField WordDoc, "FCdetails.State", d![FCdetails.State]
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "TrusteeNames", IIf(Forms![ForeclosureDetails]!State = "MD", trusteeNames(0, 2), "Commonwealth Trustees, LLC")
FillField WordDoc, "investor", d![Investor]
'FillField WordDoc, "LegalDescription", D!LegalDescription

'fillField WordDoc, "Text27", D!PropertyAddress & ", " & D!City & ", " & D![FCdetails.State] & " " & FormatZip(D!ZipCode)
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 226, "")
'If Page = 1 Then Call DrawBarcode(Me, AddDocPreIndex([FileNumber], 464, ""), 450, 4000, True)
FillField WordDoc, "filenumber", d![CaseList.FileNumber]

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & BankName & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], BankName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_NOIAffidavitWells(KeepOpen As Boolean)

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If
Dim MainDocument As String
Dim templateName As String

If Forms![case list]!ClientID = 6 Then templateName = "NOI Wells Fargo Bank NA"
If Forms![case list]!ClientID = 556 Then templateName = "NOI Wells Fargo Home Mortgage"

'TemplateName = TemplateName & ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Note Ownership Affidavit Wells")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Note Ownership Affidavit Wells.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "NoteOwner", FetchNoteOwner(d!LoanType, d!Investor, d![FCdetails.State])
FillField WordDoc, "Noteholders", GetNamesMD(0, 2, "Noteholder=True")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, d!LongClientName & " as Attorney in Fact for ", "") & d!Investor
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID)
FillField WordDoc, "FHLMCWording", IIf(d!LoanType = 5 Or d!LoanType = 4, ", and " & d!Investor & " is the holder of the Note having been transferred to " & d!Investor & " for the purposes of enforcement and conducting this foreclosure action", "")
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "jurisdiction", d!Jurisdiction
FillField WordDoc, "dotdate", Format(d![DOTdate], "mmmm d, yyyy")
FillField WordDoc, "FetchNoteOwnerT", FetchNoteOwner(d![LoanType], d![Investor], d![FCdetails.State])
FillField WordDoc, "CurrentT", IIf(d![LoanType] = 5, "", "current ")
FillField WordDoc, "Investor", d![Investor]
FillField WordDoc, "BorrowerNames", BorrowerNames(d![CaseList.FileNumber])
FillField WordDoc, "DOTIF", IIf(d!DOT = True, "Deed of trust", "Mortgage")
FillField WordDoc, "DateOfDefault", Format$(d![DateOfDefault], "mmmm d, yyyy")
FillField WordDoc, "MortgagorNamesOneline", MortgagorNames(0, 2)
FillField WordDoc, "NOI", Format$(d![NOI], "mmmm d, yyyy")
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 592, "")
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ______________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & templateName & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], templateName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_OwnershipAffidavitWells(KeepOpen As Boolean)

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If
Dim MainDocument As String
Dim templateName As String
Dim Text5 As String
Dim Text4 As String
Dim Textother As String

Text5 = "Federal Home Loan Mortgage Corporation is the owner of the loan evidenced by the Note, and that Federal Home Loan Mortgage Corporation has authorized " & d![Investor] & " to be the holder of the Note for purposes of conducting this foreclosure action."
Text4 = "Federal National Mortgage Association is the owner of the loan evidenced by the Note, and that Federal National Mortgage Association has authorized " & d![Investor] & " to be the holder of the Note for purposes of conducting this foreclosure action."
Textother = d![Investor] & " is the owner and holder of the loan evidenced by the Note."

If Forms![case list]!ClientID = 6 Then templateName = "Ownership Affidavit Wells"
If Forms![case list]!ClientID = 556 Then templateName = "Ownership Affidavit Wells"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Ownership Affidavit Wells")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Ownership Affidavit Wells" & ".doc", False)

WordObj.Visible = True
WordObj.Activate
WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "NoteOwner", FetchNoteOwner(d!LoanType, d!Investor, d![FCdetails.State])
FillField WordDoc, "Noteholders", GetNamesMD(0, 2, "Noteholder=True")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "correct", IIf(d![FCdetails.State] = "MD", "accurate", "correct")
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, d!LongClientName & " as Attorney in Fact for ", "") & d!Investor
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID)
FillField WordDoc, "FHLMCWording", IIf(d!LoanType = 5 Or d!LoanType = 4, ", and " & d!Investor & " is the holder of the Note having been transferred to " & d!Investor & " for the purposes of enforcement and conducting this foreclosure action", "")
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "jurisdiction", d!Jurisdiction
FillField WordDoc, "dotdate", Format(d![DOTdate], "mmmm d, yyyy")
FillField WordDoc, "FetchNoteOwnerT", FetchNoteOwner(d![LoanType], d![Investor], d![FCdetails.State])
FillField WordDoc, "CurrentT", IIf(d![LoanType] = 5, "", "current ")
FillField WordDoc, "Investor", d![Investor]
FillField WordDoc, "BorrowerNames", BorrowerNames(d![CaseList.FileNumber])
FillField WordDoc, "DOTIF", IIf(d!DOT = True, "Deed of trust", "Mortgage")
FillField WordDoc, "DateOfDefault", Format$(d![DateOfDefault], "mmmm d, yyyy")
FillField WordDoc, "MortgagorNamesOneline", MortgagorNames(0, 2)
FillField WordDoc, "NOI", Format$(d![NOI], "mmmm d, yyyy")
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 464, "")
FillField WordDoc, "Textbudy", IIf(d![LoanType] = 5, Text5, IIf(d![LoanType] = 4, Text4, Textother))
FillField WordDoc, "InvestorIf", IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for ", "") & d![Investor]
FillField WordDoc, "Anne", IIf(d![JurisdictionID] = 3, "Address: _______________", "")
FillField WordDoc, "Anne2", IIf(d![JurisdictionID] = 3, "                " & "_______________", "")
FillField WordDoc, "Anne3", IIf(d![JurisdictionID] = 3, "Phone No.: _____________", "")

WordObj.Selection.HomeKey wdStory, wdMove

'WordDoc.SaveAs EMailPath & templateName & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], templateName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_StatementOfDebtWithFiguresWells(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset, dd As Recordset      ' data
Dim i As Integer, itemcount As Integer, TotalItems As Currency, amountInterest As Currency, itemsFields As String, j As Integer
Dim K As Recordset
Dim Rresult As Long
Dim IntrestTo As String
Dim IntrestFrom As String

IntrestFrom = "Interest From " & InputBox("Interest From")
IntrestTo = " To " & InputBox("Interest To")


Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String

If Forms![case list]!ClientID = 6 Then templateName = "Statement of Debt Figures Wells"
If Forms![case list]!ClientID = 556 Then templateName = "Statement of Debt Figures Wells"

'If (D![ClientID] = 157) Then
'  TemplateName = TemplateName & " Cenlar"
'End If
'TemplateName = TemplateName & ".doc"


Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Statement of Debt Figures Wells")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Statement of Debt Figures Wells.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProjectName").Select
WordDoc.Bookmarks("ProjectName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "owner", IIf(d![LoanType] = 4, "holder", IIf(d![LoanType] = 5, "holder", "owner"))
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", IIf(d!CaseTypeID = 8, d!MonitorTrusteeAddress, FirmShortAddress(vbCr))
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "BorrowerNames", BorrowerNames(0)
'FillField WordDoc, "Liber", LiberFolio(D![Liber], D![Folio], D![FCdetails.State], D![JurisdictionID])
'FillField WordDoc, "LastPaymentApplied", Format$(D![DateOfDefault], "mmmm d, yyyy")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
'FillField WordDoc, "PaidStr", IIf((Nz(D![RemainingPBal], 0) > Nz(D![OriginalPBal], 0)), "Additional Interest", "Paid on principal")
'FillField WordDoc, "Paid", Format$(D!OriginalPBal - D!RemainingPBal, "Currency")
FillField WordDoc, "RemainingPBal", Format$(d!RemainingPBal, "Currency")
FillField WordDoc, "BrowersNamesV2", BrowersNamesV2(d![CaseList.FileNumber], 2)
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 223, "")
'FillField WordDoc, "DateAsOf", Forms![Print Statement of Debt]!txtDueDate
'FillField WordDoc, "DateEffective", Forms![Print Statement of Debt]!txtDueDate + 1
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "              ________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ______________", "")
'FillField WordDoc, "DateBalance", IIf(IsNull(Forms![Print Statement of Debt]!txtDueDate), "______________", Format$(Forms![Print Statement of Debt]!txtDueDate, "mmmm d"", ""yyyy"))

TotalItems = 0
amountInterest = 0
itemsFields = ""
Set dd = CurrentDb.OpenRecordset("SELECT Desc,  Amount FROM StatementOfDebt WHERE FileNumber=" & d![CaseList.FileNumber] & " ORDER BY Timestamp ASC ;", dbOpenSnapshot)
If dd.EOF Then      ' no extra lines
    FillField WordDoc, "Line_Items", ""
Else
    dd.MoveLast
    itemcount = dd.RecordCount
       
    
    ' Make enough lines
    For i = 1 To itemcount
        itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
    Next i
 
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
    FillField WordDoc, "Line_Items", itemsFields & " "
    
    dd.MoveFirst
    i = 1
    Do While Not dd.EOF
    If dd!Desc = "Interest" Then
    FillField WordDoc, "Item" & i, IntrestFrom & IntrestTo & vbTab & Format$(Nz(dd!Amount, 0), "Currency")
   i = i + 1
   dd.MoveNext
    Else
        FillField WordDoc, "Item" & i, dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency")
        i = i + 1
        dd.MoveNext
    End If
        'TotalItems = TotalItems + Nz(dd!Amount, 0)
'        dd.MoveNext
'        i = i + 1

    Loop

End If
 dd.Close
 
  Set K = CurrentDb.OpenRecordset("SELECT Desc, Amount FROM StatementOfDebt WHERE FileNumber=" & d![CaseList.FileNumber], dbOpenSnapshot)
  j = 1
  Do While Not K.EOF
   If K!Desc = "Interest" Then
   amountInterest = amountInterest + Format$(Nz(K!Amount, 0), "Currency")
   End If

   TotalItems = TotalItems + Nz(K!Amount, 0)
   K.MoveNext
   j = j + 1
  Loop
  K.Close


FillField WordDoc, "Total", Format$(TotalItems, "Currency")
FillField WordDoc, "rate", IIf(d![LoanType] = 3, "Interest will continue to accrue according to the terms of the note. ", IIf(Forms![Print Statement of Debt]!cbxRateType = "Fixed", "Per diem interest in the amount of _____ will accrue on the principal from _______ ", IIf(Forms![Print Statement of Debt]!cbxRateType = "HELOC", "A daily variable per diem will accrue on the principal in accordance with the variable rate as set forth in the Note ", "Per diem interest in the amount of _______ will accrue on the principal from ______ to the next interest rate change date and accrue thereafter in accordance with the variable rate as set forth in the Note")))
FillField WordDoc, "BalDueDate", IIf(IsNull([Forms]![Print Statement of Debt]![txtDueDate]), "______________", Format$([Forms]![Print Statement of Debt]![txtDueDate], "mmmm d"", ""yyyy"))
FillField WordDoc, "BalanceDue", Format$(d!RemainingPBal + TotalItems, "Currency")
FillField WordDoc, "PerDiemInterest", IIf(IsNull(d!PerDiem), "$_____________", Format$(d!PerDiem, "Currency"))

'FillField WordDoc, "PerDiemInterest", IIf(IsNull(D!PerDiem), "$_____________", Format$(D!PerDiem, "Currency"))
'FillField WordDoc, "InterestRate", IIf(IsNull(D!InterestRate), "____________ %", Format$(D!InterestRate, "#.000%"))
'FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
'FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
'FillField WordDoc, "NotaryLocation", IIf(IsNull(D!NotaryLocation), "STATE OF ______________:" & vbCr & "COUNTY OF ____________ :", D!NotaryLocation)
FillField WordDoc, "amountInterest$", Format$(amountInterest, "Currency")
FillField WordDoc, "jurisdiction", d!Jurisdiction
FillField WordDoc, "dotdate#", d![DOTdate]
'FillField WordDoc, "liberT", D![Liber]
'FillField WordDoc, "folioT", D![Folio]
FillField WordDoc, "lpidate", d!LPIDate
FillField WordDoc, "LPIdate+1", DateAdd("d", 1, d![LPIDate])
FillField WordDoc, "MortgagorNamesintext", MortgagorNamesIntext(0, 2, 0, 0, -1)
'FillField WordDoc, "lpidate#", D![LPIDate]
FillField WordDoc, "lastmonth", LastMonth(d![LPIDate])
FillField WordDoc, "Anne", IIf(d![JurisdictionID] = 3, "Address: _______________", "")
FillField WordDoc, "Anne2", IIf(d![JurisdictionID] = 3, "                " & "_______________", "")
FillField WordDoc, "Anne3", IIf(d![JurisdictionID] = 3, "Phone No.: _____________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & templateName & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], templateName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_SubPurchaserOrder(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim FileNumber As Long
FileNumber = Forms![case list]!FileNumber

Set d = CurrentDb.OpenRecordset("select * from qryRptSubPurchaserMotionWord where  CaseList.FileNumber =" & FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file has no data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("SubstitutePurchaserOrder")
Set WordDoc = WordObj.Documents.Open(EMailPath & "SubstitutePurchaserOrder.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = FileNumber
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), " ", ", " & d![Fair Debt] & ", ") & d!City & ", " & d![State] & " " & Format(d!ZipCode)


If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
    FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
         DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
    FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
         DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
    FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
         DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
End If
    
FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber, "")
FillField WordDoc, "PropertyAddr", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), " ", ", " & d![Fair Debt] & ", ") & vbNewLine & d!City & ", " & d![State] & " " & Format(d!ZipCode)
FillField WordDoc, "FirmName", FirmName()
FillField WordDoc, "SubstitutePurchaser", d!SubstitutePurchaser
FillField WordDoc, "Purchaser", Nz(d!Purchaser, "")

FillField WordDoc, "firmAddr", FirmAddress()
FillField WordDoc, "pCos", IIf(IsNull(Forms!frmsubpurchaserName!ChPCOS), "", Forms!frmsubpurchaserName!Text1 & vbNewLine & Forms!frmsubpurchaserName!Text2 & vbNewLine & _
                    Forms!frmsubpurchaserName!Text3)
FillField WordDoc, "SCos", IIf(IsNull(Forms!frmsubpurchaserName!ChSCOS), "", Forms!frmsubpurchaserName!Text4 & vbNewLine & Forms!frmsubpurchaserName!Text5 & vbNewLine & _
                    Forms!frmsubpurchaserName!Text6 & vbNewLine & Forms!frmsubpurchaserName!Text7 & ", " & Forms!frmsubpurchaserName!Text8 & " " & FormatZip(Forms!frmsubpurchaserName!Text9))
                    
WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
Set WordObj = Nothing
d.Close
End Sub
Public Sub Doc_SubPurchaserMotion(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim FileNumber As Long
FileNumber = Forms![case list]!FileNumber

Set d = CurrentDb.OpenRecordset("select * from qryRptSubPurchaserMotionWord where  CaseList.FileNumber =" & FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file has no data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("SubstitutePurchaserMotion")
Set WordDoc = WordObj.Documents.Open(EMailPath & "SubstitutePurchaserMotion.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = FileNumber
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), " ", ", " & d![Fair Debt] & ", ") & d!City & ", " & d![State] & " " & Format(d!ZipCode)


If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
    FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
         DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
    FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
         DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
    FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
         DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
End If

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber, "")
FillField WordDoc, "Client", d!LongClientName
FillField WordDoc, "FirmName", FirmName()
FillField WordDoc, "SubstitutePurchaser", IIf(IsNull(d!SubstitutePurchaser), "", UCase$(Left$(d!SubstitutePurchaser, 1))) & IIf(IsNull(d!SubstitutePurchaser), "", Mid$(d!SubstitutePurchaser, 2))
FillField WordDoc, "Sale", Format$(d!Sale, "mmmm d"", ""yyyy")
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), " ", ", " & d![Fair Debt] & ", ") & d!City & ", " & d![State] & " " & Format(d!ZipCode)
FillField WordDoc, "Purchaser", Nz(d!Purchaser, "")
If IsNull(d!SalePrice) Then
    FillField WordDoc, "SalePrice", "$__________"
Else
    FillField WordDoc, "SalePrice", CurrencyWords(d![SalePrice])
End If
FillField WordDoc, "currencySalePrice", IIf(IsNull(d![SalePrice]), "_________", Format$(d![SalePrice], "Currency"))
FillField WordDoc, "LienPosition", IIf(d![LienPosition] <= 1, "", ", subject to paying off senior lien(s)")
FillField WordDoc, "TrustNameswithCPTF", trusteeNamesCPTF(0, 3)
FillField WordDoc, "firmAddr", IIf(IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]), FirmAddress(), _
            IIf([Forms]![foreclosurePrint]![cboOfficeLocation] = 1, FirmAddress(), IIf([Forms]![foreclosurePrint]![cboOfficeLocation] = 2, FirmAddressVA(), FirmAddressChspk())))
FillField WordDoc, "PTitle", Nz(Forms!frmsubpurchaserName!Text2, "")
FillField WordDoc, "STitle", Nz(Forms!frmsubpurchaserName!Text5, "")
FillField WordDoc, "subTrustee", Nz(Forms!frmsubpurchaserName!selectedTrustee, "")

WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_SubPurchaserBuyin(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset, dd As Recordset
Dim FileNumber As Long

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCSubPurchDeedWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Sub Purchaser - Buy in")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Sub Purchaser - Buy in.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
                  DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID =2")
End If

FillField WordDoc, "MDHC", IIf(d![FCdetails.State] = "MD", IIf(d![ClientID] = 404 Or d![ClientID] = 531, UCase("Exempt from recordation and transfer taxes pursuant to Sections 12-108(a)(1)(iii) and 13-207(a)(1) of the Tax – Property Article, Annotated Code of Maryland."), ""), "")
FillField WordDoc, "DMHCDesc", IIf(d![ClientID] <> 404, "", "PER MD TAX PROPERTY ACTICLE, SECTION 12-108A & SECTION 13-207 A-1, THIS TRANSFER IS EXEMPT FROM TRANSFER AND RECORDATION TAXES")
FillField WordDoc, "TrusteeNames", trusteeNames(0, 2)
FillField WordDoc, "subPurchaser", d!SubstitutePurchaser
FillField WordDoc, "Mortgagors", MortgagorNamesCaps(0, 2, 2)
FillField WordDoc, "OriginalTrustee", d!OriginalTrustee
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm dd, yyyy")
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "LiberFolio", LiberFolio(d![Liber], d![Folio], d![JurisdictionList.State], d![JurisdictionID])
FillField WordDoc, "caseNo", IIf(IsNull(d![CourtCaseNumber]), "_________________", d![CourtCaseNumber])
FillField WordDoc, "LongState", d![LongState]
FillField WordDoc, "Sale", IIf(IsNull(d![Sale]), "______________________", Format$(d![Sale], "mmmm d"", ""yyyy"))
FillField WordDoc, "Newspaper", d!Newspaper
FillField WordDoc, "SalePrice", IIf(IsNull(d![SalePrice]), "$______________", Format$(d![SalePrice], "Currency"))
FillField WordDoc, "LienPosition", IIf(d![LienPosition] <= 1, "", ", subject to paying off senior lien(s)")
FillField WordDoc, "OrderSubsPurch", Format$(d![OrderSubsPurch], "mmmm d"", ""yyyy")
FillField WordDoc, "SubstitutePurchaser", d![SubstitutePurchaser]
FillField WordDoc, "Purchaser", Nz(d![Purchaser])
FillField WordDoc, "SaleRat", d![SaleRat]
FillField WordDoc, "SalePrice", IIf(IsNull(d![SalePrice]), "$______________", Format$(d![SalePrice], "Currency"))
FillField WordDoc, "Leasehold", IIf(d![Leasehold], "leasehold, subject to annual ground rent of " & Format$(d![GroundRentAmount], "Currency") & ", payable " & d![GroundRentPayable], "fee simple")
FillField WordDoc, "LegalDescription", d![LegalDescription]
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), " ", ", " & d![Fair Debt] & ", ") & d![City] & ", " & d![LongState] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "TaxID", Nz(d![TaxID])
FillField WordDoc, "AttorneyName", Nz(d![AttorneyName])
FillField WordDoc, "NotaryLocation", FetchNotaryLocation([Forms]![foreclosurePrint]![NotaryID])
FillField WordDoc, "NotaryName", FetchNotaryName([Forms]![foreclosurePrint]![NotaryID], True)
If IsNull([Forms]![foreclosurePrint]![NotaryID]) Then
    FillField WordDoc, "Expires", ""
Else
'FillField WordDoc, "Expires", IIf(IsNull([Forms]![foreclosureprint]![NotaryID]) Or [Forms]![foreclosureprint]![NotaryID] = "", "", Format(DLookup("NotaryExpires", "Staff", "ID= " & [Forms]![foreclosureprint]![NotaryID]), "mmmm d"", ""yyyy"))
FillField WordDoc, "Expires", Format(DLookup("NotaryExpires", "Staff", "ID= " & [Forms]![foreclosurePrint]![NotaryID]), "mmmm d"", ""yyyy")
End If
FillField WordDoc, "FirmAddr", FirmAddress()

WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
Set WordObj = Nothing
d.Close
Set d = Nothing
End Sub

Public Sub Doc_ConsentModifyingAll(KeepOpen As Boolean)

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim FileNumber As Long, Judge As String, CoDebtor As Boolean, AffDate As String, AffInfo As String, Debtorsplural As Boolean

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBKDocsWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Select Case d!District
    Case 8, 9, 10, 11, 18
        Set WordObj = CreateObject("Word.Application")
        Call OpenDocAsSaved("Consent Order Modifying Western VA")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "Consent Order Modifying Western VA.doc", False)
        WordObj.Visible = True
    Case Else
        Set WordObj = CreateObject("Word.Application")
        Call OpenDocAsSaved("Consent Order Modifying")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "Consent Order Modifying.doc", False)
        WordObj.Visible = True
End Select

'margin address:
    If [Forms]![BankruptcyPrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![CaseList.FileNumber])
If d!District = 6 Or d!District = 7 Then   'need attorney VA bar# for these two districts. 12/5/16
   WordDoc.Bookmarks("AttorneyInfo").Select
   WordDoc.Bookmarks("AttorneyInfo").Range.Text = [Forms]![BankruptcyPrint]![cbxAttorney].Column(0) & vbCr & "VA Bar #: " & Nz(DLookup("VABar", "Staff", "ID =" & [Forms]![BankruptcyPrint]![cbxAttorney].Column(1)))
End If

'WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
'WordDoc.Bookmarks("FileNumber").Range.text = D![CaseList.FileNumber]
'WordDoc.Bookmarks("AttorneyInfo").Select
'WordDoc.Bookmarks("AttorneyInfo").Range.text = "Diane Rosenberg" & vbCr & "VA Bar 35237"

FillField WordDoc, "Header", IIf(d![Districts.State] <> "VA", vbNewLine & vbNewLine & vbNewLine & vbNewLine & vbNewLine & vbNewLine & vbNewLine & vbNewLine & vbNewLine & vbNewLine & vbNewLine & vbNewLine & vbNewLine & vbNewLine & vbNewLine & vbNewLine, "") & _
    "IN THE UNITED STATES BANKRUPTCY COURT" & vbNewLine & "FOR THE " & UCase$(d!Name) & vbNewLine & d!Location
'Judge = Right$(UCase$(D!CaseNo), 3)
'CoDebtor = (GetNames(0, 1, "BKCoDebtor=True") <> "" And D![BKdetails.Chapter] = 13)


'If Not IsNull(d![3rdAff]) Then
'    AffDate = Format$(d![3rdAff], "mmmm d, yyyy")
'Else
'    If Not IsNull(d![2ndAff]) Then
'        AffDate = Format$(d![2ndAff], "mmmm d, yyyy")
'    Else
'        If Not IsNull(d![Affidavit]) Then
'            AffDate = Format$(d![Affidavit], "mmmm d, yyyy")
'        End If
'    End If
'End If
'If AffDate = "" Then
'    AffInfo = ""
'Else
'    AffInfo = "an Affidavit of Default having been sent on " & AffDate & ", no response or funds having been received, "
'End If
Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (BKOwner=True OR BKMortgagor=True)") > 1)

FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")

FillField WordDoc, "InvestorAddr", UCase$(d![Investor]) & vbCr & Nz(d!InvestorAddress)

'FillField WordDoc, "Respondents", UCase$(GetNames(0, 3, IIf(d![BKdetails.Chapter] = 13, _
'"(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"))) & _
'IIf(d![BKdetails.Chapter] = 7, " and " & UCase$(Nz(d![First])) & " " & _
'UCase$(Nz(d![Last])) & ", CHAPTER 7 TRUSTEE", "")
FillField WordDoc, "Respondents", _
    GetAddresses(0, 4, _
        IIf(d![BKdetails.Chapter] = 13, _
            "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
            "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"), vbCr) & _
            IIf(d![BKdetails.Chapter] = 7, vbCr & " and " & vbCr & vbCr & UCase$(Nz(d![First])) & " " & UCase$(Nz(d![Last])) & ", CHAPTER 7 TRUSTEE", "")
FillField WordDoc, "capTrustee", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), UCase([Forms]![BankruptcyDetails]![Trustee].Column(2)), "")
FillField WordDoc, "Tail", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), vbTab & vbCr & "Trustee", "")
FillField WordDoc, "More", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), "and" & vbCr, "")

'& vbCr & RemoveLF(D!InvestorAddress)
'FillField WordDoc, "RespondentsEnd", GetAddresses(0, 4, IIf(D![BKdetails.Chapter] = 13, _
'            "(BKDebtor=True OR BKCoDebtor=True) AND (Owner=True OR Mortgagor=True)", _
'            "BKDebtor=True AND (Owner=True OR Mortgagor=True)"), vbCr) & _
'    IIf(D![BKdetails.Chapter] = 7, _
'        vbCr & vbCr & "and" & vbCr & vbCr & FormatName("", _
'                                                        UCase$(Nz(D!First)), _
'                                                        UCase$(Nz(D!Last)), _
'                                                        ", CHAPTER 7 TRUSTEE", _
'                                                        D!Address, _
'                                                        D!Address2, _
'                                                        D![BKTrustees.City], _
'                                                        D![BKTrustees.State], _
'                                                        D!Zip, _
'                                                        vbCr), _
'        "")
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "capTrustee", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), [Forms]![BankruptcyDetails]![Trustee].Column(2), "")

Judge = Right$(UCase$(d![CaseNo]), 3)
FillField WordDoc, "Caption", IIf(Judge = "RGM" And d![RealEstate], "CONSENT ORDER  AS TO " & UCase$(d![PropertyAddress]), "CONSENT ORDER MODIFYING AUTOMATIC STAY")

Select Case Forms![Print Consent Order Modifying]!optTrustee
    Case 1
        FillField WordDoc, "TrusteeAction", "the trustee having filed a report of no distribution, "
    Case 2
        FillField WordDoc, "TrusteeAction", "the trustee having failed to file an answer, "
    Case 0
        FillField WordDoc, "TrusteeAction", ""
    Case 3
        FillField WordDoc, "TrusteeAction", ""
End Select

FillField WordDoc, "ThisDate", IIf(d![Districts.State] <> "VA", "", ", it is this " & OrderDate())

FillField WordDoc, "District", d![Name]
Dim chCoDebtor As Boolean
 If (GetNames(0, 1, "BKCoDebtor=True") <> "" And d![BKdetails.Chapter] = 13) Then chCoDebtor = True

FillField WordDoc, "CoDebtorSection", IIf(chCoDebtor, "and 1301", "")

FillField WordDoc, "Action", IIf(d!RealEstate, "commence foreclosure proceeding " & _
IIf(d![FCdetails.State] = "MD", "in the Circuit Court for " & d!Jurisdiction & _
IIf(IsNull(d!LongState), "", ", " & d!LongState) & ", ", "") & _
"against the real property and improvements " & IIf(IsNull(d!ShortLegal), "", _
"with a legal description of """ & d!ShortLegal & """ also ") & "known as " & _
d!PropertyAddress & IIf(Len(Forms!BankruptcyDetails!sfrmPropAddr!Apt & "") = 0, "", ", " & Forms!BankruptcyDetails!sfrmPropAddr!Apt) & _
 ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & _
FormatZip(d!ZipCode) & " and to allow the successful purchaser to obtain possession of same", _
"proceed with repossession and sale of the " & d!PropertyDesc)

'FillField WordDoc, "PropertyDesc", D![PropertyDesc]

FillField WordDoc, "OrderWording", IIf(Judge = "RGM", "ORDERED that the Debtor shall:", _
"ORDERED that the above Order be and it is hereby, stayed provided that the Debtor:")

FillField WordDoc, "ConsentPaymentAmount", Format$(d!ConsentPaymentAmount, "Currency")

FillField WordDoc, "PaymentType", IIf(d!RealEstate, "mortgage", "monthly")

FillField WordDoc, "payOpt", IIf(Forms![Print Consent Order Modifying]!OptPayment = 0, "Payments to be made by Trustee through an Amended Plan; and,", _
        IIf(Forms![Print Consent Order Modifying]!OptPayment = 1, "make future payments by Wage garnishment; and, ", _
        IIf(Forms![Print Consent Order Modifying]!OptPayment = 2, "Set up auto payments through Creditor or debtor's bank; and,", "")))

FillField WordDoc, "ConsentPaymentDate", Format$(d!ConsentPaymentDate, "mmmm d, yyyy")
FillField WordDoc, "NoteType", IIf(d!RealEstate, "Promissory Note secured by the " & DOTWord(d!DOT) & " on the above referenced property", d!PropertyContract)
FillField WordDoc, "ConsentPaymentInfo", d!ConsentPaymentInfo
If IsNull(d!Consent2A) Then
    FillField WordDoc, "2A", ""
Else
    FillField WordDoc, "2A", "^p2A. " & d!Consent2A
End If
FillField WordDoc, "ConsentPaymentTo", Nz(d![ConsentPaymentTo], "")
FillField WordDoc, "AndAttorney", IIf(IsNull(d!AttorneyLastName), "", "and Debtor's attorney ")
FillField WordDoc, "RGM1", IIf(Judge = "RGM", "", ", without further order of court")
FillField WordDoc, "RGM2", IIf(Judge = "RGM", "^pIf any amount required in Paragraph 2 is not paid timely, Movant's attorney shall mail notice to the Debtor" & _
                        IIf(IsNull(d!AttorneyLastName), "", ", Debtor's attorney") & " and Chapter 13 Trustee, and shall file an Order of Termination of Automatic " & _
                        "Stay against the Subject Property described above; and be it further^p" & _
                        "ORDERED that a default in the payment of a regularly scheduled mortgage payment as listed in Paragraph 1 shall be governed by the attached addendum.", "")
If d![Districts.State] = "VA" Then
    FillField WordDoc, "JudgeSignature", "___________________________" & vbCr & "United States Bankruptcy Judge"
    FillField WordDoc, "Submitted", "Respectfully Submitted:"
      
    FillField WordDoc, "AttorneySignature", "Diane S. Rosenberg"
    FillField WordDoc, "End", ""
Else
    FillField WordDoc, "OrderDate", ""
    FillField WordDoc, "JudgeSignature", ""
    FillField WordDoc, "Submitted", ""
  '  FillField WordDoc, "ElectronicSignature", ""
    FillField WordDoc, "AttorneySignature", ""
    FillField WordDoc, "End", "End of Order"
End If

FillField WordDoc, "ElectronicSignature", IIf([Forms]![BankruptcyPrint]![chElectronicSignature], "/s/ " & [Forms]![BankruptcyPrint]![cbxAttorney], "")
FillField WordDoc, "ElectronicSignature2", IIf([Forms]![BankruptcyPrint]![chElectronicSignature], IIf(IsNull(d![LastName]), DebtorNames(0, 5), "/s/ " & d![FirstName] & " " & d![LastName]), "")
FillField WordDoc, "date", Format(Date, "mmmm dd, yyyy")
FillField WordDoc, "AttMovment", [Forms]![BankruptcyPrint]![cbxAttorney]
FillField WordDoc, "AttDebtor", d![FirstName] & " " & d![LastName]
FillField WordDoc, "AttSign", IIf(Forms![Print Consent Order Modifying]!optTrustee = 3 And _
Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & d![First] & " " & d![Last], "")
FillField WordDoc, "AttSignb", IIf(Forms![Print Consent Order Modifying]!optTrustee = 3, "_______________________" & vbCr & d![First] & " " & d![Last] & vbCr & "Chapter 13 Trustee", "")

FillField WordDoc, "ATTpage4", [Forms]![BankruptcyPrint]![cbxAttorney] & ", Esquire"
FillField WordDoc, "Attpage4Address", FirmAddress()
FillField WordDoc, "AttFirmname", IIf(IsNull(d![LastName]), "", d![FirstName] & " " & d![LastName] & ", Esquire " & vbCr & IIf(IsNull(d![BKAttorneyFirm]), "", d![BKAttorneyFirm] & vbCr) & d![BKAttorneyAddress])
FillField WordDoc, "Truss", FormatName("", d![First], d![Last], ", Trustee", d![BKTrustees.Address], d![Address2], d![BKTrustees.City], d![BKTrustees.State], d![Zip])
FillField WordDoc, "AttFirm", IIf(IsNull(d![AttorneyLastName]), "", d![AttorneyFirstName] & " " & d![AttorneyLastName] & ", Esquire")
'FillField WordDoc, "AttFirmname", IIf(IsNull(D![BKAttorneyFirm]), "", D![BKAttorneyFirm] & "")
FillField WordDoc, "AttFirmAddress", d![BKAttorneyAddress]
FillField WordDoc, "BKService", BKService(0)
FillField WordDoc, "Copy", IIf(Forms!BankruptcyPrint!chElectronicSignature And d![Districts.State] <> "VA", _
"I HEREBY CERTIFY that the terms of the copy of the consent order submitted to the Court are identical to those set forth in the original consent order; and the signatures represented by the /s/__________ on this copy reference the signatures of consenting parties on the original consent order.", "")
FillField WordDoc, "lastSignature", [Forms]![BankruptcyPrint]![cbxAttorney]

WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
'WordDoc.SaveAs EMailPath & "Consent Order Modifying.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Consent Order Modifying.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_DebtBK(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset, R As Recordset, B As Recordset
Dim P As String, C As String, TotalItemsB As Integer, ItemsFieldsB As String, TotalItems As Currency
Dim totalA As Integer, totalB As Integer

P = "pre"
C = "post"
Dim FileNumber As Long, Judge As String, CoDebtor As Boolean, AffDate As String, AffInfo As String, Debtorsplural As Boolean, itemsFields As String
Dim itemcount As Integer, i As Integer, j As Integer

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBKDocsWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBKDocsWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If


Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Consent Order Modifying Debt")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Consent Order Modifying Debt.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![CaseList.FileNumber])

'margin location, default to MD 01/21/16
If [Forms]![BankruptcyPrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
End If

FillField WordDoc, "Header", IIf(d![Districts.State] <> "VA", vbNewLine, "") & _
    "IN THE UNITED STATES BANKRUPTCY COURT" & vbNewLine & "FOR THE " & UCase$(d!Name) & vbNewLine & d!Location


FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")

FillField WordDoc, "InvestorAddr", UCase$(d![Investor])

FillField WordDoc, "Respondents", UCase$(GetNames(0, 3, IIf(d![BKdetails.Chapter] = 13, _
"(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"))) & _
IIf(d![BKdetails.Chapter] = 7, vbCr & " and " & vbCr & vbCr & UCase$(Nz(d![First])) & " " & UCase$(Nz(d![Last])) & ", CHAPTER 7 TRUSTEE", "")
FillField WordDoc, "More", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), "and" & vbCr, "")
FillField WordDoc, "capTrustee", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), UCase([Forms]![BankruptcyDetails]![Trustee].Column(2)), "")
FillField WordDoc, "Tail", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), vbTab & vbCr & "Trustee", "")
FillField WordDoc, "More", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), "and" & vbCr, "")

FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]

Judge = Right$(UCase$(d![CaseNo]), 3)
FillField WordDoc, "Caption", "EXHIBIT A -- DEBT"
totalA = 0
TotalItems = 0
itemsFields = ""
Set R = CurrentDb.OpenRecordset("Select * FROM  BKDebt WHERE FileNumber=" & FileNumber & " AND BKDebt.PrePost = '" & P & "' ORDER BY Timestamp;", dbOpenSnapshot)
If R.EOF Then   'no extra lines
FillField WordDoc, "Line_Items", ""
Else
  R.MoveLast
  itemcount = R.RecordCount
  For i = 1 To itemcount
  itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
  Next i
  itemsFields = Left$(itemsFields, Len(itemsFields) - 1)
  FillField WordDoc, "Line_Items", itemsFields
  R.MoveFirst
  i = 1
  Do While Not R.EOF
  FillField WordDoc, "Item" & i, R!Desc & vbTab & Format$(Nz(R!Amount, 0), "Currency")
  TotalItems = TotalItems + Nz(R!Amount, 0)
  R.MoveNext
  i = i + 1
  Loop
    R.MoveFirst
    For j = 1 To R.RecordCount
    totalA = totalA + R!Amount
    R.MoveNext
    Next j
End If

R.Close
FillField WordDoc, "total", Format$(Nz(totalA, 0), "Currency")

totalB = 0
TotalItemsB = 0
ItemsFieldsB = ""
Set B = CurrentDb.OpenRecordset("Select * FROM  BKDebt WHERE FileNumber=" & FileNumber & " AND BKDebt.PrePost = '" & C & "' ORDER BY Timestamp;", dbOpenSnapshot)
If B.EOF Then   'no extra lines
FillField WordDoc, "Line_ItemsB", ""
Else
  B.MoveLast
  itemcount = B.RecordCount
  For i = 1 To itemcount
  ItemsFieldsB = ItemsFieldsB & "<<ItemB" & i & ">>" & vbCr
  Next i
  ItemsFieldsB = Left$(ItemsFieldsB, Len(ItemsFieldsB) - 1)
  FillField WordDoc, "Line_ItemsB", ItemsFieldsB
  B.MoveFirst
  i = 1
  Do While Not B.EOF
  FillField WordDoc, "ItemB" & i, B!Desc & vbTab & Format$(Nz(B!Amount, 0), "Currency")
  TotalItemsB = TotalItemsB + Nz(B!Amount, 0)
  B.MoveNext
  i = i + 1
  Loop
  B.MoveFirst
  For j = 1 To B.RecordCount
   totalB = totalB + B!Amount
    B.MoveNext
    Next j
End If
B.Close
FillField WordDoc, "totalB", Format$(Nz(totalB, 0), "Currency")

FillField WordDoc, "totalAll", Format$(Nz(CLng(totalA) + CLng(totalB), 0), "Currency")
   
WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
'WordDoc.SaveAs EMailPath & "Consent Order Modifying Debt.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Debt.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
Set d = Nothing
Set B = Nothing
End Sub


Public Sub Doc_CHAMCoverSheet(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Cover Letter CHAM")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Cover Letter CHAM.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

FillField WordDoc, "ClientLoanT", Forms!ForeclosureDetails!LoanNumber
FillField WordDoc, "State", Forms!ForeclosureDetails!State
'FillField WordDoc, "FirstLegalDate", If Is Null(Forms!foreclosureDetails![567]),"",
FillField WordDoc, "FirstLegalDate", Nz(Forms!ForeclosureDetails!FirstLegal, " No Date Selected")

'FillField WordDoc, "DocType", IIf([Forms]![ForeclosurePrint]![chDeedOfApp] = True, "Substitution of Trustee", IIf([Forms]![ForeclosurePrint]![chMilitaryAffidavitActive] = True, _
'"Active Duty Military Affidavit", IIf([Forms]![ForeclosurePrint]![chMilitaryAffidavit] = True, _
'"Military Affidavit", IIf([Forms]![ForeclosurePrint]![chMilitaryAffidavitNoSSN] = True, "Military Affidavit No SSN"))))

If Forms!foreclosurePrint!chDeedOfApp = True Then
    FillField WordDoc, "DocType", "Substitution of Trustee"
ElseIf Forms!foreclosurePrint!chMilitaryAffidavitActive = True Then
    FillField WordDoc, "DocType", "Active Duty Military Affidavit"
ElseIf Forms!foreclosurePrint!chMilitaryAffidavit = True Then
    FillField WordDoc, "DocType", "Military Affidavit"
ElseIf Forms!foreclosurePrint!chMilitaryAffidavitNoSSN = True Then
    FillField WordDoc, "DocType", "Military Affidavit No SSN"
ElseIf Forms!foreclosurePrint!chSOD2 = True Then
    FillField WordDoc, "DocType", "Statement of Debt with Figures"
ElseIf Forms!foreclosurePrint!chSOD = True Then
    FillField WordDoc, "DocType", "Statement of Debt"
ElseIf Forms!foreclosurePrint!chLossMitPrelim = True Then
    FillField WordDoc, "DocType", "Loss Mitigation - Preliminary"
ElseIf Forms!foreclosurePrint!chLossMitFinal = True Then
    FillField WordDoc, "DocType", "Loss Mitigation - Final"
ElseIf Forms!foreclosurePrint!chNoteOwnership = True Then
    FillField WordDoc, "DocType", "Affidavit of Note Ownership"
ElseIf Forms!foreclosurePrint!chAffMD7105 = True Then
    FillField WordDoc, "DocType", "NOI Affidavit"

End If

FillField WordDoc, "PropertyAddressT", Forms!ForeclosureDetails!PropertyAddress & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt]) & ", " & Forms!ForeclosureDetails!City & ", " & Forms!ForeclosureDetails!State & " " & FormatZip(Forms!ForeclosureDetails!ZipCode)
FillField WordDoc, "ContactNameT", GetLoginName() & "     " & GetStaffEmail()
FillField WordDoc, "ReturnAddress", IIf(Forms!ForeclosureDetails!State = "VA", "Commonwealth Trustees c/o Rosenberg and Associates, 8601 Westwood Center Drive, Ste 255, Vienna, VA 22182", "Rosenberg & Associates, LLC, Attn: Dockets Team, 4340 East West Highway, Ste 600, Bethesda, MD 20814")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Cover Letter CHAM.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Champion Cover Letter.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_DILJudgmentAffidavit(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDILword WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data especially on Name Tab, please be sure that Mortgagor or Owners boxes are checked or contact programmers"
    Exit Sub
End If

Do While d.EOF = False

    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Deed in Lieu - Judgement Affidavit")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Deed in Lieu - Judgement Affidavit.doc", False)
    WordObj.Visible = True
    
    WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
    WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
    
    'margin address:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & " " & Nz(d![Fair Debt] & ", ", "") & d!City & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode)
    
    FillField WordDoc, "First", d!First
    FillField WordDoc, "Last", d!Last
      
    If d!Leasehold = 1 Then
        FillField WordDoc, "Leasehold", "Leasehold"
    Else
        FillField WordDoc, "Leasehold", "Fee Simple"
    End If
    
    FillField WordDoc, "PropertyAddress", d!PropertyAddress
    FillField WordDoc, "City", d!City
    FillField WordDoc, "State", Nz(d!LongState)
    FillField WordDoc, "ZipCode", FormatZip(d!ZipCode)
    d.MoveNext
Loop

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Deed in Lieu - Judgement Affidavit.doc"

'Why do we need a function to save a word document, the save feature is BUILT in...
'Call SaveDoc(WordDoc, Forms![Case list]!FileNumber, "Deed in Lieu - Judgement Affidavit.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
Set d = Nothing
End Sub   '************************* This Sub handles the Word Doc for DIL Judgment Affidavit

Public Sub Doc_DILBorrowerLetter(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim backbydate As String
Dim backbydate2 As String
Dim mortgagors As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryfcdocswordlite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

backbydate = Nz(InputBox("Enter a back by date", "Back by Date"), "")
backbydate2 = Nz(InputBox("Enter a move out date", "Move out Date"), "")
Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Deed in Lieu - Borrower Letter1")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Deed in Lieu - Borrower Letter1.doc", False)

WordObj.Visible = True

'WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
'WordDoc.Bookmarks("FileNumber").Range.text = D![CaseList.FileNumber]
'If backbydate = "" Then    ' change to an input box, not add 7 days to backby date any more per Julie  4/25/16
'Else
'backbydate2 = Format(DateAdd("d", 7, backbydate), "mmmm d, yyyy")
'End If

mortgagors = MortgagorOwnerNames(0, 3)

FillField WordDoc, "backbydate", Format(backbydate, "mmmm d, yyyy")
FillField WordDoc, "backbydate2", Format(backbydate2, "mmmm d yyyy")
FillField WordDoc, "date", Format$(Date, "mmmm d, yyyy")
FillField WordDoc, "Mortgagors1", mortgagors
FillField WordDoc, "Mortgagors", MortgagorOwnerNames(0, 2)
FillField WordDoc, "PropertyAddress", d!PropertyAddress
FillField WordDoc, "City", d!City
FillField WordDoc, "State", Nz(d!LongState)
FillField WordDoc, "ZipCode", FormatZip(d!ZipCode)
FillField WordDoc, "Filenumber", d![CaseList.FileNumber]
FillField WordDoc, "LoginName", GetLoginName
FillField WordDoc, "STaffEmail", GetStaffEmail

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Deed in Lieu - Borrower Letter.doc"

'Why do we need a function to save a word document, the save feature is BUILT in...
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Deed in Lieu - Borrower Letter.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
Set d = Nothing
End Sub   '************************* This Sub handles the Word Doc for DIL Letter to Borrower

Public Sub Doc_DIL(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim investorAdd As String
Dim mortgagors As String
Dim sql As String
Dim dotDateFormatted As String
Dim origpBalFormat As String
Dim dotrecordedFormat As String
Dim mortgagorLine As String
Dim recordedInput As String
Dim LiberInput As String
Dim FolioInput As String
Dim consider As String
Dim assess As String
Dim marylandStr As String
Dim zipper As String
 
    Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDilWord2 WHERE [CaseList.FileNumber] = " & Forms![case list]!FileNumber, dbOpenSnapshot)
    If d.EOF Then
        MsgBox "The file might missing data, please check all the data required or contact programmers"
        Exit Sub
    End If
    
    If d!LongState = "Virginia" Then
        consider = Format(InputBox("Please enter a Consideration Amount:", "Deed in Lieu of Foreclosure - CONSIDERATION"), "Currency")
        assess = Format(InputBox("Please enter an Assessed Value Amount:", "Deed in Lieu of Foreclosure - ASSESSSED VALUE"), "Currency")
    Else ' skip it
    End If
    
    recordedInput = Format(InputBox("Deed Recorded on:", "Deed in Lieu - DATE RECORDED "), "mmmm d, yyyy")
    LiberInput = InputBox("Please enter a Liber Number: ", "Deed in Lieu - LIBER NUMBER ")
    FolioInput = InputBox("Please enter a Folio Number: ", "Deed in Lieu - FOLIO NUMBER ")
     
    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Deed in Lieu")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Deed in Lieu.doc", False)
    
    WordObj.Visible = True
       
'margin address:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & " " & Nz(d![Fair Debt] & ", ", "") & d!City & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode)
    
    
    'Could/Should combine these into 1 line below
    If Not IsNull([D!InvestorAddress]) Then
          investorAdd = OneLine(d!InvestorAddress)
    Else
        investorAdd = ""
    End If
    If Not IsNull([D!DOTdate]) Then
        dotDateFormatted = Format(d!DOTdate, "mmmm d, yyyy")
    Else
        dotDateFormatted = ""
    End If
    If Not IsNull([D!OriginalPBal]) Then
         origpBalFormat = Format(d!OriginalPBal, "Currency")
    Else
        origpBalFormat = ""
    End If
    If Not IsNull([D!DOTrecorded]) Then
           dotrecordedFormat = Format(d!DOTrecorded, "mmmm d, yyyy")
    Else
        dotrecordedFormat = ""
    End If
        
    mortgagors = MortgagorOwnerNames(0, 2)
          
    If d!LongState = "Virginia" Then
        FillField WordDoc, "Consideration", "CONSIDERATION: " & consider
        FillField WordDoc, "AssessedValue", "ASSESSED VALUE: " & assess
        FillField WordDoc, "TaxID", "TAX ID NO.: " & IIf(IsNull(d!TaxID), "", d!TaxID)
       
        If Not IsNull(Forms!foreclosurePrint!Attorney.Column(0)) Then
            FillField WordDoc, "Deed", "Deed Prepared by:"
            FillField WordDoc, "Atty", GetStaffFullName(Forms!foreclosurePrint!Attorney.Column(0))
            FillField WordDoc, "Bar", FetchbarNumberPoundSign(Forms!foreclosurePrint!Attorney, d![FCdetails.State])
        Else
            FillField WordDoc, "Deed", ""
            FillField WordDoc, "Atty", ""
            FillField WordDoc, "Bar", ""
        End If
        'FillField WordDoc, "Atty", GetStaffFullName(Forms!ForeclosurePrint!Attorney.Column(0))
        'FillField WordDoc, "Bar", FetchBarNumberPoundSign(Forms!ForeclosurePrint!Attorney, D![FCdetails.State])
        FillField WordDoc, "Maryland", ""
    Else
        FillField WordDoc, "Consideration", ""
        FillField WordDoc, "AssessedValue", ""
        FillField WordDoc, "TaxID", ""
        FillField WordDoc, "Deed", ""
        FillField WordDoc, "Atty", ""
        FillField WordDoc, "Bar", ""
        marylandStr = "This instrument was prepared under the supervision of an attorney admitted to practice before the Court of Appeals of Maryland."
        marylandStr = marylandStr + vbCrLf
        marylandStr = marylandStr & "                                                                                                            __________________________"
        FillField WordDoc, "Maryland", marylandStr
    End If
    
    FillField WordDoc, "Mortgagors", mortgagors
    FillField WordDoc, "Investor", IIf(IsNull(d!Investor), "", d!Investor)
    FillField WordDoc, "InvestorAddress", IIf(IsNull(d!PropertyAddress), "", d!PropertyAddress)
    FillField WordDoc, "dotdate", dotDateFormatted
    FillField WordDoc, "OriginalBeneficiary", IIf(IsNull(d!OriginalBeneficiary), "", d!OriginalBeneficiary)
    FillField WordDoc, "OriginalPBal", origpBalFormat
    FillField WordDoc, "dotrecorded", dotrecordedFormat
    FillField WordDoc, "liber", IIf(IsNull(d!Liber), "", d!Liber)
    FillField WordDoc, "Folio", IIf(IsNull(d!Folio), "", d!Folio)
    FillField WordDoc, "Jurisdiction", IIf(IsNull(d!Jurisdiction), "", d!Jurisdiction)
    FillField WordDoc, "State", IIf(IsNull(d!LongState), "", d!LongState)
        
    If Not IsNull([D!Leasehold]) Then
        If d!Leasehold = 1 Then
            FillField WordDoc, "Leasehold", "Leasehold with an annual ground rent of " & Format(d![GroundRentAmount], "Currency")
        Else
            FillField WordDoc, "Leasehold", "Fee Simple"
        End If
    Else
        FillField WordDoc, "Leasehold", ""
    End If
    If Not IsNull([D!Zipcode]) Then
        zipper = FormatZip(d!ZipCode)
    Else
        zipper = ""
    End If
    FillField WordDoc, "Legal", IIf(IsNull(d!LegalDescription), "", d!LegalDescription)
    FillField WordDoc, "TaxID", IIf(IsNull(d!TaxID), "", d!TaxID)
    FillField WordDoc, "PropertyAddress", IIf(IsNull(d!PropertyAddress), "", d!PropertyAddress)
    FillField WordDoc, "City", IIf(IsNull(d!City), "", d!City)
    FillField WordDoc, "ZipCode", zipper
    FillField WordDoc, "RecordedInput", recordedInput
    FillField WordDoc, "LiberInput", LiberInput
    FillField WordDoc, "FolioInput", FolioInput
    FillField WordDoc, "MortgagorsLines", MortgagorOwnerNames(0, 4)
     
    FillField WordDoc, "Filenumber", IIf(IsNull(d![CaseList.FileNumber]), "", d![CaseList.FileNumber])
    FillField WordDoc, "LoginName", GetLoginName
    FillField WordDoc, "STaffEmail", GetStaffEmail
  
    WordObj.Selection.HomeKey wdStory, wdMove
    'WordDoc.SaveAs EMailPath & "Deed in Lieu.doc"
    
    'Why do we need a function to save a word document, the save feature is BUILT in...
    'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Deed in Lieu.doc")
    'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
    Set WordObj = Nothing
    d.Close
    Set d = Nothing
  
End Sub   '************************* This Sub handles the Word Doc for DIL (Main)

Public Sub Doc_DILCertificate(KeepOpen As Boolean)

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim investorAdd As String
Dim mortgagors As String
Dim sql As String
Dim dotDateFormatted As String
Dim origpBalFormat As String
Dim dotrecordedFormat As String
Dim mortgagorLine As String
Dim recordedInput As String
Dim vacateDate As String
Dim zipper As String

    Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDilCert WHERE [CaseList.FileNumber] = " & Forms![case list]!FileNumber, dbOpenSnapshot)
    
    If d.EOF Then
        MsgBox "The file might missing data especially on Name Tab, please be sure that Mortgagor or Owners boxes are checked or contact programmers"
        Exit Sub
    End If
    
       
    vacateDate = Format(InputBox("Please enter a Vacate by Date:", "Deed in Lieu - VACATE DATE "), "mmmm d, yyyy")
    If Not IsNull([D!InvestorAddress]) Then
          investorAdd = OneLine(d!InvestorAddress)
    Else
        investorAdd = ""
    End If
    If Not IsNull([D!DOTdate]) Then
        dotDateFormatted = Format(d!DOTdate, "mmmm d, yyyy")
    Else
        dotDateFormatted = ""
    End If
    If Not IsNull([D!OriginalPBal]) Then
        origpBalFormat = Format(d!OriginalPBal, "Currency")
    Else
       origpBalFormat = ""
    End If
    If Not IsNull([D!DOTrecorded]) Then
       dotrecordedFormat = Format(d!DOTrecorded, "mmmm d, yyyy")
    Else
       dotrecordedFormat = ""
    End If
    If Not IsNull([D!Zipcode]) Then
        zipper = FormatZip(d!ZipCode)
    Else
        zipper = ""
    End If
         
   ' Do While d.EOF = False
        Set WordObj = CreateObject("Word.Application")
        Call OpenDocAsSaved("Deed in Lieu - Certificate")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "Deed in Lieu - Certificate.doc", False)
        
        WordObj.Visible = True
        
    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & " " & Nz(d![Fair Debt] & ", ", "") & d!City & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode)
    
Dim sPlura As String

sPlura = IIf(CountNames(d![CaseList.FileNumber], "Mortgagor = True or Owner = True") > 1, "Y", "N")
        
        mortgagors = MortgagorOwnerNames(0, 2)
        FillField WordDoc, "vS", IIf(sPlura = "Y", "", "s")
        FillField WordDoc, "nS", IIf(sPlura = "Y", "s", "")
'        FillField WordDoc, "has", IIf(sPlura = "Y", "have", "has")
        FillField WordDoc, "is", IIf(sPlura = "Y", "are", "is")
        FillField WordDoc, "Grantor's", IIf(sPlura = "Y", "Grantors'", "Grantor's")
        FillField WordDoc, "has/have", IIf(sPlura = "Y", "have", "has")
        FillField WordDoc, "he/she/they", IIf(sPlura = "Y", "they", "he/she")
        FillField WordDoc, "his/her/their", IIf(sPlura = "Y", "their", "his/her")
        
        FillField WordDoc, "Mortgagors", mortgagors
        FillField WordDoc, "Investor", IIf(IsNull(d!Investor), "", d!Investor)
        FillField WordDoc, "PropertyAddress", IIf(IsNull(d!PropertyAddress), "", d!PropertyAddress)
        FillField WordDoc, "City", IIf(IsNull(d!City), "", d!City)
        FillField WordDoc, "State", IIf(IsNull(d!LongState), "", d!LongState)
        FillField WordDoc, "ZipCode", zipper
        FillField WordDoc, "dotdate", dotDateFormatted
        FillField WordDoc, "OriginalBeneficiary", IIf(IsNull(d!OriginalBeneficiary), "", d!OriginalBeneficiary)
        FillField WordDoc, "OriginalPBal", origpBalFormat
        FillField WordDoc, "liber", IIf(IsNull(d!Liber), "", d!Liber)
        FillField WordDoc, "Folio", IIf(IsNull(d!Folio), "", d!Folio)
        FillField WordDoc, "Jurisdiction", IIf(IsNull(d!Jurisdiction), "", d!Jurisdiction)
        FillField WordDoc, "vacateDate", vacateDate
        FillField WordDoc, "chkClient", IIf(d!ClientID = 518, "13. It is expressly understood by the Grantor and Grantee that each shall bear its own costs in connection with the dispute, litigation, the modification and this agreement; " & _
            "and that each waives and releases any claims they otherwise have or may have to such costs and attorney’s fees." & vbCr & vbCr & "14. ", "13. ")
        FillField WordDoc, "First", IIf(IsNull(d!First), "", d!First)
        FillField WordDoc, "First", IIf(IsNull(d!First), "", d!First)
        FillField WordDoc, "Last", IIf(IsNull(d!Last), "", d!Last)
        FillField WordDoc, "Filenumber", IIf(IsNull(d![CaseList.FileNumber]), "", d![CaseList.FileNumber])
   ' d.MoveNext
   ' Loop
  
    WordObj.Selection.HomeKey wdStory, wdMove
   ' WordDoc.SaveAs EMailPath & "Deed in Lieu - Certificate.doc"
    
    'Why do we need a function to save a word document, the save feature is BUILT in...
    'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Deed in Lieu - Certificate.doc")
   ' If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
    Set WordObj = Nothing
    d.Close
    Set d = Nothing
  
End Sub   '************************* This Sub handles the Word Doc for DIL (Main)

Public Sub Doc_DeedofAppointmentOcwen(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If
Dim templateName As String
Dim BankName As String

'If Forms![foreclosureDetails]!State = "MD" Then
templateName = "Deed of Appointment Ocwen"
'Else
'TemplateName = "Deed of Appointment WellsVA"
'End If

'If Forms![Case List]!ClientID = 6 Then BankName = "Deed of Appointment-Wells Fargo Bank NA"
'If Forms![Case List]!ClientID = 556 Then BankName = "Deed of Appointment-Wells Fargo Home Mortgage"
BankName = "Deed of Appointment-Ocwen"

templateName = templateName & ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)

WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

FillField WordDoc, "bankName", d!LongClientName
FillField WordDoc, "BankAddress", d!BankStreet
FillField WordDoc, "BankCity", d!BankCity
FillField WordDoc, "BankState", d!BankState
FillField WordDoc, "BankZipCod", FormatZip(d!BankZipcode)
FillField WordDoc, "Tax", d!TaxID
FillField WordDoc, "Addy", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)

FillField WordDoc, "DOTdate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
FillField WordDoc, "originaltrustee", d!OriginalTrustee
FillField WordDoc, "OriginalBeneficiary", d!OriginalBeneficiary
FillField WordDoc, "DOTrecorded", Format$(d!DOTrecorded, "mmmm d, yyyy")

FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "JurisdictionMD", IIf(d![Jurisdiction] = "Baltimore City", "City of Baltimore", "County of " & d![Jurisdiction])
FillField WordDoc, "Folio", d!Folio
FillField WordDoc, "Liber", d!Liber

FillField WordDoc, "N/AFoilo", IIf(IsNull(d![Folio]), ", as Instrument No. " & d![Liber] & ", in book N/A, page N/A", ", as Instrument No. N/A, in book " & d![Liber] & ", " & "page " & d![Folio])
FillField WordDoc, "FCdetails.State", d![FCdetails.State]
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "TrusteeNames", IIf(Forms![ForeclosureDetails]!State = "MD", trusteeNames(0, 2), "Commonwealth Trustees, LLC")
FillField WordDoc, "investor", d![Investor]
FillField WordDoc, "investorMD", IIf(d![Investor] <> "Wells Fargo Bank, N.A.", "authorized agent of " & d![Investor], d![Investor])
FillField WordDoc, "LegalDescription", d!LegalDescription
FillField WordDoc, "MERS", IIf(d![FCdetails.State] = "MD" And d![MERS] = -1, "Mortgage Electronic Registration Systems Inc. (MERS) solely as nominee for " & d![OriginalBeneficiary], "")
'FillField WordDoc, "trusteeType", IIf(Forms!foreclosureDetails!Option221, "Successor Trustee ", "Substitute Trustee ")
FillField WordDoc, "trusteeList", getTrustees(Forms!ForeclosureDetails!lstTrustees, Forms!ForeclosureDetails!lstTrustees)

FillField WordDoc, "Text27", d!PropertyAddress & ", " & d!City & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode)
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 226, "")
'If Page = 1 Then Call DrawBarcode(Me, AddDocPreIndex([FileNumber], 464, ""), 450, 4000, True)

FillField WordDoc, "filenumber", d![CaseList.FileNumber]
WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & BankName & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], BankName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_NationstarCoverSheet(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim dName As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Nationstar Cover Letter")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Nationstar Cover Letter.doc", False)
WordObj.Visible = True

dName = IIf(Forms!foreclosurePrint!chDeedOfApp, "Appointment of Substitute Trustee", IIf(Forms!foreclosurePrint!chLostNoteAffidavit, "Lost Note Affidavit", _
  IIf(Forms!foreclosurePrint!chComplianceAffidavit And d![FCdetails.State] = "MD", "MD Combined Affidavit", _
  IIf(Forms!foreclosurePrint!!ChAffiOfLienInstru And d![FCdetails.State] = "MD", "Affidavit of Lien Instrument", _
  IIf(Forms!foreclosurePrint!chLossMitPrelim And d![FCdetails.State] = "MD", "Loss Mitigation Preliminary", _
  IIf(Forms!foreclosurePrint!chLossMitFinal And d![FCdetails.State] = "MD", "Loss Mitigation Final", ""))))))

FillField WordDoc, "DocName", Nz(dName)
FillField WordDoc, "Client", Nz(d!LongClientName)
FillField WordDoc, "FLMAOccDocktMD", IIf(Forms!foreclosurePrint!chLossMitFinal And ((Forms!ForeclosureDetails!OccupancyStatusID = 4 Or Forms!ForeclosureDetails!OccupancyStatusID = 5) _
            And IsNull(d!Docket) And d![FCdetails.State] = "MD"), "Please use ‘Property is Vacant’ ONLY as the reason on this FLMA.", "_______________________")
FillField WordDoc, "ClientLoanT", Forms!ForeclosureDetails!LoanNumber
FillField WordDoc, "State", Forms!ForeclosureDetails!State
'FillField WordDoc, "FirstLegalDate", If Is Null(Forms!foreclosureDetails![567]),"",
FillField WordDoc, "FirstLegalDate", Nz(Forms!ForeclosureDetails!FirstLegal, "No Date Selected")

'FillField WordDoc, "MortgagorNameT", MortgagorNames(0, 3)

FillField WordDoc, "PropertyAddressT", Forms!ForeclosureDetails!PropertyAddress & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt]) & ", " & Forms!ForeclosureDetails!City & ", " & Forms!ForeclosureDetails!State & " " & FormatZip(Forms!ForeclosureDetails!ZipCode)
FillField WordDoc, "ContactNameT", GetLoginName()

FillField WordDoc, "Date", Format$(Date, "mmmm d, yyyy")
FillField WordDoc, "PrimaryFirst", Forms!ForeclosureDetails!PrimaryFirstName
FillField WordDoc, "PrimaryLast", Forms!ForeclosureDetails!PrimaryLastName
FillField WordDoc, "SecondaryFirst", IIf(IsNull(Forms!ForeclosureDetails!SecondaryFirstName), "", Forms!ForeclosureDetails!SecondaryFirstName & ",")
FillField WordDoc, "SecondaryLast", IIf(IsNull(Forms!ForeclosureDetails!SecondaryLastName), "", Forms!ForeclosureDetails!SecondaryLastName)
'FillField WordDoc, "Comma", IIf(IsNull([SecondaryFirstName]), "", ", ")
FillField WordDoc, "FirmAddress", IIf(d![FCdetails.State] = "VA" Or d![FCdetails.State] = "DC", FirmShortAddressVAOneLine(), FirmShortAddressOneLine())
FillField WordDoc, "ATTN", IIf(d![FCdetails.State] = "VA", "VA Sale Setting team", IIf(d![FCdetails.State] = "DC", "DC Team", "Edwin Orellana"))
'
' If Application.CurrentProject.AllForms("Prior Servicer").IsLoaded Then
'    DoCmd.Close acForm, "Prior Servicer"
' End If

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Nationstar Cover Sheet.doc"
'WordDoc.SaveAs EMailPath & "Nationstar Cover Sheet.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Nationstar Cover Sheet.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
 
End Sub

Public Sub Doc_DeedofAppointmentMDHC(KeepOpen As Boolean)

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String
templateName = "Deed of Appointment MDHC"

templateName = templateName ' & ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

If d!JurisdictionID = 56 And d![FCdetails.State] = "VA" Then
    FillField WordDoc, "Tax", "Tax Map Number:"
Else
    FillField WordDoc, "Tax", "Tax ID #:"
End If

FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "TrusteeNames", trusteeNames(0, 2)
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "MortgagorNames", IIf(IsNull(d!OriginalMortgagors), MortgagorNamesCaps(0, 2, 2), d!OriginalMortgagors)
FillField WordDoc, "AssumedBy", IIf(IsNull(d!OriginalMortgagors), "", "assumed by " & MortgagorNamesCaps(0, 2, 2)) & " "
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "LongState", Nz(d!LongState)
FillField WordDoc, "LiberFolio", LiberFolio(d!Liber, d!Folio, d![FCdetails.State], d![JurisdictionID])
FillField WordDoc, "LegalDescription", d!LegalDescription
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)

If (d![FCdetails.State] = "VA") Then
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", IIf(IsNull(d![Folio2]), ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & _
    " at Instrument Number " & d![Liber2], ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " in Book " & d![Liber2] & ", Page " & d![Folio2]))
ElseIf d!JurisdictionID = 6 Then  'Calvert County
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Book " & d![Liber2] & ", Page " & d![Folio2])
Else 'MD or DC
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Liber " & d![Liber2] & ", Folio " & d![Folio2])
End If

FillField WordDoc, "TaxID", d!TaxID

FillField WordDoc, "OriginalTrustee", d!OriginalTrustee
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "OriginalBeneficiary", d!OriginalBeneficiary
FillField WordDoc, "MDInstrPrepared", IIf(d![FCdetails.State] = "VA", "", "This instrument was prepared under the supervision of " & d!AttorneyName & ", an attorney admitted to practice before the Court of Appeals of Maryland.")
FillField WordDoc, "MDSignLine", IIf(d![FCdetails.State] = "VA", "", "_________________________________")
FillField WordDoc, "MDAttorney", IIf(d![FCdetails.State] = "VA", "", d!AttorneyName)
FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, d!LongClientName & " as Attorney in Fact for ", "") & d!Investor
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID)
FillField WordDoc, "NotaryName", FetchNotaryName(Forms!foreclosurePrint!NotaryID, False)
FillField WordDoc, "FirmAddress", IIf(d![FCdetails.State] = "VA", "Commonwealth Trustees, LLC" & vbCr & "c/o Rosenberg & Associates, LLC" & vbCr & "8601 Westwood Center Drive, Suite 255" & vbCr & "Vienna, VA 22182", FirmAddress(vbCr))
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 226, "")
FillField WordDoc, "boa1", IIf(d![ClientID] = 446, "", "and, being duly sworn")
FillField WordDoc, "boa2", IIf(d![ClientID] = 446, "National Association.", "corporation.")
FillField WordDoc, "MERS", IIf(d![FCdetails.State] = "MD" And d![MERS] = -1, "Mortgage Electronic Registration Systems Inc. (MERS) solely as nominee for ", "")
FillField WordDoc, "FinalLanguage", "WHEREAS, " & _
IIf(Forms!ForeclosureDetails!LoanType = 5, "Federal Home Loan Mortgage Corporation is the owner of the note secured by said Deed of Trust and appointed the party of the first part with authority to hold, collect and enforce the note; and ", _
IIf(Forms!ForeclosureDetails!LoanType = 4, "Federal National Mortgage Association is the owner of the note secured by said Deed of Trust and appointed the party of the first part with authority to hold, collect and enforce the note; and ", _
 "the party of the first part is the holder of the Note secured by said Deed of Trust; and,"))

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Deed of Appointment MDHC.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Deed of Appointment MDHC.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_DeedofAppointmentMT(KeepOpen As Boolean)

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String
templateName = "Deed of Appointment M&T"

templateName = templateName '& ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

'margin address:
    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
If d!JurisdictionID = 56 And d![FCdetails.State] = "VA" Then
    FillField WordDoc, "Tax", "Tax Map Number:"
Else
    FillField WordDoc, "Tax", "Tax ID #:"
End If

FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "TrusteeNames", trusteeNames(0, 2)
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "MortgagorNames", IIf(IsNull(d!OriginalMortgagors), MortgagorNamesCaps(0, 2, 2), d!OriginalMortgagors)
FillField WordDoc, "AssumedBy", IIf(IsNull(d!OriginalMortgagors), "", "assumed by " & MortgagorNamesCaps(0, 2, 2)) & " "
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "LongState", Nz(d!LongState)
FillField WordDoc, "LiberFolio", LiberFolio(d!Liber, d!Folio, d![FCdetails.State], d![JurisdictionID])
FillField WordDoc, "LegalDescription", d!LegalDescription
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)

If (d![FCdetails.State] = "VA") Then
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", IIf(IsNull(d![Folio2]), ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & _
    " at Instrument Number " & d![Liber2], ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " in Book " & d![Liber2] & ", Page " & d![Folio2]))
ElseIf d!JurisdictionID = 6 Then  'Calvert County
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Book " & d![Liber2] & ", Page " & d![Folio2])
Else 'MD or DC
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Liber " & d![Liber2] & ", Folio " & d![Folio2])
End If

FillField WordDoc, "TaxID", Nz(d!TaxID)

FillField WordDoc, "OriginalTrustee", d!OriginalTrustee
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "OriginalBeneficiary", d!OriginalBeneficiary
FillField WordDoc, "MDInstrPrepared", IIf(d![FCdetails.State] = "VA", "", "This instrument was prepared under the supervision of " & d!AttorneyName & ", an attorney admitted to practice before the Court of Appeals of Maryland.")
FillField WordDoc, "MDSignLine", IIf(d![FCdetails.State] = "VA", "", "_________________________________")
FillField WordDoc, "MDAttorney", IIf(d![FCdetails.State] = "VA", "", d!AttorneyName)
FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, d!LongClientName & " as Attorney in Fact for ", "") & d!Investor
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID)
FillField WordDoc, "NotaryName", FetchNotaryName(Forms!foreclosurePrint!NotaryID, False)
FillField WordDoc, "FirmAddress", IIf(d![FCdetails.State] = "VA", "Commonwealth Trustees, LLC" & vbCr & "c/o Rosenberg & Associates, LLC" & vbCr & "8601 Westwood Center Drive, Suite 255" & vbCr & "Vienna, VA 22182", FirmAddress(vbCr))
FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 226, "")
FillField WordDoc, "boa1", IIf(d![ClientID] = 446, "", "and, being duly sworn")
FillField WordDoc, "boa2", IIf(d![ClientID] = 446, "National Association.", "corporation.")
FillField WordDoc, "MERS", IIf(d![FCdetails.State] = "MD" And d![MERS] = -1, "Mortgage Electronic Registration Systems Inc. (MERS) solely as nominee for ", "")
FillField WordDoc, "FinalLanguage", "WHEREAS, " & _
IIf(Forms!ForeclosureDetails!LoanType = 5, "Federal Home Loan Mortgage Corporation is the owner of the note secured by said Deed of Trust and appointed the party of the first part with authority to hold, collect and enforce the note; and ", _
IIf(Forms!ForeclosureDetails!LoanType = 4, "Federal National Mortgage Association is the owner of the note secured by said Deed of Trust and appointed the party of the first part with authority to hold, collect and enforce the note; and ", _
 "the party of the first part is the holder of the Note secured by said Deed of Trust; and,"))

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "SOT M&T.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "SOT M&T.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub
Public Sub doc_LossMitigationPreliminaryMDDitech(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Loss Mitigation Preliminary MD Ditech")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Loss Mitigation Preliminary MD Ditech" & ".doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = Forms![case list]!FileNumber

    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If


FillField WordDoc, "borrower", MortgagorNames(0, 2)
Dim FDebt As String
FDebt = Nz([Forms]![ForeclosureDetails]![Fair Debt])
FillField WordDoc, "PropertyAddress", [Forms]![ForeclosureDetails]![PropertyAddress] & IIf(Len(FDebt & "") = 0, "", ", " & FDebt) & ", " & [Forms]![ForeclosureDetails]![City] & ", " & [Forms]![ForeclosureDetails]![State] & " " & [Forms]![ForeclosureDetails]![ZipCode]
FillField WordDoc, "fillingdate", IIf(IsNull([Forms]![ForeclosureDetails]![Docket]) Or [Forms]![ForeclosureDetails]![Docket] = "", "__________________", Format([Forms]![ForeclosureDetails]![Docket], "mmmm dd yyyy"))
FillField WordDoc, "CourtCaseNumber", IIf(IsNull(Forms!ForeclosureDetails!CourtCaseNumber) Or Forms!ForeclosureDetails!CourtCaseNumber = "", "____________________", Forms!ForeclosureDetails!CourtCaseNumber)

WordObj.Selection.HomeKey wdStory, wdMove
Set WordObj = Nothing

End Sub

Public Sub Doc_FinalLossMitigationAffidavitMDDitech(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Final Loss Mitigation Affidavit Final MD Ditech")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Final Loss Mitigation Affidavit Final MD Ditech" & ".doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = Forms![case list]!FileNumber
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = Forms![case list]![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = [Forms]![ForeclosureDetails]![PropertyAddress] & IIf(Len([Forms]![ForeclosureDetails]![Fair Debt] & "") = 0, "", ", " & [Forms]![ForeclosureDetails]![Fair Debt]) & vbCr & _
    [Forms]![ForeclosureDetails]![City] & ", " & [Forms]![ForeclosureDetails]![State] & vbCr & FormatZip([Forms]![ForeclosureDetails]![ZipCode])

    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "borrower", MortgagorNames(0, 2)
Dim FDebt As String
FDebt = Nz([Forms]![ForeclosureDetails]![Fair Debt])
FillField WordDoc, "PropertyAddress", [Forms]![ForeclosureDetails]![PropertyAddress] & IIf(Len(FDebt & "") = 0, "", ", " & FDebt) & ", " & [Forms]![ForeclosureDetails]![City] & ", " & [Forms]![ForeclosureDetails]![State] & " " & [Forms]![ForeclosureDetails]![ZipCode]
FillField WordDoc, "fillingdate", IIf(IsNull([Forms]![ForeclosureDetails]![Docket]) Or [Forms]![ForeclosureDetails]![Docket] = "", "__________________", Format([Forms]![ForeclosureDetails]![Docket], "mm/dd/yyyy"))
FillField WordDoc, "CourtCaseNumber", IIf(IsNull(Forms!ForeclosureDetails!CourtCaseNumber) Or Forms!ForeclosureDetails!CourtCaseNumber = "", "____________________", Forms!ForeclosureDetails!CourtCaseNumber)

WordObj.Selection.HomeKey wdStory, wdMove
Set WordObj = Nothing

End Sub
Public Sub Doc_LossMitigationPrelimMDHCP(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim textfinal As String
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If
Dim templateName As String
Dim BankName As String

If d![ClientID] = 456 Then
BankName = "Loss Mitigation Preliminary M&T Bank"
templateName = "Loss Mitigation - Prelim MT"

ElseIf d![ClientID] = 531 Then
BankName = "Loss Mitigation Preliminary MDHC"
templateName = "Loss Mitigation - Prelim MDHCP"
Else
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "fillingdate", IIf(Not IsNull(d![Docket]), Format(d![Docket], "mm/d/yyyy"), "_____________________ ")
FillField WordDoc, "borrower", MortgagorNamesOneline(d![CaseList.FileNumber], 2)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", IIf(Not IsNull(d![CourtCaseNumber]), d![CourtCaseNumber], " _____________________ ")
FillField WordDoc, "NameAffianit", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "Print Name and Title of Affiant", "Name")
FillField WordDoc, "TitleAffiaitOrInvestor", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "", "Title of Affiant")
FillField WordDoc, "Line", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "", "______________________________")
FillField WordDoc, "Investor", IIf(d![ClientID] = 6 Or d![ClientID] = 556, d!Investor, "")
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 1484, "")
'FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ____________________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "                " & "____________________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: _________________________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & BankName & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], BankName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_LossMitigationPrelimNationStar(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim textfinal As String
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
'Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsLite WHERE CaseList.FileNumber=" & Forms![Case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If
Dim templateName As String
Dim BankName As String

If d![ClientID] = 385 And d![FCdetails.State] = "MD" Then
BankName = "Nationstar Mortgage LLC"

templateName = "Loss Mitigation Prelim Nation star"
'
'ElseIf d![ClientID] = 531 Then
'BankName = "Loss Mitigation Preliminary MDHC"
'templateName = "Loss Mitigation - Prelim Nationstar"
'Else
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

'margin address:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "client", d!LongClientName
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "fillingdate", IIf(Not IsNull(d![Docket]), Format(d![Docket], "mm/d/yyyy"), "_____________________ ")
FillField WordDoc, "borrower", MortgagorNamesOneline(d![CaseList.FileNumber], 2)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", IIf(Not IsNull(d![CourtCaseNumber]), d![CourtCaseNumber], " _____________________ ")
'FillField WordDoc, "NameAffianit", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "Print Name and Title of Affiant", "Name")    'Mei
'FillField WordDoc, "TitleAffiaitOrInvestor", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "", "Title of Affiant")  'Mei
'FillField WordDoc, "Line", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "", "______________________________")  'Mei
'FillField WordDoc, "Investor", IIf(d![ClientID] = 6 Or d![ClientID] = 556, d!Investor, "")   'Mei
FillField WordDoc, "Investor", IIf(d![ClientID] = 385 And d![Investor] = d!LongClientName, "          Nationstar maintains records for the loan that is secured by the mortgage or deed of trust being foreclosed in this action. ", _
"          Nationstar services and maintains records on behalf of " & d![Investor] & ", the secured party to the mortgage or deed of trust being foreclosed in this action.")
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 1484, "")

FillField WordDoc, "Prior Servicer", IIf(Forms![Prior Servicer]!ChPrior, "           Before the servicing of this loan transferred to Nationstar, " & [Forms]![Prior Servicer]![TxtPriorServicer] & _
" (Prior Servicer) was the servicer for the loan and it maintained the loan servicing records.  When Nationstar began servicing this loan, Prior Servicer's records for the loan were integrated and boarded into Nationstar's systems," & _
" such that Prior Servicer's records, including the collateral file, payment histories, communication logs, default letters, information," & _
"and documents concerning the Loan are now integrated into Nationstar's business records.  Nationstar maintains quality control and " & _
"verification procedures as part of the boarding process to ensure the accuracy of the boarded records.  It is the regular business practice " & _
"of Nationstar to integrate prior servicers' records into Nationstar's business records and to rely upon those boarded records in providing " & _
"its loan servicing functions.  These Prior Servicer records have been integrated and are relied upon by Nationstar as part of Nationstar's " & _
"business records.", "")


'FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ____________________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "                " & "____________________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: _________________________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Loss Mitigation Preliminary Nationstar.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Loss Mitigation Preliminary Nationstar.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_LossMitigationFinalMDHCP(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim templateName As String
Dim BankName As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If d![ClientID] = 456 Then
BankName = "Loss Mitigation Final M&T Bank"
templateName = "Loss Mitigation - Final MT"
ElseIf d![ClientID] = 531 Then
BankName = "Loss Mitigation Final MDHC"
templateName = "Loss Mitigation - Final MDHCP"
Else
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", IIf(Not IsNull(d![CourtCaseNumber]), d![CourtCaseNumber], " _____________________ ")
FillField WordDoc, "NameAffianit", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "Print Name and Title of Affiant", "Name")
FillField WordDoc, "TitleAffiaitOrInvestor", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "", "Title of Affiant")
FillField WordDoc, "Line", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "", "______________________________")
FillField WordDoc, "Investor", IIf(d![ClientID] = 6 Or d![ClientID] = 556, d![Investor], "")
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 1345, "")
'FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: _________________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "                " & "_________________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: _______________________", "")
FillField WordDoc, "fillingdate", IIf(Not IsNull(d![Docket]), Format(d![Docket], "mm/d/yyyy"), "_____________________ ")
FillField WordDoc, "borrower", MortgagorNamesOneline(d![CaseList.FileNumber], 2)

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & BankName & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], BankName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_RecordingDeedCoverMD(KeepOpen As Boolean)

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim sql As String
Dim templateName As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRecorderPrint WHERE PrintInfoMD.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot, dbSeeChanges)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")

Select Case d!JurisdictionID

Case 18  'PG County
    templateName = "Deed Recording Cover PG"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
Case 4 'Baltimore City
    templateName = "Deed Recording Cover BaltCi"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    
    FillField WordDoc, "LienExpires", Nz(d!LienExpires, "________")
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "waterfees", Nz(d!WaterFees, "________")
Case 5   'Baltimore County
    templateName = "Deed Recording Cover BaltCounty"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    
    FillField WordDoc, "LienExpires", Nz(d!LienExpires, "________")
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    'FillField WordDoc, "waterfees", Nz(d!WaterFees, "________")
Case 3 ' Anne Arundel
    templateName = "Deed Recording Cover Anne"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "waterfees", Nz(d!WaterFees, "________")
Case 17 ' Montgomery County MD
    templateName = "Deed Recording Cover MoCoMD"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
Case 10 'Charles County, MD
    templateName = "Deed Recording Cover Charles"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(Format(d!StateRecordationTax, "currency"), "________")
    FillField WordDoc, "statetransfertax", Nz(Format(d!StateTransferTax, "currency"), "_________")
    FillField WordDoc, "Propertytax", Nz(Format(d!PropertyTax, "currnecy"), "________")
    FillField WordDoc, "Certificate", Nz(Format(d!CertofTaxLien, "currency"), "_________")
    FillField WordDoc, "Waterfees", Nz(Format(d!WaterFees, "currency"), "___________")
    FillField WordDoc, "CountyTransferTax", Nz(Format(d!CountyTransferTax, "currency"), "___________")
Case 12 ' Frederick MD
    templateName = "Deed Recording Cover Frederick"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "TaxStatus", Nz(d!TaxStatus, "_________")
    FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    FillField WordDoc, "WaterFeeDestination", Nz(d!WaterFeeDestination, "_____________")
Case 23 'Washington County
    templateName = "Deed Recording Cover WashCo"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    'FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
    FillField WordDoc, "AgricultureTax", Nz(d!AgricultureTax, "___________")
Case 24 'WIcomico County
    templateName = "Deed Recording Cover Wicomico"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
 '   FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
    FillField WordDoc, "WaterFeeDestination", Nz(d!WaterFeeDestination, "___________")
Case 25 'Worcester
    templateName = "Deed Recording Cover Worcester"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
    FillField WordDoc, "waterFeeDestination", Nz(d!WaterFeeDestination, "________")
Case 19 ' Queen Anne's
    templateName = "Deed Recording Cover QueenAnne_Orig"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
Case 14 ' Harford
    templateName = "Deed Recording Cover Harford"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
    FillField WordDoc, "LienExpires", Nz(d!LienExpires, "________")
Case 8 'Carroll County
    templateName = "Deed Recording Cover Carroll"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    'FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
    FillField WordDoc, "LienExpires", Nz(d!LienExpires, "________")
    FillField WordDoc, "sewerFees", Nz(d!SewerFees, "_____________")
  
Case 7 'Caroline County
    templateName = "Deed Recording Cover Caroline"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
    FillField WordDoc, "TownRPropertyTax", Nz(d!SewerFees, "_____________")
    FillField WordDoc, "WaterTarget", Nz(d!WaterFeeDestination, "____________")
    FillField WordDoc, "TownTaxDestination", Nz(d!TownRPropertyTaxDestination, "___________")
Case 6 'Calvert
    templateName = "Deed Recording Cover Calvert"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
   ' FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
   ' FillField WordDoc, "TownRPropertyTax", Nz(d!SewerFees, "_____________")
Case 22 'Talbot
    templateName = "Deed Recording Cover Talbot"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
   ' FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
   ' FillField WordDoc, "TownRPropertyTax", Nz(d!SewerFees, "_____________")
     FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
Case 16 'Kent
    templateName = "Deed Recording Cover Kent"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
   ' FillField WordDoc, "TownRPropertyTax", Nz(d!SewerFees, "_____________")
    ' FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
Case 20 'St. Mary's
    templateName = "Deed Recording Cover StMary"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
Case 21 'Somerset County
    templateName = "Deed Recording Cover Somerset"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    FillField WordDoc, "CityTax", Nz(d!CityTax, "___________")
    FillField WordDoc, "CityTaxDestination", Nz(d!CityTaxDestination, "____________")
    FillField WordDoc, "WaterFeeDestination", Nz(d!WaterFeeDestination, "_____________")
    
Case 2 'Allegany
    templateName = "Deed Recording Cover Allegany"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    FillField WordDoc, "WaterTarget", Nz(d!WaterFeeDestination, "_____________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
    FillField WordDoc, "LienExpires", Nz(d!LienExpires, "________")
Case 11 'Dorchester
    templateName = "Deed Recording Cover Dorchester"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
    FillField WordDoc, "WaterFeeDestination", Nz(d!WaterFeeDestination, "_____________")
Case 13 'Garrett
    templateName = "Deed Recording Cover Garrett"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
   ' FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
Case 9 'Cecil
    templateName = "Deed Recording Cover Cecil"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
   ' FillField WordDoc, "LienExpires", Nz(d!LienExpires, "________")
   ' FillField WordDoc, "sewerFees", Nz(d!SewerFees, "_____________")
Case 15 'Howard
    templateName = "Deed Recording Cover Howard"
    Call OpenDocAsSaved(templateName)
    Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
    WordObj.Visible = True
    FillField WordDoc, "stateRecordationTax", Nz(d!StateRecordationTax, "________")
    FillField WordDoc, "statetransfertax", Nz(d!StateTransferTax, "_________")
    FillField WordDoc, "Propertytax", Nz(d!PropertyTax, "________")
    FillField WordDoc, "Waterfees", Nz(d!WaterFees, "___________")
    'FillField WordDoc, "cityTax", Nz(d!CityTax, "________")
    FillField WordDoc, "countyTransferTax", Nz(d!CountyTransferTax, "________")
    FillField WordDoc, "LienExpires", Nz(d!LienExpires, "________")
   ' FillField WordDoc, "sewerFees", Nz(d!SewerFees, "_____________")
Case Else
    MsgBox "No Word Document created for this County yet"
    d.Close

    Exit Sub
    
End Select

FillField WordDoc, "PrimaryDefName", d!PrimaryDefName
FillField WordDoc, "RecordingCharge", Format(Forms![Print Deed Recording Cover Letter MD].RecordingFee, "currency")
FillField WordDoc, "DeedREcordingFee", Nz(Format(d!AbstractorFees, "currency"), "________")
FillField WordDoc, "RecorderName", Nz(d!RecorderName, "________")
FillField WordDoc, "Date", Format(Now(), "mmmm d"", ""yyyy")
FillField WordDoc, "Mail", IIf(Forms![Print Deed Recording Cover Letter MD]!cboMail.Column(0) = "US Postal", "", Forms![Print Deed Recording Cover Letter MD]!cboMail.Column(0))
FillField WordDoc, "RecorderName", Forms![Print Deed Recording Cover Letter MD]!cbxAbstractorTarget.Column(1)
FillField WordDoc, "RecorderAttn", IIf(IsNull(d![RecorderATTN]) = True, "", "ATTN: " & d![RecorderATTN])
FillField WordDoc, "RecorderAddress", d!RecorderAddress & " " & Nz(d!RecorderAddress2, "")
FillField WordDoc, "RecorderAddress2", d![RecorderCity] & ", " & d![RecorderState] & " " & FormatZip(d![RecorderZip])
FillField WordDoc, "Mortgagor", MortgagorNamesOneline(0, 110)
FillField WordDoc, "Client", Forms![case list]!ClientID.Column(1)
FillField WordDoc, "PropertyAddress", d!PropertyAddress
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d!State
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "Filenumber", d!FileNumber
FillField WordDoc, "LoginName", GetLoginName()
'FillField WordDoc, "Investor", d!Investor

'
'FillField WordDoc, "RecFeeDestination", d!RecFeeDestination

'FillField WordDoc, "StateRecTaxDestination", d!StateRecTaxDestination

'FillField WordDoc, "StateTranstaxDestination", d!StateTransTaxDestination

'FillField WordDoc, "CountyTransTaxDestination", d!CountyTransTaxDestination
'FillField WordDoc, "CountyRPropertyTax", d!CountyRPropertyTax
'FillField WordDoc, "CountyRPropTaxDestination", d!CountyRPropTaxDestination
'FillField WordDoc, "TownRPropertyTax", d!TownRPropertyTax
'FillField WordDoc, "TownRPropertyTaxDestination", d!TownRPropertyTaxDestination
'FillField WordDoc, "waterfees", d!WaterFees
'FillField WordDoc, "waterFeeDestination", d!WaterFeeDestination


'FillField WordDoc, "OtherDesc", IIf(IsNull(d![OtherDescription]), "", "16.  Check in the amount of " & Format$(Nz(d![OtherAmount]), _
'"Currency") & " for " & d![OtherDescription])
'FillField WordDoc, "OtherDesc2", IIf(IsNull(d![OtherDescription2]), "", "17.  Check in the amount of " & Format$(Nz(d![OtherAmount2]), _
'"Currency") & " for " & d![OtherDescription2])
'FillField WordDoc, "OtherDesc3", IIf(IsNull(d![OtherDescription3]), "", "18.  Check in the amount of " & Format$(Nz(d![OtherAmount3]), _
'"Currency") & " for " & d![OtherDescription3])
'FillField WordDoc, "LoginName", GetLoginName()
'FillField WordDoc, "Firm", FirmName("MD")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & " " & templateName & ".doc"
'Call SaveDoc(WordDoc, d![FileNumber], templateName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_EVNoticeBalti(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Dim mortgagors As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryfcdocswordlite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

'backbydate = Nz(InputBox("Enter a back by date", "Back by Date"), "")
Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Eviction Notice Baltimore City")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Eviction Notice Baltimore City.doc", False)

WordObj.Visible = True

'WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
'WordDoc.Bookmarks("FileNumber").Range.text = D![CaseList.FileNumber]

mortgagors = MortgagorOwnerNames(0, 2)
FillField WordDoc, "Lockout", Format([Forms]![EvictionDetails]![LockoutDate], "mmmm d, yyyy")
FillField WordDoc, "date", Format(Date, "mmmm d, yyyy")
FillField WordDoc, "Mortgagors", mortgagors
FillField WordDoc, "PropertyAddress", d!PropertyAddress
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d!LongState
FillField WordDoc, "ZipCode", FormatZip(d!ZipCode)
FillField WordDoc, "Filenumber", d![CaseList.FileNumber]
'FillField WordDoc, "LoginName", GetLoginName
'FillField WordDoc, "STaffEmail", GetStaffEmail
FillField WordDoc, "Attorney", Forms![EvictionDetails]![Attorney].Column(1)

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Eviction Notice Baltimore City.doc"

'Why do we need a function to save a word document, the save feature is BUILT in...
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Eviction Notice Baltimore City.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
Set d = Nothing
End Sub   '****

Public Sub Doc_StatementOfDebtFiguresCham(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset, dd As Recordset      ' data
Dim i As Integer, itemcount As Integer, TotalItems As Currency, itemsFields As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String
templateName = "Statement of Debt Figures Cham"
templateName = templateName ' & ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

WordObj.Visible = False
If MsgBox("Is There A Loan Mod? ", vbYesNo) = vbYes Then
FillField WordDoc, "Mod", " MODIFIED by Agreement effective " & Format(InputBox(" Effective Date?   Format mm/dd/yyyy"), "mmmm d, yyyy") & " with an amended principal balance of " & Format(InputBox(" Amended Principal Balance? "), "Currency")
Else
FillField WordDoc, "Mod", ""
End If
WordObj.Visible = True

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber

FillField WordDoc, "Investor", IIf(d![AIF] = True, IIf(d![FCdetails.State] = "MD", "Nationstar Mortgage LLC as attorney-in-fact for ", d![LongClientName] & " as Attorney in Fact for "), "") & d!Investor

FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", IIf(d!CaseTypeID = 8, d!MonitorTrusteeAddress, FirmShortAddress(vbCr))
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "Reason", IIf(IsNull(Forms![Print Statement of Debt]!txtOtherReason), "________________________", Forms![Print Statement of Debt]!txtOtherReason)
'FillField WordDoc, "455Only", IIf(d![ClientID] = 455, ", and continuing each month thereafter with probable future advancements made by the mortgagee, and that the Plaintiff(s) has\have the right to foreclose;", ", and continuing each month thereafter, and that the Plaintiff(s) has\have the right to foreclose;")
FillField WordDoc, "Liber", LiberFolio(d![Liber], d![Folio], d![FCdetails.State], d![JurisdictionID])
'FillField WordDoc, "LPIdate", Format$(d![LPIDate], "mmmm d, yyyy")
'FillField WordDoc, "LPIdate+1", Format$(d![LPIDate] + 1, "mmmm d, yyyy")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "PaidStr", IIf((Nz(d![RemainingPBal], 0) > Nz(d![OriginalPBal], 0)), "Additional Interest", "Paid on principal")
FillField WordDoc, "Paid", Format$(d!OriginalPBal - d!RemainingPBal, "Currency")
FillField WordDoc, "RemainingPBal", Format$(d!RemainingPBal, "Currency")
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 223, "")
FillField WordDoc, "ReRecorded", IIf(IsNull(d!Rerecorded), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Liber " & d![Liber2] & ", Folio " & d![Folio2])

FillField WordDoc, "Diem", ""  ' Ticket 906
'FillField WordDoc, "diem", IIf(d![LoanType] = 3, IIf(d![ClientID] <> 531, "Per Monthly Interest: ", "Per Diem Interest: "), "Per Diem Interest: ")

FillField WordDoc, "txtbalanc", IIf(d![ClientID] = 361, "Unpaid Principal Balance", "Remaining Balance Due")
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ______________", "")

TotalItems = 0
itemsFields = ""
Set dd = CurrentDb.OpenRecordset("SELECT Desc, Amount FROM StatementOfDebt WHERE FileNumber=" & d![CaseList.FileNumber] & " ORDER BY Timestamp;", dbOpenSnapshot)
If dd.EOF Then      ' no extra lines
    FillField WordDoc, "Line_Items", ""
Else
    dd.MoveLast
    itemcount = dd.RecordCount
    ' Make enough lines
    For i = 1 To itemcount
        itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
    Next i
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
    FillField WordDoc, "Line_Items", itemsFields
    dd.MoveFirst
    i = 1
    Do While Not dd.EOF
        FillField WordDoc, "Item" & i, dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency")
        TotalItems = TotalItems + Nz(dd!Amount, 0)
        dd.MoveNext
        i = i + 1
    Loop
End If
dd.Close

FillField WordDoc, "BalDueDate", IIf(IsNull([Forms]![Print Statement of Debt]![txtDueDate]), "______________", Format$([Forms]![Print Statement of Debt]![txtDueDate], "mmmm d"", ""yyyy"))
FillField WordDoc, "BalanceDue", Format$(d!RemainingPBal + TotalItems, "Currency")

FillField WordDoc, "PerDiemInterest", "" 'Ticket 906
'FillField WordDoc, "PerDiemInterest", IIf(IsNull(d!PerDiem), "$_____________", Format$(d!PerDiem, "Currency"))

FillField WordDoc, "InterestRate", IIf(IsNull(d!InterestRate), "____________ %", Format$(d!InterestRate, "#0.000") & "%")
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", IIf(IsNull(d!NotaryLocation), "STATE OF ______________:" & vbCr & "COUNTY OF ____________ :", d!NotaryLocation)

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Statement of Debt CHAM.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Statement of Debt CHAM.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_CHAMCoverSheetAFF(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Cover Letter CHAM AFFmd7105")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Cover Letter CHAM AFFmd7105.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

FillField WordDoc, "ClientLoanT", Forms!ForeclosureDetails!LoanNumber
FillField WordDoc, "State", Forms!ForeclosureDetails!State
'FillField WordDoc, "FirstLegalDate", If Is Null(Forms!foreclosureDetails![567]),"",
FillField WordDoc, "FirstLegalDate", Nz(Forms!ForeclosureDetails!FirstLegal, " No Date Selected")

FillField WordDoc, "PropertyAddressT", Forms!ForeclosureDetails!PropertyAddress & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt]) & ", " & Forms!ForeclosureDetails!City & ", " & Forms!ForeclosureDetails!State & " " & FormatZip(Forms!ForeclosureDetails!ZipCode)
FillField WordDoc, "ContactNameT", GetLoginName() & "     " & GetStaffEmail()
FillField WordDoc, "ReturnAddress", IIf(Forms!ForeclosureDetails!State = "VA", "Commonwealth Trustees c/o Rosenberg and Associates, 8601 Westwood Center Drive, Ste 255, Vienna, VA 22182", "Rosenberg & Associates, LLC, Attn: Dockets Team, 4340 East West Highway, Ste 600, Bethesda, MD 20814")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Cover Letter CHAM.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Champion Cover Letter AFFMD7105.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_CHAMCoverSheetDeed(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rstAdd As Recordset      ' data


Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Cover Letter CHAM DeedOfApp")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Cover Letter CHAM DeedOfApp.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

FillField WordDoc, "ClientLoanT", Forms!ForeclosureDetails!LoanNumber
FillField WordDoc, "State", Forms!ForeclosureDetails!State
'FillField WordDoc, "FirstLegalDate", If Is Null(Forms!foreclosureDetails![567]),"",
FillField WordDoc, "FirstLegalDate", Nz(Forms!ForeclosureDetails!FirstLegal, " No Date Selected")

FillField WordDoc, "PropertyAddressT", Forms!ForeclosureDetails!PropertyAddress & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt]) & ", " & Forms!ForeclosureDetails!City & ", " & Forms!ForeclosureDetails!State & " " & FormatZip(Forms!ForeclosureDetails!ZipCode)
FillField WordDoc, "ContactNameT", GetLoginName() & "     " & GetStaffEmail()

'FillField WordDoc, "ReturnAddress", IIf(Forms!ForeclosureDetails!State = "VA", "Commonwealth Trustees c/o Rosenberg and Associates, 8601 Westwood Center Drive, Ste 255, Vienna, VA 22182", "Rosenberg & Associates, LLC, Attn: Dockets Team, 4340 East West Highway, Ste 600, Bethesda, MD 20814")
'return address is based on the office location box on the foreclosurePrint screen

If Forms!foreclosurePrint!cboOfficeLocation = "Bethesda" Then
    Set rstAdd = CurrentDb.OpenRecordset("select* from Rosenberg where id = 1")
    FillField WordDoc, "ReturnAddress", "Rosenberg & Associates, LLC, Attn: Dockets Team" & vbCr & _
                rstAdd!AddressLine & " " & rstAdd!City & ", " & rstAdd!State & " " & rstAdd!Zip
ElseIf Forms!foreclosurePrint!cboOfficeLocation = "NoVA" Then
    Set rstAdd = CurrentDb.OpenRecordset("select* from Rosenberg where id = 2")
    FillField WordDoc, "ReturnAddress", "Commonwealth Trustees, LLC, Attn: DC Team" & vbCr & _
                rstAdd!AddressLine & " " & rstAdd!City & ", " & rstAdd!State & " " & rstAdd!ZipF
ElseIf Forms!foreclosurePrint!cboOfficeLocation = "Ches" Then
    Set rstAdd = CurrentDb.OpenRecordset("select* from Rosenberg where id = 3")
    FillField WordDoc, "ReturnAddress", rstAdd!AddressLine & " " & rstAdd!City & ", " & rstAdd!State & " " & rstAdd!Zip
Else
    If d!ClientID = 567 And d![FCdetails.State] = "DC" Then
        Set rstAdd = CurrentDb.OpenRecordset("select* from Rosenberg where id = 2")
        FillField WordDoc, "ReturnAddress", "Commonwealth Trustees, LLC, Attn: DC Team" & vbCr & _
                rstAdd!AddressLine & " " & rstAdd!City & ", " & rstAdd!State & " " & rstAdd!Zip
    ElseIf d!ClientID = 567 And d![FCdetails.State] = "MD" Then
        Set rstAdd = CurrentDb.OpenRecordset("select* from Rosenberg where id = 1")
        FillField WordDoc, "ReturnAddress", "Rosenberg & Associates, LLC, Attn: Dockets Team" & vbCr & _
                rstAdd!AddressLine & " " & rstAdd!City & ", " & rstAdd!State & " " & rstAdd!Zip
    ElseIf d!ClientID = 567 And d![FCdetails.State] = "VA" Then
        Set rstAdd = CurrentDb.OpenRecordset("select* from Rosenberg where id = 2")
        FillField WordDoc, "ReturnAddress", "Rosenberg & Associates, LLC, Attn: Dockets Team" & vbCr & _
                rstAdd!AddressLine & " " & rstAdd!City & ", " & rstAdd!State & " " & rstAdd!Zip
    End If
        
End If

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Cover Letter CHAM.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Champion Cover Letter DeedOfApp.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_CHAMCoverSheetLossFinal(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data


Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Cover Letter CHAM LossMitFinal")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Cover Letter CHAM LossMitFinal.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

FillField WordDoc, "ClientLoanT", Forms!ForeclosureDetails!LoanNumber
FillField WordDoc, "State", Forms!ForeclosureDetails!State
'FillField WordDoc, "FirstLegalDate", If Is Null(Forms!foreclosureDetails![567]),"",
FillField WordDoc, "FirstLegalDate", Nz(Forms!ForeclosureDetails!FirstLegal, " No Date Selected")

FillField WordDoc, "PropertyAddressT", Forms!ForeclosureDetails!PropertyAddress & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt]) & ", " & Forms!ForeclosureDetails!City & ", " & Forms!ForeclosureDetails!State & " " & FormatZip(Forms!ForeclosureDetails!ZipCode)
FillField WordDoc, "ContactNameT", GetLoginName() & "     " & GetStaffEmail()
FillField WordDoc, "ReturnAddress", IIf(Forms!ForeclosureDetails!State = "VA", "Commonwealth Trustees c/o Rosenberg and Associates, 8601 Westwood Center Drive, Ste 255, Vienna, VA 22182", "Rosenberg & Associates, LLC, Attn: Dockets Team, 4340 East West Highway, Ste 600, Bethesda, MD 20814")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Cover Letter CHAM.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Champion Cover Letter LossMitFinal.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_CHAMCoverSheetLossPrelim(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Cover Letter CHAM LossMitPrelim")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Cover Letter CHAM LossMitPrelim.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

FillField WordDoc, "ClientLoanT", Forms!ForeclosureDetails!LoanNumber
FillField WordDoc, "State", Forms!ForeclosureDetails!State
'FillField WordDoc, "FirstLegalDate", If Is Null(Forms!foreclosureDetails![567]),"",
FillField WordDoc, "FirstLegalDate", Nz(Forms!ForeclosureDetails!FirstLegal, " No Date Selected")

FillField WordDoc, "PropertyAddressT", Forms!ForeclosureDetails!PropertyAddress & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt]) & ", " & Forms!ForeclosureDetails!City & ", " & Forms!ForeclosureDetails!State & " " & FormatZip(Forms!ForeclosureDetails!ZipCode)
FillField WordDoc, "ContactNameT", GetLoginName() & "     " & GetStaffEmail()
FillField WordDoc, "ReturnAddress", IIf(Forms!ForeclosureDetails!State = "VA", "Commonwealth Trustees c/o Rosenberg and Associates, 8601 Westwood Center Drive, Ste 255, Vienna, VA 22182", "Rosenberg & Associates, LLC, Attn: Dockets Team, 4340 East West Highway, Ste 600, Bethesda, MD 20814")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Cover Letter CHAM.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Champion Cover Letter LossMitPrelim.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_CHAMCoverSheetMA(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Cover Letter CHAM MilitaryAffidavit")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Cover Letter CHAM MilitaryAffidavit.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

FillField WordDoc, "ClientLoanT", Forms!ForeclosureDetails!LoanNumber
FillField WordDoc, "State", Forms!ForeclosureDetails!State
'FillField WordDoc, "FirstLegalDate", If Is Null(Forms!foreclosureDetails![567]),"",
FillField WordDoc, "FirstLegalDate", Nz(Forms!ForeclosureDetails!FirstLegal, " No Date Selected")

FillField WordDoc, "PropertyAddressT", Forms!ForeclosureDetails!PropertyAddress & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt]) & ", " & Forms!ForeclosureDetails!City & ", " & Forms!ForeclosureDetails!State & " " & FormatZip(Forms!ForeclosureDetails!ZipCode)
FillField WordDoc, "ContactNameT", GetLoginName() & "     " & GetStaffEmail()
FillField WordDoc, "ReturnAddress", IIf(Forms!ForeclosureDetails!State = "VA", "Commonwealth Trustees c/o Rosenberg and Associates, 8601 Westwood Center Drive, Ste 255, Vienna, VA 22182", "Rosenberg & Associates, LLC, Attn: Dockets Team, 4340 East West Highway, Ste 600, Bethesda, MD 20814")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Cover Letter CHAM.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Champion Cover Letter MA.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_CHAMCoverSheetMAActive(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Cover Letter CHAM MilitaryAffidavitActive")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Cover Letter CHAM MilitaryAffidavitActive.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

FillField WordDoc, "ClientLoanT", Forms!ForeclosureDetails!LoanNumber
FillField WordDoc, "State", Forms!ForeclosureDetails!State
'FillField WordDoc, "FirstLegalDate", If Is Null(Forms!foreclosureDetails![567]),"",
FillField WordDoc, "FirstLegalDate", Nz(Forms!ForeclosureDetails!FirstLegal, " No Date Selected")

FillField WordDoc, "PropertyAddressT", Forms!ForeclosureDetails!PropertyAddress & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt]) & ", " & Forms!ForeclosureDetails!City & ", " & Forms!ForeclosureDetails!State & " " & FormatZip(Forms!ForeclosureDetails!ZipCode)
FillField WordDoc, "ContactNameT", GetLoginName() & "     " & GetStaffEmail()
FillField WordDoc, "ReturnAddress", IIf(Forms!ForeclosureDetails!State = "VA", "Commonwealth Trustees c/o Rosenberg and Associates, 8601 Westwood Center Drive, Ste 255, Vienna, VA 22182", "Rosenberg & Associates, LLC, Attn: Dockets Team, 4340 East West Highway, Ste 600, Bethesda, MD 20814")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Cover Letter CHAM.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Champion Cover Letter MAActive.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_CHAMCoverSheetMaNoSSN(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Cover Letter CHAM MilitaryAffidavitNoSSN")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Cover Letter CHAM MilitaryAffidavitNoSSN.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

FillField WordDoc, "ClientLoanT", Forms!ForeclosureDetails!LoanNumber
FillField WordDoc, "State", Forms!ForeclosureDetails!State
'FillField WordDoc, "FirstLegalDate", If Is Null(Forms!foreclosureDetails![567]),"",
FillField WordDoc, "FirstLegalDate", Nz(Forms!ForeclosureDetails!FirstLegal, " No Date Selected")

FillField WordDoc, "PropertyAddressT", Forms!ForeclosureDetails!PropertyAddress & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt]) & ", " & Forms!ForeclosureDetails!City & ", " & Forms!ForeclosureDetails!State & " " & FormatZip(Forms!ForeclosureDetails!ZipCode)
FillField WordDoc, "ContactNameT", GetLoginName() & "     " & GetStaffEmail()
FillField WordDoc, "ReturnAddress", IIf(Forms!ForeclosureDetails!State = "VA", "Commonwealth Trustees c/o Rosenberg and Associates, 8601 Westwood Center Drive, Ste 255, Vienna, VA 22182", "Rosenberg & Associates, LLC, Attn: Dockets Team, 4340 East West Highway, Ste 600, Bethesda, MD 20814")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Cover Letter CHAM.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Champion Cover Letter MaNoSSN.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub


Public Sub Doc_CHAMCoverSheetNote(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Cover Letter CHAM NoteOwnership")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Cover Letter CHAM NoteOwnership.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

FillField WordDoc, "ClientLoanT", Forms!ForeclosureDetails!LoanNumber
FillField WordDoc, "State", Forms!ForeclosureDetails!State
'FillField WordDoc, "FirstLegalDate", If Is Null(Forms!foreclosureDetails![567]),"",
FillField WordDoc, "FirstLegalDate", Nz(Forms!ForeclosureDetails!FirstLegal, " No Date Selected")

FillField WordDoc, "PropertyAddressT", Forms!ForeclosureDetails!PropertyAddress & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt]) & ", " & Forms!ForeclosureDetails!City & ", " & Forms!ForeclosureDetails!State & " " & FormatZip(Forms!ForeclosureDetails!ZipCode)
FillField WordDoc, "ContactNameT", GetLoginName() & "     " & GetStaffEmail()
FillField WordDoc, "ReturnAddress", IIf(Forms!ForeclosureDetails!State = "VA", "Commonwealth Trustees c/o Rosenberg and Associates, 8601 Westwood Center Drive, Ste 255, Vienna, VA 22182", "Rosenberg & Associates, LLC, Attn: Dockets Team, 4340 East West Highway, Ste 600, Bethesda, MD 20814")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Cover Letter CHAM.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Champion Cover Letter Ownership Affidavit.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub


Public Sub Doc_CHAMCoverSheetSOD(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Cover Letter CHAM SOD")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Cover Letter CHAM SOD.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

FillField WordDoc, "ClientLoanT", Forms!ForeclosureDetails!LoanNumber
FillField WordDoc, "State", Forms!ForeclosureDetails!State
'FillField WordDoc, "FirstLegalDate", If Is Null(Forms!foreclosureDetails![567]),"",
FillField WordDoc, "FirstLegalDate", Nz(Forms!ForeclosureDetails!FirstLegal, " No Date Selected")

FillField WordDoc, "PropertyAddressT", Forms!ForeclosureDetails!PropertyAddress & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt]) & ", " & Forms!ForeclosureDetails!City & ", " & Forms!ForeclosureDetails!State & " " & FormatZip(Forms!ForeclosureDetails!ZipCode)
FillField WordDoc, "ContactNameT", GetLoginName() & "     " & GetStaffEmail()
FillField WordDoc, "ReturnAddress", IIf(Forms!ForeclosureDetails!State = "VA", "Commonwealth Trustees c/o Rosenberg and Associates, 8601 Westwood Center Drive, Ste 255, Vienna, VA 22182", "Rosenberg & Associates, LLC, Attn: Dockets Team, 4340 East West Highway, Ste 600, Bethesda, MD 20814")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Cover Letter CHAM.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Champion Cover Letter SOD.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_CHAMCoverSheetSOD2(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Cover Letter CHAM SOD2")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Cover Letter CHAM SOD2.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

FillField WordDoc, "ClientLoanT", Forms!ForeclosureDetails!LoanNumber
FillField WordDoc, "State", Forms!ForeclosureDetails!State
'FillField WordDoc, "FirstLegalDate", If Is Null(Forms!foreclosureDetails![567]),"",
FillField WordDoc, "FirstLegalDate", Nz(Forms!ForeclosureDetails!FirstLegal, " No Date Selected")

FillField WordDoc, "PropertyAddressT", Forms!ForeclosureDetails!PropertyAddress & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt]) & ", " & Forms!ForeclosureDetails!City & ", " & Forms!ForeclosureDetails!State & " " & FormatZip(Forms!ForeclosureDetails!ZipCode)
FillField WordDoc, "ContactNameT", GetLoginName() & "     " & GetStaffEmail()
FillField WordDoc, "ReturnAddress", IIf(Forms!ForeclosureDetails!State = "VA", "Commonwealth Trustees c/o Rosenberg and Associates, 8601 Westwood Center Drive, Ste 255, Vienna, VA 22182", "Rosenberg & Associates, LLC, Attn: Dockets Team, 4340 East West Highway, Ste 600, Bethesda, MD 20814")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Cover Letter CHAM.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Champion Cover Letter SoDwFigures.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_DismissCase(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim templateName As String
Dim BankName As String
Dim rsDismiss As Recordset
Dim sql As String

sql = "SELECT FormatName([Company],IIf([deceased]=Yes,""Estate of "" & [First],[First]),[Last],[AKA],[Address],[Address2],[City],[State],[Zip])"
sql = sql + " AS FmtNames FROM [Names]"
sql = sql + " WHERE  ((Names.FileNumber= " & [Forms]![case list]![FileNumber] & ") AND Names.COS = True);"
'"WHERE (((CaseList.FileNumber)=" & [Forms]![Case List]![FileNumber] & ") AND JurisdictionList.CountyAttnyAddr Is Not Null);"

Set rsDismiss = CurrentDb.OpenRecordset(sql, dbOpenSnapshot)

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data especially Name Tab, Please be sure that COS box is checked or contact programmers"
    Exit Sub
End If

templateName = "Dismiss Case"
BankName = "Dismiss Case"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

'margin address:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
        FillField WordDoc, "FirmPhone", FirmPhoneVA()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
        FillField WordDoc, "FirmPhone", FirmPhone()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
        FillField WordDoc, "FirmPhone", FirmPhone()
    End If

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", IIf(Not IsNull(d![CourtCaseNumber]), d![CourtCaseNumber], " _____________________ ")

FillField WordDoc, "FirmName", FirmName()
FillField WordDoc, "FirmShortAddress", FirmShortAddress()
FillField WordDoc, "Date", Format$(Date, "mmmm d, yyyy")
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 1345, "")
Dim MDBar As String
MDBar = DLookup("MDBar", "Staff", "ID =" & [Forms]![foreclosurePrint]![Attorney].Column(0))
'FillField WordDoc, "CPTF", IIf(d![FCdetails.State] = "MD", IIf(IsNull(MDBar), "", ", CPTF # " & MDBar), "")
FillField WordDoc, "AttorneyName", Nz(d!AttorneyName) & ", Esq." & IIf(d![FCdetails.State] = "MD", IIf(IsNull(MDBar), "", ", CPTF # " & MDBar), "")
Dim itemcount As Integer
Dim i As Integer
Dim itemFields As String

'grumble grumble
If rsDismiss.EOF Then
    FillField WordDoc, "Fmtnames", ""
Else
    rsDismiss.MoveLast
    itemcount = rsDismiss.RecordCount
    rsDismiss.MoveFirst
    For i = 1 To itemcount
        itemFields = itemFields + rsDismiss!FmtNames + vbCrLf + vbCrLf
        rsDismiss.MoveNext
    Next i
    FillField WordDoc, "FmtNames", itemFields
End If

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & BankName & ".doc"
''Call SaveDoc(WordDoc, d![CaseList.FileNumber], BankName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_LandInstruments(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim templateName As String
Dim BankName As String
Dim d As Recordset
Dim sql As String
Dim strCriteria As String
Dim i As Integer
Dim strTrustees As String

Set d = CurrentDb.OpenRecordset("qryMDLandInstruments", dbOpenSnapshot)
strCriteria = "Filenumber = " & Forms!ForeclosureDetails!FileNumber & ""
If Not (d.EOF And d.BOF) Then
    d.MoveFirst
    d.FindFirst (strCriteria)
    If d.NoMatch Then
        MsgBox "The file might missing data, please check all the data required or contact programmers"
        Exit Sub
    Else
    End If
Else
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If
    
templateName = "MD Land Instruments"
BankName = "MD Land Instruments"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
WordObj.Visible = True

FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "Property", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d!State
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "SalePrice", Nz(d!SalePrice, 0#)
FillField WordDoc, "TaxID", Nz(d!TaxID, "")
FillField WordDoc, "Fsmpl", IIf(d!Leasehold = 1, " ", "X")
FillField WordDoc, "GR", IIf(d!Leasehold = 1, "X", " ")

strTrustees = ""
    For i = 0 To Forms!ForeclosureDetails!lstTrustees.ListCount - 1
        If i < Forms!ForeclosureDetails!lstTrustees.ListCount - 1 Then
            If i < Forms!ForeclosureDetails!lstTrustees.ListCount - 2 Then
                strTrustees = strTrustees & Forms!ForeclosureDetails!lstTrustees.Column(1, i) & ", "
            Else
                strTrustees = strTrustees & Forms!ForeclosureDetails!lstTrustees.Column(1, i) & " and "
            End If
        Else
             strTrustees = strTrustees & Forms!ForeclosureDetails!lstTrustees.Column(1, i)
        End If
    Next i

FillField WordDoc, "Attorneys", strTrustees
FillField WordDoc, "Owners", OwnerNames(0, 2)
FillField WordDoc, "Purchaser", Nz(d!Purchaser, "")
FillField WordDoc, "PurchaserAddr", Nz(d!PurchaserAddress, "")
FillField WordDoc, "LoginName", GetLoginName()
FillField WordDoc, "FirmAddr", FirmShortAddressOneLine()
FillField WordDoc, "Recordation", Nz(d!RecordationTax, "")
FillField WordDoc, "StTransfer", Nz(d!StateTransTax, "")
FillField WordDoc, "CoTransfer", Nz(d!CountyTransTax, "")
FillField WordDoc, "District", Nz(d!District, "")
FillField WordDoc, "Map", Nz(d!Map, "")
FillField WordDoc, "Parcel", Nz(d!ParcelNo, "")
FillField WordDoc, "SubDivision", Nz(d!SubdivisionName, "")
FillField WordDoc, "Lot", Nz(d!Lot, "")
FillField WordDoc, "Block", Nz(d!Block, "")
FillField WordDoc, "Section", Nz(d!Section, "")
FillField WordDoc, "PlatRef", Nz(d!PlatRef, "")
FillField WordDoc, "SqFt", Nz(d!SqFt, "")
FillField WordDoc, "OtherProperty", Nz(d!OtherPropAddress, "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & BankName & ".doc"
'Call SaveDoc(WordDoc, d!FileNumber, BankName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing

d.Close
Set d = Nothing
End Sub

Public Sub Doc_MediationCourtNotesWells(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryWellsCourtMediation WHERE FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Mediation Court Notes Wells")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Mediation Court Notes Wells.doc", False)
WordObj.Visible = True

FillField WordDoc, "ClientName", d!LongClientName
FillField WordDoc, "Date", Format(Date, "mmmm, d, yyyy")
FillField WordDoc, "Loan", Nz(d![LoanNumber], "__________________")
FillField WordDoc, "Borrower", Nz(BorrowerNames(0), "____________________")
FillField WordDoc, "MedCaseNumber", Nz(d![MedCaseNumber], "__________________")
FillField WordDoc, "CourtCaseNumber", Nz(d![CourtCaseNumber], "__________________")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Wells Mediation Court Notes.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Wells Mediation Court Notes.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub DOC_Payoff(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, dd  As Recordset
Dim itemsFields As String
Dim TotalAmt As Currency
Dim itemcount, i, ii As Integer
Dim templateName As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE Caselist.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

templateName = "Payoff"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
WordObj.Visible = True

FillField WordDoc, "Date", Format$(Date, "mmmm d, yyyy")
FillField WordDoc, "To", Nz(Forms![Print Payoff]!To, "")
FillField WordDoc, "LoanNo", d!LoanNumber
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
FillField WordDoc, "PropertyADDR", d!PropertyAddress & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "FileNumber", Forms![case list].FileNumber
FillField WordDoc, "Dear", Nz(Forms![Print Payoff].[PayoffLetterSalutation], "")
FillField WordDoc, "ClientNameAsinvestor", d!ClientNameAsInvestor
FillField WordDoc, "PayoffOrReinstate", IIf([Forms]![Print Payoff]![optDocType] = 1, _
    "pay off the above referenced loan is " & Format$([Forms]![Print Payoff]![sfrmPayoff]![Total], "Currency"), _
    "reinstate the above referenced loan is " & Format$([Forms]![Print Payoff]![sfrmPayoff]![Total], "Currency"))
    
Set dd = CurrentDb.OpenRecordset("SELECT DISTINCTROW Payoff.FileNumber, Payoff.Timestamp, Payoff.Desc, Payoff.Amount, Payoff.ID From Payoff where FileNumber = " & Forms![case list]!FileNumber, dbOpenSnapshot)
If dd.EOF Then
    FillField WordDoc, "PayoffTable", ""
Else
    itemsFields = ""
    dd.MoveLast
    itemcount = dd.RecordCount
    For i = 1 To itemcount
        itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
    Next
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1)
    FillField WordDoc, "PayoffTable", itemsFields
    dd.MoveFirst
    
    For ii = 1 To itemcount
        FillField WordDoc, "item" & ii, dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency")
        TotalAmt = TotalAmt + Nz(dd!Amount, 0)
        dd.MoveNext
        'FillField WordDoc, "Tamt", TotalAmt
    Next
        FillField WordDoc, "Tamt", Format$(TotalAmt, "currency")
End If
dd.Close

FillField WordDoc, "chkClient", IIf(d![ClientID] = 157, "Reinstatements do not include any amounts that may be due and owing after an escrow analysis for outstanding taxes and insurance is completed.  ", "")
FillField WordDoc, "GoodThru", Format(Forms![Print Payoff]!GoodThru, "mmmm d"", ""yyyy")
FillField WordDoc, "chkSale", IIf([Forms]![Print Payoff]![chSale], " at 5:00 PM Eastern Time", "")
FillField WordDoc, "chkQuickLoan", IIf(d!ClientID = 575, "", "Estimated attorney fees and costs are included in this figure. ")
FillField WordDoc, "chkSale2", IIf([Forms]![Print Payoff]![chSale], "If funds are not received by " & Format$([Forms]![Print Payoff]![GoodThru], "mmmm d"", ""yyyy") & " at 5:00 PM Eastern Time, " & _
         "the foreclosure sale will go forward and be held accordingly. ", _
        "Please be advised that interest and expenses will continue to accrue after " & Format$([Forms]![Print Payoff]![GoodThru], "mmmm d"", ""yyyy") & ". If funds are not received by " & Format$([Forms]![Print Payoff]![GoodThru], "mmmm d"", ""yyyy") & ", the amount needed to " & IIf([Forms]![Print Payoff]![optDocType] = 1, "pay off", "reinstate") & " will increase. ")
FillField WordDoc, "PorR", IIf([Forms]![Print Payoff]![optDocType] = 1, "pay off", "reinstate")
FillField WordDoc, "FirmName", FirmName()
FillField WordDoc, "FirmNameMD", FirmName("MD")
FillField WordDoc, "FirmName2", IIf(d!ClientID = 575, "Quicken Loans, Inc.", FirmName())
FillField WordDoc, "FirmName3", IIf(d!ClientID = 575, "Quicken Loans, Inc., ", FirmName())
FillField WordDoc, "ClientAdd", IIf(d!ClientID = 575, ", 635 Woodward Avenue, Detroit, MI 48226, Attn: Servicing Payment Services Team.", " at the above referenced Bethesda, MD address.")
WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & templateName & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], templateName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges

Set WordObj = Nothing
d.Close

Set d = Nothing
Set dd = Nothing

End Sub

Public Sub Doc_PayoffJPRI(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, dd, ddd As Recordset     ' data
Dim TotalItems As Currency
Dim itemsFields As String
Dim itemsfields2 As String
Dim strsql, strSQL2 As String
Dim itemcount As Integer
Dim i As Integer
Dim itemcount2 As Integer
Dim ii As Integer
Dim templateName As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE Caselist.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If d![FCdetails.State] = "VA" Then
    templateName = "PayOffJPRIVA"
Else
    templateName = "PayoffJPRI"
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
WordObj.Visible = True

strsql = "SELECT DISTINCTROW Payoff.FileNumber, Payoff.Timestamp, Payoff.Desc, Payoff.Amount, Payoff.ID"
strsql = strsql + " FROM Payoff"
strsql = strsql + " WHERE Payoff.Desc Not Like ""Accrued Interest*"" AND payoff.FileNumber = " & Forms![case list]!FileNumber & ";"

'strSQL2 = "SELECT DISTINCTROW Payoff.FileNumber, Payoff.Timestamp, Payoff.Desc, Payoff.Amount, Payoff.ID"
'strSQL2 = strSQL2 + " FROM Payoff"
'strSQL2 = strSQL2 + " WHERE Payoff.Desc Like ""Accrued Interest*"" AND payoff.filenumber = " & Forms![case list]!FileNumber & ";"
' Maybe save this for Reinstatement?

TotalItems = 0
itemsFields = ""

Set dd = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot) 'Should we order it by something?
If dd.EOF Then
    FillField WordDoc, "Line_Items", ""
Else
    dd.MoveLast
    itemcount = dd.RecordCount
    ' Make enough lines
    For i = 1 To itemcount
        itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
    Next i
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
    FillField WordDoc, "Line_Items", itemsFields
    dd.MoveFirst
    i = 1
    Do While Not dd.EOF
        FillField WordDoc, "Item" & i, dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency")
        'FillField WordDoc, "Item" & i, dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency")
        TotalItems = TotalItems + Nz(dd!Amount, 0)
        dd.MoveNext
        i = i + 1
       
    Loop
End If
dd.Close

'itemfields2 = ""
'Set ddd = CurrentDb.OpenRecordset(strSQL2, dbOpenSnapshot) 'This is kind of dumb
'If ddd.EOF Then
'    FillField WordDoc, "Line_Items2", ""
'Else
'    ddd.MoveLast
'    itemcount2 = ddd.RecordCount
'    ' Make enough lines
'    For ii = 1 To itemcount2
'        itemsfields2 = itemsfields2 & "<<Item2" & ii & ">>" & vbCr
'    Next ii
'    itemsfields2 = Left$(itemsfields2, Len(itemsfields2) - 1) ' remove trailing CR
'    FillField WordDoc, "Line_Items2", itemsfields2
'    ddd.MoveFirst
'    ii = 1
'    Do While Not ddd.EOF
'        FillField WordDoc, "Item2" & ii, ddd!Desc & vbTab & Format$(Nz(ddd!Amount, 0), "Currency")
'        'FillField WordDoc, "Item" & i, dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency")
'        totalItems = totalItems + Nz(ddd!Amount, 0)
'        ddd.MoveNext
'        ii = i + 1
'
'    Loop
'End If
'ddd.Close

FillField WordDoc, "Date", Format$(Date, "mmmm d, yyyy")
FillField WordDoc, "To", Forms![Print Payoff]!To
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Mortgagors", MortgagorNames(0, 2)
FillField WordDoc, "PropertyADDRESS", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "ZipCODE", FormatZip(d!ZipCode)
FillField WordDoc, "FileNumber", Forms![case list].FileNumber
FillField WordDoc, "DueDate", Format$(Forms![Print Payoff].DutDate, "mmmm d"", ""yyyy")
FillField WordDoc, "Salutation", Forms![Print Payoff].[PayoffLetterSalutation]
FillField WordDoc, "Delinquent", Format(TotalItems, "Currency")
FillField WordDoc, "GoodThrough", Format(Forms![Print Payoff]!GoodThru, "mmmm d"", ""yyyy")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & templateName & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], templateName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges

Set WordObj = Nothing
d.Close
dd.Close
Set d = Nothing
Set dd = Nothing
End Sub

Public Sub Doc_ReadAtSale(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim Due As String
Dim tax As String
Dim d As Recordset      ' data
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE Caselist.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Read at Sale")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Read at Sale.doc", False)
WordObj.Visible = True

Select Case d![FCdetails.State]
    Case "MD", "DC"
        Due = "ten (10) days after ratification of sale"
        tax = "all transfer taxes"
    Case "VA"
        Due = "fifteen (15) days of sale"
        tax = "Grantor's tax"
End Select

FillField WordDoc, "Title", UCase$(TrusteeWord(0, 1))
FillField WordDoc, "PropertyADDRESS", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "VAWords", IIf(d![FCdetails.State] = "VA", "on the remaining unpaid principal purchase price ", "")
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "ZipCODE", FormatZip(d!ZipCode)
FillField WordDoc, "Mortgagors", IIf(IsNull(d![OriginalMortgagors]), MortgagorNames(0, 2), d![OriginalMortgagors] & " assumed by " & MortgagorNames(0, 2))
FillField WordDoc, "DOTDate", Format$(d![DOTdate], "mmmm d"", ""yyyy")
FillField WordDoc, "LiberFolio", LiberFolio(d![Liber], d![Folio], d![FCdetails.State])
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "LongState", Nz(d!LongState)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "TrusteeNames", trusteeNames(0, 2)
FillField WordDoc, "SaleLocation", Nz(d!SaleLocation, "_____________________")
FillField WordDoc, "SaleTime", Format$(d![Sale], "dddd"", ""mmmm d"", ""yyyy") & " at " & Format$(d![SaleTime], "h:nn AM/PM")
FillField WordDoc, "LegalDescription", d!LegalDescription
FillField WordDoc, "IRS", IIf(d![IRSLiens], "  The property will be sold subject to a 120 day right of redemption by the Internal Revenue Service.", "")
FillField WordDoc, "Deposit", Format$(d![Deposit], "Currency")
FillField WordDoc, "Due", Due
FillField WordDoc, "Tax", tax
FillField WordDoc, "VANotice", IIf(d![FCdetails.State] = "VA", "       Written notice of this " & TrusteeWord(0, 1) & "'s sale, as required by Section 55-59.1 of the 1950 Code of Virginia, as amended, has been sent to the property owners as their addresses appear in the records of the noteholder, and to all parties prescribed therein.", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Read at Sale.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Read at Sale.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_ContractForSale(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim Due As String
Dim tax As String
Dim d As Recordset      ' data
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE Caselist.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Contract for Sale")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Contract for Sale.doc", False)
WordObj.Visible = True

Select Case d![FCdetails.State]
    Case "MD", "DC"
        Due = "ten (10) days after ratification of sale"
        tax = "all transfer taxes"
    Case "VA"
        Due = "fifteen (15) days of sale"
        tax = "Grantor's tax"
End Select

'FillField WordDoc, "Title", UCase$(TrusteeWord(0, 1))
FillField WordDoc, "PropertyADDRESS", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "VAWords", IIf(d![FCdetails.State] = "VA", "on the remaining unpaid principal purchase price ", "")
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "ZipCODE", FormatZip(d!ZipCode)
If IsNull(d!Sale) Then
FillField WordDoc, "Sale", "_________________"
Else
FillField WordDoc, "Sale", IIf(IsNull(d!Sale) Or d!Sale = "", "_________________", ThisDate(d![Sale]))
End If
FillField WordDoc, "LiberFolio", LiberFolio(d![Liber], d![Folio], d![FCdetails.State])
If IsNull(d![Deposit]) Then
FillField WordDoc, "Deposit", "_________________________ Dollars" & " ($_____________)"
Else
FillField WordDoc, "Deposit", IIf(IsNull(d![Deposit]), "______________________________ Dollars", CurrencyWords(d![Deposit])) & " (" & IIf(IsNull(d![Deposit]), "$___________", Format$(d![Deposit], "Currency"))
End If
FillField WordDoc, "FirmAddress", OneLine(FirmAddress())
FillField WordDoc, "FirmPhone", FirmPhone()

'FillField WordDoc, "Mortgagors", IIf(IsNull(d![OriginalMortgagors]), MortgagorNames(0, 2), d![OriginalMortgagors] & " assumed by " & MortgagorNames(0, 2))'''''
'FillField WordDoc, "DOTDate", Format$(d![DOTdate], "mmmm d"", ""yyyy")
'FillField WordDoc, "LiberFolio", LiberFolio(d![Liber], d![Folio], d![FCdetails.State])
'FillField WordDoc, "Jurisdiction", d!Jurisdiction
'FillField WordDoc, "LongState", d!LongState
'FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "TrusteeNames", trusteeNames(0, 2)
'FillField WordDoc, "SaleLocation", d!SaleLocation
'FillField WordDoc, "SaleTime", Format$(d![Sale], "dddd"", ""mmmm d"", ""yyyy") & " at " & Format$(d![SaleTime], "h:nn AM/PM")
'FillField WordDoc, "LegalDescription", d!LegalDescription
FillField WordDoc, "IRSLiens", IIf(d![IRSLiens], "  The property will be sold subject to a 120 day right of redemption by the Internal Revenue Service.", "")

FillField WordDoc, "Due", Due
FillField WordDoc, "Tax", tax
'FillField WordDoc, "VANotice", IIf(d![FCdetails.State] = "VA", "       Written notice of this " & TrusteeWord(0, 1) & "'s sale, as required by Section 55-59.1 of the 1950 Code of Virginia, as amended, has been sent to the property owners as their addresses appear in the records of the noteholder, and to all parties prescribed therein.", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Contract For Sale.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Contract For Sale.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub doc_HUDConveyanceCoverLetter(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRptHUDConvWord WHERE FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("HUDConveyanceCoverLetter")
Set WordDoc = WordObj.Documents.Open(EMailPath & "HUDConveyanceCoverLetter.doc", False)
WordObj.Visible = True

FillField WordDoc, "ConvDate", Format$(d![Conveyancedate], "mmmm dd"", ""yyyy")
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "investorAddr", d!InvestorAddress
FillField WordDoc, "Owners", GetNames(0, 2, "Owner = True")
FillField WordDoc, "PropAddr", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "FileNumber", d!FileNumber
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "FHANumber", d!FHALoanNumber
FillField WordDoc, "LoginName", GetLoginName()
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "JurisdictionAddr", d!CourtAddress

WordObj.Selection.HomeKey wdStory, wdMove
'WordObj.PrintPreview = True
Set WordObj = Nothing
d.Close

End Sub

Public Sub doc_HUDFTPCover(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRptHUDFTPWord WHERE FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("HUDFTPCover")
Set WordDoc = WordObj.Documents.Open(EMailPath & "HUDFTPCover.doc", False)
WordObj.Visible = True

FillField WordDoc, "Date", Format$(Date, "mmmm dd"", ""yyyy")
FillField WordDoc, "Client", DLookup("longclientName", "clientList", "clientID= " & [Forms]![case list]![ClientID])
FillField WordDoc, "Owners", GetNames(0, 2, "Owner = True")
FillField WordDoc, "PropAddr", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "FileNumber", d!FileNumber
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "FHANumber", d!FHALoanNumber
FillField WordDoc, "LoginName", GetLoginName()
FillField WordDoc, "SaleDate", Format$(d![Sale], "mmmm dd"", ""yyyy")
'FillField WordDoc, "JurisdictionAddr", d!CourtAddress

WordObj.Selection.HomeKey wdStory, wdMove
'WordObj.PrintPreview = True
Set WordObj = Nothing
d.Close

End Sub

Public Sub doc_VAFTPCover(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRptVAFTPMDWord WHERE FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("VAFTPCover")
Set WordDoc = WordObj.Documents.Open(EMailPath & "VAFTPCover.doc", False)
WordObj.Visible = True

FillField WordDoc, "Date", Format$(Date, "mmmm dd"", ""yyyy")
FillField WordDoc, "Client", DLookup("longclientName", "clientList", "clientID= " & [Forms]![case list]![ClientID])
FillField WordDoc, "Owners", GetNames(0, 2, "Owner = True")
FillField WordDoc, "PropertyAddr", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "FileNumber", d!FileNumber
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "FHANumber", d!FHALoanNumber
FillField WordDoc, "XX1", IIf(d!State = "VA", "Substitute", "")
FillField WordDoc, "XX3", IIf(d!State = "VA", "Copy of recorded Deed of Trust (including copies of any recorded Assignments of Deed of Trust);", _
        "Copy of Order to Docket/Complaint (incl. NOI, Preliminary and/or Final Loss Mitigation Affidavit, " & _
        "Military Affidavit, Copy of Note, Copy of Recorded Deed of Trust; Copy of Certificate of Publication);")
FillField WordDoc, "XX4", IIf(d!State = "VA", "Copy of Original Note;", "Copy of Recorded Assignments of Deed of Trust (if applicable);")
FillField WordDoc, "XX6", IIf(d!State = "VA", "Copy of Certificate of Publication;", "Copy of Consent Motion and Order to Substitute Purchaser;")
FillField WordDoc, "XX7", IIf(d!State = "VA", "Copy of Notice(s) of Sale (including postage/envelopes);", _
            "Copy of Notices of Foreclosure Sale (incl. envelopes for certified and regular mail);")
FillField WordDoc, "XX8", IIf(d!State = "VA", "Copy of the recorded Appointment of Substitute Trustee(s);", "Copy of Order of Ratification;")
FillField WordDoc, "XX9", IIf(d!State = "VA", "Copy of Military Affidavit(s) for all mortgagors with SCRA search(es)", _
            "Copy of Recorded Appointment of Substitute Trustees;")
FillField WordDoc, "LoginName", GetLoginName()
FillField WordDoc, "SaleDate", Format$(d![Sale], "mmmm dd"", ""yyyy")
'FillField WordDoc, "JurisdictionAddr", d!CourtAddress

WordObj.Selection.HomeKey wdStory, wdMove
'WordObj.PrintPreview = True
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_HUDDEEDVA(KeepOpen As Boolean)

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim Due As String
Dim tax As String
Dim d As Recordset      ' data
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryHUDDeedVA WHERE FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("HUD Deed VA")
Set WordDoc = WordObj.Documents.Open(EMailPath & "HUD Deed VA.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("Atty").Select
WordDoc.Bookmarks("Atty").Range.Text = d!NameVA
WordDoc.Bookmarks("VABar").Select
WordDoc.Bookmarks("VABar").Range.Text = d!VABar
WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("Property").Select
WordDoc.Bookmarks("Property").Range.Text = d![PropertyAddress] & ", " & d!City & ", VA " & FormatZip(d!ZipCode)

FillField WordDoc, "TaxID", d!TaxID
FillField WordDoc, "TrusteeNames", UCase$(trusteeNames(0, 2))
FillField WordDoc, "Mortgagors1", IIf(IsNull(d![OriginalMortgagors]), MortgagorNamesCaps(0, 2, 2), UCase$(d![OriginalMortgagors]) & " assumed by " & _
MortgagorNamesCaps(0, 2, 2))
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "HUDAddress", Nz(d!HUDAddress1Line, "")
FillField WordDoc, "DOTDate", Format$(d![DOTdate], "mmmm d"", ""yyyy")
FillField WordDoc, "LiberFolio", LiberFolio(d![Liber], d![Folio], "VA")
FillField WordDoc, "State", IIf(d![State] = "VA", "Clerk's Office, Circuit Court of ", "")
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "Mortgagors2", IIf(IsNull(d![OriginalMortgagors]), MortgagorNames(0, 2), d![OriginalMortgagors])
FillField WordDoc, "OriginalTrustee", d!OriginalTrustee
FillField WordDoc, "OriginalPBal", Format$(d![OriginalPBal], "Currency")
FillField WordDoc, "OriginalBene", d!OriginalBeneficiary
FillField WordDoc, "DeedRec", Format(d![DeedAppRecorded], "mmmm d"", ""yyyy")
FillField WordDoc, "LiberDeed", LiberFolio(d![DeedAppLiber], d![DeedAppFolio], d![FCdetails.State])
FillField WordDoc, "Consideration", Format$(d![SalePrice], "Currency")
FillField WordDoc, "Assessed", Format$(d![AssessedValue], "Currency")
FillField WordDoc, "SaleTime", IIf(IsNull(d![SaleTime]), "__________", Format$(d![SaleTime], "h:nn AM/PM"))
FillField WordDoc, "Sale", IIf(IsNull(d![Sale]), "_________________________", Format$(d![Sale], "mmmm d"", ""yyyy"))
FillField WordDoc, "SaleLocation", d!SaleLocation
FillField WordDoc, "LongState", d!LongState 'JurisdictionList.Longstate
FillField WordDoc, "SalePrice", IIf(IsNull(d![SalePrice]), "$_____________", Format$(d![SalePrice], "Currency"))
FillField WordDoc, "Lien", IIf(d![LienPosition] <= 1, "", ", subject to paying off senior lien(s)")
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
FillField WordDoc, "AttorneyName", d!AttorneyName
FillField WordDoc, "CommonwealthTitle", d!CommonwealthTitle
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID)
FillField WordDoc, "NotaryName", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "NotaryExpires", NotaryExpires()
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & ", " & d!City & ", VA " & FormatZip(d!ZipCode)

WordObj.Selection.HomeKey wdStory, wdMove
WordObj.PrintPreview = True
'WordDoc.SaveAs EMailPath & "HUD Deed VA.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "HUD Deed VA.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_AuditFiling(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim templateName As String
Dim BankName As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

templateName = "Line Notifying of Audit Filing"
Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]

If d![FCdetails.State] = "VA" Or d![FCdetails.State] = "DC" Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
ElseIf d![FCdetails.State] = "MD" Then
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
'ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'how do we print chespk if there's no option for it...
'        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
'             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
End If

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
'FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", IIf(Not IsNull(d![CourtCaseNumber]), d![CourtCaseNumber], " _____________________ ")
FillField WordDoc, "Attorney", Forms![Audit - MD].Attorney.Column(1)
FillField WordDoc, "CPTF", "CPTF# " & IIf(IsNull(DLookup("MDBar", "Staff", "ID=" & [Forms]![Audit - MD].[Attorney].Column(0))), "            ", _
                DLookup("MDBar", "Staff", "ID=" & [Forms]![Audit - MD].[Attorney].Column(0)))
FillField WordDoc, "AttnyEmail", DLookup("email", "Staff", "ID=" & [Forms]![Audit - MD].[Attorney].Column(0))
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 1345, "")
FillField WordDoc, "Year", Format(Date, "yyyy")
FillField WordDoc, "CosNames", COSNamesAddress(0)

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Line Notifying of Audit Filing.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Line Notifying of Audit Filing.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_ReturnDocCoverLTR(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim sqlstring As String
Dim itemsFields As String
Dim dd As Recordset
Dim itemcount As Integer
Dim i As Integer
Dim Num As Integer

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryReturnDocs WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Return Doc Cover LTR")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Return Doc Cover LTR.doc", False)
WordObj.Visible = True
FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
FillField WordDoc, "ReturnName", IIf(IsNull(d![COLLName] = True), d![LongClientName], d![COLLName])
FillField WordDoc, "CollAddress", IIf(IsNull(d!COLLAddress = True), "", d!COLLAddress)      'Mei doc can't open if CollAddress is null. 09/10/15
FillField WordDoc, "CollAddress2", IIf(d![COLLAddress2] = Null, d![COLLCity] & ", " & d![COLLState] & " " & d![COLLZip], d![COLLAddress2] & vbCrLf _
 & d![COLLCity] & ", " & d![COLLState] & " " & FormatZip(d![COLLZip]))

FillField WordDoc, "PrimaryDefName", d!PrimaryDefName
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & " " & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt] & ", ") & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "FileNumber", d!FileNumber
FillField WordDoc, "LoginName", GetLoginName()

Dim itemFields As String
'totalItems = 0
itemsFields = ""
Num = 1

Set dd = CurrentDb.OpenRecordset("SELECT DocDescription FROM ReturnedDocs WHERE FileNumber=" & d![FileNumber] & ";", dbOpenSnapshot)

If dd.EOF Then
    FillField WordDoc, "line_items", ""
Else
    dd.MoveLast
    itemcount = dd.RecordCount
    dd.MoveFirst
    For i = 1 To itemcount
        itemFields = itemFields & i & ". " & dd!DocDescription + vbCrLf + vbCrLf
        dd.MoveNext
    Next i
    FillField WordDoc, "line_items", itemFields
End If

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Return Doc Cover LTR.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Return Doc Cover LTR.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_LisPendens(KeepOpen As Boolean)
'Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
'Dim d As Recordset      ' data
'
'Set d = CurrentDb.OpenRecordset("SELECT * FROM qryLisPendens WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
'If d.EOF Then
'    MsgBox "The file might missing data, please check all the data required or contact programmers"
'    Exit Sub
'End If
'
'Set WordObj = CreateObject("Word.Application")
'Call OpenDocAsSaved("Notice of Lis Pendens")
'Set WordDoc = WordObj.Documents.Open(EMailPath & "Notice of Lis Pendens.doc", False)
'WordObj.Visible = True
'
'FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
'FillField WordDoc, "ComplaintFiled", Format(d!ComplaintFiled, "mmmm d, yyyy")
'FillField WordDoc, "Investor", d!Investor
'FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
'FillField WordDoc, "Owners", OwnerNames(0, 2)
'FillField WordDoc, "CaseCaption", d![Investor] & " v. " & DefendantNames(0, 99)
'FillField WordDoc, "CaseNumber", d!CourtCaseNumber
'FillField WordDoc, "OriginalPBal", Format(d!OriginalPBal, "Currency")
'FillField WordDoc, "LegalDescription", d!LegalDescription
'FillField WordDoc, "AttyName", GetStaffFullName(Forms!ForeclosurePrint!Attorney.Column(0)) & " (" & FetchbarNumberPoundSign(Forms!ForeclosurePrint!Attorney, d![State]) & ")"
'
'WordObj.Selection.HomeKey wdStory, wdMove
''WordDoc.SaveAs EMailPath & "Notice of Lis Pendens.doc"
''Call SaveDoc(WordDoc, Forms![Case list].FileNumber, "Notice of Lis Pendens.doc")
''If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
'Set WordObj = Nothing
'd.Close

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim TimeDoc As String

TimeDoc = Format$(Now(), "yyyymmdd hhnnss")

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryLisPendens WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
'Call OpenDocAsSaved("Notice of Lis Pendens")
'Set WordDoc = WordObj.Documents.Open(EMailPath & "Notice of Lis Pendens.doc", False)
Dim check As Boolean
check = False

Select Case Forms!GetDocType!Frame1
Case 1

    Call SaveNewDocInRosie("Notice of Lis Pendens", d!FileNumber, 1600, TimeDoc)
    Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d!FileNumber) & "\" & d!FileNumber & "\" & "Notice of Lis Pendens" & " " & TimeDoc & ".doc", False)
    'Set WordDoc = WordObj.Documents.Open(EMailPath & "Notice of Lis Pendens.doc", False)
    check = True
Case 2
     Call OpenDocAsSaved("Notice of Lis Pendens")
    'Set WordDoc = WordObj.Documents.Open(filename:=EMailPath & "Notice of Lis Pendens.doc", ReadOnly:=True)
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Notice of Lis Pendens.doc", False)
    check = False
 End Select


WordObj.Visible = True

FillField WordDoc, "FirmAddress", IIf(IsNull(Forms![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 2, FirmShortAddressVA(), _
        IIf([Forms]![foreclosurePrint]![cboOfficeLocation] = 1, FirmShortAddress(), FirmShortAddressChspk()))
FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
FillField WordDoc, "ComplaintFiled", Format(d!ComplaintFiled, "mmmm d, yyyy")
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "Owners", OwnerNames(0, 2)
FillField WordDoc, "CaseCaption", d![Investor] & " v. " & DefendantNames(0, 99)
FillField WordDoc, "CaseNumber", IIf(IsNull(d!CourtCaseNumber), "", d!CourtCaseNumber)
FillField WordDoc, "OriginalPBal", Format(d!OriginalPBal, "Currency")
FillField WordDoc, "LegalDescription", d!LegalDescription
FillField WordDoc, "AttyName", GetStaffFullName(Forms!foreclosurePrint!Attorney.Column(0)) & " (" & FetchbarNumberPoundSign(Forms!foreclosurePrint!Attorney, d![State]) & ")"
FillField WordDoc, "FirmAddr", IIf(IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 2, FirmShortAddressVA(), _
            IIf([Forms]![foreclosurePrint]![cboOfficeLocation] = 1, FirmShortAddress(), FirmShortAddressChspk()))
WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Notice of Lis Pendens.doc"
'Call SaveDoc(WordDoc, Forms![Case list].FileNumber, "Notice of Lis Pendens.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
DoCmd.Close acForm, "GetDocType"
d.Close
Set d = Nothing
End Sub

Public Sub Doc_ReleaseofLisPendens(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim FileNo As Long
FileNo = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryLisPendens WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Release of Lis Pendens")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Release of Lis Pendens.doc", False)

WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = FileNo
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & vbCr & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])

'margin address:

    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
'        FillField WordDoc, "FirmPh", FirmPhoneVA()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
'        FillField WordDoc, "FirmPh", FirmPhone()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
'        FillField WordDoc, "FirmPh", FirmPhone()
    End If
    
FillField WordDoc, "FirmAddress", IIf(IsNull(Forms![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 2, FirmShortAddressVA(), _
        IIf([Forms]![foreclosurePrint]![cboOfficeLocation] = 1, FirmShortAddress(), FirmShortAddressChspk()))
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "Owners", d![PrimaryFirstName] & " " & d![PrimaryLastName] & IIf(IsNull(d![SecondaryLastName] & d![SecondaryFirstName]), ".", _
                " and " & d![SecondaryFirstName] & " " & d![SecondaryLastName] & ".")
FillField WordDoc, "PrimarySecondary", d![PrimaryFirstName] & " " & d![PrimaryLastName] & IIf(IsNull(d![SecondaryLastName] & d![SecondaryFirstName]), "", " et al.")
FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
FillField WordDoc, "LisPendensFiled", Format(Nz(d!LisPendensFiled), "mmmm, dd, yyyy")
FillField WordDoc, "LisPendensRecorded", Format(d!LisPendensrecorded, "mmmm, dd, yyyy")
FillField WordDoc, "LisPendenLiber", d!LisPendenLiber
FillField WordDoc, "LegalDescription", d!LegalDescription
FillField WordDoc, "Date", Format(Date, "mmmm, dd, yyyy")
FillField WordDoc, "AttyName", GetStaffFullName([Forms]![foreclosurePrint]![Attorney].Column(0))
FillField WordDoc, "DCBar", FetchbarNumberPoundSign(d![Attorney], d!State)
FillField WordDoc, "firmAddr", IIf(IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 2, FirmShortAddressVA(), _
                IIf([Forms]![foreclosurePrint]![cboOfficeLocation] = 1, FirmShortAddress(), FirmShortAddressChspk()))

WordObj.Selection.HomeKey wdStory, wdMove
Set WordObj = Nothing
DoCmd.Close acForm, "GetDocType"
d.Close
Set d = Nothing
End Sub

Public Sub Doc_ConsentTerminating13(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim FileNumber As Long, Judge As String, CoDebtor As Boolean, AffDate As String, AffInfo As String, Debtorsplural As Boolean

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBKDocsWord  WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)      'qryBKdocsConsentTerminating13

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")

    Call OpenDocAsSaved("ConsentTerminating13")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "ConsentTerminating13.doc", False)

WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![CaseList.FileNumber])
'WordDoc.Bookmarks("AttorneyInfo").Select

'RE-VISIT
'WordDoc.Bookmarks("AttorneyInfo").Range.Text = "Diane Rosenberg" & vbCr & "VA Bar 35237"

'margin address:
    If [Forms]![BankruptcyPrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
Judge = Right$(UCase$(d!CaseNo), 3)
CoDebtor = (GetNames(0, 1, "BKCoDebtor=True") <> "" And d![BKdetails.Chapter] = 13)

Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (BKOwner=True OR BKMortgagor=True)") > 1)

FillField WordDoc, "Header", _
    IIf(d![Districts.State] <> "VA", vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr, "") & _
    "IN THE UNITED STATES BANKRUPTCY COURT" & vbCr & _
    "FOR THE " & UCase$(d!Name) & vbCr & _
    d!Location

FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")

FillField WordDoc, "Investor", UCase$(d!Investor)

FillField WordDoc, "Respondents", _
   UCase$(GetNames(0, 3, IIf(d![BKdetails.Chapter] = 13, "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
                        "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"))) & _
                        IIf(d![BKdetails.Chapter] = 7, vbCr & vbCr & "and " & vbCr & vbCr & _
                        UCase$(Nz(d![First])) & " " & UCase$(Nz(d![Last])) & ", CHAPTER 7 TRUSTEE", "")
    
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]

If d![BKdetails.Chapter] = 13 Then
    Select Case Forms![Print Consent Order Terminating 13]!optTrustee
    Case 0
        FillField WordDoc, "TrusteeAction", "the parties having reached an agreement,"
    Case 1
        FillField WordDoc, "TrusteeAction", "the trustee having filed a report of no distribution, the parties having reached an agreement, "
    Case 2
        FillField WordDoc, "TrusteeAction", "the trustee having failed to file an answer, the debtor(s) and movant having reached an agreement, "
    Case 3
        FillField WordDoc, "TrusteeAction", "the parties having reached an agreement,"
    End Select
Else
    Select Case Forms![Print Consent Order Terminating 11]!optTrustee

    Case 0
        FillField WordDoc, "TrusteeAction", "the parties having reached an agreement,"
    Case 1
        FillField WordDoc, "TrusteeAction", "the trustee having filed a report of no distribution, the parties having reached an agreement, "
    Case 2
        FillField WordDoc, "TrusteeAction", "the trustee having failed to file an answer, the debtor(s) and movant having reached an agreement, "
    Case 3
        FillField WordDoc, "TrusteeAction", "the parties having reached an agreement,"
    End Select
End If

FillField WordDoc, "District", d!Name 'd!Districts.Name
FillField WordDoc, "CoDebtorSection", IIf(CoDebtor, "Sections 362(d) and 1301", "Section 362(d)")
FillField WordDoc, "Action", IIf(d!RealEstate, "commence foreclosure proceeding " & IIf(d![FCdetails.State] = "MD", "in the Circuit Court for " & d!Jurisdiction & IIf(IsNull(d!LongState), "", ", " & d!LongState) & ", ", "") & "against the real property and improvements " & IIf(IsNull(d!ShortLegal), "", "with a legal description of """ & d!ShortLegal & """ also ") & "known as " & d!PropertyAddress & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode) & " and to allow the successful purchaser to obtain possession of same", "proceed with repossession and sale of the " & d!PropertyDesc)

FillField WordDoc, "Carrington", IIf(d![ClientID] = 73, "Be it further ordered that Carrington Mortgage Services LLC, is allowed to communicate " & _
    "with the borrowers once Relief from the Automatic Stay is Granted and that all communications sent by Secured Creditor in connection with proceeding " & _
    "against the property including, but not limited to, notices required by state law and communications to offer and provide information with regard to a " & _
    "potential Forbearance Agreement, Loan Modification, Refinance Agreement, Loss Mitigation Agreement, or other Loan Workout, may be sent directly to Debtors.", "")

FillField WordDoc, "ElectronicSig", IIf(Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & Forms!BankruptcyPrint!cbxAttorney, "")
FillField WordDoc, "cboATTY", Forms!BankruptcyPrint!cbxAttorney
If d![BKdetails.Chapter] = 13 Then
    FillField WordDoc, "BKTrustees", IIf(Forms![Print Consent Order Terminating 13]!optTrustee = 3 And Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & d![First] & " " & d![Last], "")
    FillField WordDoc, "BKTrustees2", IIf([Forms]![Print Consent Order Terminating 13]![optTrustee] = 3, d![First] & " " & d![Last] & vbCr & "Chapter 13 Trustee", "")
ElseIf d![BKdetails.Chapter] = 11 Then
    FillField WordDoc, "BKTrustees", IIf(Forms![Print Consent Order Terminating 11]!optTrustee = 3 And Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & d![First] & " " & d![Last], "")
    FillField WordDoc, "BKTrustees2", IIf([Forms]![Print Consent Order Terminating 11]![optTrustee] = 3, d![First] & " " & d![Last] & vbCr & "Chapter 13 Trustee", "")
End If

FillField WordDoc, "DebtorAtty", IIf(Forms!BankruptcyPrint!chElectronicSignature, IIf(IsNull(d![LastName]), DebtorNames(0, 5), "/s/ " & d![FirstName] & " " & d![LastName]), "")
FillField WordDoc, "DebtorColumn", IIf(IsNull(d![LastName]), DebtorNames(0, 4), d![FirstName] & " " & d![LastName] & vbCr & "Attorney for Debtor")

FillField WordDoc, "AttyName", Forms!BankruptcyPrint!cbxAttorney
FillField WordDoc, "FirmAddress", FirmAddress()
FillField WordDoc, "TrusteeName", FormatName("", d![First], d![Last], ", Trustee", d![BKTrustees.Address], d![Address2], d![BKTrustees.City], d![BKTrustees.State], d![Zip])
FillField WordDoc, "AttySig", IIf(IsNull(d![LastName]), "", d![FirstName] & " " & d![LastName] & ", Esquire")
FillField WordDoc, "AttyFirm", IIf(IsNull(d![BKAttorneyFirm]), "", d![BKAttorneyFirm] & vbCr & d!BKAttorneyAddress)
FillField WordDoc, "BkServ", BKService(0)
FillField WordDoc, "WordyParagraph", IIf(Forms!BankruptcyPrint!chElectronicSignature And d![Districts.State] <> "VA", "          I HEREBY CERTIFY that the terms of the copy of the consent order submitted to the Court are identical to those set forth in the original consent order; and the signatures represented by the /s/__________ on this copy reference the signatures of consenting parties on the original consent order.", "")
FillField WordDoc, "End", IIf(d![Districts.State] <> "VA", "End of Order", "")


WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
Set WordObj = Nothing
d.Close

End Sub
Public Sub doc_ConsentTerminating7VAED(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim FileNumber As Long, Judge As String, CoDebtor As Boolean, AffDate As String, AffInfo As String, Debtorsplural As Boolean

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBKDocsWord  WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)      'qryBKdocsConsentTerminating13

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("ConsentTerminating7VAED")
Set WordDoc = WordObj.Documents.Open(EMailPath & "ConsentTerminating7VAED.doc", False)
WordObj.Visible = True
'WordObj.ScreenUpdating = False

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![CaseList.FileNumber])
If d!District = 6 Or d!District = 7 Then   'need attorney VA bar# for these two districts. 12/5/16
   WordDoc.Bookmarks("AttorneyInfo").Select
   WordDoc.Bookmarks("AttorneyInfo").Range.Text = [Forms]![BankruptcyPrint]![cbxAttorney].Column(0) & vbCr & "VA Bar #: " & Nz(DLookup("VABar", "Staff", "ID =" & [Forms]![BankruptcyPrint]![cbxAttorney].Column(1)))
End If

'margin address:
    If [Forms]![BankruptcyPrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (BKOwner=True OR BKMortgagor=True)") > 1)
BKConsTermTrustDebtor ("ConsentTerminating7VAED")

FillField WordDoc, "Header", "FOR THE " & UCase$(d!Name) & vbCr & d!Location

FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")

FillField WordDoc, "Investor", UCase$(d!Investor)

FillField WordDoc, "Respondents", _
   UCase$(GetNames(0, 3, IIf(d![BKdetails.Chapter] = 7, "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
                        "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"))) & _
                        IIf(d![BKdetails.Chapter] = 7, vbCr & vbCr & "and " & vbCr & vbCr & _
                        UCase$(Nz(d![First])) & " " & UCase$(Nz(d![Last])) & ", CHAPTER 7 TRUSTEE", "")

FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "Header", IIf(d![Districts.State] <> "VA", vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr, "") & _
    "IN THE UNITED STATES BANKRUPTCY COURT" & vbCr & "FOR THE " & UCase$(d!Name) & vbCr & d!Location
FillField WordDoc, "Title", Nz(Title)
FillField WordDoc, "TrusteeAction", Nz(opTrustee)
FillField WordDoc, "District", d![Name] & " " & opDebtor
FillField WordDoc, "Action", IIf(d![RealEstate], "commence foreclosure proceeding " & IIf(d![FCdetails.State] = "MD", "in the Circuit Court for " & d![Jurisdiction] & IIf(IsNull(d![LongState]), "", ", " & d![LongState]) & ", ", "") _
        & "against the real property and improvements " & IIf(IsNull(d!ShortLegal), "", "with a legal description of """ & d!ShortLegal & """ also ") & "known as " & _
        d!PropertyAddress & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode) & " and to allow the successful purchaser to obtain possession of same", _
        "proceed with repossession and sale of the " & d!PropertyDesc)
FillField WordDoc, "Carrington", IIf(d![ClientID] = 73, "Be it further ordered that Carrington Mortgage Services LLC, is allowed to communicate " & _
    "with the borrowers once Relief from the Automatic Stay is Granted and that all communications sent by Secured Creditor in connection with proceeding " & _
    "against the property including, but not limited to, notices required by state law and communications to offer and provide information with regard to a " & _
    "potential Forbearance Agreement, Loan Modification, Refinance Agreement, Loss Mitigation Agreement, or other Loan Workout, may be sent directly to Debtors.", "")

FillField WordDoc, "ElectronicSig", IIf(Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & Forms!BankruptcyPrint!cbxAttorney, "")
FillField WordDoc, "cboATTY", Forms!BankruptcyPrint!cbxAttorney
FillField WordDoc, "FirmAddress", FirmAddress()
FillField WordDoc, "firmphone", FirmPhone()
FillField WordDoc, "DebtorAtty", IIf(Forms!BankruptcyPrint!chElectronicSignature And Forms![Print Consent Order Terminating 7]!optDebtor = 1, IIf(IsNull(d![AttorneyLastName]), DebtorNames(0, 5), "/s/ " & d![AttorneyFirstName] & " " & d![AttorneyLastName]), "")
FillField WordDoc, "DebtorColumn", IIf([Forms]![Print Consent Order Terminating 7]![optDebtor] = 1, IIf(IsNull(d![AttorneyLastName]), DebtorNames(0, 4), d![AttorneyFirstName] & " " & d![AttorneyLastName] & vbCr & "Attorney for Debtor"), "")
FillField WordDoc, "AttyFirm", IIf(IsNull(d![AttorneyFirm]), "", d![AttorneyFirm] & vbCr & d!AttorneyAddress)
FillField WordDoc, "BKTrustees", IIf(Forms![Print Consent Order Terminating 7]!optTrustee = 3 And Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & d![First] & " " & d![Last], "")
FillField WordDoc, "BKTrustees2", IIf([Forms]![Print Consent Order Terminating 7]![optTrustee] = 3, d![First] & " " & d![Last] & vbCr & "Chapter 13 Trustee", "")
FillField WordDoc, "TrusteeName", FormatName("", d![First], d![Last], ", Trustee", d![BKTrustees.Address], d![Address2], d![BKTrustees.City], d![BKTrustees.State], d![Zip])
FillField WordDoc, "AttySig", IIf(IsNull(d![LastName]), "", d![FirstName] & " " & d![LastName] & ", Esquire")
FillField WordDoc, "AttyAddr", IIf(IsNull(d![BKAttorneyFirm]), "", d![BKAttorneyFirm] & vbCr & d!BKAttorneyAddress)
FillField WordDoc, "BkServ", BKService(0)

WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
Set WordObj = Nothing
d.Close

End Sub
Public Sub Doc_ConsentTerminating13VAED(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim FileNumber As Long, Judge As String, CoDebtor As Boolean, AffDate As String, AffInfo As String, Debtorsplural As Boolean

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBKDocsWord  WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)      'qryBKdocsConsentTerminating13

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("ConsentTerminating13VAED")
Set WordDoc = WordObj.Documents.Open(EMailPath & "ConsentTerminating13VAED.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![CaseList.FileNumber])
If d!District = 6 Or d!District = 7 Then   'need attorney VA bar# for these two districts. 12/5/16
   WordDoc.Bookmarks("AttorneyInfo").Select
   WordDoc.Bookmarks("AttorneyInfo").Range.Text = [Forms]![BankruptcyPrint]![cbxAttorney].Column(0) & vbCr & "VA Bar #: " & Nz(DLookup("VABar", "Staff", "ID =" & [Forms]![BankruptcyPrint]![cbxAttorney].Column(1)))
End If

'margin address:
    If [Forms]![BankruptcyPrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (BKOwner=True OR BKMortgagor=True)") > 1)

FillField WordDoc, "Header", "FOR THE " & UCase$(d!Name) & vbCr & d!Location

FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")

FillField WordDoc, "Investor", UCase$(d!Investor) & vbCr & Nz(d!InvestorAddress)
'
'FillField WordDoc, "Respondents", _
'   UCase$(GetNames(0, 3, IIf(d![BKdetails.Chapter] = 13, "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
'                        "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"))) & _
'                        IIf(d![BKdetails.Chapter] = 7, vbCr & vbCr & "and " & vbCr & vbCr & _
'                        UCase$(Nz(d![First])) & " " & UCase$(Nz(d![Last])) & ", CHAPTER 7 TRUSTEE", "")
FillField WordDoc, "Respondents", _
    GetAddresses(0, 4, _
        IIf(d![BKdetails.Chapter] = 13, _
            "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
            "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"), vbCr) & _
            IIf(d![BKdetails.Chapter] = 7, vbCr & " and " & vbCr & vbCr & UCase$(Nz(d![First])) & " " & UCase$(Nz(d![Last])) & ", CHAPTER 7 TRUSTEE", "")
FillField WordDoc, "capTrustee", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), UCase([Forms]![BankruptcyDetails]![Trustee].Column(2)), "")
FillField WordDoc, "Tail", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), vbTab & vbCr & "Trustee", "")
FillField WordDoc, "More", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), "and" & vbCr, "")
    
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "capTrustee", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), [Forms]![BankruptcyDetails]![Trustee].Column(2), "")

If d![BKdetails.Chapter] = 13 Then
    Select Case Forms![Print Consent Order Terminating 13]!optTrustee
        Case 0
            FillField WordDoc, "TrusteeAction", "the parties having reached an agreement,"
        Case 1
            FillField WordDoc, "TrusteeAction", "the trustee having filed a report of no distribution, the parties having reached an agreement, "
        Case 2
            FillField WordDoc, "TrusteeAction", "the trustee having failed to file an answer, the debtor(s) and movant having reached an agreement, "
        Case 3
            FillField WordDoc, "TrusteeAction", "the parties having reached an agreement,"
    End Select
ElseIf d![BKdetails.Chapter] = 11 Then
     Select Case Forms![Print Consent Order Terminating 11]!optTrustee
        Case 0
            FillField WordDoc, "TrusteeAction", "the parties having reached an agreement,"
        Case 1
            FillField WordDoc, "TrusteeAction", "the trustee having filed a report of no distribution, the parties having reached an agreement, "
        Case 2
            FillField WordDoc, "TrusteeAction", "the trustee having failed to file an answer, the debtor(s) and movant having reached an agreement, "
        Case 3
            FillField WordDoc, "TrusteeAction", "the parties having reached an agreement,"
    End Select
End If

FillField WordDoc, "District", d!Name 'd!Districts.Name
FillField WordDoc, "CoDebtorSection", IIf(CoDebtor, "Sections 362(d) and 1301", "Section 362(d)")
FillField WordDoc, "Action", IIf(d!RealEstate, "commence foreclosure proceeding " & IIf(d![FCdetails.State] = "MD", "in the Circuit Court for " & d!Jurisdiction & IIf(IsNull(d!LongState), "", ", " & d!LongState) & ", ", "") & "against the real property and improvements " & IIf(IsNull(d!ShortLegal), "", "with a legal description of """ & d!ShortLegal & """ also ") & "known as " & d!PropertyAddress & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode) & " and to allow the successful purchaser to obtain possession of same", "proceed with repossession and sale of the " & d!PropertyDesc)

FillField WordDoc, "Carrington", IIf(d![ClientID] = 73, "Be it further ordered that Carrington Mortgage Services LLC, is allowed to communicate " & _
    "with the borrowers once Relief from the Automatic Stay is Granted and that all communications sent by Secured Creditor in connection with proceeding " & _
    "against the property including, but not limited to, notices required by state law and communications to offer and provide information with regard to a " & _
    "potential Forbearance Agreement, Loan Modification, Refinance Agreement, Loss Mitigation Agreement, or other Loan Workout, may be sent directly to Debtors.", "")

FillField WordDoc, "ElectronicSig", IIf(Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & Forms!BankruptcyPrint!cbxAttorney, "")
FillField WordDoc, "cboATTY", Forms!BankruptcyPrint!cbxAttorney
If d![BKdetails.Chapter] = 13 Then
    FillField WordDoc, "BKTrustees", IIf(Forms![Print Consent Order Terminating 13]!optTrustee = 3 And Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & d![First] & " " & d![Last], "")
    FillField WordDoc, "BKTrustees2", IIf([Forms]![Print Consent Order Terminating 13]![optTrustee] = 3, d![First] & " " & d![Last] & vbCr & "Chapter 13 Trustee", "")
ElseIf d![BKdetails.Chapter] = 11 Then
    FillField WordDoc, "BKTrustees", IIf(Forms![Print Consent Order Terminating 11]!optTrustee = 3 And Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & d![First] & " " & d![Last], "")
    FillField WordDoc, "BKTrustees2", IIf([Forms]![Print Consent Order Terminating 11]![optTrustee] = 3, d![First] & " " & d![Last] & vbCr & "Chapter 13 Trustee", "")
End If

Dim sVABar As String
sVABar = Nz(DLookup("VaBar", "Staff", "ID = " & [Forms]![BankruptcyPrint]![cbxAttorney].Column(1)))
FillField WordDoc, "VABar", IIf(IsNull(sVABar) Or sVABar = "", "_______________", sVABar)
FillField WordDoc, "firmphone", FirmPhone()

FillField WordDoc, "DebtorAtty", IIf(Forms!BankruptcyPrint!chElectronicSignature, IIf(IsNull(d![LastName]), DebtorNames(0, 5), "/s/ " & d![FirstName] & " " & d![LastName]), "")
FillField WordDoc, "DebtorColumn", IIf(IsNull(d![LastName]), DebtorNames(0, 4), d![FirstName] & " " & d![LastName])
'FillField WordDoc, "MovantColumn", IIf([Forms]![Print Consent Order Terminating 13]![optTrustee] = 3 And [Forms]![BankruptcyPrint]![chElectronicSignature], "/s/ " & d![First] & " " & d![Last], "")
'FillField WordDoc, "MovantColumn2", IIf([Forms]![Print Consent Order Terminating 13]![optTrustee] = 3, "_______________________________" & d![First] & " " & d![Last] & "Chapter 13 Trustee", "")
FillField WordDoc, "AttyName", Forms!BankruptcyPrint!cbxAttorney
FillField WordDoc, "FirmAddress", FirmAddress()
FillField WordDoc, "TrusteeName", FormatName("", d![First], d![Last], ", Trustee", d![BKTrustees.Address], d![Address2], d![BKTrustees.City], d![BKTrustees.State], d![Zip])
FillField WordDoc, "AttySig", IIf(IsNull(d![LastName]), "", d![FirstName] & " " & d![LastName] & ", Esquire")
FillField WordDoc, "AttyFirm", IIf(IsNull(d![BKAttorneyFirm]), "", d![BKAttorneyFirm] & vbCr & d!BKAttorneyAddress)
FillField WordDoc, "BkServ", BKService(0)

WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_ConsentTerminating7(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim Debtorsplural As Boolean
Dim FileNumber As Long, Judge As String, CoDebtor As Boolean, AffDate As String, AffInfo As String

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRptBKConsTerminateWord WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("ConsentTerminating7")
Set WordDoc = WordObj.Documents.Open(EMailPath & "ConsentTerminating7.doc", False)
WordObj.Visible = True

BKConsTermTrustDebtor ("ConsentTerminating7")
Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (BKOwner=True OR BKMortgagor=True)") > 1)

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & Forms![case list]!FileNumber)

    If [Forms]![BankruptcyPrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
FillField WordDoc, "Header", _
    IIf(d![Districts.State] <> "VA", vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr, "") & _
    "IN THE UNITED STATES BANKRUPTCY COURT" & vbCr & _
    "FOR THE " & UCase$(d!Name) & vbCr & _
    d!Location
    
FillField WordDoc, "Title", Nz(Title)

FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")
    
FillField WordDoc, "Investor", UCase$(d!Investor)

FillField WordDoc, "Respondents", _
   UCase$(GetNames(0, 3, IIf(d![BKdetails.Chapter] = 13, "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
                        "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"))) & _
                        IIf(d![BKdetails.Chapter] = 7, vbCr & vbCr & "and " & vbCr & vbCr & _
                        UCase$(Nz(d![First])) & " " & UCase$(Nz(d![Last])) & ", CHAPTER 7 TRUSTEE", "")
   
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "PrintLang", Nz(opTrustee)
FillField WordDoc, "DistName", d![Name] & opDebtor
FillField WordDoc, "Action", IIf(d![RealEstate], "commence foreclosure proceeding " & IIf(d![FCdetails.State] = "MD", "in the Circuit Court for " & d![Jurisdiction] & _
        IIf(IsNull([d!LongState]), "", ", " & d![LongState]) & ", ", "") & "against the real property and improvements " & _
        IIf(IsNull(d![ShortLegal]), "", "with a legal description of """ & d![ShortLegal] & """ also ") & "known as " & d![PropertyAddress] & _
        IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode]) & _
        " and to allow the successful purchaser to obtain possession of same", "proceed with repossession and sale of the " & d![PropertyDesc])

FillField WordDoc, "Carrington", IIf(d!ClientID = 70, "", _
        "Be it further ordered that Carrington Mortgage Services LLC, is allowed to communicate with the borrowers once Relief from the Automatic Stay is " & _
        "Granted and that all communications sent by Secured Creditor in connection with proceeding against the property including, but not limited to, " & _
        "notices required by state law and communications to offer and provide information with regard to a potential Forbearance Agreement, Loan Modification, " & _
        "Refinance Agreement, Loss Mitigation Agreement, or other Loan Workout, may be sent directly to Debtors.")

FillField WordDoc, "MDSigLine", IIf(d![Districts.State] <> "VA", "", "__________________________________" & vbCr & vbCr & "United States Bankruptcy Judge")
FillField WordDoc, "ElectronicSig", IIf(Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & Forms!BankruptcyPrint!cbxAttorney, "")
FillField WordDoc, "cboATTY", Forms!BankruptcyPrint!cbxAttorney
FillField WordDoc, "BKTrustees", IIf(Forms![Print Consent Order Terminating 7]!optTrustee = 3 And Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & d![First] & " " & d![Last], "")
FillField WordDoc, "BKTrustees2", IIf([Forms]![Print Consent Order Terminating 7]![optTrustee] = 3, d![First] & " " & d![Last] & vbCr & "Chapter 13 Trustee", "")
FillField WordDoc, "DebtorAtty", IIf([Forms]![BankruptcyPrint]![chElectronicSignature] And [Forms]![Print Consent Order Terminating 7]![optDebtor] = 1, IIf(IsNull(d![AttorneyLastName]), DebtorNames(0, 5), "/s/ " & d![AttorneyFirstName] & " " & d![AttorneyLastName]), "")
FillField WordDoc, "DebtorColumn", IIf(Forms![Print Consent Order Terminating 7]!optDebtor = 1, IIf(IsNull([AttorneyLastName]), DebtorNames(0, 4), d![AttorneyFirstName] & " " & d![AttorneyLastName] & vbCr & "Attorney for Debtor"), "")
'FillField WordDoc, "AttyName", Forms!BankruptcyPrint!cbxAttorney
FillField WordDoc, "FirmAddress", FirmAddress()
FillField WordDoc, "TrusteeName", FormatName("", d![First], d![Last], ", Trustee", d![Address], d![Address2], d![BKTrustees.City], d![BKTrustees.State], d![Zip])
FillField WordDoc, "AttySig", IIf(IsNull(d![AttorneyLastName]), "", d![AttorneyFirstName] & " " & d![AttorneyLastName] & ", Esquire")
FillField WordDoc, "AttyFirm", IIf(IsNull(d![AttorneyFirm]), "", d![AttorneyFirm] & vbCr & d![AttorneyAddress])
FillField WordDoc, "BkServ", BKService(0)
FillField WordDoc, "WordyParagraph", IIf(Forms!BankruptcyPrint!chElectronicSignature And d![Districts.State] <> "VA", "          I HEREBY CERTIFY that the terms of the copy of the consent order submitted to the Court are identical to those set forth in the original consent order; and the signatures represented by the /s/__________ on this copy reference the signatures of consenting parties on the original consent order.", "")
FillField WordDoc, "End", IIf(d![Districts.State] <> "VA", "End of Order", "")

WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_ConsentTerminating7VAWD(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim Debtorsplural As Boolean
Dim FileNumber As Long, Judge As String, CoDebtor As Boolean, AffDate As String, AffInfo As String

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRptBKConsTerminateWord WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
WordObj.Visible = True
Call OpenDocAsSaved("ConsentTerminating7VAWD")
Set WordDoc = WordObj.Documents.Open(EMailPath & "ConsentTerminating7VAWD.doc", False)

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & Forms![case list]!FileNumber)

BKConsTermTrustDebtor ("ConsentTerminating7VAWD")
'margin address:
    If [Forms]![BankruptcyPrint]![cboOfficeLocation] = 2 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
Judge = Right$(UCase$(d!CaseNo), 3)
CoDebtor = (GetNames(0, 1, "BKCoDebtor=True") <> "" And d![BKdetails.Chapter] = 13)
Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (BKOwner=True OR BKMortgagor=True)") > 1)

FillField WordDoc, "Header", _
    IIf(d![Districts.State] <> "VA", vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr, "") & _
    "IN THE UNITED STATES BANKRUPTCY COURT" & vbCr & _
    "FOR THE " & UCase$(d!Name) & vbCr & _
    d!Location
FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")
FillField WordDoc, "Title", Nz(Title)
FillField WordDoc, "Investor", UCase$(d!Investor)

FillField WordDoc, "Respondents", _
   UCase$(GetNames(0, 3, IIf(d![BKdetails.Chapter] = 13, "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
                        "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"))) & _
                        IIf(d![BKdetails.Chapter] = 7, vbCr & vbCr & "and " & vbCr & vbCr & _
                        UCase$(Nz(d![First])) & " " & UCase$(Nz(d![Last])) & ", CHAPTER 7 TRUSTEE", "")
   
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "TrusteeAction", Nz(opTrustee)
FillField WordDoc, "District", d![Name] & " " & opDebtor
FillField WordDoc, "RealEstate", IIf(d![RealEstate], "commence foreclosure proceeding " & IIf(d![FCdetails.State] = "MD", "in the Circuit Court for " & d![Jurisdiction] & IIf(IsNull(d![LongState]), "", ", " & d![LongState]) & ", ", "") _
        & "against the real property and improvements " & IIf(IsNull(d!ShortLegal), "", "with a legal description of """ & d!ShortLegal & """ also ") & "known as " & _
        d!PropertyAddress & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode) & " and to allow the successful purchaser to obtain possession of same", _
        "proceed with repossession and sale of the " & d!PropertyDesc)
FillField WordDoc, "Carrington", IIf(d![ClientID] = 73, "Be it further ordered that Carrington Mortgage Services LLC, is allowed to communicate " & _
    "with the borrowers once Relief from the Automatic Stay is Granted and that all communications sent by Secured Creditor in connection with proceeding " & _
    "against the property including, but not limited to, notices required by state law and communications to offer and provide information with regard to a " & _
    "potential Forbearance Agreement, Loan Modification, Refinance Agreement, Loss Mitigation Agreement, or other Loan Workout, may be sent directly to Debtors.", "")
FillField WordDoc, "JudgeSignature", IIf(d![Districts.State] <> "VA", "", vbCr & vbCr & "____________________________" & vbCr & "United States Bankruptcy Judge")
FillField WordDoc, "ElectronicSig", IIf(Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & Forms!BankruptcyPrint!cbxAttorney, "")
FillField WordDoc, "BKTrustees", IIf(Forms![Print Consent Order Terminating 7]!optTrustee = 3 And Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & d![First] & " " & d![Last], "")
FillField WordDoc, "BKTrustees2", IIf([Forms]![Print Consent Order Terminating 7]![optTrustee] = 3, d![First] & " " & d![Last] & vbCr & "Chapter 13 Trustee", "")
FillField WordDoc, "AttyName", Forms!BankruptcyPrint!cbxAttorney
FillField WordDoc, "FirmAddress", FirmAddress()
FillField WordDoc, "MovantATTY", Forms!BankruptcyPrint!cbxAttorney
FillField WordDoc, "TrusteeName", FormatName("", d![First], d![Last], ", Trustee", d![Address], d![Address2], d![BKTrustees.City], d![BKTrustees.State], d![Zip])
FillField WordDoc, "DebtorColumn", IIf([Forms]![Print Consent Order Terminating 7]![optDebtor] = 1, IIf(IsNull(d![AttorneyLastName]), DebtorNames(0, 4), d![AttorneyFirstName] & " " & d![AttorneyLastName] & vbCr & "Attorney for Debtor"), "")
FillField WordDoc, "AttySig", IIf(IsNull(d![AttorneyLastName]), "", d![AttorneyFirstName] & " " & d![AttorneyLastName] & ", Esquire")
FillField WordDoc, "AttyFirm", IIf(IsNull(d![AttorneyFirm]), "", d![AttorneyFirm] & vbCr & d!AttorneyAddress)
FillField WordDoc, "BkServ", BKService(0)
FillField WordDoc, "DebtorAtty", IIf(Forms!BankruptcyPrint!chElectronicSignature And Forms![Print Consent Order Terminating 7]!optDebtor = 1, IIf(IsNull(d![AttorneyLastName]), DebtorNames(0, 5), "/s/ " & d![AttorneyFirstName] & " " & d![AttorneyLastName]), "")
FillField WordDoc, "CertDate", Format$(Date, "mmmm d"", ""yyyy")
FillField WordDoc, "ESig", IIf([Forms]![BankruptcyPrint]![chElectronicSignature], "/s/ " & [Forms]![BankruptcyPrint]![cbxAttorney], "")
FillField WordDoc, "MDWords", IIf(Forms!BankruptcyPrint!chElectronicSignature And d![Districts.State] <> "VA", "I HEREBY CERTIFY that the terms of the copy of the consent order submitted to " & _
    "the Court are identical to those set forth in the original consent order; and the signatures represented by the /s/__________ on this copy reference the signatures of " & _
    "consenting parties on the original consent order.", "")
FillField WordDoc, "End", IIf(d![Districts.State] <> "VA", "End of Order", "")


WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_ConsentTerminatingWD13(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim FileNumber As Long, Judge As String, CoDebtor As Boolean, AffDate As String, AffInfo As String, Debtorsplural As Boolean

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBKDocsWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("ConsentTerminatingWD13")
Set WordDoc = WordObj.Documents.Open(EMailPath & "ConsentTerminatingWD13.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & Forms![case list]!FileNumber)

'margin address:
    If [Forms]![BankruptcyPrint]![cboOfficeLocation] = 2 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
Judge = Right$(UCase$(d!CaseNo), 3)
CoDebtor = (GetNames(0, 1, "BKCoDebtor=True") <> "" And d![BKdetails.Chapter] = 13)

Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (BKOwner=True OR BKMortgagor=True)") > 1)

FillField WordDoc, "Header", _
    IIf(d![Districts.State] <> "VA", vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr & vbCr, "") & _
    "IN THE UNITED STATES BANKRUPTCY COURT" & vbCr & _
    "FOR THE " & UCase$(d!Name) & vbCr & d!Location

FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & "     Debtor" & IIf(Debtorsplural, "s", "")

FillField WordDoc, "Investor", UCase$(d!Investor)

FillField WordDoc, "Respondents", _
   UCase$(GetNames(0, 3, IIf(d![BKdetails.Chapter] = 13, "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
                        "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"))) & _
                        IIf(d![BKdetails.Chapter] = 7, vbCr & vbCr & "and " & vbCr & vbCr & _
                        UCase$(Nz(d![First])) & " " & UCase$(Nz(d![Last])) & ", CHAPTER 7 TRUSTEE", "")
   
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]

If d![BKdetails.Chapter] = 13 Then
        Chapter = 13
        Call BKConsTermTrustDebtor("ConsentTerminatingWD13")
         FillField WordDoc, "TrusteeAction", Nz(opTrustee)
ElseIf d![BKdetails.Chapter] = 11 Then
    Chapter = 11
    Call BKConsTermTrustDebtor("ConsentTerminatingWD13")
    FillField WordDoc, "TrusteeAction", Nz(opTrustee)
    
End If
FillField WordDoc, "District", d!Name
FillField WordDoc, "CoDebtorSection", IIf(CoDebtor, "Sections 362(d) and 1301", "Section 362(d)")
FillField WordDoc, "Action", IIf(d!RealEstate, "commence foreclosure proceeding " & IIf(d![FCdetails.State] = "MD", "in the Circuit Court for " & d!Jurisdiction & IIf(IsNull(d!LongState), "", ", " & d!LongState) & ", ", "") & "against the real property and improvements " & IIf(IsNull(d!ShortLegal), "", "with a legal description of """ & d!ShortLegal & """ also ") & "known as " & _
    d!PropertyAddress & ", " & IIf(IsNull(d![Fair Debt]), "", d![Fair Debt] & ", ") & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode) & " and to allow the successful purchaser to obtain possession of same", "proceed with repossession and sale of the " & d!PropertyDesc)
If d![Districts.State] = "VA" Then FillField WordDoc, "JudgeSignature", "________________________________" & vbCr & "United States Bankruptcy Judge"
    
FillField WordDoc, "MovantAtty", [Forms]![BankruptcyPrint]![cbxAttorney]
FillField WordDoc, "DebtorAtty", IIf(Forms!BankruptcyPrint!chElectronicSignature, IIf(IsNull(d![LastName]), DebtorNames(0, 5), "/s/ " & d![FirstName] & " " & d![LastName]), "")
FillField WordDoc, "DebtorColumn", IIf(IsNull(d![LastName]), DebtorNames(0, 4), d![FirstName] & " " & d![LastName]) & vbCr & "Attorney for Debtor"

FillField WordDoc, "Carrington", IIf(d![ClientID] = 73, "Be it further ordered that Carrington Mortgage Services LLC, is allowed to communicate " & _
    "with the borrowers once Relief from the Automatic Stay is Granted and that all communications sent by Secured Creditor in connection with proceeding " & _
    "against the property including, but not limited to, notices required by state law and communications to offer and provide information with regard to a " & _
    "potential Forbearance Agreement, Loan Modification, Refinance Agreement, Loss Mitigation Agreement, or other Loan Workout, may be sent directly to Debtors.", "")
FillField WordDoc, "ElectronicSig", IIf(Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & Forms!BankruptcyPrint!cbxAttorney, "")

If d![BKdetails.Chapter] = 13 Then
    FillField WordDoc, "BKTrustees", IIf(Forms![Print Consent Order Terminating 13]!optTrustee = 3 And Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & d![First] & " " & d![Last], "")
    FillField WordDoc, "BKTrustees2", IIf([Forms]![Print Consent Order Terminating 13]![optTrustee] = 3, d![First] & " " & d![Last] & vbCr & "Chapter 13 Trustee", "")
ElseIf d![BKdetails.Chapter] = 11 Then
    FillField WordDoc, "BKTrustees", IIf(Forms![Print Consent Order Terminating 11]!optTrustee = 3 And Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & d![First] & " " & d![Last], "")
    FillField WordDoc, "BKTrustees2", IIf([Forms]![Print Consent Order Terminating 11]![optTrustee] = 3, d![First] & " " & d![Last] & vbCr & "Chapter 13 Trustee", "")
End If
FillField WordDoc, "AttyName", Forms!BankruptcyPrint!cbxAttorney
FillField WordDoc, "FirmAddress", FirmAddress()
FillField WordDoc, "TrusteeName", FormatName("", d![First], d![Last], ", Trustee", d![BKTrustees.Address], d![Address2], d![BKTrustees.City], d![BKTrustees.State], d![Zip])
'FillField WordDoc, "AttySig", IIf(IsNull(d![AttorneyLastName]), "", d![AttorneyFirstName] & " " & d![AttorneyLastName] & ", Esquire" & IIf(IsNull(d![AttorneyFirm]), "", d![AttorneyFirm] & "") & d![AttorneyAddress])
FillField WordDoc, "AttySig", IIf(IsNull(d![LastName]), "", d![FirstName] & " " & d![LastName] & ", Esquire")
FillField WordDoc, "AttyFirm", IIf(IsNull(d![BKAttorneyFirm]), "", d![BKAttorneyFirm] & vbCr & d!BKAttorneyAddress)
FillField WordDoc, "BkServ", BKService(0)
    
FillField WordDoc, "CertDate", Format$(Date, "mmmm d"", ""yyyy")
FillField WordDoc, "ESig", IIf([Forms]![BankruptcyPrint]![chElectronicSignature], "/s/ " & [Forms]![BankruptcyPrint]![cbxAttorney], "")
    
WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
'WordDoc.SaveAs EMailPath & "ConsentTerminatingWD13.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "ConsentTerminatingWD13.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
Chapter = ""
End Sub

Public Sub Doc_DCAccounting(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset, dd As Recordset      ' data
Dim sqlstring As String
Dim TotalProceeds As Currency
Dim TotalExpenses As Currency
Dim NoticeAmount As Currency
Dim TotalDebt As Currency
Dim availableToPay As Currency
Dim FinalBalance As Currency

Set dd = CurrentDb.OpenRecordset("Select * From qryDCAccounting WHERE Caselist.FileNumber=" & Forms![case list]!FileNumber & "AND AuditID =" & [Forms]![Audit - DC]![AuditID], dbOpenSnapshot)

If dd.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If
NoticeAmount = [Forms]![Audit - DC]![NoticesAmount]
TotalExpenses = Nz(dd![FilingFee]) + Nz(dd![DeedApp]) + Nz(dd![Bond]) + Nz(dd![AdvertisingPreSale]) + Nz(dd![AttorneyFee]) + Nz(dd![TitleReport]) + Nz(dd![AuctioneerFee]) + Nz(NoticeAmount) + Nz(dd![OtherAmount]) + Nz(dd![Other2Amount]) + Nz(dd![Other3Amount]) + Nz(dd![Other4Amount]) + Nz(dd![Other5Amount]) + Nz(dd![Other6Amount]) + Nz(dd![Other7Amount]) + Nz(dd![Other8Amount]) + Nz(dd![Other9Amount]) + Nz(dd![Other10Amount]) + Nz(dd![LisPendensFee])
'TotalExpenses = Nz(dd![FilingFee]) + Nz(dd![DeedApp]) + Nz(dd![Bond]) + Nz(dd![BondFiling]) + Nz(dd![AdvertisingPreSale]) + Nz(dd![AdvertisingNiSi]) + Nz(dd![CommissionAmount]) + Nz(dd![AuditorFee]) + Nz(dd![AttorneyFee]) + Nz(dd![TitleReport]) + Nz(dd![AuctioneerFee]) + Nz(dd![ChicagoJudgement]) + Nz(NoticeAmount) + Nz(dd![DelinquentTaxes]) + Nz(dd![TaxSaleRedemption]) + Nz(dd![Water]) + Nz(dd![OtherAmount]) + Nz(dd![Other2Amount]) + Nz(dd![Other3Amount]) + Nz(dd![Other4Amount]) + Nz(dd![Other5Amount])

TotalProceeds = Nz(dd![Proceeds]) + Nz(dd![Interest]) + Nz(dd![PropertyTaxes]) + Nz(dd![OtherProceeds1Amount]) + Nz(dd![OtherProceeds2Amount])
TotalDebt = Nz(dd![StatementofDebt]) + Nz(dd![Interest])
availableToPay = TotalProceeds - TotalExpenses
FinalBalance = availableToPay - TotalDebt

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("DC Accounting")
Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Accounting.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & " " & Nz(d![Fair Debt] & ", ", "") & d!City & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode)

FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
FillField WordDoc, "Defendants", DefendantNames(0, 99)
FillField WordDoc, "JudgmentEntered", Format$(d!JudgmentEntered, "mmmm d, yyyy")
FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
'FillField WordDoc, "LegalDescription", d!LegalDescription
'FillField WordDoc, "TrusteeWord", UCase$(TrusteeWord(d![CaseList.FileNumber], 0))
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & vbCr & "" & d!City & ", " & d![FCdetails.State] & ", " & FormatZip(d!ZipCode)
'FillField WordDoc, "DOTRecorded", Format$(d!DOTrecorded, "mmmm d, yyyy")
'FillField WordDoc, "DoTDate", Format$(d!DOTdate, "mmmm d, yyyy")
'FillField WordDoc, "Liber", d!Liber
'FillField WordDoc, "Docket", Format$(d!Docket, "mmmm d, yyyy")
FillField WordDoc, "SaleDate", Format$(d!Sale, "m/d/yyyy")
FillField WordDoc, "SaleDate2", Format$(d!Sale, "mmmm dd, yyyy")
'FillField WordDoc, "SaleTime", Format$(d!SaleTime, "h:nn AM/PM")
'FillField WordDoc, "TaxID", d!TaxID
'FillField WordDoc, "IRSLiens", IIf(d!IRSLiens, "The property will be sold subject to a 120 day right of redemption by the Internal Revenue Service.  ", "")
'FillField WordDoc, "PriorLien", IIf(d!LienPosition <= 1, "", "The property will be sold subject to a prior mortgage, the amount to be announced at the time of sale.  ")
'FillField WordDoc, "Deposit", Format$(d!Deposit, "Currency")
FillField WordDoc, "Trustees", trusteeNames(d![CaseList.FileNumber], 2)
FillField WordDoc, "TrusteeList", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "PrintDate", Format(Date, "mmmm, d, yyyy")
FillField WordDoc, "Parties", NoticeNames2(d![CaseList.FileNumber], "(noteholder = true or NoticeType = 2)")
'FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
'FillField WordDoc, "ComplaintFiled", Format(d!ComplaintFiled, "mmmm d, yyyy")
FillField WordDoc, "Investor", d!Investor
'FillField WordDoc, "PropertyAddress", d![PropertyAddress] & ", " & d![City] & ", " & d![State] & " " & d![ZipCode]
'FillField WordDoc, "Owners", OwnerNames(0, 2)
'FillField WordDoc, "CaseCaption", d![Investor] & " v. " & DefendantNames(0, 99)
FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
'FillField WordDoc, "OriginalPBal", Format(d!OriginalPBal, "Currency")
'FillField WordDoc, "LegalDescription", d!LegalDescription
'FillField WordDoc, "AttyName", GetStaffFullName(Forms!ForeclosurePrint!Attorney.Column(0)) & " (" & FetchBarNumberPoundSign(Forms!ForeclosurePrint!Attorney, d![State]) & ")"
FillField WordDoc, "Interest", IIf(Nz(dd![Interest]) = 0, "", "Interest " & Format$(dd![Interest3From], "m/d/yyyy" & " - " & Format$(dd![Interest3To], "m/d/yyyy")))
FillField WordDoc, "PropertyTaxesDesc", Nz(dd!PropertyTaxesDesc, "")
FillField WordDoc, "PropertyTaxes", Format$(dd![PropertyTaxes], "Currency")
'FillField WordDoc, "LeaseHold", IIf(dd![Leasehold] And dd![CaseList.JurisdictionID] = 4, "Leasehold Real Estate subject to annual ground rent of " & Format$(dd![GroundRentAmount], "Currency") & " payable " & dd![GroundRentPayable], "Real Estate")
FillField WordDoc, "Proceeds", Format$(dd![Proceeds], "Currency")
FillField WordDoc, "InterestAmount", IIf(Nz(dd![Interest]) = 0, "", Format$(dd![Interest], "Currency"))
FillField WordDoc, "TotalProceeds", Format$(TotalProceeds, "Currency")

'Expenses
FillField WordDoc, "FilingFee", Format$(dd![FilingFee], "Currency")
FillField WordDoc, "DeedApp", Format$(dd![DeedApp], "Currency")
FillField WordDoc, "Bond", Format$(dd![Bond], "Currency")
FillField WordDoc, "NewspaperPreSale", dd!NewspaperPreSale
FillField WordDoc, "AdvertisingPreSale", Format$(dd![AdvertisingPreSale], "Currency")
FillField WordDoc, "FirmName", FirmName()
FillField WordDoc, "AttorneyFee", Format$(dd![AttorneyFee], "Currency")
FillField WordDoc, "Abstractor", dd!Abstractor
FillField WordDoc, "TitleReport", Format$(dd![TitleReport], "Currency")
FillField WordDoc, "Auctioneer", Nz(dd!Auctioneer, "")
FillField WordDoc, "AuctioneerFee", Format$(dd![AuctioneerFee], "Currency")
FillField WordDoc, "Notices", Format(Forms![Audit - DC]!NoticesAmount, "Currency")
FillField WordDoc, "OtherDesc", IIf(dd![OtherDesc] <> "", dd![OtherDesc], "")
FillField WordDoc, "Other2Desc", IIf(dd![Other2Desc] <> "", dd![Other2Desc], "")
FillField WordDoc, "Other3Desc", IIf(dd![Other3Desc] <> "", dd![Other3Desc], "")
FillField WordDoc, "Other4Desc", IIf(dd![Other4Desc] <> "", dd![Other4Desc], "")
FillField WordDoc, "Other5Desc", IIf(dd![Other5Desc] <> "", dd![Other5Desc], "")
FillField WordDoc, "OtherAmount", IIf(dd![OtherDesc] <> "", Format$(dd![OtherAmount], "Currency"), "")
FillField WordDoc, "Other2Amount", IIf(dd![Other2Desc] <> "", Format$(dd![Other2Amount], "Currency"), "")
FillField WordDoc, "Other3Amount", IIf(dd![Other3Desc] <> "", Format$(dd![Other3Amount], "Currency"), "")
FillField WordDoc, "Other4Amount", IIf(dd![Other4Desc] <> "", Format$(dd![Other4Amount], "Currency"), "")
FillField WordDoc, "Other5Amount", IIf(dd![Other5Desc] <> "", Format$(dd![Other5Amount], "Currency"), "")

FillField WordDoc, "Other6Desc", IIf(dd![OtherDesc] <> "", dd![Other6Desc], "")
FillField WordDoc, "Other7Desc", IIf(dd![Other2Desc] <> "", dd![Other7Desc], "")
FillField WordDoc, "Other8Desc", IIf(dd![Other3Desc] <> "", dd![Other8Desc], "")
FillField WordDoc, "Other9Desc", IIf(dd![Other4Desc] <> "", dd![Other9Desc], "")
FillField WordDoc, "Other10Desc", IIf(dd![Other5Desc] <> "", dd![Other10Desc], "")
FillField WordDoc, "Other6Amount", IIf(dd![OtherDesc] <> "", Format$(dd![Other6Amount], "Currency"), "")
FillField WordDoc, "Other7Amount", IIf(dd![Other2Desc] <> "", Format$(dd![Other7Amount], "Currency"), "")
FillField WordDoc, "Other8Amount", IIf(dd![Other3Desc] <> "", Format$(dd![Other8Amount], "Currency"), "")
FillField WordDoc, "Other9Amount", IIf(dd![Other4Desc] <> "", Format$(dd![Other9Amount], "Currency"), "")
FillField WordDoc, "Other10Amount", IIf(dd![Other5Desc] <> "", Format$(dd![Other10Amount], "Currency"), "")

FillField WordDoc, "TotalExpenses", Format(TotalExpenses, "Currency")

'Section 3
FillField WordDoc, "LisPendens", Format(Nz(dd!LisPendensFee, 0), "Currency")
FillField WordDoc, "StatementOfDebt", Format$(dd![StatementofDebt], "Currency")
FillField WordDoc, "InterestFrom", Format$(dd![InterestFrom], "m/d/yyyy")
FillField WordDoc, "InterestTo", Format$(dd![InterestTo], "m/d/yyyy")
FillField WordDoc, "DateDiff", Nz(DateDiff("d", dd![InterestFrom], dd![InterestTo]), "")
FillField WordDoc, "PerDiem", Nz(Format$(dd![InterestPerDiem], "Currency"), "")
FillField WordDoc, "PerDiemTotal", Nz(Format$(DateDiff("d", dd![InterestFrom], dd![InterestTo]) * dd![InterestPerDiem], "Currency"), "")
FillField WordDoc, "TotalDebt", Format(TotalDebt, "currency")
FillField WordDoc, "AvailableTOPay", Format(availableToPay, "Currency")
FillField WordDoc, "FinalBalance", Format(FinalBalance, "Currency")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "DC Accounting.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "DC Accounting.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
dd.Close

End Sub

Public Sub Doc_DCProposedOrder(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset, dd As Recordset      ' data
Dim sqlstring As String

Set dd = CurrentDb.OpenRecordset("Select * From qryDCProposedOrderWord WHERE Caselist.FileNumber=" & Forms![case list]!FileNumber & "AND AuditID =" & [Forms]![Audit - DC]![AuditID], dbOpenSnapshot)

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("DCProposedOrder")
Set WordDoc = WordObj.Documents.Open(EMailPath & "DCProposedOrder.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = dd![FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = dd![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = dd![PropertyAddress] & " " & Nz(dd![Fair Debt] & ", ", "") & dd!City & ", " & dd![State] & " " & FormatZip(dd!ZipCode)


FillField WordDoc, "Investor", dd!Investor
FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
FillField WordDoc, "Defendants", DefendantNames(0, 99)
FillField WordDoc, "CourtCaseNumber", dd!CourtCaseNumber
FillField WordDoc, "PropertyAddress", dd!PropertyAddress & IIf(IsNull(dd![Fair Debt]), "", ", " & dd![Fair Debt]) & vbCr & "" & dd!City & ", " & dd![State] & ", " & FormatZip(dd!ZipCode)

Set d = CurrentDb.OpenRecordset("SELECT FileNumber, NoticeTypes.NoticeType, Company, First, Last, AKA, Address, Address2,City, State, Zip, Deceased " & _
            "FROM [Names] INNER JOIN NoticeTypes ON Names.NoticeType = NoticeTypes.ID WHERE Cos=1 And FileNumber = " & Forms![case list]!FileNumber, dbOpenSnapshot)
Dim itemsFields As String
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
Else
    d.MoveLast
    Dim N, i As Integer
    N = d.RecordCount
    d.MoveFirst
    
    For i = 1 To N
    
        itemsFields = itemsFields & "<<COSNames" & i & ">>" & vbCr & "<<COSAddress" & i & ">>" & vbCr & vbCr

    Next
      FillField WordDoc, "COSNames", itemsFields & " "
d.MoveFirst
i = 1
 Do While Not d.EOF
    FillField WordDoc, "COSNames" & i, d![First] & " " & d![Last]
    FillField WordDoc, "COSAddress" & i, d![Address] & IIf(IsNull(d![Address2]), "", " " & d![Address2]) & vbCr & d![City] & ", " & d![State] & " " & FormatZip(d![Zip])
    d.MoveNext
    i = i + 1
 Loop

End If
'FillField WordDoc, "COS", IIf(IsNull(d![Company]), IIf(d![Deceased], "Estate of " & d![First] & " " & d![Last], d![First] & " " & d![Last]) & IIf(d![AKA], " " & d![AKA], ""), d![Company])
'FillField WordDoc, "COSAddress", d![Address] & IIf(IsNull(d![Address2]), " ", " " & d![Address2]) & vbCr



End Sub


Public Sub Doc_DCTrusteeAffidavit(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCTrusteeAFF WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("DC Trustee Affidavit")
Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Trustee Affidavit.doc", False)
WordObj.Visible = True

'margin address:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
        FillField WordDoc, "FirmPh", FirmPhoneVA()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
        FillField WordDoc, "FirmPh", FirmPhone()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
        FillField WordDoc, "FirmPh", FirmPhone()
    End If

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & " " & Nz(d![Fair Debt]) & vbNewLine & d!City & ", " & d![State] & ", " & FormatZip(d!ZipCode)

FillField WordDoc, "Pub1", Format(InputBox("Please enter the next Publication Date.  (2 of 4)  Format mm/dd/yyyy"), "mmmm d, yyyy")
FillField WordDoc, "Pub2", Format(InputBox("Please enter the next Publication Date.  (3 of 4)  Format mm/dd/yyyy"), "mmmm d, yyyy")
FillField WordDoc, "Pub3", Format(InputBox("Please enter the next Publication Date.  (4 of 4)  Format mm/dd/yyyy"), "mmmm d, yyyy")

FillField WordDoc, "AttyName", GetStaffFullName(Forms!foreclosurePrint!Attorney.Column(0))
FillField WordDoc, "Defendants", DefendantNames(0, 99)
FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
FillField WordDoc, "PropertyAddress", d!PropertyAddress & vbCr & "" & d!City & ", " & d![State] & ", " & FormatZip(d!ZipCode)
FillField WordDoc, "Sale", Format$(d!Sale, "dddd, mmmm d, yyyy")
FillField WordDoc, "SaleTime", Format$(d!SaleTime, "h:nn AM/PM")
FillField WordDoc, "VendorAdd", DLookup("StreetAddress", "Vendors", "ID=222") & " " & DLookup("City", "Vendors", "ID=222") & ", " & DLookup("State", "Vendors", "ID=222") & " " & DLookup("Zipcode", "Vendors", "ID=222")
FillField WordDoc, "Notices", Format(d!Notices, "mmmm d, yyyy")
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "firstPub", Format(d!FirstPub, "mmmm d, yyyy")
FillField WordDoc, "BondPosted", Format(d!BondPosted, "mmmm d, yyyy")
FillField WordDoc, "Purchaser", Nz(d!Purchaser)
FillField WordDoc, "SalePrice", Format(d!SalePrice, "Currency")
FillField WordDoc, "SelectedTrustee", GetStaffFullName(Forms!foreclosurePrint!Attorney.Column(0)) & " (" & FetchbarNumberPoundSign(Forms!foreclosurePrint!Attorney, d![State]) & ")"
FillField WordDoc, "Month", Format(Date, "mmmm")
FillField WordDoc, "Year", Format(Date, "yyyy")
FillField WordDoc, "NoticePosted", Format(d!NoticePosted, "mmmm d, yyyy")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "DC Trustee Affidavit.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "DC Trustee Affidavit.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub


Public Sub Doc_DCTrusteesDeed(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCTrusteesDeedDC WHERE FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("DC Trustees Deed")
Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Trustees Deed.doc", False)
WordObj.Visible = True

'margin address:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
        FillField WordDoc, "FirmPh", FirmPhoneVA()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
        FillField WordDoc, "FirmPh", FirmPhone()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
        FillField WordDoc, "FirmPh", FirmPhone()
    End If

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & " " & Nz(d![Fair Debt]) & vbNewLine & d!City & ", " & d![FCdetails.State] & ", " & FormatZip(d!ZipCode)

FillField WordDoc, "TrusteeNames", UCase$(trusteeNames(d![FileNumber], 2))
FillField WordDoc, "Purchaser", Nz(d!Purchaser)
FillField WordDoc, "OriginalMortgagors", IIf(IsNull(d![OriginalMortgagors]), MortgagorNamesCaps(d![FileNumber], 2, 2), d![OriginalMortgagors] & " " & MortgagorNamesCaps(0, 2, 2))
FillField WordDoc, "OriginalBeneficiary", Nz(d!OriginalBeneficiary, "________________________")
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "CaseNo", Nz(d!CourtCaseNumber, "________________")
FillField WordDoc, "LiberFolio", IIf(IsNull(d![Folio]), "as Instrument Number " & d![Liber], "in Liber " & d![Liber] & ", " & "Folio " & d![Folio]) & _
    IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & IIf(IsNull(d![Folio2]), _
    " as Instrument Number " & d![Liber2], " in Liber " & d![Liber2] & ", Floio " & d![Folio2]))
FillField WordDoc, "CaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "SaleDate", Format$(d!Sale, "dddd, mmmm d, yyyy")
If IsNull(d!SalePrice) Then
    FillField WordDoc, "SalePrice", "$________________"
Else
    FillField WordDoc, "SalePrice", SpellNumber(d!SalePrice) & " (" & Format(d!SalePrice, "Currency") & ")"
End If
FillField WordDoc, "Primary name", d!PrimaryDefName
FillField WordDoc, "LegaDesc", d!LegalDescription
FillField WordDoc, "TaxID", Nz(d!TaxID)
FillField WordDoc, "Trustees", trusteeNames(d![FileNumber], 3)
'FillField WordDoc, "NotaryName", FetchNotaryName(Forms!ForeclosurePrint!NotaryID, False)

If Not IsNull(Forms!foreclosurePrint!NotaryID) Then
    FillField WordDoc, "NotaryName", DLookup("NotaryName", "Staff", "ID=" & Forms!foreclosurePrint!NotaryID)
    FillField WordDoc, "NotaryExp", DLookup("NotaryExpires", "Staff", "ID = " & Forms!foreclosurePrint!NotaryID)
Else
    FillField WordDoc, "NotaryName", " "
    FillField WordDoc, "NotaryExp", ""
End If
FillField WordDoc, "PropertyAddress", Nz(d!PropertyAddress) & IIf(Len(d![Fair Debt]) = 0, " ", ", " & d![Fair Debt]) & ", " & d!City & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode)

WordObj.Selection.HomeKey wdStory, wdMove
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_BaltCityIntakeSheet(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBaltCityIntake WHERE FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("BaltCity Intake Sheet")
Set WordDoc = WordObj.Documents.Open(EMailPath & "BaltCity Intake Sheet.doc", False)
WordObj.Visible = True

FillField WordDoc, "PropertyAddress", Nz(d!PropertyAddress) & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "TrusteeNames", trusteeNames(d![FileNumber], 2)
FillField WordDoc, "Purchaser", Nz(d!Purchaser)
FillField WordDoc, "SalePrice", Nz(Format(d!SalePrice, "Currency"))
FillField WordDoc, "GetloginName", GetLoginName()
FillField WordDoc, "GetStaffEmail", GetStaffEmail()
FillField WordDoc, "PurchaserAddress", Nz(d!PurchaserAddress)
FillField WordDoc, "firmAddr", FirmShortAddressOneLine

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Baltimore City Intake Sheet.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Baltimore City Intake Sheet.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_DCOrderGrantingDefaultWells(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range, DefendantsAddress As String
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCTrusteeAFF WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("DC Order Granting Default - Wells")
Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Order Granting Default - Wells.doc", False)
WordObj.Visible = True

'margin address:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
        FillField WordDoc, "FirmPh", FirmPhoneVA()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
        FillField WordDoc, "FirmPh", FirmPhone()
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
        FillField WordDoc, "FirmPh", FirmPhone()
    End If

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & " " & IIf(IsNull(d![Fair Debt]), "", d![Fair Debt] & ", ") & d!City & ", " & d![State] & ", " & FormatZip(d!ZipCode)

'DefendantsAddress = GetAddresses(d!FileNumber, 5, "Defendant=True", NewLine)
'FillField WordDoc, "AttyName", GetStaffFullName(Forms!ForeclosurePrint!Attorney.Column(0))

FillField WordDoc, "Defendants", DefendantNames(0, 99)
FillField WordDoc, "DefendantNames", DefendantNames(0, 99)
FillField WordDoc, "DefendantAddress", GetAddresses(0, 5, "Defendant = True") ', vbCr)
FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
FillField WordDoc, "PropertyAddress", d!PropertyAddress & d![Fair Debt] & vbCr & "" & d!City & ", " & d![State] & ", " & FormatZip(d!ZipCode)
FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & ", " & d![Fair Debt] & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "Month", Format(Date, "mmmm")
FillField WordDoc, "Year", Format(Date, "yyyy")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "DC Order Granting Default Wells.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "DC Order Granting Default Wells.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_DeedOfAppointmentSPLS(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String

If (d![FCdetails.State] = "MD") Then
    templateName = "Deed of Appointment SPLS MD"
Else
    templateName = "Deed of Appointment SPLS VA"
End If

templateName = templateName ' & ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

'office locations:
    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

If d!JurisdictionID = 56 And d![FCdetails.State] = "VA" Then
    FillField WordDoc, "Tax", "Tax Map Number:"
Else
    FillField WordDoc, "Tax", "Tax ID #:"
End If

FillField WordDoc, "FirmAddress", IIf([Forms]![foreclosurePrint]![cboOfficeLocation] = 2, "Commonwealth Trustees, LLC" & vbCr & "8601 Westwood Center Drive, Suite 255" & vbCr & "Vienna, VA 22182", _
            IIf(IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 1, FirmAddress(vbCr), _
            "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")))

If (d![FCdetails.State] = "VA") Then
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", IIf(IsNull(d![Folio2]), ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & _
    " at Instrument Number " & d![Liber2], ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " in Book " & d![Liber2] & ", Page " & d![Folio2]))
ElseIf d!JurisdictionID = 6 Then  'Calvert County
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Book " & d![Liber2] & ", Page " & d![Folio2])
Else 'MD or DC
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Liber " & d![Liber2] & ", Page " & d![Folio2])
End If

FillField WordDoc, "LoanNumber", d!LoanNumber

If d!JurisdictionID = 153 Then ' Accomack VA
    FillField WordDoc, "OriginalTrustee", UCase$(d!OriginalTrustee)
    'FillField WordDoc, "InvestorAIF", IIf(d!AIF = True, d!LongClientName & " as Attorney in Fact for ", "") & UCase$(d!Investor)
    FillField WordDoc, "InvestorAIF", IIf((d!AIF = True And d!ClientID = 532), UCase$(d![Investor]) & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for ", "") & UCase$(d![Investor]))
    FillField WordDoc, "OriginalBeneficiary", UCase$(d!OriginalBeneficiary)
    FillField WordDoc, "AssumedBy", IIf(IsNull(d!OriginalMortgagors), "", "assumed by " & UCase$(MortgagorNamesCaps(0, 2, 2))) & " "
    FillField WordDoc, "MortgagorNames", IIf(IsNull(d!OriginalMortgagors), UCase$(MortgagorNamesCaps(0, 2, 2)), UCase$(d!OriginalMortgagors))
    FillField WordDoc, "TrusteeNames", UCase$(trusteeNames(0, 2))
    FillField WordDoc, "Investor", UCase$(d!Investor)
Else
    If d!ClientID = 328 And d![FCdetails.State] = "MD" Then
        FillField WordDoc, "OriginalTrustee", IIf(IsNull(d![OriginalMortgagors]), "", "assumed by " & MortgagorNamesCaps(0, 2, 2)) & " " & d!OriginalTrustee
    End If
    FillField WordDoc, "OriginalTrustee", d!OriginalTrustee
    FillField WordDoc, "InvestorAIF", IIf((d![AIF] = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for ", "") & d![Investor])
    FillField WordDoc, "OriginalBeneficiary", d!OriginalBeneficiary
    'FillField WordDoc, "AssumedBy", IIf(IsNull(d!OriginalMortgagors), "", "assumed by " & MortgagorNamesCaps(0, 2, 2)) & " "
    'FillField WordDoc, "AssumedBy", " "
    FillField WordDoc, "MortgagorNames", IIf(IsNull(d!OriginalMortgagors), MortgagorNamesCaps(0, 2, 2), d!OriginalMortgagors)
    'FillField WordDoc, "TrusteeNames", d!OriginalTrustee
    FillField WordDoc, "TrusteeNames", trusteeNames(0, 2)
    FillField WordDoc, "Investor", d!Investor
    'FillField WordDoc, "InvestorSPLS", d![Investor] & IIf((d![AIF] = True And d![Investor] <> "Specialized Loan Servicing, LLC"), ", by Specialized Loan Servicing, LLC, as servicer for secured party", "")
    FillField WordDoc, "InvestorSPLS", d![Investor] & IIf((d![AIF] = True And Not Trim(UCase$(d![Investor])) Like "SPECIALIZED LOAN SERVICING*"), ", by Specialized Loan Servicing, LLC, as servicer for secured party", "")
 
End If

FillField WordDoc, "Filenumber", d![CaseList.FileNumber]
FillField WordDoc, "DOTDate", Format$(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "LongState", Nz(d!LongState)
FillField WordDoc, "LiberFolio", LiberFolio(d!Liber, d!Folio, d![FCdetails.State], d![JurisdictionID])
FillField WordDoc, "Liber", Nz(d!Liber)
FillField WordDoc, "Folio", Nz(d!Folio)
FillField WordDoc, "LegalDescription", d!LegalDescription
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "TaxID", Nz(d!TaxID, "")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")

FillField WordDoc, "MDInstrPrepared", IIf(d![FCdetails.State] = "VA", "", "This instrument was prepared under the supervision of " & d!AttorneyName & ", an attorney admitted to practice before the Court of Appeals of Maryland.")
FillField WordDoc, "MDSignLine", IIf(d![FCdetails.State] = "VA", "", "_________________________________")
FillField WordDoc, "MDAttorney", IIf(d![FCdetails.State] = "VA", "", Nz(d!AttorneyName, ""))
    
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", FetchNotaryLocation(Forms!foreclosurePrint!NotaryID)
FillField WordDoc, "NotaryName", FetchNotaryName(Forms!foreclosurePrint!NotaryID, False)

FillField WordDoc, "NotaryNameSignLine", FetchNotaryName(Forms!foreclosurePrint!NotaryID, True)
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 226, "")
FillField WordDoc, "boa1", IIf(d![ClientID] = 446, "", "and, being duly sworn")
'FillField WordDoc, "boa2", IIf(d![ClientID] = 446, "National Association.", IIf(d![ClientID] = 385 Or d![ClientID] = 567, "company.", IIf([d!clientID] = 87, "association.", "corporation.")))
FillField WordDoc, "BOA2", IIf(d![ClientID] = 446, " National Association.", IIf(d![ClientID] = 385 Or d![ClientID] = 567, " company.", IIf(d![ClientID] = 87, " association.", " corporation.")))
'FillField WordDoc, "MERS", IIf(d![FCdetails.State] = "MD" And d![MERS] = -1, "Mortgage Electronic Registration Systems Inc. (MERS) solely as nominee for ", "")
FillField WordDoc, "MERS", IIf(d![MERS] = -1, "Mortgage Electronic Registration Systems Inc. (MERS) solely as nominee for ", "")

FillField WordDoc, "FinalLanguage", "WHEREAS, " & _
IIf(Forms!ForeclosureDetails!LoanType = 5, "Federal Home Loan Mortgage Corporation is the owner of the note secured by said Deed of Trust and appointed the party of the first part with authority to hold, collect and enforce the note; and ", _
IIf(Forms!ForeclosureDetails!LoanType = 4, "Federal National Mortgage Association is the owner of the note secured by said Deed of Trust and appointed the party of the first part with authority to hold, collect and enforce the note; and ", _
 "the party of the first part is the holder of the Note secured by said Deed of Trust; and,"))

WordObj.Selection.HomeKey wdStory, wdMove
If (d![FCdetails.State] = "MD") Then
   ' WordDoc.SaveAs EMailPath & "Substitute Trustee SLS MD.doc"
  '  Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Substitute Trustee SLS MD.doc")
Else
   ' WordDoc.SaveAs EMailPath & "Deed of Appointment SPLS.doc"
   ' Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Deed of Appointment SPLS.doc")
End If
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_EvictionTenant_NTQ_SPS(KeepOpen As Boolean)
'Call MsgBox("This section is under construction", vbExclamation + vbAbortRetryIgnore, "Word Documents arent finished yet")
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qry90DayNoticeSPSWord WHERE FileNumber=" & Forms![case list]!FileNumber & " AND FcDetails.Current = TRUE;", dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Eviction Print MD Tenant NTQ SPS")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Eviction Print MD Tenant NTQ SPS.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]

'DefendantsAddress = GetAddresses(d!FileNumber, 5, "Defendant=True", NewLine)
FillField WordDoc, "AttySignature", GetStaffFullName(Forms!EvictionPrint!cboAttorney.Column(0))
FillField WordDoc, "FileNumber", d!FileNumber
'FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
FillField WordDoc, "PropertyAddress", d!PropertyAddress
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d!State
FillField WordDoc, "Zip", FormatZip(d!ZipCode)

FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "Year", Format(Date, "yyyy")
FillField WordDoc, "Purchaser", d!Purchaser
FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Eviction Print MD Tenant NTQ SPS.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Eviction Print MD Tenant NTQ SPS.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_EvictionOwner_NTQ_SPS(KeepOpen As Boolean)
'Call MsgBox("This section is under going testing", vbExclamation + vbAbortRetryIgnore, "Don't test this yet")

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qry90DayNoticeSPSWord WHERE FileNumber=" & Forms![case list]!FileNumber & " AND FcDetails.Current = TRUE;", dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Eviction Print MD Owner NTQ SPS")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Eviction Print MD Owner NTQ SPS.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]

'DefendantsAddress = GetAddresses(d!FileNumber, 5, "Defendant=True", NewLine)
FillField WordDoc, "AttySignature", GetStaffFullName(Forms!EvictionPrint!cboAttorney.Column(0))
FillField WordDoc, "FileNumber", d!FileNumber
'FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
FillField WordDoc, "PropertyAddress", d!PropertyAddress
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d!State
FillField WordDoc, "Zip", FormatZip(d!ZipCode)

FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "Year", Format(Date, "yyyy")
FillField WordDoc, "Purchaser", d!Purchaser
FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Eviction Print MD Owner NTQ SPS.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Eviction Print MD Owner NTQ SPS.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_Eviction_MD_NTQ_53(KeepOpen As Boolean)
'Call MsgBox("This section is under construction", vbExclamation + vbAbortRetryIgnore, "Word Documents arent finished yet")
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qry90DayNoticeSPSWord WHERE FileNumber=" & Forms![case list]!FileNumber & " AND FcDetails.Current = TRUE;", dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Eviction Print MD NTQ Fifth Third")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Eviction Print MD NTQ Fifth Third.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]

FillField WordDoc, "Sale", Format(d!Sale, "mmmm d, yyyy")
'DefendantsAddress = GetAddresses(d!FileNumber, 5, "Defendant=True", NewLine)
FillField WordDoc, "AttySignature", GetStaffFullName(Forms!EvictionPrint!cboAttorney.Column(0))
FillField WordDoc, "FileNumber", d!FileNumber
'FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
FillField WordDoc, "PropertyAddress", d!PropertyAddress
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d!State
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "BrokerNM", d!BrokerNm
FillField WordDoc, "BrokerPh", FormatPhone(d!BrokerPh)
FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "Year", Format(Date, "yyyy")
FillField WordDoc, "Purchaser", d!Purchaser
FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
FillField WordDoc, "LastDays", Format(LastDay90(Date), "mmmm d, yyyy")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Eviction Print MD NTQ Fifth Third.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Eviction Print MD NTQ Fifth Third.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_Eviction_VA_Owner_NTQ_53(KeepOpen As Boolean)
'Call MsgBox("This section is under construction", vbExclamation + vbAbortRetryIgnore, "Word Documents arent finished yet")
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qry90DayNoticeSPSWord WHERE FileNumber=" & Forms![case list]!FileNumber & " AND FcDetails.Current = TRUE;", dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Eviction Print VA Owner NTQ Fifth Third")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Eviction Print VA Owner NTQ Fifth Third.doc", False)
WordObj.Visible = True

FillField WordDoc, "Sale", Format(d!Sale, "mmmm d, yyyy")
'DefendantsAddress = GetAddresses(d!FileNumber, 5, "Defendant=True", NewLine)
FillField WordDoc, "AttySignature", Nz(GetStaffFullName(Forms!EvictionPrint!cboAttorney.Column(0)))
FillField WordDoc, "FileNumber", d!FileNumber
'FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d!State
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "BrokerNM", Nz(d!BrokerNm, "_____________")
If IsNull(d!BrokerPh) Then
   FillField WordDoc, "BrokerPh", Nz(d!BrokerPh)
Else
    FillField WordDoc, "BrokerPh", FormatPhone(d!BrokerPh)
End If
FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "Year", Format(Date, "yyyy")
FillField WordDoc, "Purchaser", d!Purchaser
FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
FillField WordDoc, "LastDays", Format(LastDay90(Date), "mmmm d, yyyy")
FillField WordDoc, "FirmAddress", FirmShortAddress()
FillField WordDoc, "FirmFax", FirmFax()

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Eviction Print VA Owner NTQ Fifth Third.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Eviction Print VA Owner NTQ Fifth Third.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_Eviction_VA_Tenant_NTQ_53(KeepOpen As Boolean)
'Call MsgBox("This section is under construction", vbExclamation + vbAbortRetryIgnore, "Word Documents arent finished yet")
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qry90DayNoticeSPSWord WHERE FileNumber=" & Forms![case list]!FileNumber & " AND FcDetails.Current = TRUE;", dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Eviction Print VA Tenant NTQ Fifth Third")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Eviction Print VA Tenant NTQ Fifth Third.doc", False)
WordObj.Visible = True

'WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
'WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
'WordDoc.Bookmarks("ProName").Select
'WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
'WordDoc.Bookmarks("PropertyAddress").Select
'WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]

FillField WordDoc, "Sale", Format(d!Sale, "mmmm d, yyyy")
'DefendantsAddress = GetAddresses(d!FileNumber, 5, "Defendant=True", NewLine)
FillField WordDoc, "AttySignature", GetStaffFullName(Forms!EvictionPrint!cboAttorney.Column(0))
FillField WordDoc, "FileNumber", d!FileNumber
'FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d!State
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "BrokerNM", Nz(d!BrokerNm, "____________________")
If IsNull(d!BrokerPh) Then
    FillField WordDoc, "BrokerPh", Nz(d!BrokerPh, "_______________________")
Else
    FillField WordDoc, "BrokerPh", FormatPhone(d!BrokerPh)
End If
FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "Year", Format(Date, "yyyy")
FillField WordDoc, "Purchaser", d!Purchaser
FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
'FillField WordDoc, "LastDays", Format(LastDay90(Date), "mmmm d, yyyy")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Eviction Print VA Tenant NTQ Fifth Third.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Eviction Print VA Tenant NTQ Fifth Third.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_LossMitigationPrelimSPLS(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim textfinal As String
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If
Dim templateName As String
Dim BankName As String

BankName = "Loss Mitigation Preliminary SPLS"
templateName = "Loss Mitigation Prelim - SPLS"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "fillingdate", IIf(Not IsNull(d![Docket]), Format(d![Docket], "mm/d/yyyy"), "_____________________ ")
FillField WordDoc, "borrower", MortgagorNamesOneline(d![CaseList.FileNumber], 2)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", IIf(Not IsNull(d![CourtCaseNumber]), d![CourtCaseNumber], " _____________________ ")
FillField WordDoc, "NameAffianit", "Print Name and Title of Affiant"
'FillField WordDoc, "TitleAffiaitOrInvestor", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "", "Title of Affiant")
'FillField WordDoc, "Line", IIf(d![ClientID] = 6 Or d![ClientID] = 556, "", "______________________________")
FillField WordDoc, "Investor", IIf(d![ClientID] = 6 Or d![ClientID] = 556, d!Investor, "")
'FillField WordDoc, "Barcode", IIf(d![FCdetails.State] = "MD", "", AddDocPreIndex(d![CaseList.FileNumber], 1484, ""))
'FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ____________________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "                " & "____________________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: _________________________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & BankName & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], BankName & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_Eviction_MD14102b(KeepOpen As Boolean)
'Call MsgBox("This section is under construction", vbExclamation + vbAbortRetryIgnore, "Word Documents arent finished yet")
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

'Set d = CurrentDb.OpenRecordset("SELECT * FROM qryMD14102b WHERE FileNumber=" & Forms![Case List]!FileNumber & " AND EVDetails.Current = TRUE;", dbOpenSnapshot)
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryMD14102bWord WHERE FileNumber=" & Forms![case list]!FileNumber & " AND FcDetails.Current = TRUE AND EVdetails.current = True;", dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("MD14-102b")
Set WordDoc = WordObj.Documents.Open(EMailPath & "MD14-102b.doc", False)
WordObj.Visible = True

FillField WordDoc, "Case", Nz(d!CourtCaseNumber, "_________")
FillField WordDoc, "TrusteeNames", trusteeNames(0, 2)
FillField WordDoc, "Defendants", MortgagorOwnerNames(0, 2)
FillField WordDoc, "Broker", Nz(d!BrokerNm)

FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "MD14-102b.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "MD14-102b.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

'#1219
Public Sub Doc_StatementOfDebtWithFiguresSPLS(KeepOpen As Boolean)

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset, dd As Recordset      ' data
Dim i As Integer, itemcount As Integer, TotalItems As Currency, amountInterest As Currency, itemsFields As String, j As Integer
Dim K As Recordset
Dim Rresult As Long
Dim InterestFrom As String
Dim InterestTo As String

Set d = CurrentDb.OpenRecordset("Select * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String
templateName = "Statement of Debt Figures Spls"
templateName = templateName '& ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

    If (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "VA") Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "DC") _
                    Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCdetails.State] = "MD") Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

WordObj.Visible = False
If MsgBox("Is There A Loan Mod? ", vbYesNo) = vbYes Then
FillField WordDoc, "Mod", ", MODIFIED by Agreement effective " & Format(InputBox(" Effective Date?   Format mm/dd/yyyy"), "mmmm d, yyyy") & " with an amended principal balance of " & Format(InputBox(" Amended Principal Balance? "), "Currency")
Else
FillField WordDoc, "Mod", ""
End If

InterestFrom = InputBox("Interest From")
InterestTo = InputBox("Interest To")

WordObj.Visible = True

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "Investor", d!Investor

FillField WordDoc, "owner", IIf(d![LoanType] = 4, "Federal National Mortgage Association is the owner", _
IIf(d![LoanType] = 5, "Federal Home Loan Mortgage Corporation is the owner", d![Investor] & " is the owner"))
FillField WordDoc, "InvestorSPLS", IIf(d![AIF], d![Investor] & " by its servicer, Specialized Loan Servicing LLC", d![Investor])
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", IIf(d!CaseTypeID = 8, d!MonitorTrusteeAddress, FirmShortAddress(vbCr))
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "LastPaymentApplied", Format$(d![DateOfDefault], "mmmm d, yyyy")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
'FillField WordDoc, "PBalance", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "RemainingPBal", Format$(d!RemainingPBal, "Currency")
'FillField WordDoc, "Barcode", IIf(d![FCdetails.State] = "MD", "", AddDocPreIndex(d![CaseList.FileNumber], 223, ""))

FillField WordDoc, "DateBalance", IIf(IsNull(Forms![Print Statement of Debt]!txtDueDate), "______________", Format$(Forms![Print Statement of Debt]!txtDueDate, "mmmm d"", ""yyyy"))
FillField WordDoc, "ReRecorded", IIf(IsNull(d!Rerecorded), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Liber " & d![Liber2] & ", Folio " & d![Folio2])

TotalItems = 0
amountInterest = 0
itemsFields = ""

'Set dd = CurrentDb.OpenRecordset("SELECT Desc, TempSortId, Amount FROM QryStatementOfDebtWithFigurersBOA WHERE FileNumber=" & d![CaseList.FileNumber] & " ORDER BY TempSortId DESC;", dbOpenSnapshot)
Set dd = CurrentDb.OpenRecordset("select * from statementofdebt where filenumber=" & d![CaseList.FileNumber] & " ORDER BY Sort_Desc ASC;", dbOpenDynaset, dbSeeChanges)
If dd.EOF Then      ' no extra lines
    FillField WordDoc, "Line_Items", ""
Else
    dd.MoveLast
    itemcount = dd.RecordCount
    
    ' Make enough lines
    For i = 1 To itemcount
        itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
    Next i
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
    FillField WordDoc, "Line_Items", itemsFields & " "
    
    dd.MoveFirst
    i = 1

     Do While Not dd.EOF
     '   FillField WordDoc, "Item" & i, IIf(dd!Desc = "Interest Due", "Interest Due from " & InterestFrom & " to " & InterestTo & _
     '   " @ " & IIf(Forms![Print Statement of Debt]!chVarRate = 0, Format(Forms![Print Statement of Debt]!InterestRate, "#.000%"), _
     '   " variable rate(s)"), dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency"))
        If dd!Desc = "Interest" Then
           ' FillField WordDoc, "Item" & i, "Interest Due from " & InterestFrom & " to " & InterestTo & " @ " & IIf(Forms![Print Statement of Debt]!chVarRate = 0, Format(Forms![Print Statement of Debt]!InterestRate, "#0.000") & "%", " variable rate(s)")
            FillField WordDoc, "Item" & i, "Interest at " & IIf(Not IsNull([Forms]![Print Statement of Debt]!chAdj) And Not [Forms]![Print Statement of Debt]!chAdj = "", "a variable rate ", IIf([Forms]![Print Statement of Debt]![chVarRate] = 0, Format([Forms]![Print Statement of Debt]![InterestRate], "0.000") & "%", " variable rate(s)")) & _
                    " From " & InterestFrom & " to " & InterestTo & vbTab & Format$(Nz(dd!Amount, 0), "Currency")
        Else
            FillField WordDoc, "Item" & i, dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency")
        End If
        dd.MoveNext
        i = i + 1
    Loop
End If
    
 dd.Close
 
  Set K = CurrentDb.OpenRecordset("SELECT Desc, Amount FROM StatementOfDebt WHERE FileNumber=" & d![CaseList.FileNumber], dbOpenSnapshot)
  j = 1
  Do While Not K.EOF
   If K!Desc = "Interest" Then
   amountInterest = amountInterest + Format$(Nz(K!Amount, 0), "Currency")
   End If
      
   TotalItems = TotalItems + Nz(K!Amount, 0)
   K.MoveNext
   j = j + 1
  Loop
  K.Close

FillField WordDoc, "BalDueDate", IIf(IsNull([Forms]![Print Statement of Debt]![txtDueDate]), "______________", Format$([Forms]![Print Statement of Debt]![txtDueDate], "mmmm d"", ""yyyy"))
FillField WordDoc, "BalanceDue", Format$(d!RemainingPBal + TotalItems, "Currency")
FillField WordDoc, "diem", IIf(d![LoanType] = 3, "Monthly", "Diem")
FillField WordDoc, "PerDiemInterest", IIf([Forms]![Print Statement of Debt]![txtOPerDiem].Visible, IIf(IsNull([Forms]![Print Statement of Debt]![txtOPerDiem]), "$_______", Format$([Forms]![Print Statement of Debt]![txtOPerDiem], "$" & "0.0000")), IIf(IsNull([PerDiem]), "$_____________", Format$(d![PerDiem], "Currency")))
FillField WordDoc, "InterestRate", IIf(IsNull(d!InterestRate), "____________ %", Format$(d!InterestRate, "#0.000") & "%")
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "NotaryLocation", IIf(IsNull(d!NotaryLocation), "STATE OF ______________:" & vbCr & "COUNTY OF ____________ :", d!NotaryLocation)
FillField WordDoc, "amountInterest$", Format$(amountInterest, "Currency")
FillField WordDoc, "jurisdiction", d!Jurisdiction
FillField WordDoc, "liber", d![Liber]
FillField WordDoc, "folio", Nz(d![Folio])

'FillField WordDoc, "MortgagorNamesintext", MortgagorNamesIntext(0, 2, 0, 0, -1)
WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Statement of Debt Figures SPLS.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Statement of Debt Figures SPLS.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub
'/#1219

Public Sub Doc_AffCoverSheet(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Affidavit Cover letter")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Affidavit Cover letter.doc", False)
    WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

FillField WordDoc, "ClientLoanT", Forms!ForeclosureDetails!LoanNumber
FillField WordDoc, "MortgagorNameT", MortgagorNames(0, 3)
FillField WordDoc, "PropertyAddressT", Forms!ForeclosureDetails!PropertyAddress & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt]) & ", " & Forms!ForeclosureDetails!City & ", " & Forms!ForeclosureDetails!State & " " & FormatZip(Forms!ForeclosureDetails!ZipCode)

FillField WordDoc, "ContactNameT", GetLoginName()

FillField WordDoc, "DateofUpload", Format$(Now(), "mmmm d, yyyy")

'FillField WordDoc, "Disclaimer2", IIf(Forms![Case list]!State = "MD", trusteeNames(0, 2) & ", the substitute trustees listed, are employees of the attorney firm", "")
'FillField WordDoc, "Disclaimer", IIf(Not IsNull(Forms![Print Assignment]!cboBOANoteLocation), Forms![Print Assignment]!cboBOANoteLocation.Column(0), IIf(Forms!ForeclosureDetails!DocBackOrigNote = -1, "The firm is in possession of the original note", "The firm is NOT in possession of the original note"))

'FillField WordDoc, "Disclaimer", IIf(Forms!ForeclosureDetails!DocBackOrigNote = -1, "The firm is in possession of the original note", "The firm is NOT in possession of the original note")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Affidavit Cover letter.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Affidavit Cover letter.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_AffidavitofDefault(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
NextNumber = 1

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRptAffidavitofDefaultWord WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

    Set WordObj = CreateObject("Word.Application")
    If d!District = 1 Or d!District = 2 Then
        Call OpenDocAsSaved("Affidavit of Default MD")
         Set WordDoc = WordObj.Documents.Open(EMailPath & "Affidavit of Default MD.doc", False)
    ElseIf d!District = 4 Or d!District = 5 Then
        Call OpenDocAsSaved("Affidavit of Default Rich-Alex")
         Set WordDoc = WordObj.Documents.Open(EMailPath & "Affidavit of Default Rich-Alex.doc", False)
    Else
        Call OpenDocAsSaved("Affidavit of Default")
         Set WordDoc = WordObj.Documents.Open(EMailPath & "Affidavit of Default.doc", False)
    End If
   
    WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![FileNumber])
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

'margin location, default to MD 01/21/16
If [Forms]![BankruptcyPrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
End If

FillField WordDoc, "DistrictName", UCase$(d![Name])
FillField WordDoc, "DistrictsLocation", d![Location]
FillField WordDoc, "DebtorNames", UCase$(DebtorNames(0, 3))
FillField WordDoc, "CourtCaseNumber", Nz(d![CaseNo], "")
FillField WordDoc, "capTrustee", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), [Forms]![BankruptcyDetails]![Trustee].Column(2), "")

FillField WordDoc, "BKchapter", Nz(d![BKdetails.Chapter])
FillField WordDoc, "Investor", d![Investor]
FillField WordDoc, "Investor2", d![Investor]
FillField WordDoc, "GetNextNumber1", GetNextNumber()
FillField WordDoc, "GetNextNumber2", GetNextNumber()

FillField WordDoc, "MortgagorNames", UCase$(GetNames(0, 3, IIf(d![BKdetails.Chapter] = 13, _
"(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"))) & _
IIf(d![BKdetails.Chapter] = 7, vbCr & " and " & vbCr & vbCr & UCase$(Nz(d![First])) & " " & UCase$(Nz(d![Last])) & ", CHAPTER 7 TRUSTEE", "")
FillField WordDoc, "capTrustee", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), UCase([Forms]![BankruptcyDetails]![Trustee].Column(2)), "")
FillField WordDoc, "Tail", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), vbTab & vbCr & "Trustee", "")
FillField WordDoc, "More", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), "and" & vbCr, "")

FillField WordDoc, "DOT", IIf(d![RealEstate], DOTWord(d![DOT]) & " on the real property and improvements " & IIf(IsNull(d![ShortLegal]), "", "with a legal description of """ & d![ShortLegal] & """ also ") & "known as " & d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode]), d![PropertyContract] & " on a " & d![PropertyDesc])
FillField WordDoc, "ConsentPaymentAmt", Format$(d![ConsentPaymentAmount], "Currency")
FillField WordDoc, "RealEstate", IIf(d![RealEstate], "mortgage", "monthly")
FillField WordDoc, "ConsentPaymentDate", d!ConsentPaymentDate
FillField WordDoc, "AffDefault3A", IIf(IsNull(d![AffDefault3A]), "", "2A. " & d![AffDefault3A])
FillField WordDoc, "GetNextNumber3", IIf(IsNull(d![ConsentPaymentInfo]), "", GetNextNumber() & "  Pursuant to the terms of the Consent Order entered in the above referenced matter, the Debtor was to make a payment to the Movant of " & d![ConsentPaymentInfo] & ".")
FillField WordDoc, "GetNextNumber4", GetNextNumber()
FillField WordDoc, "NoOfDays", NumberWords([Forms]![Print Affidavit of Default]![NoDays]) & " (" & [Forms]![Print Affidavit of Default]![NoDays] & ")"
FillField WordDoc, "PaymentAmt", Format$(d![AffDefaultPaymentAmount], "Currency")
FillField WordDoc, "AffDefaultPaymentInfo", IIf(0 < Len(d![AffDefaultPaymentInfo]), d![AffDefaultPaymentInfo], "includes $75.00 attorney fees and costs")
FillField WordDoc, "GetNextNumber5", GetNextNumber()
FillField WordDoc, "GetNextNumber6", GetNextNumber()
FillField WordDoc, "BKPaymentsTo", Nz(d![BKPaymentsTo])
FillField WordDoc, "Investor", d![Investor]
FillField WordDoc, "ElectronicSignature", IIf([Forms]![BankruptcyPrint]![chElectronicSignature], "/s/" & [Forms]![BankruptcyPrint]![cbxAttorney], "____________________________")
FillField WordDoc, "elecSignature", IIf(Forms!BankruptcyPrint!chElectronicSignature, "or via electronic email, ", "")
If IsNull(Forms!BankruptcyPrint!cbxAttorney.Column(1)) Then
    FillField WordDoc, "BarNumber", ""
Else
FillField WordDoc, "BarNumber", FetchBarNumber(Forms!BankruptcyPrint!cbxAttorney.Column(1), [Forms]![BankruptcyDetails]![District].Column(4), "BK")
End If
FillField WordDoc, "firmAddress", FirmAddress()
FillField WordDoc, "firmphone", FirmPhone()
FillField WordDoc, "today", IIf(Forms!BankruptcyPrint!chElectronicSignature, ThisDate(Date), "____ day of ____________, 20____")
'FillField WordDoc, "AttorneyName", IIf(IsNull(d![AttorneyLastName]), "", d![AttorneyFirstName] & " " & d![AttorneyLastName])
FillField WordDoc, "AttorneyName", IIf([Forms]![BankruptcyDetails]![ckProSe], "", d![AttorneyFirstName] & " " & d![AttorneyLastName] & IIf(IsNull(d![AttorneyLastName]), "", ", Esquire"))
FillField WordDoc, "Email", IIf(Forms!BankruptcyPrint!chElectronicSignature, "or via electronic email, ", "")
FillField WordDoc, "AttorneyAddress", IIf(IsNull(d![AttorneyFirm]), "", d![AttorneyFirm] & vbCr) & d![AttorneyAddress]
If d!District = 1 Or d!District = 2 Then
    FillField WordDoc, "Trustee", d![First] & " " & d![Last] & ", Trustee" & vbCr & vbCr & _
        IIf([Forms]![BankruptcyDetails]![ckProSe], "", d![AttorneyFirstName] & " " & d![AttorneyLastName] & IIf(IsNull(d![AttorneyLastName]), "", ", Esquire"))
Else
    FillField WordDoc, "Trustee", FormatName("", d![First], d![Last], ", Trustee", d![Address], d![Address2], d![BKTrustees.City], d![BKTrustees.State], d![Zip])
End If
FillField WordDoc, "BKService", GetAddresses(0, 5, "(BKDebtor=True or BKCoDebtor = true)")
FillField WordDoc, "Attorney", Forms!BankruptcyPrint!cbxAttorney

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Affidavit of Default.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Affidavit of Default.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
   
End Sub

Public Sub DOC_AffidavitofLienInstrumentNationStar(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim FileNumber  As Long

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Affidavit of Lien Instrument Nationtar")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Affidavit of Lien Instrument Nationtar.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
'WordDoc.Bookmarks("ProName").Select
'WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]

    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth " & vbCr & "Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & " & vbCr & "Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & " & vbCr & "Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", IIf(d!CaseTypeID = 8, d!MonitorTrusteeAddress, FirmShortAddress(vbCr))
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "Client", d!LongClientName
FillField WordDoc, "Investor", IIf(d![ClientID] = 385 And d![Investor] = d!LongClientName, "Nationstar maintains records for the loan that is secured by the mortgage or deed of trust being foreclosed in this action. ", _
"Nationstar services and maintains records on behalf of " & d![Investor] & ", the secured party to the mortgage or deed of trust being foreclosed in this action.")

FillField WordDoc, "Prior Servicer", IIf(Forms![Prior Servicer]!ChPrior, "           Before the servicing of this loan transferred to Nationstar, " & [Forms]![Prior Servicer]![TxtPriorServicer] & _
" (Prior Servicer) was the servicer for the loan and it maintained the loan servicing records.  When Nationstar began servicing this loan, Prior Servicer's records for the loan were integrated and boarded into Nationstar's systems," & _
" such that Prior Servicer's records, including the collateral file, payment histories, communication logs, default letters, information," & _
"and documents concerning the Loan are now integrated into Nationstar's business records.  Nationstar maintains quality control and " & _
"verification procedures as part of the boarding process to ensure the accuracy of the boarded records.  It is the regular business practice " & _
"of Nationstar to integrate prior servicers' records into Nationstar's business records and to rely upon those boarded records in providing " & _
"its loan servicing functions.  These Prior Servicer records have been integrated and are relied upon by Nationstar as part of Nationstar's " & _
"business records.", "")

FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "loan servicing", IIf(d!Investor = "Nationstar Mortgage LLC", "", " loan servicing")
FillField WordDoc, "DOTdate", Format(d!DOTdate, "mmmm dd, yyyy")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Affidavit Lien Instrument Nationtar.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Affidavit Lien Instrument Nationtar.doc")

'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
 
'
'If Application.CurrentProject.AllForms("Prior Servicer").IsLoaded Then
'    DoCmd.Close acForm, "Prior Servicer"
'End If

End Sub

Public Sub doc_BaileeLetter(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, dd As Recordset
Dim items As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRptBaileeLetterWord WHERE FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
Set dd = CurrentDb.OpenRecordset("SELECT * FROM ReturnedDocs where FileNumber =" & Forms![case list]!FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If dd.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("BaileeLetter")
Set WordDoc = WordObj.Documents.Open(EMailPath & "BaileeLetter.doc", False)
WordObj.Visible = True

Dim N, i As Integer
dd.MoveFirst
dd.MoveLast
i = dd.RecordCount

FillField WordDoc, "client", [Forms]![case list]![ClientID].Column(1)
FillField WordDoc, "Date", Format(Date, "mm/dd/yyyy")
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), " ", ", " & d![Fair Debt] & " ") & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "LoginName", GetLoginName()
FillField WordDoc, "LoginEmail", GetStaffEmail()

For N = 1 To i
    items = items & "<<Item" & N & ">>" & vbCr
Next
    FillField WordDoc, "Items", items

dd.MoveFirst
N = 1
Do While Not dd.EOF
     FillField WordDoc, "Item" & N, N & "." & vbTab & dd!DocDescription
     N = N + 1
     dd.MoveNext
Loop
    
End Sub

Public Sub Doc_BaileeLTR(KeepOpen As Boolean)   'For GreenTree
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim dd As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryGreenTreeBailee WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Green Tree Bailee Letter")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Green Tree Bailee Letter.doc", False)
WordObj.Visible = True

FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "PropertyAddress", d![PropertyAddress]
FillField WordDoc, "PropertyAddress2", d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "ProjectName", d!PrimaryDefName
FillField WordDoc, "LoginName", GetLoginName()


Set dd = CurrentDb.OpenRecordset("SELECT * FROM BaileeDocs WHERE FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If dd.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

FillField WordDoc, "OrigMort", IIf(dd!OriginalMortgage = True, "X", "  ")
FillField WordDoc, "CopyMort", IIf(dd!CopyMortgage = True, "X", "  ")
FillField WordDoc, "OrigNote", IIf(dd!OriginalNote = True, "X", "  ")
FillField WordDoc, "CopyNote", IIf(dd!CopyNote = True, "X", "  ")
FillField WordDoc, "OrigLNA", IIf(dd!OriginalLNA = True, "X", "  ")
FillField WordDoc, "CopyLNA", IIf(dd!CopyLNA = True, "X", "  ")
FillField WordDoc, "OrigMod", IIf(dd!OriginalModification = True, "X", "  ")
FillField WordDoc, "CopyMod", IIf(dd!CopyModification = True, "X", "  ")
FillField WordDoc, "OrigOther", IIf(dd!OriginalOther = True, "X", "  ")
FillField WordDoc, "CopyOther", IIf(dd!CopyMortgage = True, "X", "  ")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Green Tree Bailee Letter.doc"
'Call SaveDoc(WordDoc, Forms![Case list].FileNumber, "Green Tree Bailee Letter.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
dd.Close
End Sub
 
Public Sub doc_BKCertOfService(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("select * from qryRptBKCOSWord where CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
        MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
If d![Districts.State] = "MD" Then
    Call OpenDocAsSaved("BKCertificateOfServiceMD")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "BKCertificateOfServiceMD.doc", False)
Else
    Call OpenDocAsSaved("BKCertificateOfService")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "BKCertificateOfService.doc", False)
End If
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![FileNumber])

    If [Forms]![BankruptcyPrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "district", UCase$(d![Name]) & vbCr & d!Location
Dim Debtorsplural As Boolean
Debtorsplural = CountNames(d![FileNumber], "BKDebtor = True  AND (BKOwner=True OR BKMortgagor=True)")
FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")
FillField WordDoc, "InvestorAddr", UCase$(d!Investor)
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "Respondents", _
   UCase$(GetNames(0, 3, IIf(d![BKdetails.Chapter] = 13, "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
                        "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"))) & _
                        IIf(d![BKdetails.Chapter] = 7, vbCr & vbCr & "and " & vbCr & vbCr & _
                        UCase$(Nz(d![First])) & " " & UCase$(Nz(d![Last])) & ", CHAPTER 7 TRUSTEE", "")
                        
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Date", ThisDate(Date)
FillField WordDoc, "docName", [Forms]![BK Print Certificate of Service]![DocName]
FillField WordDoc, "was", IIf(d![Districts.State] <> "MD" And Right([Forms]![BK Print Certificate of Service]![DocName], 4) = "stay", " and Notice of Opportunity to Object were", " was")
FillField WordDoc, "BKService", GetAddresses(0, 5, "(BKDebtor=True or BKCoDebtor = true)")       'BKService(0)
FillField WordDoc, "debtorAttny", IIf(Forms![BankruptcyDetails]!ckProSe Or (d![AttorneyFirstName] & " " & d![AttorneyLastName]) = " ", "", d![AttorneyFirstName] & " " & d![AttorneyLastName] & IIf(IsNull([AttorneyLastName]), "", ", Esquire") & IIf(d![Districts.State] = "MD", "", vbCr _
    & IIf(IsNull(d![AttorneyFirm]), "", d![AttorneyFirm] & vbCr) & d![AttorneyAddress]) & IIf(d![Districts.State] = "MD", "", vbCr & "(served via CM/ECF)"))
FillField WordDoc, "Trustees", IIf(d![Districts.State] = "MD", d![First] & " " & d![Last] & ", Trustee", FormatName("", d![First], d![Last] & ", Trustee", "", d![Address], d![Address2], d![City], d![BKTrustees.State], FormatZip(d![Zip])))
FillField WordDoc, "FirmAddr", FirmAddress()
If Forms!BankruptcyPrint!chElectronicSignature Then
        FillField WordDoc, "ElectronicSignature", "/s/ " & Forms!BankruptcyPrint!cbxAttorney
    Else
        FillField WordDoc, "ElectronicSignature", "______________________"
    End If
'Dim strBar As String           'Don't need Bar# per Tian   1/26/17
'strBar = Nz(DLookup("FedBar", "Staff", "ID = " & [Forms]![BankruptcyPrint]![cbxAttorney].Column(1)))
FillField WordDoc, "AttorneySignature", Forms!BankruptcyPrint!cbxAttorney ' & IIf(IsNull(strBar), "", vbCr & "Bar # " & strBar)


End Sub
Public Sub Doc_TitleClaim(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("select * from qryFCDocsWordTitleClaim where CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)

If d.EOF Then
        MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Title Claim")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Title Claim.doc", False)
WordObj.Visible = True

FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
FillField WordDoc, "Insurer", Forms![Print Title Claim]!cbxTitleInsurer.Column(1)
FillField WordDoc, "policyNo", IIf(Forms![Print Title Claim]!optClaim, "Policy", "Commitment") & " Number:"
FillField WordDoc, "ClaimNo", Nz(Forms![Print Title Claim]!ClaimNumber)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), " ", ", " & d![Fair Debt] & ", ") & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "FileNumber", Forms![case list]!FileNumber
FillField WordDoc, "Titleinsurer", [Forms]![Print Title Claim]!cbxTitleInsurer.Column(3)
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "DOT", IIf(d![DOT], "Deed of Trust", "Mortgage")
FillField WordDoc, "optClaim", IIf([Forms]![Print Title Claim]![optClaim], "policy.  A copy of the title policy is", "commitment.  A copy of the commitment and HUD-1 are")
FillField WordDoc, "Sale", IIf(IsNull(d![Sale]), "", ", which is scheduled for " & Format$(d![Sale], "mmmm d"", ""yyyy") & ",")
FillField WordDoc, "policyOrcommt", IIf([Forms]![Print Title Claim]![optClaim], "policy", "commitment")
FillField WordDoc, "Claim", Forms![Print Title Claim]!Claim
FillField WordDoc, "FirstLineInsurer", FirstLine(Forms![Print Title Claim]!cbxTitleInsurer.Column(1))
FillField WordDoc, "LoginName", GetLoginName()

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Title Claim.doc"
'Call SaveDoc(WordDoc, Forms![Case list].FileNumber, "Title Claim.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub
Public Sub Doc_TitleOrderBK(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim FileNumber As Long
Dim SID As Integer
Dim sAbst As String

SID = GetStaffID()
FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT FCdetails.FileNumber, FCdetails.PropertyAddress, FCdetails.City, FCdetails.State, FCdetails.ZipCode, FCdetails.docdate, " & _
    "FCdetails.OriginalPBal, FCdetails.LegalDescription, Staff.Name, Staff.EMail, FCdetails.[Fair Debt] From fcdetails, Staff " & _
    "WHERE ([fcdetails.Current] = True)and [fcdetails.FileNumber] = " & FileNumber & "and [Staff.ID] = " & SID, dbOpenSnapshot)
    
Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("TitleOrder BK")
Set WordDoc = WordObj.Documents.Open(EMailPath & "TitleOrder BK.doc", False)
WordObj.Visible = True
    
    sAbst = InputBox("enter abstractor: ")
    
    FillField WordDoc, "Date", Format$(Date, "mmmm d"", ""yyyy")
    FillField WordDoc, "LoginName", GetLoginName()
    FillField WordDoc, "FirmPhone", FirmPhone()
    FillField WordDoc, "abstractor", sAbst
    FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt])
    FillField WordDoc, "citystzip", d!City & ", " & d!State & " " & FormatZip(d!ZipCode)
    FillField WordDoc, "DebtorNames", DebtorNames(0, 1)
    FillField WordDoc, "DOTDate", Format(d!DOTdate, "mmmm, d"", ""yyyy")
    FillField WordDoc, "LoanAmount", Format(d!OriginalPBal, "currency")
    FillField WordDoc, "FileNumber", Forms![case list]!FileNumber
    FillField WordDoc, "Desc", d!LegalDescription
    FillField WordDoc, "email", d!EMail
        
WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "TitleOrder BK.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "TitleOrder BK.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
    
End Sub

Public Sub Doc_BKBOAMotionForRelief(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim dd As Recordset
Dim ddd As Recordset
Dim FileNumber As Long, Debtorsplural As Boolean
Dim i As Integer, itemcount As Integer, TotalItems As Currency, itemsFields As String
Dim delinquent As Currency
Dim delinquenttotal, encumbrances As Currency
newNextNumber = 1
NextNumber = 1

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBOAMFr WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Motion for Relief BOA")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Motion for Relief BOA.doc", False)
WordObj.Visible = True
WordObj.ScreenUpdating = False
WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
'WordDoc.Bookmarks("AttorneyInfo").Select
'WordDoc.Bookmarks("AttorneyInfo").Range.Text = "Diane Rosenberg" & vbCr & "VA Bar 35237"

'Judge = Right$(UCase$(d!CaseNo), 3)
'CoDebtor = (GetNames(0, 1, "BKCoDebtor=True") <> "" And d![BKdetails.Chapter] = 13)

encumbrances = Nz((InputBox("Sum of known encumbrances?")), 0)
Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (BKOwner=True OR BKMortgagor=True)") > 1)

FillField WordDoc, "Header", _
    "IN THE UNITED STATES BANKRUPTCY COURT" & vbCr & _
    "FOR THE " & UCase$(d!Name) & vbCr & _
    d!Location

FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")

FillField WordDoc, "InvestorAddr", UCase$(d!Investor) & vbCr & RemoveLF(d!InvestorAddress)
FillField WordDoc, "Respondents", _
    GetAddresses(0, 4, _
        IIf(d![BKdetails.Chapter] = 13, _
            "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
            "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"), vbCr) & _
    IIf(d![BKdetails.Chapter] = 7, _
        vbCr & vbCr & "and" & vbCr & vbCr & FormatName("", _
                                                        UCase$(Nz(d!First)), _
                                                        UCase$(Nz(d!Last)), _
                                                        ", CHAPTER 7 TRUSTEE", _
                                                        d!Address, _
                                                        d!Address2, _
                                                        d![BKTrustees.City], _
                                                        d![BKTrustees.State], _
                                                        d!Zip, _
                                                        vbCr), _
        "")

FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "Date", Format(Date, "mmmm d yyyy")
FillField WordDoc, "AndAttorney", IIf(IsNull(d!AttorneyLastName), "", "and Debtor's attorney ")
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "GetNextNumber1", GetNextNumber()
FillField WordDoc, "GetNextNumber2", GetNextNumber()
FillField WordDoc, "GetNextNumber3", GetNextNumber()
FillField WordDoc, "GetNextNumber4", GetNextNumber()

FillField WordDoc, "OtherCostsParagraph", IIf(d![otherCosts] > 0 Or IsNull(d![otherCosts]) = False, GetNextNumber() & "The foregoing Other Costs consist of the following:", "")
FillField WordDoc, "OtherCostsTable", IIf(d![otherCosts] > 0 Or IsNull(d![otherCosts]) = False, "Pre-Petition Or Post-Petition   | Transaction Date | Fee Description | Amount", "")
If d!otherCosts > 0 Or IsNull(d!otherCosts) = False Then
' Do nothing
Else
'Other costs Blank
NextNumber = NextNumber - 2
End If

FillField WordDoc, "GetNextNumber7", GetNextNumber()
FillField WordDoc, "GetNextNumber8", GetNextNumber()
FillField WordDoc, "GetNextNumber9", GetNextNumber()

If MsgBox("Is Debtor being evaluated for Loss Mit?", vbYesNo) = vbYes Then
    FillField WordDoc, "LossMit", GetNextNumber() & "As of the date of this Motion, the Debtor is being evaluated for a loss mitigation option.   Additional information regarding such evaluation is available upon request."
Else
    FillField WordDoc, "LossMit", ""
End If

FillField WordDoc, "GetNextNumber10", GetNextNumber()
FillField WordDoc, "GetNextNumber11", GetNextNumber()
FillField WordDoc, "ConvChapter", IIf(IsNull(d![ConvChapter]) = True, d![BKdetails.Chapter], d![ConvChapter])
FillField WordDoc, "FilingDate", Format(d![DateofFiling], "mmmm d"", ""yyyy")
FillField WordDoc, "ConvDate", IIf(IsNull(d![ConvDate]) = True, "", "An orderF converting the case to a case under chapter 7 was entered on " & Format(d![ConvDate], "mmmm d"", ""yyyy") & ".")
FillField WordDoc, "OriginalPbal", Format(d![OriginalPBal], "Currency")
FillField WordDoc, "SecurityDoc", Nz(d!SecurityDoc)
FillField WordDoc, "Jurisdiction", Forms![case list]!JurisdictionID.Column(1)
FillField WordDoc, "SecurityParagraph", IIf((IsNull(d![SecurityDoc]) = False And d![AssignByDOT] = 1), GetNextNumber() & "All rights and remedies under the Security Instrument have been assigned to the Movant pursuant to that certain assignment of Security Instrument , a copy of which is attached hereto as Exhibit C.", "")
FillField WordDoc, "boaAsOfDate", Format(d![boaAsOfDate], "mmmm d"", ""yyyy")
FillField WordDoc, "PrincipalBalance", Format(d!principalBalance, "Currency")
FillField WordDoc, "AccruedInterest", Format(d!accruedInterest, "Currency")
FillField WordDoc, "LateCharges", Format(d!lateCharges, "Currency")
FillField WordDoc, "InsurancePremiums", Format(d!insurancePremiums, "Currency")
FillField WordDoc, "DebtorTaxesInsurance", Format(d!debtorTaxesInsurance, "Currency")
FillField WordDoc, "OtherCosts", Format(d!otherCosts, "Currency")

FillField WordDoc, "PartialPayments", Format(d!partialPayments, "Currency")
FillField WordDoc, "OutstandingObligations", Format(d!outstandingObligations, "Currency")
FillField WordDoc, "BOAAsofDate", Format(d![boaAsOfDate], "mmmm d"", ""yyyy")
FillField WordDoc, "Fee", Format(d![Fee], "Currency")
FillField WordDoc, "MarketValue", Format(d![MarketValue], "Currency")
FillField WordDoc, "Source", Nz(d!Source)
FillField WordDoc, "Encumbrances", Format(encumbrances, "Currency")
FillField WordDoc, "GetNewNextNumber1", GetNewNextNumber()
FillField WordDoc, "GetNewNextNumber2", GetNewNextNumber()
FillField WordDoc, "GetNewNextNumber3", GetNewNextNumber()
FillField WordDoc, "GetnewNextNumber4", GetNewNextNumber()

TotalItems = 0
itemsFields = ""
If (d![otherCosts] = 0 Or IsNull(d![otherCosts]) = True) Then
    
      FillField WordDoc, "Line_Items", ""
      FillField WordDoc, "PreTitle", ""
      FillField WordDoc, "PostTitle", ""
      FillField WordDoc, "PreTotal", ""
      FillField WordDoc, "PostTotal", ""
'skip other costs
Else
    Set dd = CurrentDb.OpenRecordset("SELECT PrePost, TimeStamp,  Desc, Amount FROM BKDebt WHERE FileNumber=" & d![FileNumber] & " ORDER BY Timestamp;", dbOpenSnapshot)
    If dd.EOF Then      ' no extra lines
        FillField WordDoc, "Line_Items", ""
    Else
        dd.MoveLast
        itemcount = dd.RecordCount
        ' Make enough lines
        For i = 1 To itemcount
            itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
        Next i
        itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
        FillField WordDoc, "Line_Items", itemsFields
        dd.MoveFirst
        i = 1
        Do While Not dd.EOF
            FillField WordDoc, "Item" & i, dd!PrePost & vbTab & Format(dd!Timestamp, "mm/dd/yyyy") & vbTab & dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency")
     
            TotalItems = TotalItems + Nz(dd!Amount, 0)
            dd.MoveNext
            i = i + 1
        Loop
        FillField WordDoc, "PreTitle", "Pre-Petition Total:"
        FillField WordDoc, "PostTitle", "Post-Petition Total:"
        FillField WordDoc, "PreTotal", Format(Nz(DSum("Amount", "BKDebt", "Prepost = 'Pre-Petition' AND FileNumber=" & [Forms]![case list]![FileNumber] & ""), 0), "Currency")
        FillField WordDoc, "PostTotal", Format(Nz(DSum("Amount", "BKDebt", "Prepost = 'Post-Petition' AND FileNumber=" & [Forms]![case list]![FileNumber] & ""), 0), "Currency")
        'FillField WordDoc, "Total", Format(totalItems, "Currency")
    End If
    dd.Close

End If
TotalItems = 0
itemsFields = ""
Set ddd = CurrentDb.OpenRecordset("SELECT numMissedPayments, missedPaymentsTo,  missedPaymentsFrom, MonthlyAmount FROM BKMissedPayments WHERE FileNumber=" & d![FileNumber] & " ORder BY MissedPaymentsFrom;", dbOpenSnapshot)
If ddd.EOF Then      ' no extra lines
    FillField WordDoc, "Line_Items", ""
Else
    ddd.MoveLast
    itemcount = ddd.RecordCount
    ' Make enough lines
    For i = 1 To itemcount
        itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
    Next i
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
    FillField WordDoc, "Line_Items2", itemsFields
    ddd.MoveFirst
    i = 1
    Do While Not ddd.EOF
        delinquent = ddd!numMissedPayments * ddd!MonthlyAmount
        FillField WordDoc, "Item" & i, ddd!numMissedPayments & vbTab & ddd!missedPaymentsFrom & _
        vbTab & ddd!missedPaymentsTo & vbTab & Format$(Nz(ddd!MonthlyAmount, 0), "Currency") & vbTab & Format(delinquent, "Currency")
        
 
        TotalItems = TotalItems + Nz(ddd!MonthlyAmount, 0)
        delinquenttotal = delinquent + delinquenttotal
        ddd.MoveNext
        i = i + 1
    Loop
    FillField WordDoc, "Total", Format(delinquenttotal + d!partialPayments, "Currency")

End If
ddd.Close

FillField WordDoc, "TrusteeName", FormatName("", d![First], d![Last] & IIf(d![BKdetails.Chapter] = 11, "", ", Trustee"), "", d![Address], d![Address2], d![BKTrustees.City], d![BKTrustees.State], d![Zip])
FillField WordDoc, "AttorneyName", d![AttorneyFirstName] & " " & d![AttorneyLastName] & IIf(IsNull(d![AttorneyLastName]), "", ", Esquire")
FillField WordDoc, "AttorneyFirmName", IIf(IsNull(d![AttorneyFirm]), "", d![AttorneyFirm]) & vbCr & d![AttorneyAddress]

    If Forms!BankruptcyPrint!chElectronicSignature Then
        FillField WordDoc, "ElectronicSignature", "/s/ " & Forms!BankruptcyPrint!cbxAttorney
    Else
        FillField WordDoc, "ElectronicSignature", "_______________________________"
    End If
    FillField WordDoc, "AttorneySignature", Forms!BankruptcyPrint!cbxAttorney
FillField WordDoc, "BkService", BKService(0)

WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
'WordDoc.SaveAs EMailPath & "BOA Motion For Relief.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "BOA Motion for Relief.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_ClerkCoverLTR(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim dd As Recordset

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Clerk Cover Letter_New")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Clerk Cover Letter_New.doc", False)
WordObj.Visible = True

FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
FillField WordDoc, "PropertyAddress", [Forms]![ForeclosureDetails]![PropertyAddress] & IIf(Len(Forms!ForeclosureDetails![Fair Debt] & "") = 0, "", ", " & Forms!ForeclosureDetails![Fair Debt])
FillField WordDoc, "CIty", [Forms]![ForeclosureDetails]![City]
FillField WordDoc, "State", [Forms]![ForeclosureDetails]![State]
FillField WordDoc, "Zip", FormatZip([Forms]![ForeclosureDetails]![ZipCode])
FillField WordDoc, "CaseNumber", Nz(Forms![ForeclosureDetails]![CourtCaseNumber])
FillField WordDoc, "Filenumber", [Forms]![case list]![FileNumber]
FillField WordDoc, "Jurisdiction", Forms![case list]![JurisdictionID].Column(1)

FillField WordDoc, "GetLoginName", GetLoginName()

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Clerk Cover Letter.doc"
'Call SaveDoc(WordDoc, Forms![Case list].FileNumber, "Clerk Cover Letter.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing

End Sub
Public Sub Doc_BKChaseMotionForRelief(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim dd As Recordset
Dim ddd As Recordset
Dim FileNumber As Long, Debtorsplural As Boolean
Dim response As Integer
Dim rightToForecloseLanguage As String
Dim i As Integer, itemcount As Integer, TotalItems As Currency, itemsFields As String
Dim delinquent As Currency
Dim delinquenttotal, encumbrances As Currency

newNextNumber = 1
NextNumber = 1
lettercounter = 1
FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryMFRChaseWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Motion for Relief Chase")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Motion for Relief Chase.doc", False)
WordObj.Visible = True
'WordObj.ScreenUpdating = False
'WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]

FillField WordDoc, "Header", "IN THE UNITED STATES BANKRUPTCY COURT" & vbCr & _
    "FOR THE " & UCase$(d!Name) & vbCr & d!Location
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "Date", Format(Date, "mmmm d yyyy")
FillField WordDoc, "AndAttorney", IIf(IsNull(d!AttorneyLastName), "", "and Debtor's attorney ")
FillField WordDoc, "Investor", d!Investor & IIf(d![Districts.ID] = 7 Or d![Districts.ID] = 6, " ", _
    " its successors and/or assigns,") & " movant, by its attorneys, " & [Forms]![BankruptcyPrint]![cbxAttorney] & ", and " & FirmName() & ", and respectfully represents as follows:"
FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")
FillField WordDoc, "InvestorAddr", UCase$(d!Investor) & vbCr & RemoveLF(d!InvestorAddress)
FillField WordDoc, "Respondents", _
    GetAddresses(0, 4, _
        IIf(d![BKdetails.Chapter] = 13, _
            "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
            "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"), vbCr) & _
            IIf(d![BKdetails.Chapter] = 7, vbCr & " and " & vbCr & vbCr & UCase$(Nz(d![First])) & " " & UCase$(Nz(d![Last])) & ", CHAPTER 7 TRUSTEE", "")
FillField WordDoc, "capTrustee", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), UCase([Forms]![BankruptcyDetails]![Trustee].Column(2)), "")
FillField WordDoc, "Tail", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), vbTab & vbCr & "Trustee", "")
FillField WordDoc, "More", IIf(d![BKdetails.Chapter] = 13 And (d!District = 6 Or d!District = 7), "and" & vbCr, "")
 '-----------------------------------------------------------
FillField WordDoc, "GetNextNumber1", GetNextNumber()
Dim chCoDebtor As Boolean
 If GetNames(0, 1, "BKCoDebtor=True") <> "" And d![BKdetails.Chapter] = 13 Then chCoDebtor = True
FillField WordDoc, "chCoDebtor", IIf(chCoDebtor, " and 1301", "")
'2.
FillField WordDoc, "GetNextNumber2", GetNextNumber()
FillField WordDoc, "DateOFFiling", Format$(d![DateofFiling], "mmmm d"", ""yyyy")

If CountNames([FileNumber], "BKDebtor = True And (BKOwner=True Or BKMortgagor=True)") > 1 Then Debtorsplural = True

FillField WordDoc, "Debtor", GetNames(0, 2, "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)") & " (""Debtor" & IIf(Debtorsplural, "s", "") & """)"
FillField WordDoc, "chapter", IIf(IsNull(d![ConvChapter]), d![BKdetails.Chapter], d![ConvChapter])
FillField WordDoc, "Value2", IIf(IsNull(d![ConvDate]), "", ", which case later converted to Chapter " & d![BKdetails.Chapter] & " on ") & Format$(d!ConvDate, "mmmm d"", ""yyyy")
'3.
FillField WordDoc, "GetNextNumber3", IIf(d![BKdetails.Chapter] = 11, "", GetNextNumber() & d![First] _
    & " " & d![Last] & " is the Chapter " & d![BKdetails.Chapter] & " trustee of the Debtor" & IIf([Debtorsplural], "s'", "'s") & " estate.")

'4. if there's any coDebtor
If Len(GetNames(0, 2, "BKCoDebtor=True")) > 0 Then
FillField WordDoc, "GetNextNumber4", GetNextNumber() & GetNames(0, 2, "BKCoDebtor=True") & " (""Co-Debtor" & IIf(CountNames(0, "BKCoDebtor=True") > 1, "s", "") & """) " & _
        IIf(CountNames(0, "BKCoDebtor=True") > 1, "are co-debtors", "is a co-debtor") & " on this note."
Else
    FillField WordDoc, "GetNextNumber4", ""
End If
'5.
FillField WordDoc, "GetNextNumber5", GetNextNumber()
FillField WordDoc, "value5", IIf([Debtorsplural], "s", "")
FillField WordDoc, "value6", IIf(d!RealEstate, "parcel of " & IIf(d![Leasehold], "leasehold", "fee simple"), "")
FillField WordDoc, "value7", IIf(IsNull(d![LegalDescription]), "", "with a legal description of """ & d![LegalDescription] & """ also ")
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "value8", IIf(IsNull(d![PropertyDesc]), "", d![PropertyDesc])
'6.
FillField WordDoc, "GetNextNumber6", GetNextNumber()

FillField WordDoc, "AssignmentInfo", AssignmentInfo() & IIf([Forms]![case list]![ClientID] = 385, "", " The documents evidencing the movant's security interest are attached hereto. ")
'FillField WordDoc, "AssignmentInfo", IIf([Forms]![Case List]![ClientID] = 385, "", " The documents evidencing the movant's security interest are attached hereto. ")
   
'If [Forms]![Print Motion for Relief]![Text33] = "Yes" Then  'Chase and Chpt 13
'    If [Forms]![Print Motion for Relief]![Text31] = "Yes" Then  'Note lost?
'        FillField WordDoc, "checktxt33", GetNextNumber()
'        FillField WordDoc, "txtOf33", " JPMorgan Chase Bank, N.A., services the loan on the property referenced in this Motion for Relief. In the event the automatic stay in this case is lifted/set aside, this case dismisses, and/or the debtor obtains a discharge and a foreclosure action is commenced on the mortgaged property, the foreclosure will be conducted in the name of " & d![Investor] & "."
'    ElseIf [Forms]![Print Motion for Relief]![Text34] = "Yes" Then
'        FillField WordDoc, "checktxt33", GetNextNumber()
'        FillField WordDoc, "txtOf33", " JPMorgan Chase Bank, N.A., services the loan on the property referenced in this Motion for Relief. In the event the automatic stay in this case is lifted/set aside, this case dismisses, and/or the debtor obtains a discharge and a foreclosure action is commenced on the mortgaged property, the foreclosure will be conducted in the name of " & d![Investor] & "."
'
'    Else
'        FillField WordDoc, "checktxt33", GetNextNumber()
'        FillField WordDoc, "txtOf33", " JPMorgan Chase Bank, N.A., services the loan on the property referenced in this Motion for Relief. In the event the automatic stay in this case is lifted/set aside, this case dismisses, and/or the debtor obtains a discharge and a foreclosure action is commenced on the mortgaged property, the foreclosure will be conducted in the name of " & d![Investor] & "."
'    End If
'End If

FillField WordDoc, "BeforeNextNo", GetNextNumber() & " " & IIf([Forms]![Print Motion for Relief]![Text31] = "Yes", "Said entity is unable to find the promissory note and will seek to prove the promissory note using a lost note affidavit.", _
IIf([Forms]![Print Motion for Relief]![Text31] = "No" And [Forms]![Print Motion for Relief]![Text34] = "Yes", "Said entity, directly or through an agent, has possession of the promissory note. The promissory note is either made payable to said entity or has been duly endorsed.", _
IIf([Forms]![Print Motion for Relief]![Text31] = "No" And [Forms]![Print Motion for Relief]![Text34] = "No", "Said entity, directly or through an agent, has possession of the promissory note. Said entity will enforce the promissory note as transferee in possession.", "")))

FillField WordDoc, "GetNextNumber8", GetNextNumber()
FillField WordDoc, "Value9", IIf(d![RealEstate], DOTWord(d![DOT]), IIf(IsNull(d![PropertyContract]), "", d![PropertyContract]))
FillField WordDoc, "DueDate", Format$([Forms]![Print Motion for Relief]![DueDate])
FillField WordDoc, "amount", Format$([Forms]![Print Motion for Relief]![Amount], "Currency")

FillField WordDoc, "GetNextNumber9", GetNextNumber()
FillField WordDoc, "Value10", IIf(Debtorsplural, "s are", " is")
FillField WordDoc, "Value11", IIf(d![RealEstate], "Note and Mortgage", IIf(IsNull(d![PropertyContract]), "", Nz(d![PropertyContract])))

FillField WordDoc, "GetNextNumber10", GetNextNumber()
FillField WordDoc, "PaymentMonth", Nz([Forms]![Print Motion for Relief]![Payment])
FillField WordDoc, "Value13", IIf(d![RealEstate], "Debtor" & IIf(Debtorsplural, "s'", "'s") & " residence", "subject property") & " is dissipating."

FillField WordDoc, "GetNextNumber11", GetNextNumber()
FillField WordDoc, "GetNextNumber12", GetNextNumber()
FillField WordDoc, "Section", IIf(chCoDebtor, "Sections 362 and 1301", "Section 362")
FillField WordDoc, "NoteDeedTrust", IIf(d![RealEstate], "Note and " & DOTWord(d!DOT), IIf(IsNull(d![PropertyContract]), "", d![PropertyContract]))
FillField WordDoc, "GetNextNumber13", GetNextNumber()
FillField WordDoc, "Section1", IIf([chCoDebtor], "Sections 362 and 1301", "Section 362")
FillField WordDoc, "Section2", IIf(d![RealEstate], "Note and " & DOTWord(d!DOT), IIf(IsNull(d![PropertyContract]), "", d![PropertyContract])) & "."

If [Forms]![Print Motion for Relief]![chReorganization] Then
    FillField WordDoc, "GetNextNumber14", GetNextNumber()
    FillField WordDoc, "txtOf14", "The subject property is not necessary for an effective reorganization."
Else
    FillField WordDoc, "GetNextNumber14", ""
    FillField WordDoc, "txtOf14", ""
End If

FillField WordDoc, "investor2", d![Investor] & IIf(d![Districts.ID] = 7 Or d![Districts.ID] = 6, " ", " its successors and/or assigns,")
FillField WordDoc, "value14", IIf(d![RealEstate], "a foreclosure sale, accept a deed in lieu or agree to a short sale of the real property and improvements located at " & d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode]), "repossession and sale of the " & IIf(IsNull(d![PropertyDesc]), "", d![PropertyDesc]) & ";")

FillField WordDoc, "ElectronicSignature", IIf(Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & Forms!BankruptcyPrint!cbxAttorney, "")
FillField WordDoc, "AttorneySignature", [Forms]![BankruptcyPrint]![cbxAttorney]
FillField WordDoc, "BarCode", IIf(Not IsNull(([Forms]![BankruptcyPrint]![cbxAttorney].Column(1))), FetchBarNumber([Forms]![BankruptcyPrint]![cbxAttorney].Column(1), [Forms]![BankruptcyDetails]![District].Column(4), "BK"), "")
FillField WordDoc, "Date", Format$(Date, "mmmm d, yyyy")
FillField WordDoc, "BKService", BKService(0)
'FillField WordDoc, "TrusteeName", FormatName("", d![First], d![Last] & IIf(d![Chapter] = 11, "", ", Trustee"), "", d!Address, d![Address2], d![City], d![State], d![Zip])
'FillField WordDoc, "TrusteeName", FormatName("", d![First], d![Last] & IIf(d![BKdetails.Chapter] = 11, "", ", Trustee"), "", d![Address], d![Address2], d![BKTrustees.City], d![BKTrustees.State], d![Zip])
FillField WordDoc, "TrusteeName", Nz(d![First] & " " & d![Last]) & IIf(d![BKdetails.Chapter] = 11, "", IIf(IsNull(d![First] & " " & d![Last]), "", ", Trustee"))
FillField WordDoc, "AttorneyName", IIf([Forms]![BankruptcyDetails]![ckProSe], "", d![AttorneyFirstName] & " " & d![AttorneyLastName] & IIf(IsNull(d![AttorneyLastName]), "", ", Esquire"))
FillField WordDoc, "AttorneyFirmName", IIf(IsNull(d![AttorneyFirm]), "", d![AttorneyFirm])
FillField WordDoc, "AttAddr", d!AttorneyAddress

WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
End Sub

Public Sub Doc_NoticeOfNonPay(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim FileNumber As Long
Dim d As Recordset
'Dim Debtorsplural As Boolean

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("Select * from qryRptBKNonPayWord where fileNumber = " & FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Notice of Non Payment and Termination")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Notice of Non Payment and Termination.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![FileNumber])

 If ([Forms]![BankruptcyPrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2") & vbCr & FirmPhoneVA()
ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then    'MD
    FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
         DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1") & vbCr & FirmPhone()
ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
    FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
         DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3") & vbCr & FirmPhone()
End If

FillField WordDoc, "Header", d!Location
'Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (Owner=True OR Mortgagor=True)") > 1)
FillField WordDoc, "Debtors", GetNames([FileNumber], 3, "BKDebtor = true or BKCoDebtor = true")     'DebtorNames(FileNumber, 3)
FillField WordDoc, "Debtors2", GetAddresses(0, 5, "(BKDebtor=True or BKCoDebtor = true)")
FillField WordDoc, "Investor", d!Investor & vbCr & UCase$(Nz(d![InvestorAddress]))
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![Chapter]
FillField WordDoc, "capTrustee", IIf(d![Chapter] = 13 And (d!District = 6 Or d!District = 7), [Forms]![BankruptcyDetails]![Trustee].Column(2), "")
FillField WordDoc, "Date", Format(Date, "mmmm d yyyy")
'FillField WordDoc, "Respondents", GetNames(0, 3, _
'    IIf(d![Chapter] = 13, "(BKDebtor=True OR BKCoDebtor=True) AND (Owner=True OR Mortgagor=True)", "BKDebtor=True AND (Owner=True OR Mortgagor=True)"))
FillField WordDoc, "Respondents", _
    GetAddresses(0, 4, _
        IIf(d![Chapter] = 13, _
            "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
            "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"), vbCr)
FillField WordDoc, "More", IIf(d![Chapter] = 13 And (d!District = 6 Or d!District = 7), "and" & vbCr, "")
FillField WordDoc, "capTrustee", IIf(d![Chapter] = 13 And (d!District = 6 Or d!District = 7), UCase([Forms]![BankruptcyDetails]![Trustee].Column(2)), "")
FillField WordDoc, "Tail", IIf(d![Chapter] = 13 And (d!District = 6 Or d!District = 7), vbTab & vbCr & "Trustee", "")
FillField WordDoc, "More", IIf(d![Chapter] = 13 And (d!District = 6 Or d!District = 7), "and" & vbCr, "")
    
FillField WordDoc, "Modify", Format$(d![modify], "mmmm d"", ""yyyy")
FillField WordDoc, "FiledDate", Format$(GetBiggestValue(d![Affidavit], d![2ndAff], d![3rdAff], d![4rdAff], d![5rdAff], d![6rdAff]), "mmmm d"", ""yyyy")
If Forms!BankruptcyPrint!chElectronicSignature Then
        FillField WordDoc, "ElectronicSignature", "/s/ " & Forms!BankruptcyPrint!cbxAttorney
Else
        FillField WordDoc, "ElectronicSignature", "_______________________________"
End If
FillField WordDoc, "AttorneySignature", Forms!BankruptcyPrint!cbxAttorney

FillField WordDoc, "FirmAddr", FirmShortAddress() & vbCr & FirmPhone()
If IsNull(DLookup("[FedBar]", "[Staff]", "[ID] = " & [Forms]![BankruptcyPrint]![cbxAttorney].Column(1))) Then
    FillField WordDoc, "BarCode", "MD Bar "
Else
  FillField WordDoc, "BarCode", Replace(FetchBarNumber([Forms]![BankruptcyPrint]![cbxAttorney].Column(1), [Forms]![BankruptcyDetails]![District].Column(4), "BK"), "Federal", "MD")
End If
FillField WordDoc, "Trustee", d![First] & " " & d![Last]
FillField WordDoc, "AttorneyName", d![FirstName] & " " & d![LastName]

d.Close
Set d = Nothing
WordObj.Selection.HomeKey wdStory, wdMove
Set WordObj = Nothing

End Sub

Public Sub Doc_NoticeOfCure(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim FileNumber As Long
Dim d As Recordset
Dim st As String
st = Forms!BankruptcyPrint!State
'Dim Debtorsplural As Boolean

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("Select * from qryRptBKNonPayWord where fileNumber = " & FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Notice of Cure of Notice Of Default")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Notice of Cure of Notice Of Default.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![FileNumber])

If st = "MD" Then
    If IsNull(DLookup("[MDBar]", "[Staff]", "[ID] = " & [Forms]![BankruptcyPrint]![cbxAttorney].Column(1))) Then
      FillField WordDoc, "BarCode", "MD Bar "
    Else
      FillField WordDoc, "BarCode", "MD Bar " & DLookup("[MDBar]", "[Staff]", "[ID] = " & [Forms]![BankruptcyPrint]![cbxAttorney].Column(1))
    End If
ElseIf st = "VA" Then
    If IsNull(DLookup("[VABar]", "[Staff]", "[ID] = " & [Forms]![BankruptcyPrint]![cbxAttorney].Column(1))) Then
      FillField WordDoc, "BarCode", "VA Bar "
    Else
      FillField WordDoc, "BarCode", "VA Bar " & DLookup("[VABar]", "[Staff]", "[ID] = " & [Forms]![BankruptcyPrint]![cbxAttorney].Column(1))
    End If
Else  'DC
    If IsNull(DLookup("[DCBar]", "[Staff]", "[ID] = " & [Forms]![BankruptcyPrint]![cbxAttorney].Column(1))) Then
      FillField WordDoc, "BarCode", "DC Bar "
    Else
      FillField WordDoc, "BarCode", "DC Bar " & DLookup("[VABar]", "[Staff]", "[ID] = " & [Forms]![BankruptcyPrint]![cbxAttorney].Column(1))
    End If
End If

If ([Forms]![BankruptcyPrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2") & vbCr & FirmPhoneVA()
ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then    'MD
    FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
         DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1") & vbCr & FirmPhone()
ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
    FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
         DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3") & vbCr & FirmPhone()
End If


FillField WordDoc, "Header", d!Location
FillField WordDoc, "DistrictName", d!Name
FillField WordDoc, "Investor", d!Investor & vbCr & Nz(d!InvestorAddress)
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![Chapter]
FillField WordDoc, "capTrustee", IIf(d![Chapter] = 13 And (d!District = 6 Or d!District = 7), [Forms]![BankruptcyDetails]![Trustee].Column(2), "")

FillField WordDoc, "Date", Format(Date, "mmmm d yyyy")
'FillField WordDoc, "Respondents", GetNames(0, 3, _
'    IIf(d![Chapter] = 13, "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"))
FillField WordDoc, "Respondents", _
    GetAddresses(0, 4, _
        IIf(d![Chapter] = 13, _
            "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
            "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"), vbCr)
FillField WordDoc, "More", IIf(d![Chapter] = 13 And (d!District = 6 Or d!District = 7), "and" & vbCr, "")
FillField WordDoc, "capTrustee", IIf(d![Chapter] = 13 And (d!District = 6 Or d!District = 7), UCase([Forms]![BankruptcyDetails]![Trustee].Column(2)), "")
FillField WordDoc, "Tail", IIf(d![Chapter] = 13 And (d!District = 6 Or d!District = 7), vbTab & vbCr & "Trustee", "")
FillField WordDoc, "More", IIf(d![Chapter] = 13 And (d!District = 6 Or d!District = 7), "and" & vbCr, "")

FillField WordDoc, "AffDate", Format$(GetBiggestValue(d![Affidavit], d![2ndAff], d![3rdAff], d![4rdAff], d![5rdAff], d![6rdAff]), "mmmm d"", ""yyyy")
If Forms!BankruptcyPrint!chElectronicSignature Then
        FillField WordDoc, "ElectronicSignature", "/s/ " & Forms!BankruptcyPrint!cbxAttorney
Else
        FillField WordDoc, "ElectronicSignature", "_______________________________"
End If
FillField WordDoc, "AttorneySignature", Forms!BankruptcyPrint!cbxAttorney
'FillField WordDoc, "FedBar", DLookup("FedBar", "Staff", "ID= " & [Forms]![BankruptcyPrint]![cbxAttorney].Column(1))
FillField WordDoc, "FirmAddr", FirmAddress() & vbCr & FirmPhone()
FillField WordDoc, "Trustee", d![First] & " " & d![Last]
FillField WordDoc, "AttorneyName", d![FirstName] & " " & d![LastName]
FillField WordDoc, "Debtors", UCase(DebtorNames(0, 3))
FillField WordDoc, "DebtorwithAddr", GetAddresses(0, 5, "(BKDebtor=True or BKCoDebtor = true)")

d.Close
Set d = Nothing
WordObj.Selection.HomeKey wdStory, wdMove
Set WordObj = Nothing

End Sub

Public Sub Doc_certOfNoncompliance(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim FileNumber As Long
Dim d As Recordset
'Dim Debtorsplural As Boolean

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("Select * from qryRptBKNonPayWord where fileNumber = " & FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Certificate of Non Compliance")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Certificate of Non Compliance.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![FileNumber])

 If ([Forms]![BankruptcyPrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2") & vbCr & FirmPhoneVA()
ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then    'MD
    FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
         DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1") & vbCr & FirmPhone()
ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
    FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
         DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3") & vbCr & FirmPhone()
End If

FillField WordDoc, "Header", d!Location
'Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (Owner=True OR Mortgagor=True)") > 1)
'FillField WordDoc, "Debtors", DebtorNames(FileNumber, 3)

FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![Chapter]
FillField WordDoc, "Date", ThisDate(Date)
FillField WordDoc, "Respondents", GetNames(0, 3, _
    IIf(d![Chapter] = 13, "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"))
FillField WordDoc, "FiledDate", Format$(GetBiggestValue(d![Affidavit], d![2ndAff], d![3rdAff], d![4rdAff], d![5rdAff], d![6rdAff]), "mmmm d"", ""yyyy")
If Forms!BankruptcyPrint!chElectronicSignature Then
        FillField WordDoc, "ElectronicSignature", "/s/ " & Forms!BankruptcyPrint!cbxAttorney
Else
        FillField WordDoc, "ElectronicSignature", "_______________________________"
End If
FillField WordDoc, "Debtors0", DebtorNames(FileNumber, 3)
FillField WordDoc, "PopUp", IIf(IsNull([Forms]![Bankruptcy Default]![txtDefault]), "____________________", [Forms]![Bankruptcy Default]![txtDefault])
FillField WordDoc, "PropertyAddr", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "AttorneySignature", Forms!BankruptcyPrint!cbxAttorney

If IsNull(DLookup("[vaBar]", "[Staff]", "[ID] = " & [Forms]![BankruptcyPrint]![cbxAttorney].Column(1))) Then
    FillField WordDoc, "BarCode", "VA Bar "
Else
  FillField WordDoc, "BarCode", FetchBarNumber([Forms]![BankruptcyPrint]![cbxAttorney].Column(1), [Forms]![BankruptcyDetails]![District].Column(4), "BK")
End If
FillField WordDoc, "Trustee", d![First] & " " & d![Last]
FillField WordDoc, "TrusteeAddr", d![BKTrustees.Address] & IIf(IsNull(d![Address2]), "", vbCr & d![Address2]) & vbCr & _
     d![BKTrustees.City] & " " & d![BKTrustees.State] & ", " & FormatZip(d![BKTrustees.Zip])
FillField WordDoc, "AttorneyName", d![FirstName] & " " & d![LastName]
FillField WordDoc, "AttnyAddr", d![BKAttorneys.Address] & vbCr & d![BKAttorneys.City] & ", " & d![BKAttorneys.State] & " " & FormatZip(d![BKAttorneys.Zip])
FillField WordDoc, "Debtors", GetAddresses(0, 5, "(BKDebtor=True or BKCoDebtor = true)")
    
d.Close
Set d = Nothing
WordObj.Selection.HomeKey wdStory, wdMove
Set WordObj = Nothing

End Sub

Public Sub Doc_BKBOAMotionForReliefCh13(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim dd As Recordset
Dim ddd As Recordset
Dim FileNumber As Long, Debtorsplural As Boolean
Dim response As Integer
Dim rightToForecloseLanguage As String
Dim i As Integer, itemcount As Integer, TotalItems As Currency, itemsFields As String
Dim delinquent As Currency
Dim delinquenttotal, encumbrances As Currency

newNextNumber = 1
NextNumber = 1
lettercounter = 1
FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryBOAMFr13 WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Motion for Relief BOA CH13")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Motion for Relief BOA CH13.doc", False)
WordObj.Visible = True
WordObj.ScreenUpdating = False
WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
'WordDoc.Bookmarks("AttorneyInfo").Select
'WordDoc.Bookmarks("AttorneyInfo").Range.Text = "Diane Rosenberg" & vbCr & "VA Bar 35237"

'Judge = Right$(UCase$(d!CaseNo), 3)
'CoDebtor = (GetNames(0, 1, "BKCoDebtor=True") <> "" And d![BKdetails.Chapter] = 13)

encumbrances = Nz((InputBox("Sum of known encumbrances?")), 0)

rightToForecloseLanguage = "Enter a Numeric option (1, 2, or 3)" & vbCr & vbCr
rightToForecloseLanguage = rightToForecloseLanguage + "Option 1. The Note is either made payable to Movant or has been duly endorsed." & vbCr & vbCr
rightToForecloseLanguage = rightToForecloseLanguage + "Option 2. Movant will enforce the Note as transferee in possession." & vbCr & vbCr
rightToForecloseLanguage = rightToForecloseLanguage + "Option 3. Movant is unable to find the Note and will seek to prove the Note using a lost note affidavit."

response = InputBox(rightToForecloseLanguage, "Which Right to Foreclose Language?")

Select Case response

    Case 1
        FillField WordDoc, "Response", "The Note is either made payable to Movant or has been duly endorsed."
    Case 2
        FillField WordDoc, "Response", "Movant will enforce the Note as transferee in possession."
    Case 3
        FillField WordDoc, "Response", "Movant is unable to find the Note and will seek to prove the Note using a lost note affidavit."
End Select

Debtorsplural = (CountNames(FileNumber, "BKDebtor = True AND (BKOwner=True OR BKMortgagor=True)") > 1)

FillField WordDoc, "Header", _
    "IN THE UNITED STATES BANKRUPTCY COURT" & vbCr & _
    "FOR THE " & UCase$(d!Name) & vbCr & _
    d!Location

FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")

FillField WordDoc, "InvestorAddr", UCase$(d!Investor) & vbCr & RemoveLF(d!InvestorAddress)
FillField WordDoc, "Respondents", _
    GetAddresses(0, 4, _
        IIf(d![BKdetails.Chapter] = 13, _
            "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
            "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"), vbCr) & _
    IIf(d![BKdetails.Chapter] = 7, _
        vbCr & vbCr & "and" & vbCr & vbCr & FormatName("", _
                                                        UCase$(Nz(d!First)), _
                                                        UCase$(Nz(d!Last)), _
                                                        ", CHAPTER 7 TRUSTEE", _
                                                        d!Address, _
                                                        d!Address2, _
                                                        d![BKTrustees.City], _
                                                        d![BKTrustees.State], _
                                                        d!Zip, _
                                                        vbCr), _
        "")

FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "Date", Format(Date, "mmmm d yyyy")
FillField WordDoc, "AndAttorney", IIf(IsNull(d!AttorneyLastName), "", "and Debtor's attorney ")
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "GetNextNumber1", GetNextNumber()
FillField WordDoc, "GetNextNumber2", GetNextNumber()
FillField WordDoc, "GetNextNumber3", GetNextNumber()
FillField WordDoc, "GetNextNumber4", GetNextNumber()
FillField WordDoc, "SecurityParagraph", IIf((IsNull(d![SecurityDoc]) = False And d![AssignByDOT] = 1), GetNextNumber() & "All rights and remedies under the Deed of Trust have been assigned to the Movant pursuant to that certain assignment of Deed of Trust, a copy of which is attached hereto as Exhibit C.", "")

FillField WordDoc, "GetNextNumber5", GetNextNumber()
FillField WordDoc, "GetNextNumber6", GetNextNumber()

FillField WordDoc, "OtherCostsParagraph", IIf(d![otherCosts] > 0, GetNextNumber() & "The foregoing Other Costs consist of the following:", "")
FillField WordDoc, "OtherCostsTable", IIf(d![otherCosts] > 0, "Pre-Petition Or   | Transaction Date | Fee Description                          | Amount", "")
FillField WordDoc, "OtherCostsTable2", IIf(d![otherCosts] > 0, "Post-Petition", "")
FillField WordDoc, "OtherCostsTable3", IIf(d![otherCosts] > 0, "__________________________________________________________________", "")
If d!otherCosts > 0 Then
' Do nothing
Else
'Other costs Blank
NextNumber = NextNumber - 1
End If

FillField WordDoc, "GetNextNumber7", GetNextNumber()
FillField WordDoc, "GetNextNumber8", GetNextNumber()
FillField WordDoc, "GetNextNumber9", GetNextNumber()
FillField WordDoc, "GetNextNumber10", GetNextNumber()

If MsgBox("Is Debtor being evaluated for Loss Mit?", vbYesNo) = vbYes Then
    FillField WordDoc, "LossMit", GetNextNumber() & "As of the date of this Motion, the Debtor is being evaluated for a loss mitigation option.   Additional information regarding such evaluation is available upon request."
Else
    FillField WordDoc, "LossMit", ""
End If
FillField WordDoc, "GetNextNumber11", GetNextNumber()
FillField WordDoc, "GetNextNumber12", GetNextNumber()
FillField WordDoc, "ConvChapter", IIf(IsNull(d![ConvChapter]) = True, d![BKdetails.Chapter], d![ConvChapter])
FillField WordDoc, "FilingDate", Format(d![DateofFiling], "mmmm d"", ""yyyy")
FillField WordDoc, "ConvDate", IIf(IsNull(d![ConvDate]) = True, "", "An order converting the case to a case under chapter 7 was entered on " & Format(d![ConvDate], "mmmm d"", ""yyyy") & ".")
FillField WordDoc, "OriginalPbal", Format(d![OriginalPBal], "Currency")
FillField WordDoc, "SecurityDoc", Nz(d!SecurityDoc)
FillField WordDoc, "Jurisdiction", Forms![case list]!JurisdictionID.Column(1)
FillField WordDoc, "boaAsOfDate", Format(d![boaAsOfDate], "mmmm d"", ""yyyy")
FillField WordDoc, "PrincipalBalance", Format(d!principalBalance, "Currency")
FillField WordDoc, "AccruedInterest", Format(d!accruedInterest, "Currency")
FillField WordDoc, "LateCharges", Format(d!lateCharges, "Currency")
FillField WordDoc, "InsurancePremiums", Format(d!insurancePremiums, "Currency")
FillField WordDoc, "DebtorTaxesInsurance", Format(d!debtorTaxesInsurance, "Currency")
FillField WordDoc, "OtherCosts", Format(d!otherCosts, "Currency")

FillField WordDoc, "PostPetitionPartialPayments", Format(d!postPetitionPartialPayments, "Currency")
FillField WordDoc, "PartialPayments", Format(d!partialPayments, "Currency")
FillField WordDoc, "OutstandingObligations", Format(d!outstandingObligations, "Currency")
FillField WordDoc, "BOAAsofDate", Format(d![boaAsOfDate], "mmmm d"", ""yyyy")
FillField WordDoc, "Fee", Format(d![Fee], "Currency")
FillField WordDoc, "MarketValue", Format(d![MarketValue], "Currency")
FillField WordDoc, "Source", Nz(d!Source)
FillField WordDoc, "Encumbrances", Format(encumbrances, "Currency")
FillField WordDoc, "GetNewNextNumber1", GetNewNextNumber()
FillField WordDoc, "GetNewNextNumber2", GetNewNextNumber()
FillField WordDoc, "GetNewNextNumber3", GetNewNextNumber()
FillField WordDoc, "GetnewNextNumber4", GetNewNextNumber()
FillField WordDoc, "CoDebtor1", IIf(Debtorsplural = True, "AND CO-DEBTOR STAY", "")
FillField WordDoc, "CoDebtor2", IIf(Debtorsplural = True, "AND 1301", "")
FillField WordDoc, "CoDebtor3", IIf(Debtorsplural = True, "and co-debtor stay", "")
FillField WordDoc, "PlanCOnfirmDate", Format(d![PlanConfirmDate], "mmmm d, yyyy")
FillField WordDoc, "GetNextLetter", GetNextLetter()
FillField WordDoc, "GetNextLetter2", GetNextLetter()
FillField WordDoc, "GetNextLetter3", GetNextLetter()
FillField WordDoc, "GetNextLetter4", GetNextLetter()
FillField WordDoc, "GetNextLetter5", GetNextLetter()

TotalItems = 0
itemsFields = ""
If (d![otherCosts] = 0 Or IsNull(d![otherCosts]) = True) Then
    
      FillField WordDoc, "Line_Items", ""
      FillField WordDoc, "PreTitle", ""
      FillField WordDoc, "PostTitle", ""
      FillField WordDoc, "PreTotal", ""
      FillField WordDoc, "PostTotal", ""
'skip other costs
Else
    Set dd = CurrentDb.OpenRecordset("SELECT PrePost, TimeStamp,  Desc, Amount FROM BKDebt WHERE FileNumber=" & d![FileNumber] & " ORDER BY Timestamp;", dbOpenSnapshot)
    If dd.EOF Then      ' no extra lines
        FillField WordDoc, "Line_Items", ""
    Else
        dd.MoveLast
        itemcount = dd.RecordCount
        ' Make enough lines
        For i = 1 To itemcount
            itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
        Next i
        itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
        FillField WordDoc, "Line_Items", itemsFields
        dd.MoveFirst
        i = 1
        Do While Not dd.EOF
            FillField WordDoc, "Item" & i, dd!PrePost & vbTab & Format(dd!Timestamp, "mm/dd/yyyy") & vbTab & dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency")
     
            TotalItems = TotalItems + Nz(dd!Amount, 0)
            dd.MoveNext
            i = i + 1
        Loop
        FillField WordDoc, "PreTitle", "Pre-Petition Total:"
        FillField WordDoc, "PostTitle", "Post-Petition Total:"
        FillField WordDoc, "PreTotal", Format(Nz(DSum("Amount", "BKDebt", "Prepost = 'Pre-Petition' AND FileNumber=" & [Forms]![case list]![FileNumber] & ""), 0), "Currency")
        FillField WordDoc, "PostTotal", Format(Nz(DSum("Amount", "BKDebt", "Prepost = 'Post-Petition' AND FileNumber=" & [Forms]![case list]![FileNumber] & ""), 0), "Currency")
        'FillField WordDoc, "Total", Format(totalItems, "Currency")
    End If
    dd.Close

End If
TotalItems = 0
itemsFields = ""
Set ddd = CurrentDb.OpenRecordset("SELECT numMissedPayments, missedPaymentsTo,  missedPaymentsFrom, MonthlyAmount FROM BKMissedPayments WHERE FileNumber=" & d![FileNumber] & " ORder BY MissedPaymentsFrom;", dbOpenSnapshot)
If ddd.EOF Then      ' no extra lines
    FillField WordDoc, "Line_Items", ""
Else
    ddd.MoveLast
    itemcount = ddd.RecordCount
    ' Make enough lines
    For i = 1 To itemcount
        itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
    Next i
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
    FillField WordDoc, "Line_Items2", itemsFields
    ddd.MoveFirst
    i = 1
    Do While Not ddd.EOF
        delinquent = ddd!numMissedPayments * ddd!MonthlyAmount
        FillField WordDoc, "Item" & i, ddd!numMissedPayments & vbTab & ddd!missedPaymentsFrom & _
        vbTab & ddd!missedPaymentsTo & vbTab & Format$(Nz(ddd!MonthlyAmount, 0), "Currency") & vbTab & Format(delinquent, "Currency")
         
        TotalItems = TotalItems + Nz(ddd!MonthlyAmount, 0)
        delinquenttotal = delinquent + delinquenttotal
        ddd.MoveNext
        i = i + 1
    Loop
    FillField WordDoc, "Total", Format(delinquenttotal + d!postPetitionPartialPayments, "Currency")

End If
ddd.Close

FillField WordDoc, "TrusteeName", FormatName("", d![First], d![Last] & IIf(d![BKdetails.Chapter] = 11, "", ", Trustee"), "", d![Address], d![Address2], d![BKTrustees.City], d![BKTrustees.State], d![Zip])
FillField WordDoc, "AttorneyName", d![AttorneyFirstName] & " " & d![AttorneyLastName] & IIf(IsNull(d![AttorneyLastName]), "", ", Esquire")
FillField WordDoc, "BarCode", IIf(Not IsNull(([Forms]![BankruptcyPrint]![cbxAttorney].Column(1))), FetchBarNumber([Forms]![BankruptcyPrint]![cbxAttorney].Column(1), [Forms]![BankruptcyDetails]![District].Column(4), "BK"), "")
FillField WordDoc, "AttorneyFirmName", IIf(IsNull(d![AttorneyFirm]), "", d![AttorneyFirm]) & vbCr & d![AttorneyAddress]

    If Forms!BankruptcyPrint!chElectronicSignature Then
        FillField WordDoc, "ElectronicSignature", "/s/ " & Forms!BankruptcyPrint!cbxAttorney
    Else
        FillField WordDoc, "ElectronicSignature", "_______________________________"
    End If
    FillField WordDoc, "AttorneySignature", Forms!BankruptcyPrint!cbxAttorney
FillField WordDoc, "BkService", BKService(0)

WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
'WordDoc.SaveAs EMailPath & "BOA Motion For Relief CH13.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "BOA Motion for Relief CH13.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_MotiontoExtendtheStayWestern(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim FileNumber As Long, Debtorsplural As Boolean
'Dim response As Integer
'Dim rightToForecloseLanguage As String
'Dim i As Integer, itemcount As Integer, TotalItems As Currency, itemsFields As String

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryMotionExtendStayWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim WestVA As Boolean
If d!District = 8 Or d!District = 11 Or d!District = 10 Then WestVA = True

If Not WestVA Then
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("MotiontoExtendtheStayWestern")
Set WordDoc = WordObj.Documents.Open(EMailPath & "MotiontoExtendtheStayWestern.doc", False)
WordObj.Visible = True
'WordDoc.Bookmarks("FileNumber").Select
FillField WordDoc, "FileNo", IIf(d!ClientID = 575, "", "File Number: " & d![FileNumber])
'margin office location:
    If ([Forms]![BankruptcyPrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
FillField WordDoc, "FileNO", d!FileNumber
FillField WordDoc, "Header", d!BKDistrictCity & " Division"
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "Date", Format(Date, "mmmm d yyyy")
'FillField WordDoc, "AndAttorney", IIf(IsNull(d!AttorneyLastName), "", "and Debtor's attorney ")
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "Attorney", Replace([Forms]![BankruptcyPrint]![cbxAttorney], "Esq.", "")
FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")
'FillField WordDoc, "InvestorAddr", UCase$(d!Investor) & vbCr & RemoveLF(d!InvestorAddress)
FillField WordDoc, "Respondents", _
    GetAddresses(0, 4, _
        IIf(d![BKdetails.Chapter] = 13, _
            "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
            "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"), vbCr)

Dim chCoDebtor As Boolean
 If GetNames(0, 1, "BKCoDebtor=True") <> "" And d![BKdetails.Chapter] = 13 Then chCoDebtor = True
FillField WordDoc, "chCoDebtor", IIf(chCoDebtor, " and 1301", "")
FillField WordDoc, "DateOFFiling", Format$(d![DateofFiling], "mmmm d"", ""yyyy")

If CountNames([FileNumber], "BKDebtor = True And (BKOwner=True Or BKMortgagor=True)") > 1 Then Debtorsplural = True

FillField WordDoc, "Debtor", GetNames(0, 2, "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)") & " (""Debtor" & IIf(Debtorsplural, "s", "") & """)"
'FillField WordDoc, "chapter", IIf(IsNull(d![ConvChapter]), d![BKdetails.Chapter], d![ConvChapter])

FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])

'FillField WordDoc, "AssignmentInfo", AssignmentInfo() & IIf([Forms]![case list]![ClientID] = 385, "", " The documents evidencing the movant's security interest are attached hereto. ")

FillField WordDoc, "Hearing", Format(d![Hearing], "mmmm d\, yyyy ") & "@" & Format(d![Hearing], "h:nn:ss AM/PM")
FillField WordDoc, "Hearing2", Format(d![Hearing], "mmmm d\, yyyy ")
FillField WordDoc, "ElectronicSignature", IIf(Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & Forms!BankruptcyPrint!cbxAttorney, "")
FillField WordDoc, "AttorneySignature", [Forms]![BankruptcyPrint]![cbxAttorney]
FillField WordDoc, "BarCode", IIf(Not IsNull(([Forms]![BankruptcyPrint]![cbxAttorney].Column(1))), FetchBarNumber([Forms]![BankruptcyPrint]![cbxAttorney].Column(1), [Forms]![BankruptcyDetails]![District].Column(4), "BK"), "")
FillField WordDoc, "Date", Format$(Date, "mmmm d, yyyy")
FillField WordDoc, "BKService", BKService(0)
'FillField WordDoc, "TrusteeName",FormatName("", d![First], d![Last] & IIf(d![Chapter] = 11, "", ", Trustee"), "", d!Address, d![Address2], d![City], d![State], d![Zip])
FillField WordDoc, "TrusteeName", FormatName("", d![First], d![Last] & IIf(d![BKdetails.Chapter] = 11, "", ", Trustee"), "", d![Address], d![Address2], d![BKTrustees.City], d![BKTrustees.State], d![Zip])
'FillField WordDoc, "TrusteeAddress", d![BKTrustees.Address] & vbCr & d![BKTrustees.Address2] & vbCr & d![BKTrustees.City] & ", " & d![BKTrustees.State] & " " & FormatZip(d![BKTrustees.Zip])
FillField WordDoc, "AttorneyName", d![AttorneyFirstName] & " " & d![AttorneyLastName] & IIf(IsNull(d![AttorneyLastName]), "", ", Esquire")
FillField WordDoc, "AttorneyFirmName", IIf(IsNull(d![AttorneyFirm]), "", d![AttorneyFirm])
FillField WordDoc, "AttAddr", d!AttorneyAddress

WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
End Sub

Public Sub Doc_MovantCertificateWestern(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim FileNumber As Long, Debtorsplural As Boolean
'Dim response As Integer
'Dim rightToForecloseLanguage As String
'Dim i As Integer, itemcount As Integer, TotalItems As Currency, itemsFields As String

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryMotionExtendStayWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim WestVA As Boolean
If d!District = 8 Or d!District = 11 Or d!District = 10 Then WestVA = True

If Not WestVA Then
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("MovantCertificationWestern")
Set WordDoc = WordObj.Documents.Open(EMailPath & "MovantCertificationWestern.doc", False)
WordObj.Visible = True
'WordDoc.Bookmarks("FileNumber").Select
FillField WordDoc, "FileNo", IIf(d!ClientID = 575, "", "File Number: " & d![FileNumber])
'margin office location:
    If ([Forms]![BankruptcyPrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
    
FillField WordDoc, "FileNO", d!FileNumber
FillField WordDoc, "Header", d!BKDistrictCity & " Division"
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")
'FillField WordDoc, "InvestorAddr", UCase$(d!Investor) & vbCr & RemoveLF(d!InvestorAddress)
FillField WordDoc, "Respondents", _
    GetAddresses(0, 4, _
        IIf(d![BKdetails.Chapter] = 13, _
            "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
            "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)"), vbCr)
            
'from Movant Certification pop up screen:
'Dim strYes, strUnpaid, strAccru, strlateChg, strFee, strEscr, strIntrst, strOther, strDiem, strBasis, strMovant, strAttch As String
'strYes = IIf([Forms]![frmMovantCertification]![ChNo] = -1, "N/A", [Forms]![frmMovantCertification]![txtYes])
'strlateChg = IIf(IsNull([Forms]![frmMovantCertification]![txtlateChg]), "N/A", Format([Forms]![frmMovantCertification]![txtlateChg], "Currency"))
'strAccru = IIf(IsNull([Forms]![frmMovantCertification]![TxtAccru]), "N/A", Format([Forms]![frmMovantCertification]![TxtAccru], "Currency"))
'strFee = IIf(IsNull([Forms]![frmMovantCertification]![TxtFee]), "N/A", Format([Forms]![frmMovantCertification]![TxtFee], "Currency"))
'strEscr = IIf(IsNull([Forms]![frmMovantCertification]![TxtEscr]), "N/A", Format([Forms]![frmMovantCertification]![TxtEscr], "Currency"))
'strIntrst = IIf(IsNull([Forms]![frmMovantCertification]![TxtIntrst]), "N/A", Format([Forms]![frmMovantCertification]![TxtIntrst], "Currency"))
'strOther = IIf(IsNull([Forms]![frmMovantCertification]![txtOther]), "N/A", Format([Forms]![frmMovantCertification]![txtOther], "Currency"))
'strDiem = IIf(IsNull([Forms]![frmMovantCertification]![txtPerDiem]), "N/A", Format([Forms]![frmMovantCertification]![txtPerDiem], "Currency"))
'strBasis = IIf(IsNull([Forms]![frmMovantCertification]![TxtBasis]), "N/A", Format([Forms]![frmMovantCertification]![TxtBasis], "Currency"))
'strMovant = IIf(IsNull([Forms]![frmMovantCertification]![Txtmovant]), "N/A", Format([Forms]![frmMovantCertification]![Txtmovant], "Currency"))
'strAttch = IIf(IsNull([Forms]![frmMovantCertification]![TxtAttch]), "N/A", [Forms]![frmMovantCertification]![TxtAttch])
'strUnpaid = IIf(IsNull([Forms]![frmMovantCertification]![txtUnpaid]), "N/A", Format([Forms]![frmMovantCertification]![txtUnpaid], "Currency"))

FillField WordDoc, "YN", IIf([Forms]![frmMovantCertification]![ChNo] = -1, "N/A", [Forms]![frmMovantCertification]![txtYes])
FillField WordDoc, "unpaid", IIf(IsNull([Forms]![frmMovantCertification]![txtUnpaid]), "N/A", Format([Forms]![frmMovantCertification]![txtUnpaid], "Currency"))
FillField WordDoc, "Accru", IIf(IsNull([Forms]![frmMovantCertification]![TxtAccru]), "N/A", Format([Forms]![frmMovantCertification]![TxtAccru], "Currency"))
FillField WordDoc, "lateChg", IIf(IsNull([Forms]![frmMovantCertification]![txtlateChg]), "N/A", Format([Forms]![frmMovantCertification]![txtlateChg], "Currency"))
FillField WordDoc, "Fee", IIf(IsNull([Forms]![frmMovantCertification]![TxtFee]), "N/A", Format([Forms]![frmMovantCertification]![TxtFee], "Currency"))
FillField WordDoc, "Escr", IIf(IsNull([Forms]![frmMovantCertification]![TxtEscr]), "N/A", Format([Forms]![frmMovantCertification]![TxtEscr], "Currency"))
FillField WordDoc, "Intrst", IIf(IsNull([Forms]![frmMovantCertification]![TxtIntrst]), "N/A", Format([Forms]![frmMovantCertification]![TxtIntrst], "Currency"))
FillField WordDoc, "Other", IIf(IsNull([Forms]![frmMovantCertification]![txtOther]), "N/A", Format([Forms]![frmMovantCertification]![txtOther], "Currency"))
FillField WordDoc, "Diem", IIf(IsNull([Forms]![frmMovantCertification]![txtPerDiem]), "N/A", Format([Forms]![frmMovantCertification]![txtPerDiem], "Currency"))
FillField WordDoc, "Basis", IIf(IsNull([Forms]![frmMovantCertification]![TxtBasis]), "N/A", Format([Forms]![frmMovantCertification]![TxtBasis], "Currency"))
FillField WordDoc, "Movant", IIf(IsNull([Forms]![frmMovantCertification]![Txtmovant]), "N/A", Format([Forms]![frmMovantCertification]![Txtmovant], "Currency"))
FillField WordDoc, "Attch", IIf(IsNull([Forms]![frmMovantCertification]![TxtAttch]), "N/A", [Forms]![frmMovantCertification]![TxtAttch])

Dim chCoDebtor As Boolean
 If GetNames(0, 1, "BKCoDebtor=True") <> "" And d![BKdetails.Chapter] = 13 Then chCoDebtor = True
FillField WordDoc, "chCoDebtor", IIf(chCoDebtor, " and 1301", "")
FillField WordDoc, "DateOFFiling", Format$(d![DateofFiling], "mmmm d"", ""yyyy")

If CountNames([FileNumber], "BKDebtor = True And (BKOwner=True Or BKMortgagor=True)") > 1 Then Debtorsplural = True

FillField WordDoc, "Debtor", GetNames(0, 2, "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)") & " (""Debtor" & IIf(Debtorsplural, "s", "") & """)"
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "AttorneySignature", [Forms]![BankruptcyPrint]![cbxAttorney]
FillField WordDoc, "Date", Format$(Date, "mmmm d, yyyy")

WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
End Sub

Public Sub Doc_OrderGrantingExtendofStay(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim FileNumber As Long, Debtorsplural As Boolean
'Dim response As Integer
'Dim rightToForecloseLanguage As String
'Dim i As Integer, itemcount As Integer, TotalItems As Currency, itemsFields As String

FileNumber = Forms![case list]!FileNumber
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryMotionExtendStayWord WHERE CaseList.FileNumber=" & FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim WestVA As Boolean
If d!District = 8 Or d!District = 11 Or d!District = 10 Then WestVA = True

If Not WestVA Then
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("OrderGrantingExtendofStay")
Set WordDoc = WordObj.Documents.Open(EMailPath & "OrderGrantingExtendofStay.doc", False)
WordObj.Visible = True
'WordDoc.Bookmarks("FileNumber").Select
'WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
'margin office location:
    If ([Forms]![BankruptcyPrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "FileNO", IIf(d!ClientID = 575, "", "File Number: " & d!FileNumber)
FillField WordDoc, "FirmAddr", FirmAddress()
FillField WordDoc, "Header", d!BKDistrictCity & " Division"
FillField WordDoc, "CaseNo", d!CaseNo
FillField WordDoc, "Chapter", d![BKdetails.Chapter]
FillField WordDoc, "Date", Format(Date, "mmmm d yyyy")
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "Attorney", Replace([Forms]![BankruptcyPrint]![cbxAttorney], "Esq.", "")
FillField WordDoc, "Debtors", UCase$(DebtorNames(0, 3, vbCr)) & vbCr & _
    "     Debtor" & IIf(Debtorsplural, "s", "")
FillField WordDoc, "Respondents", _
    GetNames(0, 3, _
        IIf(d![BKdetails.Chapter] = 13, _
            "(BKDebtor=True OR BKCoDebtor=True) AND (BKOwner=True OR BKMortgagor=True)", _
            "BKDebtor=True AND (BkOwner=True OR BKMortgagor=True)"), vbCr)

Dim chCoDebtor As Boolean
 If GetNames(0, 1, "BKCoDebtor=True") <> "" And d![BKdetails.Chapter] = 13 Then chCoDebtor = True
FillField WordDoc, "chCoDebtor", IIf(chCoDebtor, " and 1301", "")
'FillField WordDoc, "DateOFFiling", Format$(d![DateofFiling], "mmmm d"", ""yyyy")

If CountNames([FileNumber], "BKDebtor = True And (BKOwner=True Or BKMortgagor=True)") > 1 Then Debtorsplural = True

FillField WordDoc, "Debtor", GetNames(0, 2, "BKDebtor=True AND (BKOwner=True OR BKMortgagor=True)") & " (""Debtor" & IIf(Debtorsplural, "s", "") & """)"
FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![FCdetails.City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])

FillField WordDoc, "HearingDate", Format(d![Hearing], "mmmm d\, yyyy ") & "@" & Format(d![Hearing], "h:nn:ss AM/PM")
'FillField WordDoc, "Hearing2", Format(d![Hearing], "mmmm d\,yyyy ")
FillField WordDoc, "ElectronicSignature", IIf(Forms!BankruptcyPrint!chElectronicSignature, "/s/ " & Forms!BankruptcyPrint!cbxAttorney, "")
FillField WordDoc, "AttorneySignature", [Forms]![BankruptcyPrint]![cbxAttorney]
'FillField WordDoc, "BarCode", IIf(Not IsNull(([Forms]![BankruptcyPrint]![cbxAttorney].Column(1))), FetchBarNumber([Forms]![BankruptcyPrint]![cbxAttorney].Column(1), [Forms]![BankruptcyDetails]![District].Column(4), "BK"), "")
'FillField WordDoc, "Date", Format$(Date, "mmmm d, yyyy")
FillField WordDoc, "BKService", BKService(0)
FillField WordDoc, "TrusteeName", FormatName("", d![First], d![Last] & IIf(d![BKdetails.Chapter] = 11, "", ", Trustee"), "", d![Address], d![Address2], d![BKTrustees.City], d![BKTrustees.State], d![Zip])
'FillField WordDoc, "TrusteeAddress", d![BKTrustees.Address] & vbCr & d![BKTrustees.Address2] & vbCr & d![BKTrustees.City] & ", " & d![BKTrustees.State] & " " & FormatZip(d![BKTrustees.Zip])
FillField WordDoc, "AttorneyName", d![AttorneyFirstName] & " " & d![AttorneyLastName] & IIf(IsNull(d![AttorneyLastName]), "", ", Esquire")
FillField WordDoc, "AttorneyFirmName", IIf(IsNull(d![AttorneyFirm]), "", d![AttorneyFirm])
FillField WordDoc, "AttAddr", d!AttorneyAddress

WordObj.Selection.HomeKey wdStory, wdMove
WordObj.ScreenUpdating = True
End Sub

Public Sub Doc_EvictionRentDocument(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("select * from qryWordEvRentDoc where FileNumber = " & Forms![case list]!FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data espcially in Name tab, please be sure that Tenant box is checked or contace programers"
    Exit Sub
End If

d.MoveLast
Dim i, N As Integer
N = d.RecordCount
d.MoveFirst

For i = 1 To N
    Set WordObj = CreateObject("Word.application")
    Call OpenDocAsSaved("Eviction Rent Document")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Eviction Rent Document.doc", False)
    WordObj.Visible = True
    
    FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
    FillField WordDoc, "Tenants", IIf(IsNull(d![Company]), d![First] & " " & d![Last], d![Company])
    FillField WordDoc, "PropertyAddress", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & vbCr & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
    FillField WordDoc, "PropertyAdd", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt] & " ") & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
    FillField WordDoc, "FileNumber", d!FileNumber
    FillField WordDoc, "sale", Format(d![Sale], "mmmm dd"", ""yyyy")
    FillField WordDoc, "Jurisdiction", d![Jurisdiction] & ", " & d![JurisdictionList.State]
    FillField WordDoc, "Purchaser", d![Purchaser]
    FillField WordDoc, "rentamount", Format(d![RentAmount], "Currency")
    FillField WordDoc, "RentFirstPayment", Format(d![RentFirstPayment], "mmmm dd"", ""yyyy")
    FillField WordDoc, "RentPayableTo", d![RentPayableTo]
    FillField WordDoc, "RentToBeSentTo", d![RentToBeSentTo]
    FillField WordDoc, "SentAddress", d![RentToBeSentAddress1] & vbCr & d![RentToBeSentAddress2] & vbCr & d![RentCity] & ", " & d![RentState] & " " & FormatZip(d![RentZip])
    FillField WordDoc, "RentCheckRef", d!RentCheckRef
    FillField WordDoc, "RentPropertyManager", d!RentPropertyManager
    FillField WordDoc, "RentPropertyAddress1", d!RentPropertyAddress1
    FillField WordDoc, "RentPropertyAddress2", d!RentPropertyAddress2
    FillField WordDoc, "RentPropertyCityStZip", d!RentPropertyCity & ", " & d!RentPropertyState & " " & FormatZip(d!RentPropertyZip)
    FillField WordDoc, "attorney", [Forms]![EvictionPrint]![cboAttorney].Column(1)
    
    If IsNull([Forms]![EvictionPrint]![cboOfficeLocation]) Or [Forms]![EvictionPrint]![cboOfficeLocation] = 1 Then
        FillField WordDoc, "OfficeLocation", DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![EvictionPrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "OfficeLocation", DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![EvictionPrint]![cboOfficeLocation] = 3 Then
        FillField WordDoc, "OfficeLocation", DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                  DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    End If
    
    WordObj.Selection.HomeKey wdStory, wdMove
   ' WordDoc.SaveAs EMailPath & "Eviction Rent Document" & i & ".doc"
   ' Call SaveDoc(WordDoc, Forms![Case list].FileNumber, "Eviction Rent Document" & i & ".doc")
    d.MoveNext
Next
End Sub
Public Sub Doc_CourtesyEvictionLetter(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range

Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryEVCourtesy WHERE FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim i, N As Integer
d.MoveLast
i = d.RecordCount

d.MoveFirst
For N = 1 To i

    Set WordObj = CreateObject("Word.Application")
    
    Call OpenDocAsSaved("Eviction Courtesy Letter")
    
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Eviction Courtesy Letter.doc", False)
    WordObj.Visible = True
    
    FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
    FillField WordDoc, "FullName", IIf(IsNull(d!Company) = True, d!First & " " & d!Last, d!Company)
    FillField WordDoc, "Address", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", " , " & d![Fair Debt])
    FillField WordDoc, "Address2", d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
    FillField WordDoc, "AddressOneLine", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", " , " & d![Fair Debt]) & " " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
    FillField WordDoc, "Sale", Format(d!Sale, "mmmm d, yyyy")
    FillField WordDoc, "State", d!State
    'FillField WordDoc, "Attorney", GetStaffFullName([Forms]![EvictionPrint]![cboAttorney].[Column](0))
    FillField WordDoc, "Attorney", GetStaffFullName(Forms!EvictionPrint!cboAttorney.Column(0))
    FillField WordDoc, "Purchaser", d!Purchaser
    
    FillField WordDoc, "Title", IIf([Forms]![EvictionPrint]![cboOfficeLocation] = 2, "Commonwealth Trustees, LLC", "Rosenberg & Associates, LLC")
    'Office location:
    If IsNull([Forms]![EvictionPrint]![cboOfficeLocation]) Or [Forms]![EvictionPrint]![cboOfficeLocation] = 1 Then
        FillField WordDoc, "FirmAddr", DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![EvictionPrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "FirmAddr", DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![EvictionPrint]![cboOfficeLocation] = 3 Then
        FillField WordDoc, "FirmAddr", DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                  DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    End If
    
    Select Case Forms![case list]!ClientID
        Case 466
            FillField WordDoc, "RelocationPara", d![Purchaser] & " provides relocation assistance programs to occupants of its foreclosed properties. To discuss these programs and your options under them, please contact the Select Portfolio Servicing, Inc. relocation assistance hotline @ 1-800-962-6010. Select Portfolio Servicing, Inc. is the servicing agent for " & d![Purchaser] & "."
        Case Else
            FillField WordDoc, "RelocationPara", d![Purchaser] & " may provide relocation assistance programs to occupants of its foreclosed properties. To discuss these programs and your options under them, please contact " & _
                IIf(IsNull(d![BrokerName]), "_____________________", d![BrokerName]) & ", or " & _
                GetStaffFullName(Forms!EvictionPrint!cboAttorney.Column(0)) & " @ " & IIf(IsNull(d![BrokerPhone]), "______________________", FormatPhone(Nz(d![BrokerPhone]))) & ", or (301) 907-8000."
    End Select
    'FillField WordDoc, "RelocationPara", IIf([Forms]![Case List]![ClientID] = 466, d![Purchaser] & " provides relocation assistance programs to occupants of its foreclosed properties. To discuss these programs and your options under them, please contact the Select Portfolio Servicing, Inc. relocation assistance hotline @ 1-800-962-6010. Select Portfolio Servicing, Inc. is the servicing agent for " & d![Purchaser] & ".", _
    'd![Purchaser] & " may provide relocation assistance programs to occupants of its foreclosed properties. To discuss these programs and your options under them, please contact " & d![BrokerName] & ", or " & GetStaffFullName([Forms]![EvictionPrint]![cboAttorney].[Column](0)) & " @ " & FormatPhone(d![BrokerPhone]) & ", or (301) 907-8000.")
    
    WordObj.Selection.HomeKey wdStory, wdMove
  '  WordDoc.SaveAs EMailPath & "Eviction Courtesy Letter" & n & ".doc"
  '  Call SaveDoc(WordDoc, Forms![Case list].FileNumber, "Eviction Courtesy Letter" & n & ".doc")
d.MoveNext
Next

If Not KeepOpen Then WordObj.Quit Savechanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub


Public Sub Doc_EvictionTenant_NTQ_SPS_PTFA(KeepOpen As Boolean)
'Call MsgBox("This section is under construction", vbExclamation + vbAbortRetryIgnore, "Word Documents arent finished yet")
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qry90DayNoticeSPSWord WHERE FileNumber=" & Forms![case list]!FileNumber & " AND FcDetails.Current = TRUE;", dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Eviction Print PTFA Tenant NTQ SPS")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Eviction Print PTFA Tenant NTQ SPS.doc", False)
WordObj.Visible = True

'WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
'WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
'WordDoc.Bookmarks("ProName").Select
'WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
'WordDoc.Bookmarks("PropertyAddress").Select
'WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]

'DefendantsAddress = GetAddresses(d!FileNumber, 5, "Defendant=True", NewLine)
FillField WordDoc, "AttySignature", GetStaffFullName(Forms!EvictionPrint!cboAttorney.Column(0))
FillField WordDoc, "FileNumber", d!FileNumber
'FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d!State
FillField WordDoc, "Zip", FormatZip(d!ZipCode)

FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "Year", Format(Date, "yyyy")
FillField WordDoc, "Purchaser", d!Purchaser
FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")


WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Eviction Print PTFA Tenant NTQ SPS.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Eviction Print PTFA Tenant NTQ SPS.doc")
''If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_EvictionOwner_NTQ_SPS_PTFA(KeepOpen As Boolean)
'Call MsgBox("This section is under going testing", vbExclamation + vbAbortRetryIgnore, "Don't test this yet")

Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qry90DayNoticeSPSWord WHERE FileNumber=" & Forms![case list]!FileNumber & " AND FcDetails.Current = TRUE;", dbOpenSnapshot)


If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Eviction Print PTFA Owner NTQ SPS")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Eviction Print PTFA Owner NTQ SPS.doc", False)
WordObj.Visible = True

'WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
'WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
'WordDoc.Bookmarks("ProName").Select
'WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
'WordDoc.Bookmarks("PropertyAddress").Select
'WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]

'DefendantsAddress = GetAddresses(d!FileNumber, 5, "Defendant=True", NewLine)
FillField WordDoc, "AttySignature", GetStaffFullName(Forms!EvictionPrint!cboAttorney.Column(0))
FillField WordDoc, "FileNumber", d!FileNumber
'FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d!State
FillField WordDoc, "Zip", FormatZip(d!ZipCode)

FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "Year", Format(Date, "yyyy")
FillField WordDoc, "Purchaser", d!Purchaser
FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Eviction Print PTFA Owner NTQ SPS.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Eviction Print PTFA Owner NTQ SPS.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_Eviction_PTFA_NTQ_53(KeepOpen As Boolean)
'Call MsgBox("This section is under construction", vbExclamation + vbAbortRetryIgnore, "Word Documents arent finished yet")
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qry90DayNoticeSPSWord WHERE FileNumber=" & Forms![case list]!FileNumber & " AND FcDetails.Current = TRUE;", dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Eviction Print PTFA NTQ Fifth Third")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Eviction Print PTFA NTQ Fifth Third.doc", False)
WordObj.Visible = True

'WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
'WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
'WordDoc.Bookmarks("ProName").Select
'WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
'WordDoc.Bookmarks("PropertyAddress").Select
'WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]

FillField WordDoc, "Sale", Format(d!Sale, "mmmm d, yyyy")
'DefendantsAddress = GetAddresses(d!FileNumber, 5, "Defendant=True", NewLine)
FillField WordDoc, "AttySignature", GetStaffFullName(Forms!EvictionPrint!cboAttorney.Column(0))
FillField WordDoc, "FileNumber", d!FileNumber
'FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d!State
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "BrokerNM", Nz(d!BrokerNm, "_____________________")
If IsNull(d!BrokerPh) Then
    FillField WordDoc, "BrokerPh", Nz(d!BrokerPh, "__________________")
Else
    FillField WordDoc, "BrokerPh", FormatPhone(d!BrokerPh)
End If
FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "Year", Format(Date, "yyyy")
FillField WordDoc, "Purchaser", d!Purchaser
FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
FillField WordDoc, "LastDays", Format(LastDay90(Date), "mmmm d, yyyy")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Eviction Print PTFA NTQ Fifth Third.doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Eviction Print PTFA NTQ Fifth Third.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_QuitClaimDeed(KeepOpen As Boolean)
'Call MsgBox("This section is under construction", vbExclamation + vbAbortRetryIgnore, "Word Documents arent finished yet")
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim Grantorname As String
Dim GrantorAddress As String
Dim GranteeName As String, GranteeAddress As String
Dim exemptText As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsConventionalDeedWord WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If
Grantorname = InputBox("Grantor Name?")
GrantorAddress = InputBox("Grantor Address?")
GranteeName = InputBox("Grantee Name?")
GranteeAddress = InputBox("Grantee Address?")

If d![FCdetails.State] = "MD" Then
    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Quit Claim Deed MD")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Quit Claim Deed MD.doc", False)
    WordObj.Visible = True
    
    WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
    WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
    WordDoc.Bookmarks("ProName").Select
    WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
    WordDoc.Bookmarks("PropertyAddress").Select
    WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt] & ", ") & d!City & ", " & "MD " & FormatZip(d!ZipCode)
Else
    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Quit Claim Deed VA")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Quit Claim Deed VA.doc", False)
    WordObj.Visible = True

    
    If MsgBox("Is the file Transter Tax Exempt?", vbYesNo) = vbYes Then
        FillField WordDoc, "exemptText", InputBox("Enter the section reference", "Transfer Tax Exempt")
        FillField WordDoc, "Tax", "TAX EXEMPT PURSUANT TO CODE OF"
    Else
        FillField WordDoc, "exemptText", ""
        FillField WordDoc, "Tax", ""
    End If
    WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
    WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
    WordDoc.Bookmarks("PropertyAddress").Select
    WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!City & ", VA " & FormatZip(d!ZipCode)
    WordDoc.Bookmarks("ProName").Select
    WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
    WordDoc.Bookmarks("Atty").Select
    WordDoc.Bookmarks("Atty").Range.Text = d!NameVA
    WordDoc.Bookmarks("VABar").Select
    WordDoc.Bookmarks("VABar").Range.Text = d!VABar
    'WordDoc.Bookmarks("FileNumber").Select
    'WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
    FillField WordDoc, "FileNumber", d![CaseList.FileNumber]

End If

    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "GrantorName", Grantorname
FillField WordDoc, "GrantorAddress", GrantorAddress
FillField WordDoc, "GranteeName", GranteeName
FillField WordDoc, "GranteeAddress", GranteeAddress

If IsNull(Forms!foreclosurePrint!Attorney.Column(0)) Then
    FillField WordDoc, "Attorney", ""
Else
    FillField WordDoc, "Attorney", GetStaffFullName(Forms!foreclosurePrint!Attorney.Column(0))
End If
FillField WordDoc, "LegalDescription", d!LegalDescription
FillField WordDoc, "TaxID", Nz(d!TaxID, "")
FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "Jurisdiction", d!Jurisdiction

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Quit Claim Deed " & d![CaseList.FileNumber] & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Quit Claim Deed " & d![CaseList.FileNumber] & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_SpecialWarranty(KeepOpen As Boolean)
'Call MsgBox("This section is under construction", vbExclamation + vbAbortRetryIgnore, "Word Documents arent finished yet")
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset
Dim Grantorname As String ' Add by sarab to fix the invalid error 2/10
Dim GrantorAddress As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsConventionalDeedWord WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If d![FCdetails.State] = "MD" Then
    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Special Warranty Deed MD_New")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Special Warranty Deed MD_New.doc", False)
    WordObj.Visible = True

    WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
    WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
    
    FillField WordDoc, "Purchaser", IIf(IsNull(d!Purchaser), "", d!Purchaser)
    FillField WordDoc, "PurchaserAddress", OneLine(d!PurchaserAddress)
    FillField WordDoc, "LegalDescription", d!LegalDescription
    FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
    FillField WordDoc, "Leasehold", IIf(d![Leasehold] = 1, "Leasehold", IIf(d![Leasehold] = 0, "Fee Simple", ""))
    FillField WordDoc, "Attorney", GetStaffFullName(Forms!foreclosurePrint!Attorney.Column(0))
    FillField WordDoc, "HUDAddress", d!HUDAddress1Line
    FillField WordDoc, "TAXID", Nz(d!TaxID)

Else
    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Special Warranty Deed VA")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Special Warranty Deed VA.doc", False)
    WordObj.Visible = True

    WordDoc.Bookmarks("Property").Select
    WordDoc.Bookmarks("Property").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
    WordDoc.Bookmarks("PropertyAdd").Select
    WordDoc.Bookmarks("PropertyAdd").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
    WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
    WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
    WordDoc.Bookmarks("AssessedValue").Select
    WordDoc.Bookmarks("AssessedValue").Range.Text = Nz(Format(d!AssessedValue, "Currency"))
    WordDoc.Bookmarks("ProName").Select      ' use this method for bookmarks in header/footer
    WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
    WordDoc.Bookmarks("Atty").Select
    WordDoc.Bookmarks("Atty").Range.Text = d!NameVA
    WordDoc.Bookmarks("VABar").Select
    WordDoc.Bookmarks("VABar").Range.Text = d!VABar
       
    FillField WordDoc, "TaxID", Nz(d!TaxID, "")
    FillField WordDoc, "FileNumber", d![CaseList.FileNumber]
    FillField WordDoc, "Purchaser", Nz(d!Purchaser, "")
    FillField WordDoc, "PurchaserAddress", Nz(OneLine(d!PurchaserAddress))
    FillField WordDoc, "LegalDescription", d!LegalDescription
    FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
    FillField WordDoc, "Leasehold", IIf(d![Leasehold] = 1, "Leasehold", IIf(d![Leasehold] = 0, "Fee Simple", ""))
    FillField WordDoc, "Attorney", GetStaffFullName(Forms!foreclosurePrint!Attorney.Column(0))
    FillField WordDoc, "HUDAddress", d!HUDAddress1Line
End If
'margin address:
    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Special Warranty Deed " & d![CaseList.FileNumber] & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Special Warranty Deed " & d![CaseList.FileNumber] & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_Line(KeepOpen As Boolean)

'FormattedTextToWord
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim templateName As String
Dim BankName As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryLineWord WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

templateName = "Line with attachments"
Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName & ".doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & (vbCr) & d!City & ", " & d![FCdetails.State]

'margin office location:
    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
'FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", IIf(Not IsNull(d![CourtCaseNumber]), d![CourtCaseNumber], " _____________________ ")
Dim attny As String

FillField WordDoc, "Attorney", Forms!foreclosurePrint.Attorney.Column(1)
Dim MDBar As String
MDBar = DLookup("MDBar", "Staff", "ID =" & [Forms]![foreclosurePrint]![Attorney].Column(0))
FillField WordDoc, "CPTF", IIf(d![FCdetails.State] = "MD", IIf(IsNull(MDBar), "", ", CPTF # " & MDBar), "")

FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 1345, "")
FillField WordDoc, "LineDescription", PlainText(d!LineDescription)
FillField WordDoc, "Year", Format(Date, "yyyy")
FillField WordDoc, "CosNames", COSNamesAddress(0)
'Dim arg0 As String
'arg0 = Split(ReportArgs, "|")(0)
If Split(ReportArgs, "|")(2) = 3 Then  'designagted attorney is selected
    FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0)) & IIf(d![FCdetails.State] = "MD", IIf(IsNull(MDBar), "", ", CPTF # " & MDBar), "")
Else
    FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
End If
FillField WordDoc, "InvestorTitle", IIf(Split(ReportArgs, "|")(2) = 3, IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), (Split(ReportArgs, "|")(1)))
FillField WordDoc, "Investor", IIf(Split(ReportArgs, "|")(2) = 3, IIf(d![SubstituteTrustees] = True, "Substitute Trustee", "Trustee"), IIf((d!AIF = True And d!ClientID = 373), d!Investor & ", by BSI Financial Services as attorney in fact", IIf((d![AIF] = True And d![ClientID] = 523), d![Investor] & " by Green Tree Servicing LLC as servicer", IIf(d!ClientID = 531, "M&T Bank as Servicer for " & Forms![case list]!Investor, IIf((d![AIF] = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf((d![AIF] = True And d![ClientID] = 605), d![LongClientName] & " as Servicer for " & d!Investor, IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for " & Forms![case list]!Investor, Forms![case list]!Investor)))))))
FillField WordDoc, "ThisDate", ThisDate(Date)

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Line.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Line.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_MDExpiredLease(KeepOpen As Boolean)
'Call MsgBox("This section is under construction", vbExclamation + vbAbortRetryIgnore, "Word Documents arent finished yet")
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim Tenant As Integer

Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryexpiredLeaseWord WHERE FileNumber=" & Forms![case list]!FileNumber & " AND FcDetails.Current = TRUE AND Names.Tenant = TRUE;", dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Tenant = TenantNamesCount(d!FileNumber)

Do While Tenant <> 0

    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("MD Expired Lease - working")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "MD Expired Lease - working.doc", False)
    WordObj.Visible = True

    'WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
    'WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
    'WordDoc.Bookmarks("ProName").Select
    'WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
    'WordDoc.Bookmarks("PropertyAddress").Select
    'WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

    FillField WordDoc, "Owner", OwnerNames(0, 2)
    FillField WordDoc, "Occupants", d!FullName
    FillField WordDoc, "Sale", Format(d!Sale, "mmmm d, yyyy")
    FillField WordDoc, "Attorney", GetStaffFullName(Forms!EvictionPrint!cboAttorney.Column(0))
    FillField WordDoc, "FileNumber", d!FileNumber
    FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
    FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
    FillField WordDoc, "PropertyAddress2", d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
   
    FillField WordDoc, "FirmPhone", FirmPhone()
    FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
    'FillField WordDoc, "Year", Format(Date, "yyyy")
    FillField WordDoc, "Purchaser", d!Purchaser
    FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
    FillField WordDoc, "LastDays", Format(LastDay90(Date), "mmmm d, yyyy")

    WordObj.Selection.HomeKey wdStory, wdMove
  ' WordDoc.SaveAs EMailPath & "MD Expired Lease " & d!FileNumber & "(" & Tenant & ").doc"
  '  Call SaveDoc(WordDoc, d![FileNumber], "MD Expired Lease " & d!FileNumber & "(" & Tenant & ").doc")
   ' If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges

d.MoveNext
Tenant = Tenant - 1

Loop
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_MDLeaseTermination(KeepOpen As Boolean)
'Call MsgBox("This section is under construction", vbExclamation + vbAbortRetryIgnore, "Word Documents arent finished yet")
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim Tenant As Integer

Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryexpiredLeaseWord WHERE FileNumber=" & Forms![case list]!FileNumber & " AND FcDetails.Current = TRUE AND Names.Tenant = TRUE;", dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Tenant = TenantNamesCount(d!FileNumber)

Do While Tenant <> 0

    Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("MD Lease Termination")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "MD Lease Termination.doc", False)
    WordObj.Visible = True

    'WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
    'WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
    'WordDoc.Bookmarks("ProName").Select
    'WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
    'WordDoc.Bookmarks("PropertyAddress").Select
    'WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

    FillField WordDoc, "Owner", OwnerNames(0, 2)
    FillField WordDoc, "Occupants", d!FullName
    FillField WordDoc, "Sale", Format(d!Sale, "mmmm d, yyyy")
    FillField WordDoc, "Attorney", GetStaffFullName(Forms!EvictionPrint!cboAttorney.Column(0))
    FillField WordDoc, "FileNumber", d!FileNumber
    FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber
    FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
    FillField WordDoc, "PropertyAddress2", d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
   
    FillField WordDoc, "FirmPhone", FirmPhone()
    FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), ", ", ", " & d![Fair Debt] & ", ") & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
    'FillField WordDoc, "Year", Format(Date, "yyyy")
    FillField WordDoc, "Purchaser", d!Purchaser
    FillField WordDoc, "Date", Format(Date, "mmmm d, yyyy")
    FillField WordDoc, "LastDays", Format(LastDay90(Date), "mmmm d, yyyy")

    WordObj.Selection.HomeKey wdStory, wdMove
   ' WordDoc.SaveAs EMailPath & "MD Lease Termination " & d!FileNumber & "(" & Tenant & ").doc"
   ' Call SaveDoc(WordDoc, d![FileNumber], "MD Lease Termination " & d!FileNumber & "(" & Tenant & ").doc")
   ' If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges

d.MoveNext
Tenant = Tenant - 1

Loop
Set WordObj = Nothing
d.Close
End Sub

Public Sub Doc_LossMitigationFinalSPS(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Loss Mitigation - Final SPS")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Loss Mitigation - Final SPS.doc", False)
WordObj.Visible = True

    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])


FillField WordDoc, "MDfooter", IIf(d![FCdetails.State] = "MD", "MD004.N001", "MD004")
FillField WordDoc, "footer2", IIf(d![FCdetails.State] = "MD", "11/16", "")

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "InvestorAIF", IIf([Forms]![case list]![AIF], d![Investor] & ", by Select Portfolio Servicing, Inc., as attorney-in-fact", d![Investor])
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber, "_________________")
FillField WordDoc, "Docket", Nz(Format(d!Docket, "mm/d/yyyy"), "___________________")
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ______________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Loss Mitigation - Final Select " & d![CaseList.FileNumber] & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Loss Mitigation - Final Select " & d![CaseList.FileNumber] & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_ReaffLetter(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT FileNumber, Current, PropertyAddress, [Fair Debt], City, State, ZipCode From fcdetails " & _
           "WHERE FileNumber= " & [Forms]![BankruptcyDetails]![FileNumber] & " AND Current=True", dbOpenSnapshot)
           
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Reaff Letter")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Reaff Letter.doc", False)
WordObj.Visible = True

FillField WordDoc, "Date", Format(Date, "mmmm dd"", ""yyyy")
FillField WordDoc, "AttnyName", [Forms]![BankruptcyDetails]![AttorneyFirstName] & " " & [Forms]![BankruptcyDetails]![AttorneyLastName] & ", Esq"
FillField WordDoc, "Attnyfirm", Nz([Forms]![BankruptcyDetails]![AttorneyFirm])
FillField WordDoc, "AttnyAddr", [Forms]![BankruptcyDetails]![AttorneyAddress]
FillField WordDoc, "Attnycitystatezip", [Forms]![BankruptcyDetails]![AttorneyCity] & ", " & [Forms]![BankruptcyDetails]![AttorneyState] & " " & FormatZip([Forms]![BankruptcyDetails]![AttorneyZip])
FillField WordDoc, "CaseNo", [Forms]![BankruptcyDetails]![CaseNo]
FillField WordDoc, "Investor", [Forms]![case list]![Investor]
FillField WordDoc, "Debtor", DebtorNames(0, 2)
FillField WordDoc, "PropertyAddr", d!PropertyAddress & IIf(IsNull(d![Fair Debt]), " ", ", " & d![Fair Debt] & ", ") & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Reaff Letter" & d![FileNumber] & ".doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Reaff Letter" & d![FileNumber] & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub
Public Sub doc_DoveLossMitLetter(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT FileNumber, Current, PropertyAddress, [Fair Debt], City, State, ZipCode From fcdetails " & _
           "WHERE FileNumber= " & [Forms]![BankruptcyDetails]![FileNumber] & " AND Current=True", dbOpenSnapshot)
           
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Dove Loss Mit Letter")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Dove Loss Mit Letter.doc", False)
WordObj.Visible = True

FillField WordDoc, "Date", Format(Date, "mmmm dd"", ""yyyy")
FillField WordDoc, "AttnyName", [Forms]![BankruptcyDetails]![AttorneyFirstName] & " " & [Forms]![BankruptcyDetails]![AttorneyLastName] & ", Esq"
FillField WordDoc, "Attnyfirm", Nz([Forms]![BankruptcyDetails]![AttorneyFirm])
FillField WordDoc, "AttnyAddr", [Forms]![BankruptcyDetails]![AttorneyAddress]
FillField WordDoc, "Attnycitystatezip", [Forms]![BankruptcyDetails]![AttorneyCity] & ", " & [Forms]![BankruptcyDetails]![AttorneyState] & " " & FormatZip([Forms]![BankruptcyDetails]![AttorneyZip])
FillField WordDoc, "CaseNo", [Forms]![BankruptcyDetails]![CaseNo]
FillField WordDoc, "Debtor", DebtorNames(0, 2)
FillField WordDoc, "Investor", [Forms]![case list]![Investor]
FillField WordDoc, "PropertyAddr", d!PropertyAddress & IIf(IsNull(d![Fair Debt]), " ", ", " & d![Fair Debt] & ", ") & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Dove Loss Mit Letter" & d![FileNumber] & ".doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Dove Loss Mit Letter" & d![FileNumber] & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_DoveLossMitLetterNoAttny(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT Names.FileNumber,Company, First, Last, AKA, Address, Address2, City, State, Zip, BKDebtor, BKCoDebtor " & _
    "FROM CaseList INNER JOIN [Names] ON CaseList.FileNumber = [Names].FileNumber " & _
    "WHERE [Names].FileNumber= " & [Forms]![BankruptcyDetails]![FileNumber] & " AND (BKDebtor=True)", dbOpenSnapshot)
           
If d.EOF Then
    MsgBox "The file might missing data especially in Name Tab, please be sure that BK debtor box  is checked"
    Exit Sub
End If

Dim i, N As Integer
d.MoveLast
N = d.RecordCount
d.MoveFirst
For i = 1 To N
Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Dove Loss Mit Letter no attny")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Dove Loss Mit Letter no attny.doc", False)
WordObj.Visible = True

FillField WordDoc, "Date", Format(Date, "mmmm dd"", ""yyyy")
FillField WordDoc, "DebtorName", d!First & " " & d!Last
FillField WordDoc, "DebtorAddr", d!Address & IIf(IsNull(d!Address2), "", " " & d!Address2)
FillField WordDoc, "Debtorcitystatezip", d!City & ", " & d!State & " " & FormatZip(d!Zip)
FillField WordDoc, "CaseNo", [Forms]![BankruptcyDetails]![CaseNo]
FillField WordDoc, "Debtor", DebtorNames(0, 2)
FillField WordDoc, "Investor", [Forms]![case list]![Investor]
FillField WordDoc, "PropertyAddr", [Forms]![BankruptcyDetails]![sfrmPropAddr].[Form]![PropertyAddress] & IIf(IsNull([Forms]![BankruptcyDetails]![sfrmPropAddr].[Form]![Apt]), " ", " " & [Forms]![BankruptcyDetails]![sfrmPropAddr].[Form]![Apt] & ", ") & [Forms]![BankruptcyDetails]![sfrmPropAddr].[Form]![City] & ", " & [Forms]![BankruptcyDetails]![sfrmPropAddr].[Form]![State] & " " & FormatZip([Forms]![BankruptcyDetails]![sfrmPropAddr].[Form]![ZipCode])

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Dove Loss Mit Letter no attny" & d![FileNumber] & "-" & i & ".doc"
'Call SaveDoc(WordDoc, d![FileNumber], "Dove Loss Mit Letter no attny" & d![FileNumber] & "-" & i & ".doc")
d.MoveNext
Next

If Not KeepOpen Then WordObj.Quit Savechanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close
End Sub

Public Sub DOC_MTLossMitLetter(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset

Set d = CurrentDb.OpenRecordset("SELECT FileNumber, Current, PropertyAddress, [Fair Debt], City, State, ZipCode From fcdetails " & _
           "WHERE FileNumber= " & [Forms]![BankruptcyDetails]![FileNumber] & " AND Current=True", dbOpenSnapshot)
           
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("MT Loss Mit Letter")
Set WordDoc = WordObj.Documents.Open(EMailPath & "MT Loss Mit Letter.doc", False)
WordObj.Visible = True

FillField WordDoc, "Date", Format(Date, "mmmm dd"", ""yyyy")
FillField WordDoc, "AttnyName", [Forms]![BankruptcyDetails]![AttorneyFirstName] & " " & [Forms]![BankruptcyDetails]![AttorneyLastName] & ", Esq"
FillField WordDoc, "AttnyAddr", [Forms]![BankruptcyDetails]![AttorneyAddress]
FillField WordDoc, "Attnycitystatezip", [Forms]![BankruptcyDetails]![AttorneyCity] & ", " & [Forms]![BankruptcyDetails]![AttorneyState] & " " & FormatZip([Forms]![BankruptcyDetails]![AttorneyZip])
FillField WordDoc, "CaseNo", [Forms]![BankruptcyDetails]![CaseNo]
FillField WordDoc, "Debtor", DebtorNames(0, 2)
FillField WordDoc, "PropertyAddr", d!PropertyAddress & IIf(IsNull(d![Fair Debt]), " ", ", " & d![Fair Debt] & ", ") & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "MT Loss Mit Letter" & d![FileNumber] & ".doc"
'Call SaveDoc(WordDoc, d![FileNumber], "MT Loss Mit Letter" & d![FileNumber] & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_LossMitigationPrelimSPS(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Loss Mitigation - Prelim SPS")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Loss Mitigation - Prelim SPS.doc", False)
WordObj.Visible = True

    If d![FCdetails.State] = "DC" Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "MDfooter", IIf(d![FCdetails.State] = "MD", "MD003.N001", "MD003")
FillField WordDoc, "footer2", IIf(d![FCdetails.State] = "MD", "11/16", "")

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "InvestorAIF", IIf([Forms]![case list]![AIF], d![Investor] & ", by Select Portfolio Servicing, Inc., as attorney-in-fact", d![Investor])
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber, "_________________")
FillField WordDoc, "Docket", Nz(Format(d!Docket, "mm/d/yyyy"), "___________________")
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ______________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Loss Mitigation - Prelim Select " & d![CaseList.FileNumber] & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Loss Mitigation - Prelim Select " & d![CaseList.FileNumber] & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub
Public Sub doc_CombinedAffidavitofComplianceNationStar(KeepOpen As Boolean)     'Mei 10/7/15
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset, dd As Recordset      ' data
Dim i As Integer, itemcount As Integer, TotalItems As Currency, itemsFields As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Combined Affidavit of Compliance NationstarMD")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Combined Affidavit of Compliance NationstarMD.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), "", " " & d![Fair Debt]) & vbCr & d!City & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode)
'WordDoc.Bookmarks("APTNum").Select
'WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])


If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1") & vbCr & _
                 FirmPhone()
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2") & vbCr & _
                 FirmPhoneVA()
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
                  DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID =2") & vbCr & _
                  FirmPhone()
End If

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "Jurisdiction", d!Jurisdiction
'FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "InvestorAIF", IIf([Forms]![case list]![AIF], d![Investor] & ", by Select Portfolio Servicing, Inc., as attorney-in-fact", d![Investor])
FillField WordDoc, "DotDate", Format([Forms]![ForeclosureDetails]![DOTdate], "mmmm d"", ""yyyy")
FillField WordDoc, "Client", d!LongClientName
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", IIf(d!CaseTypeID = 8, d!MonitorTrusteeAddress, FirmShortAddress(vbCr))
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "Mortgagors", MortgagorNames(0, 20)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)

FillField WordDoc, "Investor", IIf(d![ClientID] = 385 And d![Investor] = d!LongClientName, "Nationstar maintains records for the loan that is secured by the mortgage or deed of trust being foreclosed in this action. ", _
"Nationstar services and maintains records on behalf of " & d![Investor] & " the secured party to the mortgage or deed of trust being foreclosed in this action.")

FillField WordDoc, "Prior Servicer", IIf(bPrior = True, "           Before the servicing of this loan transferred to Nationstar, " & strPriorServicer & _
" (Prior Servicer) was the servicer for the loan and it maintained the loan servicing records.  When Nationstar began servicing this loan, Prior Servicer's records for the loan were integrated and boarded into Nationstar's systems," & _
" such that Prior Servicer's records, including the collateral file, payment histories, communication logs, default letters, information," & _
"and documents concerning the Loan are now integrated into Nationstar's business records.  Nationstar maintains quality control and " & _
"verification procedures as part of the boarding process to ensure the accuracy of the boarded records.  It is the regular business practice " & _
"of Nationstar to integrate prior servicers' records into Nationstar's business records and to rely upon those boarded records in providing " & _
"its loan servicing functions.  These Prior Servicer records have been integrated and are relied upon by Nationstar as part of Nationstar's " & _
"business records.", "")

DoCmd.Close acForm, "Prior Servicer"                '10/9/15

If bReferee = True Then
    FillField WordDoc, "HolderTransLost", (d!Investor & " directly or through an agent, has possession of the promissory note and held the note at the time of filing the foreclosure complaint. " & d!Investor & " will enforce the promissory note as transferee in possession.")
ElseIf bHolder Then
    FillField WordDoc, "HolderTransLost", (d!Investor & " directly or through an agent, has possession of the promissory note and held the note at the time of filing the foreclosure complaint. The promissory note is made payable to " & d!Investor & " OR The promissory note has been duly indorsed.")
ElseIf bLost = True Then
    FillField WordDoc, "HolderTransLost", (d!Investor & " is unable to find the promissory note and will seek to prove the promissory note using a lost note affidavit.")
End If

FillField WordDoc, "BorrowerNames", BorrowerNames(d![CaseList.FileNumber])
FillField WordDoc, "DOTdate", Format([Forms]![ForeclosureDetails]![DOTdate], "mmmm d"", ""yyyy")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "propertyaddress2", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!City & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode)
FillField WordDoc, "AsOfDate", Format([Forms]![Print Statement of Debt]![txtDueDate], "mmmm dd"", ""yyyy")

'FillField WordDoc, "AsOfDate", Format([Forms]![Print Statement of Debt]![txtDueDate], "mmmm dd"", ""yyyy")
If d!LoanType = 5 Then
    FillField WordDoc, "chkLoanType", "Federal Home Loan Mortgage Corporation "
ElseIf d!LoanType = 4 Then
    FillField WordDoc, "chkLoanType", "Federal National Mortgage Association "
Else
    FillField WordDoc, "chkLoanType", d!Investor
End If

If d!LoanType = 5 Or d!LoanType = 4 Then
    FillField WordDoc, "chkLoanType2", "For the purposes of foreclosure, the note or other debt instrument is held by " & d!Investor & "."
Else
    FillField WordDoc, "chkLoanType2", ""
End If

FillField WordDoc, "DateOfDefault", Format$(d!DateOfDefault, "mmmm d, yyyy")
FillField WordDoc, "NOI", Format$(d!NOI, "mmmm d, yyyy")

FillField WordDoc, "RemainingPBal", Format$(d!RemainingPBal, "Currency")
FillField WordDoc, "FromToDates", IIf([Forms]![Print Statement of Debt]!Check86 = 0, "From  " & [Forms]![Print Statement of Debt]![Text100] & "  To  " & [Forms]![Print Statement of Debt]![Text102] & "  at  " & [Forms]![Print Statement of Debt]![Text104] & "%", "")
'FillField WordDoc, "Rate", " " & [Forms]![Print Statement of Debt]![Text104] & "%"
FillField WordDoc, "IntrestAmt", Format$([Forms]![Print Statement of Debt]![Text94], "Currency")

'if there're adj rates:
If [Forms]![Print Statement of Debt]!Check86 Then    'the adj rate check box is checked
    Set dd = CurrentDb.OpenRecordset("SELECT * FROM StatementOfDebtAdjRate WHERE FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
        If Not dd.EOF Then
                dd.MoveLast
                 For i = 1 To dd.RecordCount
                    itemsFields = itemsFields & "<<AdjRate" & i & ">>" & vbCr
                 Next i
                
                 FillField WordDoc, "AdjRate", itemsFields
                
                dd.MoveFirst
                i = 1
                
                Do While Not dd.EOF
                
                FillField WordDoc, "AdjRate" & i, "        From   " & dd!DateFrom & "   to  " & dd!DateTo & "  at  " & dd!ADJRate & "%" & vbTab & Format(dd!Amount, "currency")
                dd.MoveNext
                i = i + 1
                Loop
        End If
Else
    FillField WordDoc, "AdjRate", ""
End If

Dim rs As Recordset
Dim itemTags As String
'Dim totalItems As Currency

Set rs = CurrentDb.OpenRecordset("SELECT StatementOfDebt.ID, StatementOfDebt.FileNumber, StatementOfDebt.Desc, StatementOfDebt.Amount, StatementOfDebt.Timestamp, StatementOfDebt.Sort_Desc FROM StatementOfDebt WHERE FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)

If rs.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers from StatementOfDebt table."
    Exit Sub
Else
    rs.MoveLast
        For i = 1 To rs.RecordCount
            itemTags = itemTags & "<<Line_Items" & i & ">>" & vbCr
        Next i
         
         FillField WordDoc, "Line_Items", itemTags
                
                rs.MoveFirst
                i = 1
                
                Do While Not rs.EOF
                
                FillField WordDoc, "Line_Items" & i, rs!Desc & vbTab & Format(rs!Amount, "currency")
                TotalItems = TotalItems + Nz(rs!Amount, 0)
                rs.MoveNext
                i = i + 1
                Loop
End If

FillField WordDoc, "Total", "Total" & vbTab & Format$(TotalItems + [Forms]![Print Statement of Debt]![Text94] + d!RemainingPBal, "Currency")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Combined Affidavit of Compliance Nationstar " & d![CaseList.FileNumber] & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Combined Affidavit of Compliance Nationstar " & d![CaseList.FileNumber] & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_CombinedAffidavitMDDitech(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset, dd As Recordset
Dim InterestFrom, InterestTo As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRptCombinedAffComplianceDitech WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String
templateName = "Combined Affidavit of Compliance MD Ditech"

InterestFrom = InputBox("Interest From")
InterestTo = InputBox("Interest To")

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
                  DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID =2")
End If
                  
WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]

FillField WordDoc, "PropAddr", d!PropertyAddress & IIf(IsNull(d![Fair Debt]), "", ", " & d![Fair Debt]) & ", " & d!City & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode)
FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "PropertyAddr", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "Investor2", IIf(d![LoanType] = 4, "Federal National Mortgage Association", _
                                        IIf(d![LoanType] = 5, "Federal Home Loan Mortgage Corporation", d![Investor]))
FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", IIf(d!CaseTypeID = 8, d!MonitorTrusteeAddress, FirmShortAddress(vbCr))
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber, "______________")
FillField WordDoc, "MORTGAGOR", Replace(MortgagorNames(0, 2), "Estate of", "")
FillField WordDoc, "DOT", Format([Forms]![ForeclosureDetails]![DOTdate], "mmmm d"", ""yyyy")
FillField WordDoc, "Liber", Nz(d!Liber, "________")
FillField WordDoc, "Folio", Nz(d!Folio, "________") & IIf(IsNull(d![Rerecorded]), "", ", and  re-recorded on " & Format(d![Rerecorded], "mmmm dd"", ""yyyy") & " in Liber " & d![Liber2] & ", Folio " & d![Folio2])
FillField WordDoc, "AsOfDate", IIf(IsNull([Forms]![Print Statement of Debt]![txtDueDate]), "______________", Format$([Forms]![Print Statement of Debt]![txtDueDate], "mmmm d"", ""yyyy"))
FillField WordDoc, "LPIdate", Format$(d![LPIDate], "mmmm d, yyyy")
FillField WordDoc, "LPIdatem", Format$(DateAdd("M", -1, d![LPIDate]), "mmmm d, yyyy")
FillField WordDoc, "LPIdate+1", Format$(d![LPIDate] + 1, "mmmm d, yyyy")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
FillField WordDoc, "InvestorAIF", IIf(d![AIF], "Ditech Financial LLC, as Servicer for " & d![Investor], d![Investor])
FillField WordDoc, "TotalBal", Format(d!RemainingPBal, "Currency")
FillField WordDoc, "Diem", IIf(d![LoanType] = 3, "Monthly Interest", "Diem")
FillField WordDoc, "monthlyIntrst", IIf(IsNull(d![PerDiem]), "", Format(d![PerDiem], "Currency"))
FillField WordDoc, "InvestorAIF", IIf(d![AIF], "Ditech Financial LLC, as Servicer for " & d![Investor], d![Investor])
FillField WordDoc, "AsofDate2", IIf(IsNull([Forms]![Print Statement of Debt]![txtDueDate]), "______________", Format$([Forms]![Print Statement of Debt]![txtDueDate], "mmmm dd, yyyy"))
Dim i As Integer, itemcount As Integer, TotalItems As Currency, itemsFields As String
Set dd = CurrentDb.OpenRecordset("Select desc, amount from statementOFDebt WHERE FileNumber=" & d![CaseList.FileNumber] & " ORDER BY ID;", dbOpenSnapshot)
TotalItems = 0
itemsFields = ""
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
Else
    dd.MoveLast
    itemcount = dd.RecordCount
    For i = 1 To itemcount
        itemsFields = itemsFields & "<<item" & i & ">>" & vbCr
    Next i
    FillField WordDoc, "Line_Items", itemsFields
     i = 1
     dd.MoveFirst
        Do While Not dd.EOF
            FillField WordDoc, "Item" & i, IIf(dd!Desc = "Interest", "Interest from " & [InterestFrom] & " to " & [InterestTo] & vbTab & Format$(Nz(dd!Amount, 0), "Currency"), dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency"))
            TotalItems = TotalItems + Nz(dd!Amount, 0)
            dd.MoveNext
            i = i + 1
        Loop
End If
FillField WordDoc, "BalanceDue", Format(d![RemainingPBal] + TotalItems, "Currency")

End Sub

Public Sub Doc_ComplianceAffidavit(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset, dd As Recordset      ' data
Dim i As Integer, itemcount As Integer, TotalItems As Currency, itemsFields As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String
templateName = "Combined Affidavit of Compliance"

If (d![ClientID] = 466) Then
    templateName = templateName & " Select"
End If
'templateName = templateName & ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)
WordObj.Visible = True

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Or [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
                 DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
                  DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID =2")
End If

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "Investor", d!Investor
FillField WordDoc, "InvestorAIF", IIf([Forms]![case list]![AIF], d![Investor] & ", by Select Portfolio Servicing, Inc., as attorney-in-fact", d![Investor])
FillField WordDoc, "DotDate", Format([Forms]![ForeclosureDetails]![DOTdate], "mmmm d"", ""yyyy")

FillField WordDoc, "TrusteeNames", trusteeNames(0, 3, , vbCr)
FillField WordDoc, "FirmShortAddress", IIf(d!CaseTypeID = 8, d!MonitorTrusteeAddress, FirmShortAddress(vbCr))
FillField WordDoc, "TrusteeWord", IIf(d![FCdetails.State] = "MD", "Substitute Trustees", TrusteeWord(0, 0))
FillField WordDoc, "S", IIf(d![FCdetails.State] = "MD", "", "(s)")
FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "Mortgagors", MortgagorNames(0, 20)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)

FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber, "______________")
'FillField WordDoc, "455Only", IIf(d![ClientID] = 455, ", and continuing each month thereafter with probable future advancements made by the mortgagee, and that the Plaintiff(s) has\have the right to foreclose;", ", and continuing each month thereafter, and that the Plaintiff(s) has\have the right to foreclose;")
FillField WordDoc, "Liber", Nz(d!Liber, "________")
FillField WordDoc, "Folio", Nz(d!Folio, "________")
FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " in Liber " & d![Liber2] & " at Folio " & d![Folio2])

FillField WordDoc, "LPIdate", Format$(d![LPIDate], "mmmm d, yyyy")
FillField WordDoc, "LPIdate+1", Format$(d![LPIDate] + 1, "mmmm d, yyyy")
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")

'FillField WordDoc, "PaidStr", IIf((Nz(d![RemainingPBal], 0) > Nz(d![OriginalPBal], 0)), "Additional Interest", "Paid on principal")
'FillField WordDoc, "Paid", Format$(d!OriginalPBal - d!RemainingPBal, "Currency")
FillField WordDoc, "RemainingPBal", Format$(d!RemainingPBal, "Currency")
FillField WordDoc, "Barcode", IIf(d!ClientID = 466, "", AddDocPreIndex(d![CaseList.FileNumber], 223, ""))

'May have to put these in later
'FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ________________", "")
'FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ________________", "")
'FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ______________", "")

TotalItems = 0
itemsFields = ""
Set dd = CurrentDb.OpenRecordset("SELECT Desc, Amount, Sort_Desc FROM StatementOfDebt WHERE FileNumber=" & d![CaseList.FileNumber] & " ORDER BY Sort_Desc Desc;", dbOpenSnapshot)
If dd.EOF Then      ' no extra lines
    FillField WordDoc, "Line_Items", ""
Else
    dd.MoveLast
    itemcount = dd.RecordCount
    ' Make enough lines
    For i = 1 To itemcount
        itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
    Next i
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
    FillField WordDoc, "Line_Items", itemsFields
    dd.MoveFirst
    i = 1
    Do While Not dd.EOF
        FillField WordDoc, "Item" & i, IIf(dd!Desc = "Interest good through", dd!Desc & " " & [Forms]![Print Statement of Debt]![txtDueDate] & vbTab & Format$(Nz(dd!Amount, 0), "Currency"), _
                                                        dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency"))
        TotalItems = TotalItems + Nz(dd!Amount, 0)
        dd.MoveNext
        i = i + 1
    Loop
End If
dd.Close

FillField WordDoc, "PerDiem", Format$(d!PerDiem, "Currency")
FillField WordDoc, "BalDueDate", IIf(IsNull([Forms]![Print Statement of Debt]![txtDueDate]), "______________", Format$([Forms]![Print Statement of Debt]![txtDueDate], "mmmm d"", ""yyyy"))
FillField WordDoc, "BalanceDue", Format$(d!RemainingPBal + TotalItems, "Currency")

FillField WordDoc, "InterestRate", IIf(IsNull(d!InterestRate), "____________ %", Format$(d!InterestRate, "#0.000") & "%")
FillField WordDoc, "holder", IIf(d![FCdetails.State] = "MD", "", "and holder ")
FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "MDFooter", IIf(d![FCdetails.State] = "MD", "MD002.N002", "MD002")
FillField WordDoc, "Footer2", IIf(d![FCdetails.State] = "MD", "11/16", "")
'FillField WordDoc, "NotaryLocation", IIf(IsNull(d!NotaryLocation), "STATE OF ______________:" & vbCr & "COUNTY OF ____________ :", d!NotaryLocation)

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Combined Affidavit of Compliance Select " & d![CaseList.FileNumber] & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Combined Affidavit of Compliance Select " & d![CaseList.FileNumber] & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_MotionToIntervene(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryMotionToInterveneWord WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber & " AND FcDetails.Current = TRUE;", dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Motion to Intervene")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Motion to Intervene.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

If d![JurisdictionList.State] = "MD" Then
    FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
ElseIf d![JurisdictionList.State] = "VA" Or d![JurisdictionList.State] = "DC" Then
    FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
End If

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & IIf(IsNull(d!LongState), "", ", " & d!LongState))
'FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "MonitorTrusteeName", Nz(d!MonitorTrusteeName)
FillField WordDoc, "Client", Forms![case list]!ClientID.Column(1) '[Forms]![Case List]![ClientID].[Column](1)

FillField WordDoc, "HeaderNames", d![PrimaryFirstName] & " " & d![PrimaryLastName]
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
'FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "DotDate", Format(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "Names", d![PrimaryFirstName] & " " & d![PrimaryLastName] & IIf(Len(d![SecondaryFirstName] & " " & d![SecondaryLastName]) = 1, "", " and " & d![SecondaryFirstName] & " " & d![SecondaryLastName])
FillField WordDoc, "DotRecorded", Format(d!DOTrecorded, "mmmm d, yyyy")
FillField WordDoc, "Liber", d!Liber
FillField WordDoc, "Folio", Nz(d!Folio)
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![FCdetails.State] & " " & FormatZip(d![ZipCode])
Dim MDBar As String
MDBar = DLookup("MDBar", "Staff", "ID =" & [Forms]![MonitorPrint]![Attorney].Column(0))

FillField WordDoc, "Attorney", Forms!MonitorPrint!Attorney.Column(1) & IIf(d![JurisdictionList.State] = "MD", IIf((IsNull(MDBar) Or MDBar = ""), "", ", CPTF #:" & MDBar), "")
FillField WordDoc, "FirmName", FirmName()
FillField WordDoc, "FirmAddress", FirmAddress()
'FillField WordDoc, "GetAddress", GetAddresses(150, 5, "")
FillField WordDoc, "GetAddress", GetAddresses(0, 5, "Owner = true and (Mortgagor = true or Noteholder = true)")
FillField WordDoc, "ThisDate", ThisDate(Date)
'FillField WordDoc, "City", d!City
FillField WordDoc, "LongState", d![JurisdictionList.State]
'FillField WordDoc, "InvestorAIF", IIf([Forms]![Case List]![AIF], d![Investor] & ", by Select Portfolio Servicing, Inc., as attorney-in-fact", d![Investor])
'FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber, "_________________")
FillField WordDoc, "attEmailFirmPhone", d!EMail & vbCr & "Phone Number: " & FirmPhone()
'FillField WordDoc, "Docket", Nz(Format(d!Docket, "mm/d/yyyy"), "___________________")
'FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ________________", "")
'FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ________________", "")
'FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ______________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Motion to Intervene " & d![CaseList.FileNumber] & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Motion to Intervene " & d![CaseList.FileNumber] & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_OrderGrantingIntervention(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryMotionToInterveneWord WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber & " AND FcDetails.Current = TRUE;", dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Order Granting Intervention")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Order Granting Intervention.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

If d![JurisdictionList.State] = "MD" Then
    FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
ElseIf d![JurisdictionList.State] = "VA" Or d![JurisdictionList.State] = "DC" Then
    FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
End If
FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
'FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "MonitorTrusteeName", d!MonitorTrusteeName
FillField WordDoc, "Client", Forms![case list]!ClientID.Column(1) '[Forms]![Case List]![ClientID].[Column](1)

FillField WordDoc, "HeaderNames", d![PrimaryFirstName] & " " & d![PrimaryLastName] & vbCr & _
IIf(Len(d![SecondaryFirstName] & " " & d![SecondaryLastName]) = 1, "", d![SecondaryFirstName] & " " & d![SecondaryLastName])

'FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
'FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
'FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
'FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
'FillField WordDoc, "DotDate", Format(d!DOTdate, "mmmm d, yyyy")
'FillField WordDoc, "Names", d![PrimaryFirstName] & " " & d![PrimaryLastName] & IIf(Len(d![SecondaryFirstName] & " " & d![SecondaryLastName]) = 1, "", " and " & d![SecondaryFirstName] & " " & d![SecondaryLastName])
'FillField WordDoc, "DotRecorded", Format(d!DOTrecorded, "mmmm d, yyyy")
'FillField WordDoc, "Liber", d!Liber
'FillField WordDoc, "Folio", d!Folio
'FillField WordDoc, "Jurisdiction", d!Jurisdiction
'FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
'FillField WordDoc, "Attorney", Forms!MonitorPrint!Attorney.Column(1) '[Forms]![MonitorPrint]![Attorney].[Column](1)
'FillField WordDoc, "FirmName", FirmName()
'FillField WordDoc, "FirmAddress", FirmAddress()
'FillField WordDoc, "GetAddresses", GetAddresses(150, 5, "")
FillField WordDoc, "GetAddress", GetAddresses(0, 5, "Owner = true and (Mortgagor = true or Noteholder = true)")

'FillField WordDoc, "ThisDate", ThisDate(Date)
'FillField WordDoc, "City", d!City
FillField WordDoc, "LongState", d![JurisdictionList.State]
'FillField WordDoc, "InvestorAIF", IIf([Forms]![Case List]![AIF], d![Investor] & ", by Select Portfolio Servicing, Inc., as attorney-in-fact", d![Investor])
'FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber, "_________________")
'FillField WordDoc, "Docket", Nz(Format(d!Docket, "mm/d/yyyy"), "___________________")
'FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ________________", "")
'FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ________________", "")
'FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ______________", "")
FillField WordDoc, "year", Format(Date, "yyyy")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Order Granting Intervention " & d![CaseList.FileNumber] & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Order Granting Intervention " & d![CaseList.FileNumber] & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_StatementOfDebtMonitor(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryFCDocsWordLite WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Dim templateName As String
templateName = "Statement of Debt Monitor"

'If (d![ClientID] = 157) Then
'  templateName = templateName & " Cenlar"
'ElseIf d!ClientID = 404 Then
'  templateName = templateName & " Bogman"
'ElseIf (d![ClientID] = 451 And Trim(UCase$(d!Investor)) Like "LPP MORTGAGE*" And d![FCdetails.State] = "MD") Then
'  templateName = templateName & " Dove"
'ElseIf d![ClientID] = 451 Then
'    templateName = templateName & " Dove"
'End If
templateName = templateName ' & ".doc"

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved(templateName)
Set WordDoc = WordObj.Documents.Open(EMailPath & templateName, False)

WordObj.Visible = True
WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress]
WordDoc.Bookmarks("APTNum").Select
WordDoc.Bookmarks("APTNum").Range.Text = Nz(d![Fair Debt])

If d![JurisdictionList.State] = "MD" Then
    FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
ElseIf d![JurisdictionList.State] = "VA" Or d![JurisdictionList.State] = "DC" Then
    FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
End If

WordObj.Visible = False
If MsgBox("Is There A Loan Mod? ", vbYesNo) = vbYes Then
FillField WordDoc, "Mod", ", MODIFIED by Agreement effective " & Format(InputBox(" Effective Date?   Format mm/dd/yyyy"), "mmmm d, yyyy") & " with an amended principal balance of " & Format(InputBox(" Amended Principal Balance? "), "Currency")
Else
FillField WordDoc, "Mod", ""
End If

If d!JurisdictionID = 6 Then  'Calvert County
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Book " & d![Liber2] & ", Page " & d![Folio2])
Else 'MD or DC
    FillField WordDoc, "ReRecorded", IIf(IsNull(d![Rerecorded]), "", ", and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Liber " & d![Liber2] & ", Folio " & d![Folio2])
End If

WordObj.Visible = True
FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "LoanNumber", d!LoanNumber


'If d!ClientID = 532 Then 'SELENE Finance
'    FillField WordDoc, "Investor", IIf((d![AIF] = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", d![Investor])
'ElseIf d!ClientID = 523 Then 'GreenTree
'    FillField WordDoc, "Investor", IIf((d![AIF] = True And d![ClientID] = 523), d![Investor] & " by Green Tree Servicing LLC as servicer", d![Investor])
'Else
'    FillField WordDoc, "Investor", IIf((d!AIF = True And d!ClientID = 373), d!Investor & ", by BSI Financial Services as attorney in fact", IIf((d![AIF] = True And d![ClientID] = 523), d![Investor] & " by Green Tree Servicing LLC as servicer", IIf((d![AIF] = True And d!ClientID = 532), d![Investor] & ", by and through Selene Finance LP, its Servicer and Attorney-in-Fact", IIf((d![AIF] = True And d![ClientID] = 605), d![LongClientName] & " as Servicer for ", IIf(d![AIF] = True, d![LongClientName] & " as Attorney in Fact for ", "")))) & d![Investor])
'End If

FillField WordDoc, "MonitorTrusteeName", Nz(d!MonitorTrusteeName)
FillField WordDoc, "FirmShortAddress", Nz(d!MonitorTrusteeAddress)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
'FillField WordDoc, "MortgagorNames", MortgagorNames(0, 3, vbCr)
FillField WordDoc, "Names", d![PrimaryFirstName] & " " & d![PrimaryLastName] & vbCr & _
IIf(Len(d![SecondaryFirstName] & " " & d![SecondaryLastName]) = 1, "", d![SecondaryFirstName] & " " & d![SecondaryLastName])

FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "LongClientName", d!LongClientName

FillField WordDoc, "City", d!City
FillField WordDoc, "State", d![FCdetails.State]
FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "Liber", LiberFolio(d![Liber], d![Folio], d![FCdetails.State], d![JurisdictionID])
'FillField WordDoc, "LPIdate", Format$(d![LPIDate], "mmmm d, yyyy")
'FillField WordDoc, "LPIdate+1", Format$(d![LPIDate] + 1, "mmmm d, yyyy")
'FillField WordDoc, "LPdM", DateAdd("m", -1, d![LPIDate])
FillField WordDoc, "OriginalPBal", Format$(d!OriginalPBal, "Currency")
'FillField WordDoc, "PaidStr", IIf((Nz(d![RemainingPBal], 0) > Nz(d![OriginalPBal], 0)), "Additional Interest", "Paid on principal")
'FillField WordDoc, "Paid", Format$(d!OriginalPBal - d!RemainingPBal, "Currency")
'FillField WordDoc, "RemainingPBal", Format$(d!RemainingPBal, "Currency")
FillField WordDoc, "InterestRate", IIf(IsNull(d!InterestRate), "____________ %", Format$(d!InterestRate, "#.000%"))
'FillField WordDoc, "InvestorName", (Split(ReportArgs, "|")(0))
'FillField WordDoc, "InvestorTitle", (Split(ReportArgs, "|")(1))
FillField WordDoc, "Barcode", AddDocPreIndex(d![CaseList.FileNumber], 223, "")
FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ________________", "")
FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ________________", "")
FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ______________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Statement of Debt.doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Statement of Debt.doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub Doc_MotionToReleaseFunds(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d As Recordset      ' data
Dim MotiontoDepositSurplus, MotionToIntervene, OrderGranting, OrderGrantingIntervention, CheckDeposited, CheckAmount As String

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryMotionToInterveneWord WHERE CaseList.FileNumber=" & Forms![case list]!FileNumber & " AND FcDetails.Current = TRUE;", dbOpenSnapshot)
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Motion to Release Funds")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Motion to Release Funds.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

MotiontoDepositSurplus = InputBox("Motion to Deposit Surplus Monies filed date")
'MotionToIntervene = InputBox("Motion to Intervene filed")
OrderGranting = InputBox("Order Granting the Motion to Deposit Surplus Monies filed")
'OrderGrantingIntervention = InputBox("Order Granting the Motion to Intervene filed")
CheckDeposited = InputBox("Check Deposited date")
CheckAmount = InputBox("Check Amount")

FillField WordDoc, "MotionToDepositSurplus", Format(MotiontoDepositSurplus, "mmmm dd, yyyy")
'FillField WordDoc, "MotionToIntervene", Format(MotionToIntervene, "mmmm dd, yyyy")
FillField WordDoc, "OrderGranting", Format(OrderGranting, "mmmm dd, yyyy")
'FillField WordDoc, "ORderGrantingIntervention", Format(OrderGrantingIntervention, "mmmm dd, yyyy")
FillField WordDoc, "CheckDeposited", Format(CheckDeposited, "mmmm dd, yyyy")
FillField WordDoc, "CheckAmount", Format(CheckAmount, "Currency")
'added on 6/9/15
FillField WordDoc, "MonitorMotionSurplusFiled", Format(d!MonitorMotionSurplusFiled, "mmmm d, yyyy")
'StatementOfDebtDate
'StatementOfDebtAmount
FillField WordDoc, "StatementOfDebtDate", Format(d!StatementOfDebtDate, "mmmm d, yyyy")
FillField WordDoc, "StatementOfDebtAmount", Format(d!StatementOfDebtAmount, "Currency")
'MonitorOrderSurplus
FillField WordDoc, "MonitorOrderSurplus", Format(d!MonitorOrderSurplus, "mmmm d, yyyy")
'CourtCaseNumber
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)

FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
'FillField WordDoc, "LoanNumber", d!LoanNumber
FillField WordDoc, "MonitorTrusteeName", Nz(d!MonitorTrusteeName)
FillField WordDoc, "Client", Forms![case list]!ClientID.Column(1) '[Forms]![Case List]![ClientID].[Column](1)

FillField WordDoc, "HeaderNames", d![PrimaryFirstName] & " " & d![PrimaryLastName]
FillField WordDoc, "FirmShortAddress", FirmShortAddress(vbCr)
FillField WordDoc, "TrusteeWord", TrusteeWord(0, 0)
'FillField WordDoc, "MortgagorNames", MortgagorNames(0, 2)
FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])
FillField WordDoc, "DotDate", Format(d!DOTdate, "mmmm d, yyyy")
'FillField WordDoc, "DotRecorded", Format(d!DOTrecorded, "mmmm d, yyyy")
FillField WordDoc, "Liber", d!Liber
FillField WordDoc, "Folio", Nz(d!Folio)
FillField WordDoc, "Jurisdiction", d!Jurisdiction
'FillField WordDoc, "PropertyAddressOneLine", d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d![City] & ", " & d![State] & " " & FormatZip(d![ZipCode])
FillField WordDoc, "Attorney", Forms!MonitorPrint!Attorney.Column(1) '[Forms]![MonitorPrint]![Attorney].[Column](1)
FillField WordDoc, "FirmName", FirmName()
FillField WordDoc, "FirmAddress", FirmAddress()
'FillField WordDoc, "GetAddress", GetAddresses(150, 5, "")
FillField WordDoc, "GetAddress", GetAddresses(0, 5, "Owner = true and (Mortgagor = true or Noteholder = true)")

FillField WordDoc, "ThisDate", ThisDate(Date)
'FillField WordDoc, "City", d!City
FillField WordDoc, "LongState", d![State]
'FillField WordDoc, "InvestorAIF", IIf([Forms]![Case List]![AIF], d![Investor] & ", by Select Portfolio Servicing, Inc., as attorney-in-fact", d![Investor])
'FillField WordDoc, "Zip", FormatZip(d!ZipCode)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber, "_________________")
'FillField WordDoc, "Docket", Nz(Format(d!Docket, "mm/d/yyyy"), "___________________")
'FillField WordDoc, "AnneArundel1", IIf(d![JurisdictionID] = 3, "Address: ________________", "")
'FillField WordDoc, "AnneArundel2", IIf(d![JurisdictionID] = 3, "               ________________", "")
'FillField WordDoc, "AnneArundel3", IIf(d![JurisdictionID] = 3, "Phone No.: ______________", "")

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Motion to Release Funds " & d![CaseList.FileNumber] & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Motion to Release Funds " & d![CaseList.FileNumber] & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub

Public Sub DOC_DeedofAppointmentNationstarMD(KeepOpen As Boolean)
'Added on the 10/6/15

    Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
    
    Dim d, rs As Recordset

    Set d = CurrentDb.OpenRecordset("SELECT * FROM SOT_VA_Nations WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
    If d.EOF Then
        MsgBox "The file might missing data, please check all the data required or contact programmers"
        Exit Sub
    End If
    
Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Deed of Appointment NationstarMD")

Set WordDoc = WordObj.Documents.Open(EMailPath & "Deed of Appointment NationstarMD.doc", False)
'Need to rename the doc if it's DC    2/27/17
If d!JurisdictionState = "DC" Then
    WordDoc.SaveAs filename:=EMailPath & "Substitute Trustee DC Nationstar.doc"
    WordDoc.Close
    Kill EMailPath & "Deed of Appointment NationstarMD.doc"     'doc is renamed, so delete this one and open the renamed file. 2/27/17
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Substitute Trustee DC Nationstar.doc", False)
End If
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select

'office locations:
    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And (d!JurisdictionState = "DC" Or d!JurisdictionState = "VA")) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth " & vbCr & "Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And (d!JurisdictionState = "MD")) Then  'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & " & vbCr & "Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg &" & vbCr & "Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "FirmAddress", IIf([Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And (d!JurisdictionState = "DC" Or d!JurisdictionState = "VA")), "Commonwealth Trustees, LLC" & vbCr & "8601 Westwood Center Drive, Suite 255" & vbCr & "Vienna, VA 22182", _
            IIf([Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And (d!JurisdictionState = "MD")), FirmAddress(vbCr), _
            "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")))
FillField WordDoc, "taxID1", IIf(d!JurisdictionState <> "DC", "TAX ID#:  " & Nz(d!TaxID, ""), "")
FillField WordDoc, "taxID2", IIf(d!JurisdictionState = "DC", "TAX ID#:  " & Nz(d!TaxID, ""), "")
FillField WordDoc, "DOTDate", Format(d!DOTdate, "mmmm d, yyyy")
FillField WordDoc, "OriginalTrustee", d!OriginalTrustee
FillField WordDoc, "mortgagorNames", MortgagorNames1(0, 3, vbNewLine)
FillField WordDoc, "Mers", IIf(d!MERS = True, "Mortgage Electronic Registration Systems, Inc.(MERS), solely as nominee for " & d!OriginalBeneficiary & " and its successors and assigns", d!OriginalBeneficiary)
FillField WordDoc, "Client", Nz(d!LongClientName)
'ClientAddress
FillField WordDoc, "ClientAddress", d!StreetAddress
FillField WordDoc, "CityStZip", d!City & ", " & d!State & " " & FormatZip(d!ZipCode)
FillField WordDoc, "Investor", Nz(d!Investor)
FillField WordDoc, "chkInvestor", IIf(d!Investor = d!LongClientName, "present", "")
FillField WordDoc, "JurisdictionState", d!JurisdictionState
FillField WordDoc, "Jurisdiction", UCase$(d!Jurisdiction & ", ")
'FillField WordDoc, "Word2", IIf(d!Investor = "Nationstar Mortgage LLC", "undersigned", d!Investor)
FillField WordDoc, "trusteeNames", trusteeNames(0, 2)
FillField WordDoc, "RecordingInformation", IIf(IsNull(d!Liber) = True And IsNull(d!Folio) = True, "", "Recording Information")
FillField WordDoc, "Instrument", IIf(IsNull(d!Liber) = False And IsNull(d!Folio) = True, "Instrument: " & d!Liber & " ", IIf(IsNull(d!Liber) = False And IsNull(d!Folio) = False, "Book: " & d!Liber & ", Page: " & d!Folio & "", ""))
FillField WordDoc, "Re-recordingInfo", IIf(IsNull(d!Liber2) = True And IsNull(d!Folio2) = True, "", "Re-Recording Information")
FillField WordDoc, "Instrument2", IIf(IsNull(d!Liber2) = False And IsNull(d!Folio2) = True, "Instrument: " & d!Liber2 & " ", IIf(IsNull(d!Liber2) = False And IsNull(d!Folio2) = False, "Book: " & d!Liber2 & ", Page: " & d!Folio2 & "", ""))

FillField WordDoc, "FirmShortAddressOneLine", FirmShortAddressOneLine()
FillField WordDoc, "AIF", IIf(d!AIF = True, d!LongClientName & ", attorney-in-fact for " & d!Investor & " ", d!Investor)
'FillField WordDoc, "Recording", IIf(IsNull(d!Liber) = False And IsNull(d!Folio) = True, "Instrument: " & d!Liber & " ", IIf(IsNull(d!Liber) = False And IsNull(d!Folio) = False, "Book: " & d!Liber & " , Page: " & d!Folio & ""))

'FillField WordDoc, "Recording", IIf(d!Liber <> "" And d!Folio = "", "Instrument: " & d!Liber & " ", IIf(d!Liber <> "" And d!Folio <> "", "Book: " & d!Liber & " , Page: " & d!Folio & "", ""))

WordObj.Selection.HomeKey wdStory, wdMove
'WordDoc.SaveAs EMailPath & "Substitute Trustee MD Nationstar" & ".doc"
'Call SaveDoc(WordDoc, d![CaseList.FileNumber], "Substitute Trustee MD Nationstar" & ".doc")
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
d.Close

End Sub
'Added on the 6/18/15
Public Sub Doc_DeedofAppointmentNationStarVA(KeepOpen As Boolean)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rs, rsGrantors As Recordset     ' data
'Dim MotiontoDepositSurplus, MotionToIntervene, OrderGranting, OrderGrantingIntervention, CheckDeposited, CheckAmount As String

'Set d = CurrentDb.OpenRecordset("SELECT * FROM qrySOT_VA_Nations WHERE CaseList.FileNumber=" & Forms![Case List]!FileNumber & " AND FcDetails.Current = TRUE;", dbOpenSnapshot)
Set d = CurrentDb.OpenRecordset("SELECT * FROM SOT_VA_Nations WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("SELECT Name FROM qryTrustees WHERE FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rsGrantors = CurrentDb.OpenRecordset("Select * from qryNationsVASOTWord where FileNumber=" & Forms![case list]!FileNumber, dbOpenSnapshot)
NextNumber = rsGrantors!JurisdictionID    'borrow the global variable to hole the JurisdictionID   Mei
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("Deed of Appointment NationStar VA")
Set WordDoc = WordObj.Documents.Open(EMailPath & "Deed of Appointment NationStar VA.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt])

'margin address:
    If (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCState] = "VA") Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCState] = "DC") _
                    Or ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) And d![FCState] = "MD") Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If

FillField WordDoc, "DOTDate", Format(d!DOTdate, "mmmm d, yyyy")

If d!Jurisdiction = "Accomack County" Then      'Mei 10/20/15  Accormack cnty wants ALL capitals
  FillField WordDoc, "OriginalBeneficiary", UCase(IIf(d!MERS = True, "Mortgage Electronic Registration Systems, Inc.(MERS), solely as nominee for " & d!OriginalBeneficiary & " and its successors and assigns", d!OriginalBeneficiary))
  FillField WordDoc, "Grantors", UCase(MortgagorNames1(0, 3, vbNewLine)) 'GetNames(d![CaseList.FileNumber], 3, "Mortgagor = True")
  FillField WordDoc, "AKA", ""
  FillField WordDoc, "TrusteeName", IIf(Left(trusteeNames(0, 3), Len(trusteeNames(0, 3)) - 2) = "Commonwealth Trustees, LLC", "", UCase(trusteeNames(0, 3)))
  FillField WordDoc, "CurrentBeneficiary", UCase(Nz(d!Investor))
  FillField WordDoc, "Client", UCase(Nz(d!LongClientName))
  FillField WordDoc, "Investor", UCase(Nz(d!Investor))
  FillField WordDoc, "Word2", UCase(IIf(d!Investor = "Nationstar Mortgage LLC", "undersigned", d!Investor))
  FillField WordDoc, "Trustee", UCase(Nz(rs!Name))
  FillField WordDoc, "ClientInfo", UCase(IIf(d!AIF = True, d!LongClientName & ", attorney-in-fact for " & d!Investor & " ", d!Investor))
Else
  Dim itemsFields As String    'Last name and First Name from AKA
  Dim i As Integer
  
        If rsGrantors.EOF Then
             FillFieldSOTNationsVA WordDoc, "Grantors", ""
        Else
             rsGrantors.MoveLast
        
            For i = 1 To rsGrantors.RecordCount
              itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
            Next i
            itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
            FillField WordDoc, "Grantors", itemsFields & " "

            rsGrantors.MoveFirst
            i = 1
            
            Do Until rsGrantors.EOF
                If IsNull(rsGrantors![Company]) Then
   
                    If Not (IsNull(rsGrantors![AKA])) Then
                        fName = IIf(IsNull(rsGrantors![AKA]), "", Left(rsGrantors![AKA], InStrRev(Trim(rsGrantors![AKA]), " ")))
                        LName = IIf(IsNull(rsGrantors![AKA]), "", UCase(Right(rsGrantors![AKA], Len(Trim(rsGrantors![AKA])) - InStrRev(Trim(rsGrantors![AKA]), " "))))
                    Else
                    End If
                End If
                
                ' FillField function just for NationStar VA SOT.   Mei 1/11/17
                FillFieldSOTNationsVA WordDoc, "Item" & i, IIf(IsNull(rsGrantors![Company]), rsGrantors![First] & " " & UCase(rsGrantors![Last]), rsGrantors![Company] & "CName") & _
                    IIf(IsNull(rsGrantors![Company]), IIf(IsNull(rsGrantors![AKA]), "", vbCr & fName & " " & LName), "")
             
                rsGrantors.MoveNext
                i = i + 1
            Loop
        End If
'
'        FillField WordDoc, "Grantors", IIf(IsNull(rsGrantors![Company]), rsGrantors![First] & " " & UCase(rsGrantors![Last]), rsGrantors![Company]) & _
'              IIf(IsNull(rsGrantors![Company]), IIf(IsNull(rsGrantors![AKA]), "", vbCr & FName & " " & LName), "")
  
  FillField WordDoc, "OriginalBeneficiary", IIf(d!MERS = True, "Mortgage Electronic Registration Systems, Inc.(MERS), solely as nominee for " & d!OriginalBeneficiary & " and its successors and assigns", d!OriginalBeneficiary)
  FillField WordDoc, "TrusteeName", IIf(Left(trusteeNames(0, 3), Len(trusteeNames(0, 3)) - 2) = "Commonwealth Trustees, LLC", "", trusteeNames(0, 3))
  FillField WordDoc, "CurrentBeneficiary", Nz(d!Investor)
  FillField WordDoc, "Client", Nz(d!LongClientName)
  FillField WordDoc, "Investor", Nz(d!Investor)
  FillField WordDoc, "Word2", IIf(d!Investor = "Nationstar Mortgage LLC", "undersigned", d!Investor)
  FillField WordDoc, "Trustee", Nz(rs!Name)
  FillField WordDoc, "ClientInfo", IIf(d!AIF = True, d!LongClientName & ", attorney-in-fact for " & d!Investor & " ", d!Investor)
End If

FillField WordDoc, "OriginalTrustee", d!OriginalTrustee
FillField WordDoc, "ClientAddress", d!StreetAddress & " " & Nz(d!StreetAddr2, "")
FillField WordDoc, "City", d!City & ", " & d!State & " " & FormatZip(d!ZipCode)
FillField WordDoc, "word1", IIf(d!Investor = "Nationstar Mortgage LLC", "present", "")
FillField WordDoc, "Jurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
'FillField WordDoc, "Recording", IIf(IsNull(d!Liber) = False And IsNull(d!Folio) = True, "Instrument: " & d!Liber & " ", IIf(IsNull(d!Liber) = False And IsNull(d!Folio) = False, "Book: " & d!Liber & " , Page: " & d!Folio & ""))
FillField WordDoc, "Recording", IIf(IsNull(d!Liber) = False And IsNull(d!Folio) = True, "Instrument: " & d!Liber & " ", IIf(IsNull(d!Liber) = False And IsNull(d!Folio) = False, "Book: " & d!Liber & ", Page: " & d!Folio & "", ""))
'FillField WordDoc, "Recording", IIf(d!Liber <> "" And d!Folio = "", "Instrument: " & d!Liber & " ", IIf(d!Liber <> "" And d!Folio <> "", "Book: " & d!Liber & " , Page: " & d!Folio & "", ""))

FillField WordDoc, "TaxmapNo", Nz(d!TaxID)
'Mei 10-19-15 shows only if re-recording info is not null
If IsNull(d![Folio2]) And IsNull(d![Liber2]) Then
    FillField WordDoc, "Re-Recording Information:", ""
    FillField WordDoc, "Re-Recording", ""
Else
    FillField WordDoc, "Re-Recording Information:", "Re-Recording Information:"
    FillField WordDoc, "Re-Recording", IIf(IsNull(d!Liber2) = False And IsNull(d!Folio2) = True, "Instrument: " & d!Liber2 & " ", IIf(IsNull(d!Liber2) = False And IsNull(d!Folio2) = False, "Book: " & d!Liber2 & ", Page: " & d!Folio2 & "", ""))
End If
'FillField WordDoc, "Recordinginfo", IIf(IsNull(d!Liber) = True And IsNull(d!Folio) = True, "", "Recording Information")

FillField WordDoc, "Property Address", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)

WordObj.Selection.HomeKey wdStory, wdMove

Set WordObj = Nothing

d.Close
rs.Close
rsGrantors.Close
NextNumber = ""
fName = ""
LName = ""
Set d = Nothing
Set rs = Nothing
Set rsGrantors = Nothing
End Sub

Public Sub Doc_DCComplaint(KeepOpen As Boolean, Optional NewLine As String = vbNewLine)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rs, N, rsStaff, rsPayoff, rsdef As Recordset  ' data
Dim itemsFields As String
Dim TotalItems As Currency
Dim i, j, t, cnt As Integer
Dim Fnum As Long
Dim rsNo As String
Dim TimeDoc As String

TimeDoc = Format$(Now(), "yyyymmdd hhnnss")

If IsNull([Forms]![GetBarredAtty_DCCompliant]![cboOfficeLocation].Column(0)) Then
    i = 2
Else
    i = [Forms]![GetBarredAtty_DCCompliant]![cboOfficeLocation].Column(0)
End If
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCComplaint WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("SELECT * FROM Rosenberg WHERE ID = " & i, dbOpenSnapshot)
Set N = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE owner = true and FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rsdef = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE Defendant = True and FileNumber = " & [Forms]![case list]![FileNumber], dbOpenSnapshot)


If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If N.EOF Then
    MsgBox ("Please check a Owner in the Name tap")
    Exit Sub
End If

If rsdef.EOF Then
    MsgBox ("Please check a Defendant in the Name tap")
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")

    
If Not rsdef.EOF Then

rsdef.MoveLast
cnt = rsdef.RecordCount
rsNo = cnt
Dim check As Boolean
check = False

Select Case Forms!GetDocType!Frame1
Case 1
    
    Select Case cnt
        Case 1
        Call SaveNewDocInRosie("DC Complaint - 1", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint - 1" & " " & TimeDoc & ".doc", False)
        Case 2
        Call SaveNewDocInRosie("DC Complaint - 2", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint - 2" & " " & TimeDoc & ".doc", False)
        
        Case 3
        Call SaveNewDocInRosie("DC Complaint - 3", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint - 3" & " " & TimeDoc & ".doc", False)
        
        Case 4
        Call SaveNewDocInRosie("DC Complaint - 4", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint - 4" & " " & TimeDoc & ".doc", False)
        
        Case 5
        Call SaveNewDocInRosie("DC Complaint - 5", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint - 5" & " " & TimeDoc & ".doc", False)
        
        Case 6
        Call SaveNewDocInRosie("DC Complaint - 6", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint - 6" & " " & TimeDoc & ".doc", False)
        
        Case 7
        Call SaveNewDocInRosie("DC Complaint - 7", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint - 7" & " " & TimeDoc & ".doc", False)
        
        Case 8
        Call SaveNewDocInRosie("DC Complaint - 8", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint - 8" & " " & TimeDoc & ".doc", False)
        
        Case 9
        Call SaveNewDocInRosie("DC Complaint - 9", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint - 9" & " " & TimeDoc & ".doc", False)
        
        Case 10
        Call SaveNewDocInRosie("DC Complaint - 10", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint - 10" & " " & TimeDoc & ".doc", False)
        Case Else
       
        MsgBox ("More than 10 defendants, please call IT programmer for help")
        Exit Sub
        
      End Select
    check = True
Case 2
    
    Select Case cnt
        Case 1
         Call OpenDocAsSaved("DC Complaint - 1")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint - 1.doc", ReadOnly:=True)
        Case 2
         Call OpenDocAsSaved("DC Complaint - 2")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint - 2.doc", ReadOnly:=True)

        Case 3
         Call OpenDocAsSaved("DC Complaint - 3")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 3.doc", ReadOnly:=True)
       ' Set WordDoc = WordObj.Documents.Open(TemplatePath & "DC Complaint - 3.doc", False)

        Case 4
         Call OpenDocAsSaved("DC Complaint - 4")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 4.doc", ReadOnly:=True)
        'Set WordDoc = WordObj.Documents.Open(TemplatePath & "DC Complaint - 4.doc", ReadOnly:=True)

        Case 5
         Call OpenDocAsSaved("DC Complaint - 5")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 5.doc", ReadOnly:=True)
       ' Set WordDoc = WordObj.Documents.Open(TemplatePath & "DC Complaint - 5.doc", ReadOnly:=True)

        Case 6
         Call OpenDocAsSaved("DC Complaint - 6")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 6.doc", ReadOnly:=True)
        'Set WordDoc = WordObj.Documents.Open(TemplatePath & "DC Complaint - 6.doc", ReadOnly:=True)

        Case 7
         Call OpenDocAsSaved("DC Complaint - 7")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 7.doc", ReadOnly:=True)
        'Set WordDoc = WordObj.Documents.Open(TemplatePath & "DC Complaint - 7.doc", ReadOnly:=True)

        Case 8
         Call OpenDocAsSaved("DC Complaint - 8")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 8.doc", ReadOnly:=True)
        'Set WordDoc = WordObj.Documents.Open(TemplatePath & "DC Complaint - 8.doc", ReadOnly:=True)

        Case 9
         Call OpenDocAsSaved("DC Complaint - 9")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 9.doc", ReadOnly:=True)
        'Set WordDoc = WordObj.Documents.Open(TemplatePath & "DC Complaint - 9.doc", ReadOnly:=True)

        Case 10
         Call OpenDocAsSaved("DC Complaint - 10")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 10.doc", ReadOnly:=True)
        'Set WordDoc = WordObj.Documents.Open(TemplatePath & "DC Complaint - 10.doc", ReadOnly:=True)

        Case Else
        MsgBox ("More than 10 defendants, please call IT programmer for help")
        Exit Sub

        End Select
    check = False
    End Select
Else
    Call OpenDocAsSaved("DC Complaint - 0")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint - 0.doc", False)
End If
'Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint.doc", False)

If Forms!GetDocType!Frame1 = 2 Then
    WordObj.Visible = True
End If

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("Address").Select
WordDoc.Bookmarks("Address").Range.Text = rs!Address
WordDoc.Bookmarks("Unit").Select
WordDoc.Bookmarks("Unit").Range.Text = rs!Unit
WordDoc.Bookmarks("Cityline").Select
WordDoc.Bookmarks("Cityline").Range.Text = rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)

WordDoc.Bookmarks("PropAddress").Select
WordDoc.Bookmarks("PropAddress").Range.Text = d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", "," & vbNewLine & "         " & d![Fair Debt]) '& ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)

WordDoc.Bookmarks("PropCityline").Select
WordDoc.Bookmarks("PropCityline").Range.Text = d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]

If Not N.EOF Then
    N.MoveLast
   If N.RecordCount > 1 Then
     FillField WordDoc, "v", "are"
     FillField WordDoc, "u", "s"
   ElseIf N.RecordCount = 1 Then
     FillField WordDoc, "v", "is"
     FillField WordDoc, "u", ""
   End If
End If

  FillField WordDoc, "BENEFICIARY NAME", UCase(Nz(d!Investor))
  FillField WordDoc, "RECORD OWNERS NAME", OwnerNames(0, 2)
  'FillField WordDoc, "BORROWERS NAME", BorrowerDefendants(d![CaseList.FileNumber]) '& d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
  FillField WordDoc, "PROPERTY ADDRESS", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
  FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
  FillField WordDoc, "Address", rs!Address
  FillField WordDoc, "Unit", rs!Unit
  FillField WordDoc, "City", rs!City
  FillField WordDoc, "State", rs!LongState
  FillField WordDoc, "Zip", Nz(rs!Zip)
  FillField WordDoc, "DCattorneys", GetDCattorneys()
  FillField WordDoc, "LEGAL DESCRIPTION", IIf(IsNull(d!LegalDescription), "", d!LegalDescription)
  FillField WordDoc, "DocumentNumber", IIf(IsNull(d!Deedrecorded), "", d!DeedLiber)
  FillField WordDoc, "Borrowers", MortgagorNames(0, 2) ', vbCr)
  FillField WordDoc, "DATE OF EXECUTION OF DOT", IIf(IsNull(d!DOTdate), "", Format$(d!DOTdate, "mmmm d, yyyy"))

  FillField WordDoc, "TEXT OF NUMBER", IIf(IsNull(d!OriginalPBal) Or d!OriginalPBal = 0, "Zero", CurrencyWords(d!OriginalPBal))
  FillField WordDoc, "NUMBERICAL NUMBER", IIf(IsNull(d!OriginalPBal) Or d!OriginalPBal = 0, "$0", Format(d!OriginalPBal, "Currency"))
  'FillField WordDoc, "RECORDINGDATE", IIf(IsNull(d!DOTrecorded), "", "" & Format$(d!DOTrecorded, "mmmm d, yyyy") & " at Document Number " & d!Liber & "")
  'FillField WordDoc, "Re-RECORDINGDATE", IIf(IsNull(d![Rerecorded]), "", "and re-recorded at Document Number " & d!Liber2 & "") & IIf(IsNull(d![LoanMod]), "", " and was modified as recorded on " & Format$(d![LoanModRecorded], "mmmm d, yyyy") & " at Document Number " & d![LiberLoanMod] & ".")

  FillField WordDoc, "RECORDINGDATE", IIf(IsNull(d!DOTrecorded), "", "" & Format$(d!DOTrecorded, "mmmm d, yyyy") & " at Document Number " & d!Liber & "") & IIf(IsNull(d![Rerecorded]), "", " and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Document Number " & d!Liber2 & "") & IIf(IsNull(d![LoanMod]), "", " and was modified as recorded on " & Format$(d![LoanModRecorded], "mmmm d, yyyy") & " at Document Number " & d![LiberLoanMod] & ".")
  FillField WordDoc, "DATE OF DEFAULT", IIf(IsNull(d!LPIDate), "", Format$(d!LPIDate, "mmmm d, yyyy"))
  FillField WordDoc, "DATE OF DEMAND", IIf(IsNull(d!AccelerationIssued), "", Format$(d!AccelerationIssued, "mmmm d, yyyy"))
  FillField WordDoc, "trusteeList", getTrustees(Forms!ForeclosureDetails!lstTrustees, Forms!ForeclosureDetails!lstTrustees)
  FillField WordDoc, "DCattorneyLine", GetDCattorneyLine()
  FillField WordDoc, "DCattorneyEmail", GetDCattorneyEmail()
  FillField WordDoc, "Due", Format$(Forms!GetBarredAtty_DCCompliant!txtDueDate, "mmmm d, yyyy")
  
  FillField WordDoc, "AddressLine", rs!AddressLine
  FillField WordDoc, "Cityline", rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)

Set rsPayoff = CurrentDb.OpenRecordset("SELECT Desc,  Amount FROM Payoff WHERE FileNumber=" & d![CaseList.FileNumber], dbOpenSnapshot)
If rsPayoff.EOF Then
     FillField WordDoc, "Payoff_Items", ""
Else
    
    rsPayoff.MoveLast
    'itemCount = rsPayoff.RecordCount

    For i = 1 To rsPayoff.RecordCount
      itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
    Next i
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
    FillField WordDoc, "Payoff_Items", itemsFields & " "
    'FillField WordDoc, "Items_Amount", itemsFields & " "

    rsPayoff.MoveFirst
    i = 1
    Do While Not rsPayoff.EOF
        
        FillField WordDoc, "Item" & i, i & ".  " & rsPayoff!Desc & vbTab & Format$(Nz(rsPayoff!Amount, 0), "Currency")
        'FillField WordDoc, "Item" & i, rsPayoff!Desc & vbTab
        FillField WordDoc, "Item" & i, Format$(Nz(rsPayoff!Amount, 0), "Currency")

        ''Items_Amount
        'FillField WordDoc, "Item" & i, IIf(dd!Desc = "Interest", "Interest at " & Format$(Forms![Print Statement of Debt]!InterestRate, "#0.000%") & " for " & [InterestFrom] & " to " & [InterestTo] & vbTab & Format$(Nz(dd!Amount, 0), "Currency"), dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency"))
        TotalItems = TotalItems + Nz(rsPayoff!Amount, 0)
        rsPayoff.MoveNext
        i = i + 1
    Loop
End If

cnt = 0

If Not rsdef.EOF Then
    
    rsdef.MoveFirst
Do While Not rsdef.EOF

    cnt = cnt + 1
    
    Select Case cnt
        
         Case 1
            
            FillField WordDoc, "BORROWERS NAME1", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress1", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) '& NewLine & NewLine & "and" & NewLine & NewLine

         Case 2
            FillField WordDoc, "BORROWERS NAME2", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress2", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine

        Case 3
            FillField WordDoc, "BORROWERS NAME3", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress3", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) '& NewLine & NewLine & "and" & NewLine & NewLine

        Case 4
            
            FillField WordDoc, "BORROWERS NAME4", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress4", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine

        Case 5
            FillField WordDoc, "BORROWERS NAME5", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress5", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine

        Case 6
            FillField WordDoc, "BORROWERS NAME6", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress6", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine


        Case 7
            FillField WordDoc, "BORROWERS NAME7", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress7", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine

        Case 8
            
            FillField WordDoc, "BORROWERS NAME8", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress8", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine

        Case 9
            
            FillField WordDoc, "BORROWERS NAME9", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress9", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine

        Case 10
            FillField WordDoc, "BORROWERS NAME10", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress10", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine
      
    End Select
    rsdef.MoveNext
Loop

rsdef.Close
Set rsdef = Nothing
End If

FillField WordDoc, "Total", Format$(Nz(TotalItems, 0), "Currency")
rsPayoff.Close
WordObj.Selection.HomeKey wdStory, wdMove

Fnum = d![CaseList.FileNumber]

d.Close
rs.Close
Set d = Nothing
Set rs = Nothing

If Forms!GetDocType!Frame1 = 1 Then
    WordObj.Quit Savechanges:=wdSaveChanges

DoCmd.SetWarnings False

strInfo = "Draft complaint has completed merging and auto saved"
strInfo = Replace(strInfo, "'", "''")
strSQLJournal = "Insert into Journal (FileNumber,JournalDate,Who,Info,Color) Values(" & [Forms]![case list]![FileNumber] & ",Now,GetFullName(),'" & strInfo & "',1 )"

DoCmd.RunSQL strSQLJournal
Forms!Journal.Requery

DoCmd.SetWarnings True

MsgBox ("Draft complaint has completed merging and auto saved")

ElseIf Forms!GetDocType!Frame1 = 2 Then

MsgBox ("Draft complaint has completed merging and ready for view")

End If
Set WordObj = Nothing
'Call CheckSaveInRosie("DC Complaint" & " - " & rsNo, Fnum)
DoCmd.Close acForm, "GetDocType"


End Sub

Public Sub Doc_DCComplaint_QT(KeepOpen As Boolean, Optional NewLine As String = vbNewLine)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rs, N, rsStaff, rsPayoff, rsdef As Recordset  ' data
Dim itemsFields As String
Dim TotalItems As Currency
Dim i, j, cnt As Integer
Dim Fnum As Long
Dim TimeDoc As String

TimeDoc = Format$(Now(), "yyyymmdd hhnnss")

If IsNull([Forms]![GetBarredAtty_DCCompliant]![cboOfficeLocation].Column(0)) Then
    i = 2
Else
    i = [Forms]![GetBarredAtty_DCCompliant]![cboOfficeLocation].Column(0)
End If

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCComplaint WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("SELECT * FROM Rosenberg WHERE ID = " & i, dbOpenSnapshot)
Set N = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE owner = true and FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rsdef = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE Defendant = True and FileNumber = " & [Forms]![case list]![FileNumber], dbOpenSnapshot)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If rsdef.EOF Then
    MsgBox ("Please check a defendant in the Name tap")
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")

If Not rsdef.EOF Then

        rsdef.MoveLast
        cnt = rsdef.RecordCount
        
        Dim check As Boolean
        check = False
        
        Select Case Forms!GetDocType!Frame1
        Case 1
            
            Select Case cnt 'save doc
                Case 1
                
                Call SaveNewDocInRosie("DC Complaint_QT", d![CaseList.FileNumber], 1600, TimeDoc)
                    Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint_QT" & " " & TimeDoc & ".doc", False)
                Case 2
                    Call SaveNewDocInRosie("DC Complaint_QT - 2", d![CaseList.FileNumber], 1600, TimeDoc)
                    Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint_QT - 2" & " " & TimeDoc & ".doc", False)
                Case 3
                    Call SaveNewDocInRosie("DC Complaint_QT - 3", d![CaseList.FileNumber], 1600, TimeDoc)
                    Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint_QT - 3" & " " & TimeDoc & ".doc", False)
                Case 4
                    Call SaveNewDocInRosie("DC Complaint_QT - 4", d![CaseList.FileNumber], 1600, TimeDoc)
                    Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint_QT - 4" & " " & TimeDoc & ".doc", False)
                Case 5
                    Call SaveNewDocInRosie("DC Complaint_QT - 5", d![CaseList.FileNumber], 1600, TimeDoc)
                    Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint_QT - 5" & " " & TimeDoc & ".doc", False)
                Case 6
                    Call SaveNewDocInRosie("DC Complaint_QT - 6", d![CaseList.FileNumber], 1600, TimeDoc)
                    Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint_QT - 6" & " " & TimeDoc & ".doc", False)
                Case 7
                    Call SaveNewDocInRosie("DC Complaint_QT - 7", d![CaseList.FileNumber], 1600, TimeDoc)
                    Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint_QT - 7" & " " & TimeDoc & ".doc", False)
                Case 8
                    Call SaveNewDocInRosie("DC Complaint_QT - 8", d![CaseList.FileNumber], 1600, TimeDoc)
                    Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint_QT - 8" & " " & TimeDoc & ".doc", False)
                Case 9
                    Call SaveNewDocInRosie("DC Complaint_QT - 9", d![CaseList.FileNumber], 1600, TimeDoc)
                    Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint_QT - 9" & " " & TimeDoc & ".doc", False)
                Case 10
                    Call SaveNewDocInRosie("DC Complaint_QT - 10", d![CaseList.FileNumber], 1600, TimeDoc)
                    Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Complaint_QT - 10" & " " & TimeDoc & ".doc", False)
                Case Else
                    MsgBox ("More than 10 defendants, please call IT programmer for help")
                Exit Sub
                
                End Select
            check = True
        Case 2
            'Case 1
'         Call OpenDocAsSaved("DC Complaint - 1")
'        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint - 1.doc", False)
            Select Case cnt ' read only
                Case 1
                    Call OpenDocAsSaved("DC Complaint_QT")
                     Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT.doc", ReadOnly:=True)
                Case 2
                    Call OpenDocAsSaved("DC Complaint_QT - 2")
                    Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 2.doc", ReadOnly:=True)
                Case 3
                    Call OpenDocAsSaved("DC Complaint_QT - 3")
                    Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 3.doc", ReadOnly:=True)
                Case 4
                    Call OpenDocAsSaved("DC Complaint_QT - 4")
                    Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 4.doc", ReadOnly:=True)
                Case 5
                    Call OpenDocAsSaved("DC Complaint_QT - 5")
                    Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 5.doc", ReadOnly:=True)
                Case 6
                    Call OpenDocAsSaved("DC Complaint_QT - 6")
                    Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 6.doc", ReadOnly:=True)
                Case 7
                    Call OpenDocAsSaved("DC Complaint_QT - 7")
                    Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 7.doc", ReadOnly:=True)
                Case 8
                    Call OpenDocAsSaved("DC Complaint_QT - 8")
                    Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 8.doc", ReadOnly:=True)
                Case 9
                    Call OpenDocAsSaved("DC Complaint_QT - 9")
                    Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 9.doc", ReadOnly:=True)
                Case 10
                    Call OpenDocAsSaved("DC Complaint_QT - 10")
                    Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 10.doc", ReadOnly:=True)
                Case Else
                MsgBox ("More than 10 defendants, please call IT programmer for help")
                Exit Sub
                
                End Select
            check = False
        End Select
Else
        Call OpenDocAsSaved("DC Complaint_QT - 0")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Complaint_QT - 0.doc", False)
End If


'WordObj.Visible = True
'WordObj.Visible = False
If Forms!GetDocType!Frame1 = 2 Then
    WordObj.Visible = True
End If

WordDoc.Bookmarks("FileNumber").Select      'bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("Address").Select
WordDoc.Bookmarks("Address").Range.Text = rs!Address
WordDoc.Bookmarks("Unit").Select
WordDoc.Bookmarks("Unit").Range.Text = rs!Unit
WordDoc.Bookmarks("Cityline").Select
WordDoc.Bookmarks("Cityline").Range.Text = rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)

WordDoc.Bookmarks("PropAddress").Select
WordDoc.Bookmarks("PropAddress").Range.Text = d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", "," & vbNewLine & "         " & d![Fair Debt]) '& ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)

WordDoc.Bookmarks("PropCityline").Select
WordDoc.Bookmarks("PropCityline").Range.Text = d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]

If Not N.EOF Then
    N.MoveLast
   If N.RecordCount > 1 Then
     FillField WordDoc, "v", "are"
     FillField WordDoc, "u", "s"
   ElseIf N.RecordCount = 1 Then
     FillField WordDoc, "v", "is"
     FillField WordDoc, "u", ""
   End If
End If

  FillField WordDoc, "BENEFICIARY NAME", UCase(Nz(d!Investor))
  FillField WordDoc, "RECORD OWNERS NAME", OwnerNames(0, 2)
 ' FillField WordDoc, "BORROWERS NAME", BorrowerDefendants(d![CaseList.FileNumber]) '& d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
  FillField WordDoc, "PROPERTY ADDRESS", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
  FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
  FillField WordDoc, "Address", rs!Address
  FillField WordDoc, "Unit", rs!Unit
  FillField WordDoc, "City", rs!City
  FillField WordDoc, "State", rs!LongState
  FillField WordDoc, "Zip", Nz(rs!Zip)
  FillField WordDoc, "DCattorneys", GetDCattorneys()
  FillField WordDoc, "LEGAL DESCRIPTION", IIf(IsNull(d!LegalDescription), "", d!LegalDescription)
  FillField WordDoc, "DocumentNumber", IIf(IsNull(d!Deedrecorded), "", d!DeedLiber)
  FillField WordDoc, "Borrowers", MortgagorNames(0, 2) ', vbCr)
  FillField WordDoc, "DATE OF EXECUTION OF DOT", IIf(IsNull(d!DOTdate), "", Format$(d!DOTdate, "mmmm d, yyyy"))

  FillField WordDoc, "TEXT OF NUMBER", IIf(IsNull(d!OriginalPBal) Or d!OriginalPBal = 0, "Zero", CurrencyWords(d!OriginalPBal))
  FillField WordDoc, "NUMBERICAL NUMBER", IIf(IsNull(d!OriginalPBal) Or d!OriginalPBal = 0, "$0", Format(d!OriginalPBal, "Currency"))

  FillField WordDoc, "RECORDINGDATE", IIf(IsNull(d!DOTrecorded), "", "" & Format$(d!DOTrecorded, "mmmm d, yyyy") & " at Document Number " & d!Liber & "") & IIf(IsNull(d![Rerecorded]), "", " and re-recorded on " & Format$(d![Rerecorded], "mmmm d, yyyy") & " at Document Number " & d!Liber2 & "") & IIf(IsNull(d![LoanMod]), "", " and was modified as recorded on " & Format$(d![LoanModRecorded], "mmmm d, yyyy") & " at Document Number " & d![LiberLoanMod] & ".")

  FillField WordDoc, "DATE OF DEFAULT", IIf(IsNull(d!LPIDate), "", Format$(d!LPIDate, "mmmm d, yyyy"))
  FillField WordDoc, "DATE OF DEMAND", IIf(IsNull(d!AccelerationIssued), "", Format$(d!AccelerationIssued, "mmmm d, yyyy"))
  FillField WordDoc, "trusteeList", getTrustees(Forms!ForeclosureDetails!lstTrustees, Forms!ForeclosureDetails!lstTrustees)
  FillField WordDoc, "DCattorneyLine", GetDCattorneyLine()
  FillField WordDoc, "DCattorneyEmail", GetDCattorneyEmail()
  FillField WordDoc, "Due", Format$(Forms!GetBarredAtty_DCCompliant!txtDueDate, "mmmm d, yyyy")
  
  FillField WordDoc, "AddressLine", rs!AddressLine
  FillField WordDoc, "Cityline", rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
  FillField WordDoc, "DOT/MortgageDate", IIf(IsNull(d!DOTdate), "", Format$(d!DOTdate, "mmmm d, yyyy"))
'2/5/16 DEFENDANTS
 
cnt = 0

If Not rsdef.EOF Then
    rsdef.MoveFirst
Do While Not rsdef.EOF
    cnt = cnt + 1
    Select Case cnt
        
         Case 1
            FillField WordDoc, "DEFENDANT1", Nz(rsdef("First")) & " " & Nz(rsdef("Last"))
            FillField WordDoc, "Name1", Nz(rsdef("Last"))
            FillField WordDoc, "Blank", "BLANK"
            FillField WordDoc, "BORROWERS NAME1", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress1", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) '& NewLine & NewLine & "and" & NewLine & NewLine
         Case 2
            'FillField WordDoc, "DEFENDANT2", "Upon information and belief, " & Nz(rsdef("First")) & " " & Nz(rsdef("Last")) & " (""" & rsdef!Last & """) is a " & "       " & " that may have an interest in the Property."
            FillField WordDoc, "DEFENDANT2", Nz(rsdef("First")) & " " & Nz(rsdef("Last"))
            FillField WordDoc, "Name2", Nz(rsdef("Last"))
            FillField WordDoc, "Blank", "BLANK"
            
            FillField WordDoc, "BORROWERS NAME2", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress2", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine
        Case 3
            'FillField WordDoc, "DEFENDANT3", "Upon information and belief, " & Nz(rsdef("First")) & " " & Nz(rsdef("Last")) & " (""" & rsdef!Last & """) is a " & "       " & " that may have an interest in the Property."
            FillField WordDoc, "DEFENDANT3", Nz(rsdef("First")) & " " & Nz(rsdef("Last"))
            FillField WordDoc, "Name3", Nz(rsdef("Last"))
            FillField WordDoc, "Blank", "BLANK"

            FillField WordDoc, "BORROWERS NAME3", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress3", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) '& NewLine & NewLine & "and" & NewLine & NewLine

        Case 4
            'FillField WordDoc, "DEFENDANT4", "Upon information and belief, " & Nz(rsdef("First")) & " " & Nz(rsdef("Last")) & " (""" & rsdef!Last & """) is a " & "       " & " that may have an interest in the Property."
            FillField WordDoc, "DEFENDANT4", Nz(rsdef("First")) & " " & Nz(rsdef("Last"))
            FillField WordDoc, "Name4", Nz(rsdef("Last"))
            FillField WordDoc, "Blank", "BLANK"
            
            FillField WordDoc, "BORROWERS NAME4", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress4", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine

        Case 5
            FillField WordDoc, "DEFENDANT5", Nz(rsdef("First")) & " " & Nz(rsdef("Last"))
            FillField WordDoc, "Name5", Nz(rsdef("Last"))
            FillField WordDoc, "Blank", "BLANK"
            
            FillField WordDoc, "BORROWERS NAME5", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress5", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine

        Case 6
            FillField WordDoc, "DEFENDANT6", Nz(rsdef("First")) & " " & Nz(rsdef("Last"))
            FillField WordDoc, "Name6", Nz(rsdef("Last"))
            FillField WordDoc, "Blank", "BLANK"
            
            FillField WordDoc, "BORROWERS NAME6", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress6", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine

        Case 7
            FillField WordDoc, "DEFENDANT7", Nz(rsdef("First")) & " " & Nz(rsdef("Last"))
            FillField WordDoc, "Name7", Nz(rsdef("Last"))
            FillField WordDoc, "Blank", "BLANK"
            
            FillField WordDoc, "BORROWERS NAME7", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress7", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine

        Case 8
            FillField WordDoc, "DEFENDANT8", Nz(rsdef("First")) & " " & Nz(rsdef("Last"))
            FillField WordDoc, "Name8", Nz(rsdef("Last"))
            FillField WordDoc, "Blank", "BLANK"
            
            FillField WordDoc, "BORROWERS NAME8", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress8", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine

        Case 9
            FillField WordDoc, "DEFENDANT9", Nz(rsdef("First")) & " " & Nz(rsdef("Last"))
            FillField WordDoc, "Name9", Nz(rsdef("Last"))
            FillField WordDoc, "Blank", "BLANK"
            
            FillField WordDoc, "BORROWERS NAME9", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress9", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine

        Case 10
            FillField WordDoc, "DEFENDANT10", Nz(rsdef("First")) & " " & Nz(rsdef("Last"))
            FillField WordDoc, "Name10", Nz(rsdef("Last"))
            FillField WordDoc, "Blank", "BLANK"
            
            FillField WordDoc, "BORROWERS NAME10", UCase(Nz(rsdef("First"))) & " " & UCase(Nz(rsdef("Last")))
            FillField WordDoc, "DefAddress10", rsdef!Address & IIf(IsNull(rsdef!Address2), "", NewLine & rsdef!Address2) & NewLine & rsdef!City & ", " & rsdef!State & " " & FormatZip(rsdef!Zip) ' & NewLine & NewLine & "and" & NewLine & NewLine
    End Select
    rsdef.MoveNext
Loop

rsdef.Close
Set rsdef = Nothing
End If

'pay off part
Set rsPayoff = CurrentDb.OpenRecordset("SELECT Desc,  Amount FROM Payoff WHERE FileNumber=" & d![CaseList.FileNumber], dbOpenSnapshot)
If rsPayoff.EOF Then
     FillField WordDoc, "Payoff_Items", ""
Else
    rsPayoff.MoveLast

    For i = 1 To rsPayoff.RecordCount
      itemsFields = itemsFields & "<<Item" & i & ">>" & vbCr
    Next i
    itemsFields = Left$(itemsFields, Len(itemsFields) - 1) ' remove trailing CR
    FillField WordDoc, "Payoff_Items", itemsFields & " "
    'FillField WordDoc, "Items_Amount", itemsFields & " "

    rsPayoff.MoveFirst
    i = 1
    Do While Not rsPayoff.EOF
        
        'FillField WordDoc, "Item" & i, rsPayoff!Desc & vbTab & "$___________"
        FillField WordDoc, "Item" & i, i & ".  " & rsPayoff!Desc & vbTab & Format$(Nz(rsPayoff!Amount, 0), "Currency")
        'FillField WordDoc, "Item" & i, rsPayoff!Desc & vbTab
        FillField WordDoc, "Item" & i, Format$(Nz(rsPayoff!Amount, 0), "Currency")

        ''Items_Amount
        'FillField WordDoc, "Item" & i, IIf(dd!Desc = "Interest", "Interest at " & Format$(Forms![Print Statement of Debt]!InterestRate, "#0.000%") & " for " & [InterestFrom] & " to " & [InterestTo] & vbTab & Format$(Nz(dd!Amount, 0), "Currency"), dd!Desc & vbTab & Format$(Nz(dd!Amount, 0), "Currency"))
        TotalItems = TotalItems + Nz(rsPayoff!Amount, 0)
        rsPayoff.MoveNext
        i = i + 1
    Loop
End If

FillField WordDoc, "Total", Format$(Nz(TotalItems, 0), "Currency")
rsPayoff.Close
WordObj.Selection.HomeKey wdStory, wdMove

Fnum = d![CaseList.FileNumber]

d.Close
rs.Close

Set d = Nothing
Set rs = Nothing

'uploade word doc to Rosie 5/20/16

'If check = True Then
'
''Dim Fname, ct As String
''    ct = Format$(Now(), "yyyymmdd hhnnss")
''    Fname = "DC Complaint to Quiet Title" & "_" & ct & ".doc"
''   ' Call UploadWordDoc(Fnum, "" & Fname & "")
''  '  Call SaveDocNew(WordDoc, Fnum, "" & Fname & "")
''    'Forms![case list].Requery
'End If
    
'If Not KeepOpen Then WordObj.Quit Savechanges:=wdDoNotSaveChanges

'WordObj.Quit Savechanges:=wdSaveChanges
'Set WordObj = Nothing
'
''add journal and message here
'DoCmd.Close acForm, "GetDocType"


If Forms!GetDocType!Frame1 = 1 Then
    WordObj.Quit Savechanges:=wdSaveChanges

DoCmd.SetWarnings False

strInfo = "Draft complaint QT has completed merging and auto saved"
strInfo = Replace(strInfo, "'", "''")
strSQLJournal = "Insert into Journal (FileNumber,JournalDate,Who,Info,Color) Values(" & [Forms]![case list]![FileNumber] & ",Now,GetFullName(),'" & strInfo & "',1 )"

DoCmd.RunSQL strSQLJournal
Forms!Journal.Requery

DoCmd.SetWarnings True

MsgBox ("Draft complaint QT has completed merging and auto saved")

ElseIf Forms!GetDocType!Frame1 = 2 Then

MsgBox ("Draft complaint QT has completed merging and ready for view")
End If

Set WordObj = Nothing

'Call CheckSaveInRosie("DC Complaint" & " - " & rsNo, Fnum)

DoCmd.Close acForm, "GetDocType"


End Sub



Public Sub Doc_DCMotion(KeepOpen As Boolean, Optional NewLine As String = vbNewLine)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rs, N, rsSelected, rsStaff As Recordset   ' data
Dim itemsFields As String
Dim TotalItems As Currency
Dim i, j, t, cnt As Integer
Dim Fnum As Long
Dim TimeDoc As String

TimeDoc = Format$(Now(), "yyyymmdd hhnnss")

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation].Column(0)) Then
    i = 2
Else
    i = Forms!foreclosurePrint![cboOfficeLocation].Column(0)
End If


Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCMotion WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("SELECT * FROM Rosenberg WHERE ID = " & i, dbOpenSnapshot)
'Set n = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE owner = true and FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set N = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE Defendant = True and FileNumber = " & [Forms]![case list]![FileNumber], dbOpenSnapshot)
'Set rsdef = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE Defendant = True and FileNumber = " & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rsSelected = CurrentDb.OpenRecordset("select * from DC_CompSelectedAtty where filenumber = " & Forms![case list]!FileNumber, dbOpenDynaset, dbSeeChanges)
Set rsStaff = CurrentDb.OpenRecordset("select * from Staff", dbOpenDynaset, dbSeeChanges)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If N.EOF Then
    MsgBox ("Please check a defendant in the Name tap")
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
          
Dim check As Boolean
check = False

Select Case Forms!GetDocType!Frame1
Case 1

    Call SaveNewDocInRosie("DC Motion", d![CaseList.FileNumber], 1600, TimeDoc)
    Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Motion" & " " & TimeDoc & ".doc", False)
    check = True
Case 2
     Call OpenDocAsSaved("DC Motion")
    Set WordDoc = WordObj.Documents.Open(filename:=EMailPath & "DC Motion.doc", ReadOnly:=True)
    check = False
 End Select

WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("Address").Select
WordDoc.Bookmarks("Address").Range.Text = rs!Address
WordDoc.Bookmarks("Unit").Select
WordDoc.Bookmarks("Unit").Range.Text = rs!Unit
WordDoc.Bookmarks("Cityline").Select
WordDoc.Bookmarks("Cityline").Range.Text = rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
WordDoc.Bookmarks("PropAddress").Select
WordDoc.Bookmarks("PropAddress").Range.Text = d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", "," & vbNewLine & "         " & d![Fair Debt]) '& ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("PropCityline").Select
WordDoc.Bookmarks("PropCityline").Range.Text = d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]

If Not N.EOF Then
    N.MoveLast
   If N.RecordCount > 1 Then
     FillField WordDoc, "et", ", et al."
    
   Else
    FillField WordDoc, "et", ""
   End If
End If

If Not N.EOF Then
    Dim PrimaryDefNameCaption As String
    Dim flag As Boolean
    flag = False
    N.MoveFirst
    Do Until N.EOF
    
        If N![First] & " " & N![Last] = d![PrimaryDefName] And N!Owner = True And N!Mortgagor = True And N!Deceased = True Then
            PrimaryDefNameCaption = "Estate of " & d![PrimaryDefName] & ""
            flag = True
        Else
            'PrimaryDefNameCaption = d![PrimaryDefName]
        End If
    N.MoveNext
    Loop
End If

  FillField WordDoc, "Investor", UCase(Nz(d!Investor))
  FillField WordDoc, "Judge", Nz(d!Judge)
  FillField WordDoc, "NextEvent", IIf(IsNull(Forms!foreclosurePrint!sfrmDCEvent!Event), "", Forms!foreclosurePrint!sfrmDCEvent!Event.Column(1))
  FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
  FillField WordDoc, "EventDate", IIf(IsNull(Forms!foreclosurePrint!txtNextEventDate), "", Format$(Forms!foreclosurePrint!txtNextEventDate, "mmmm d, yyyy"))
  FillField WordDoc, "PrimDefendant", IIf(flag = True, UCase(PrimaryDefNameCaption), UCase(d!PrimaryDefName))
  FillField WordDoc, "ComplaintFiledDate", IIf(IsNull(d!ComplaintFiled), "", Format$(d!ComplaintFiled, "mmmm d, yyyy"))
  FillField WordDoc, "ServDdl", IIf(IsNull(d!ServiceDeadline), "", Format$(d!ServiceDeadline, "mmmm d, yyyy"))
  FillField WordDoc, "DefendantNoServed", NoServiedDefendant(d![CaseList.FileNumber], 2)
  FillField WordDoc, "SignAtty", IIf(IsNull(Forms!foreclosurePrint!Attorney.Column(1)), "", Forms!foreclosurePrint!Attorney.Column(1))
  
  DoCmd.SetWarnings False
  DoCmd.RunSQL ("update Staff set selected = 0")
  DoCmd.RunSQL ("UPDATE Staff INNER JOIN DC_CompSelectedAtty ON Staff.ID = DC_CompSelectedAtty.AttyID SET Staff.DCSelected = true WHERE DC_CompSelectedAtty.FileNumber =[Forms]![ForeclosurePrint]![FileNumber]")
  DoCmd.SetWarnings True

  FillField WordDoc, "DCattorneyLine", GetDCattorneyLine()
  FillField WordDoc, "DCattorneyEmail", GetDCattorneyEmail()
  FillField WordDoc, "AddressLine", rs!AddressLine
  FillField WordDoc, "Cityline", rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
  FillField WordDoc, "CurrentDate", Format$(Date, "mmmm d, yyyy")
  FillField WordDoc, "Defendant", DefendantNames(d![CaseList.FileNumber], 2)
  FillField WordDoc, "COS", COSNamesAddress(d![CaseList.FileNumber])
  FillField WordDoc, "DCattorneyLine1", GetDCattorneyLineEsq()
  FillField WordDoc, "COSDate", Format$(Date, "mmmm d, yyyy")

Fnum = d![CaseList.FileNumber]

d.Close
rs.Close
N.Close
Set d = Nothing
Set rs = Nothing
Set N = Nothing

'If check = True Then
'
'Dim Fname, ct As String
'    ct = Format$(Now(), "yyyymmdd hhnnss")
'    Fname = "DC Motion" & "_" & ct & ".doc"
'    Call UploadWordDoc(Fnum, "" & Fname & "")
'    Call SaveDocNew(WordDoc, Fnum, "" & Fname & "")
'    'Forms![case list].Requery
'End If
'
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
DoCmd.Close acForm, "GetDocType"

End Sub

Public Sub Doc_DCMotionDefaultJudgment(KeepOpen As Boolean, Optional NewLine As String = vbNewLine)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rs, N, rsSelected, rsStaff As Recordset   ' data
Dim itemsFields As String
Dim TotalItems As Currency
Dim i, j, t, cnt As Integer
Dim Fnum As Long
Dim TimeDoc As String

TimeDoc = Format$(Now(), "yyyymmdd hhnnss")

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation].Column(0)) Then
    i = 2
Else
    i = Forms!foreclosurePrint![cboOfficeLocation].Column(0)
End If
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCMotion WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("SELECT * FROM Rosenberg WHERE ID = " & i, dbOpenSnapshot)
Set N = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE Defendant = True and FileNumber = " & [Forms]![case list]![FileNumber], dbOpenSnapshot)
'Set rsSelected = CurrentDb.OpenRecordset("select * from DC_CompSelectedAtty where filenumber = " & Forms![case list]!FileNumber, dbOpenDynaset, dbSeeChanges)
Set rsStaff = CurrentDb.OpenRecordset("select * from Staff", dbOpenDynaset, dbSeeChanges)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If N.EOF Then
    MsgBox ("Please check a defendant in the Name tap")
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
    
Dim check As Boolean
check = False

Select Case Forms!GetDocType!Frame1
Case 1 'for save
    Call SaveNewDocInRosie("DC Motion for Default Judgment and Order", d![CaseList.FileNumber], 1600, TimeDoc)
    Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Motion for Default Judgment and Order" & " " & TimeDoc & ".doc", False)
    check = True
Case 2
    Call OpenDocAsSaved("DC Motion for Default Judgment and Order")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Motion for Default Judgment and Order.doc", False)
    check = False
 End Select
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("Address").Select
WordDoc.Bookmarks("Address").Range.Text = rs!Address
WordDoc.Bookmarks("Unit").Select
WordDoc.Bookmarks("Unit").Range.Text = rs!Unit
WordDoc.Bookmarks("Cityline").Select
WordDoc.Bookmarks("Cityline").Range.Text = rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
WordDoc.Bookmarks("PropAddress").Select
WordDoc.Bookmarks("PropAddress").Range.Text = d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", "," & vbNewLine & "         " & d![Fair Debt]) '& ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("PropCityline").Select
WordDoc.Bookmarks("PropCityline").Range.Text = d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]

If Not N.EOF Then
    N.MoveLast
   If N.RecordCount > 1 Then
     FillField WordDoc, "et", ", et al."
    
   Else
    FillField WordDoc, "et", ""
   End If
End If

If Not N.EOF Then
    Dim PrimaryDefNameCaption As String
    Dim flag As Boolean
    flag = False
    N.MoveFirst
    Do Until N.EOF
    
        If N![First] & " " & N![Last] = d![PrimaryDefName] And N!Owner = True And N!Mortgagor = True And N!Deceased = True Then
            PrimaryDefNameCaption = "Estate of " & d![PrimaryDefName] & ""
            flag = True
        Else
            'PrimaryDefNameCaption = d![PrimaryDefName]
        End If
    N.MoveNext
    Loop
End If

  FillField WordDoc, "PrimDefendant", IIf(flag = True, UCase(PrimaryDefNameCaption), UCase(d!PrimaryDefName))
  FillField WordDoc, "Judge", Nz(d!Judge)
  FillField WordDoc, "NextEvent", IIf(IsNull(Forms!foreclosurePrint!sfrmDCEvent!Event), "", Forms!foreclosurePrint!sfrmDCEvent!Event.Column(1))
  FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
  FillField WordDoc, "EventDate", IIf(IsNull(Forms!foreclosurePrint!txtNextEventDate), "", Format$(Forms!foreclosurePrint!txtNextEventDate, "mmmm d, yyyy"))
  FillField WordDoc, "Investor", UCase(Nz(d!Investor))
  FillField WordDoc, "Investor1", Nz(d!Investor)
  FillField WordDoc, "ComplaintFiledDate", IIf(IsNull(d!ComplaintFiled), "", Format$(d!ComplaintFiled, "mmmm d, yyyy"))
  FillField WordDoc, "Defendant", DefendantNames(d![CaseList.FileNumber], 2)
  'FillField WordDoc, "PROPERTY ADDRESS", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
  FillField WordDoc, "AllBorrowerServe", IIf(IsNull(d!AllBorrowerServed), "", Format$(d!AllBorrowerServed, "mmmm d, yyyy"))
  FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
  FillField WordDoc, "SignAtty", IIf(IsNull(Forms!foreclosurePrint!Attorney.Column(1)), "", Forms!foreclosurePrint!Attorney.Column(1))
  FillField WordDoc, "AddressLine", rs!AddressLine
  FillField WordDoc, "Cityline", rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
  FillField WordDoc, "CurrentDate", Format$(Date, "mmmm d, yyyy")
  FillField WordDoc, "COSDefendants", COSNamesAddress(d![CaseList.FileNumber])
  
  FillField WordDoc, "Date", Format$(Date, "mmmm d, yyyy")
  
  Fnum = d![CaseList.FileNumber]
  
d.Close
rs.Close
N.Close
Set d = Nothing
Set rs = Nothing
Set N = Nothing

'uploade word doc to Rosie 5/20/16

'If check = True Then
'
'Dim Fname, ct As String
'    ct = Format$(Now(), "yyyymmdd hhnnss")
'    Fname = "DC Motion for Default Judgment & Order" & "_" & ct & ".doc"
'    Call UploadWordDoc(Fnum, "" & Fname & "")
'    Call SaveDocNew(WordDoc, Fnum, "" & Fname & "")
'    'Forms![case list].Requery
'End If
    
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
DoCmd.Close acForm, "GetDocType"

End Sub

Public Sub Doc_DCReportofSale(KeepOpen As Boolean, Optional NewLine As String = vbNewLine)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rs, N, rsSelected, rsStaff As Recordset   ' data
Dim itemsFields As String
Dim TotalItems As Currency
Dim i, j, t, cnt As Integer
Dim Fnum As Long
Dim TimeDoc As String

TimeDoc = Format$(Now(), "yyyymmdd hhnnss")

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation].Column(0)) Then
    i = 2
Else
    i = Forms!foreclosurePrint![cboOfficeLocation].Column(0)
End If

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCReportOFSale WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("SELECT * FROM Rosenberg WHERE ID = " & i, dbOpenSnapshot)
Set N = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE Defendant = True and FileNumber = " & [Forms]![case list]![FileNumber], dbOpenSnapshot)
'Set rsSelected = CurrentDb.OpenRecordset("select * from DC_CompSelectedAtty where filenumber = " & Forms![case list]!FileNumber, dbOpenDynaset, dbSeeChanges)
Set rsStaff = CurrentDb.OpenRecordset("select * from Staff", dbOpenDynaset, dbSeeChanges)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If N.EOF Then
    MsgBox ("Please check a defendant in the Name tap")
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
      
Dim check As Boolean
check = False

Select Case Forms!GetDocType!Frame1
Case 1 ' save

    If DLookup("disposition", "qryDCReportOFSale", "caselist.Filenumber = " & [Forms]![case list]![FileNumber]) = 1 Then '7/25/2017 Sarab here the error is returne null not 1 or 2 so it is file issue or data missing issue in dispostion
      
        Call SaveNewDocInRosie("DC Report of sale_Buyin", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Report of sale_Buyin" & " " & TimeDoc & ".doc", False)
    
    ElseIf DLookup("disposition", "qryDCReportOFSale", "caselist.Filenumber = " & [Forms]![case list]![FileNumber]) = 2 Then
   
        Call SaveNewDocInRosie("DC Report of sale_ThirdParty", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Report of sale_ThirdParty" & " " & TimeDoc & ".doc", False)

     End If
    
    check = True
Case 2 'read only

    If DLookup("disposition", "qryDCReportOFSale", "caselist.Filenumber = " & [Forms]![case list]![FileNumber]) = 1 Then
    
        Call OpenDocAsSaved("DC Report of sale_Buyin")
'        Set WordDoc = WordObj.Documents.Open("DC Report of sale_Buyin.doc", False)
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Report of sale_Buyin.doc", False)
    ElseIf DLookup("disposition", "qryDCReportOFSale", "caselist.Filenumber = " & [Forms]![case list]![FileNumber]) = 2 Then
    
         Call OpenDocAsSaved("DC Report of sale_ThirdParty")
'        Set WordDoc = WordObj.Documents.Open("DC Report of sale_ThirdParty.doc", False)
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Report of sale_ThirdParty.doc", False)
    End If

    check = False
End Select
    
If d!Disposition = 1 Or d!Disposition = 2 Then      'Mei only for buy-in and 3rd party dispotions to avoid error   1/4/17
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("Address").Select
WordDoc.Bookmarks("Address").Range.Text = rs!Address
WordDoc.Bookmarks("Unit").Select
WordDoc.Bookmarks("Unit").Range.Text = rs!Unit
WordDoc.Bookmarks("Cityline").Select
WordDoc.Bookmarks("Cityline").Range.Text = rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
WordDoc.Bookmarks("PropAddress").Select
WordDoc.Bookmarks("PropAddress").Range.Text = d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", "," & vbNewLine & "         " & d![Fair Debt]) '& ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("PropCityline").Select
WordDoc.Bookmarks("PropCityline").Range.Text = d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]

If Not N.EOF Then
    N.MoveLast
   If N.RecordCount > 1 Then
     FillField WordDoc, "et", ", et al."
   Else
     FillField WordDoc, "et", ""
   End If
End If

If Not N.EOF Then
    Dim PrimaryDefNameCaption As String
    Dim flag As Boolean
    flag = False
    N.MoveFirst
    Do Until N.EOF
    
        If N![First] & " " & N![Last] = d![PrimaryDefName] And N!Owner = True And N!Mortgagor = True And N!Deceased = True Then
            PrimaryDefNameCaption = "Estate of " & d![PrimaryDefName] & ""
            flag = True
        Else
            'PrimaryDefNameCaption = d![PrimaryDefName]
        End If
    N.MoveNext
    Loop
End If

  FillField WordDoc, "PrimDefendant", IIf(flag = True, UCase(PrimaryDefNameCaption), UCase(d!PrimaryDefName))
  FillField WordDoc, "Judge", Nz(d!Judge)
  FillField WordDoc, "NextEvent", IIf(IsNull(Forms!foreclosurePrint!sfrmDCEvent!Event), "", Forms!foreclosurePrint!sfrmDCEvent!Event.Column(1))
  FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
  FillField WordDoc, "EventDate", IIf(IsNull(Forms!foreclosurePrint!txtNextEventDate), "", Format$(Forms!foreclosurePrint!txtNextEventDate, "mmmm d, yyyy"))
  FillField WordDoc, "Investor", UCase(Nz(d!Investor))
  FillField WordDoc, "Purchaser", Nz(d!Purchaser)
  FillField WordDoc, "Defendant", DefendantNames(d![CaseList.FileNumber], 2)
  FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
  FillField WordDoc, "SaleLocation", d!SaleLocation
  FillField WordDoc, "SignAtty", IIf(IsNull(Forms!foreclosurePrint!Attorney.Column(1)), "", Forms!foreclosurePrint!Attorney.Column(1))
  FillField WordDoc, "AddressLine", rs!AddressLine
  FillField WordDoc, "Cityline", rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
  FillField WordDoc, "CurrentDate", Format$(Date, "mmmm d, yyyy")
  FillField WordDoc, "COSDefendants", COSNamesAddress(d![CaseList.FileNumber])
  FillField WordDoc, "SaleDate", Format$(d!Sale, "mmmm d, yyyy")
  'FillField WordDoc, "SaleTime", Format(d!SaleTime, "Medium Time")
  FillField WordDoc, "SaleTime", Format(d!SaleTime, "h:mm ampm")
  FillField WordDoc, "JudgmentEnteredDate", Format$(d!JudgmentEntered, "mmmm d, yyyy")
  FillField WordDoc, "Deposit", Format$(d!Deposit, "Currency")
  FillField WordDoc, "SalePric", Format$(d!SalePrice, "Currency")
  FillField WordDoc, "IRSLienNotes", IIf(d!IRSLiens = True, "Sold subject to a 120 day right-of-redemption by the Internal Revenue Service.", "")

  Fnum = d![CaseList.FileNumber]
Else
    Exit Sub
End If

d.Close
rs.Close
N.Close
Set d = Nothing
Set rs = Nothing
Set N = Nothing

'uploade word doc to Rosie 5/20/16

'If check = True Then
'
'Dim Fname, ct As String
'    ct = Format$(Now(), "yyyymmdd hhnnss")
'    Fname = "DC Report of Sale" & "_" & ct & ".doc"
'    Call UploadWordDoc(Fnum, "" & Fname & "")
'    Call SaveDocNew(WordDoc, Fnum, "" & Fname & "")
'    'Forms![case list].Requery
'End If
'
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
DoCmd.Close acForm, "GetDocType"

End Sub

Public Sub Doc_TrusteesAffidavitforROS(KeepOpen As Boolean, Optional NewLine As String = vbNewLine)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rs, N, rsSelected, rsStaff As Recordset   ' data
Dim itemsFields As String
Dim TotalItems As Currency
Dim i, j, t, cnt As Integer
Dim Fnum As Long
Dim TimeDoc As String

TimeDoc = Format$(Now(), "yyyymmdd hhnnss")

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation].Column(0)) Then
    i = 2
Else
    i = Forms!foreclosurePrint![cboOfficeLocation].Column(0)
End If

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCReportOFSale WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("SELECT * FROM Rosenberg WHERE ID = " & i, dbOpenSnapshot)
Set N = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE Defendant = True and FileNumber = " & [Forms]![case list]![FileNumber], dbOpenSnapshot)
'Set rsSelected = CurrentDb.OpenRecordset("select * from DC_CompSelectedAtty where filenumber = " & Forms![case list]!FileNumber, dbOpenDynaset, dbSeeChanges)
Set rsStaff = CurrentDb.OpenRecordset("select * from Staff", dbOpenDynaset, dbSeeChanges)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If N.EOF Then
    MsgBox ("Please check a defendant in the Name tap")
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
    
Dim check As Boolean
check = False

Select Case Forms!GetDocType!Frame1
Case 1
    If DLookup("disposition", "qryDCReportOFSale", "caselist.Filenumber = " & [Forms]![case list]![FileNumber]) = 1 Then
    
        Call SaveNewDocInRosie("DC Trustees Affidavit for ROS_Buyin", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Trustees Affidavit for ROS_Buyin" & " " & TimeDoc & ".doc", False)

    ElseIf DLookup("disposition", "qryDCReportOFSale", "caselist.Filenumber = " & [Forms]![case list]![FileNumber]) = 2 Then
    
        Call SaveNewDocInRosie("DC Trustees Affidavit for ROS_ThirdParty", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Trustees Affidavit for ROS_ThirdParty" & " " & TimeDoc & ".doc", False)
    
    End If
    check = True

Case 2
    If DLookup("disposition", "qryDCReportOFSale", "caselist.Filenumber = " & [Forms]![case list]![FileNumber]) = 1 Then
         Call OpenDocAsSaved("DC Trustees Affidavit for ROS_Buyin")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Trustees Affidavit for ROS_Buyin.doc", False)
    
    ElseIf DLookup("disposition", "qryDCReportOFSale", "caselist.Filenumber = " & [Forms]![case list]![FileNumber]) = 2 Then
        Call OpenDocAsSaved("DC Trustees Affidavit for ROS_ThirdParty")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Trustees Affidavit for ROS_ThirdParty.doc", False)
    End If
    check = False

End Select

If d!Disposition = 1 Or d!Disposition = 2 Then
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("Address").Select
WordDoc.Bookmarks("Address").Range.Text = rs!Address
WordDoc.Bookmarks("Unit").Select
WordDoc.Bookmarks("Unit").Range.Text = rs!Unit
WordDoc.Bookmarks("Cityline").Select
WordDoc.Bookmarks("Cityline").Range.Text = rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
WordDoc.Bookmarks("PropAddress").Select
WordDoc.Bookmarks("PropAddress").Range.Text = d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", "," & vbNewLine & d![Fair Debt]) '& ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("PropCityline").Select
WordDoc.Bookmarks("PropCityline").Range.Text = d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]

If Not N.EOF Then
    N.MoveLast
   If N.RecordCount > 1 Then
     FillField WordDoc, "et", ", et al."
    
   Else
    FillField WordDoc, "et", ""
   End If
End If

If Not N.EOF Then
    Dim PrimaryDefNameCaption As String
    Dim flag As Boolean
    flag = False
    N.MoveFirst
    Do Until N.EOF
    
        If N![First] & " " & N![Last] = d![PrimaryDefName] And N!Owner = True And N!Mortgagor = True And N!Deceased = True Then
            PrimaryDefNameCaption = "Estate of " & d![PrimaryDefName] & ""
            flag = True
        Else
            'PrimaryDefNameCaption = d![PrimaryDefName]
        End If
    N.MoveNext
    Loop
End If

  FillField WordDoc, "PrimDefendant", IIf(flag = True, UCase(PrimaryDefNameCaption), UCase(d!PrimaryDefName))
  FillField WordDoc, "Judge", Nz(d!Judge)
  FillField WordDoc, "NextEvent", IIf(IsNull(Forms!foreclosurePrint!sfrmDCEvent!Event), "", Forms!foreclosurePrint!sfrmDCEvent!Event.Column(1))
  FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
  FillField WordDoc, "EventDate", IIf(IsNull(Forms!foreclosurePrint!txtNextEventDate), "", Format$(Forms!foreclosurePrint!txtNextEventDate, "mmmm d, yyyy"))
  FillField WordDoc, "Investor", UCase(Nz(d!Investor))
  FillField WordDoc, "Purchaser", Nz(d!Purchaser)
  FillField WordDoc, "Defendant", DefendantNames(d![CaseList.FileNumber], 2)
  FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
  FillField WordDoc, "SignAtty", IIf(IsNull(Forms!foreclosurePrint!Attorney.Column(1)), "", Forms!foreclosurePrint!Attorney.Column(1))
  FillField WordDoc, "SaleLocation", d!SaleLocation
  FillField WordDoc, "AddressLine", rs!AddressLine
  FillField WordDoc, "Cityline", rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
  FillField WordDoc, "CurrentDate", Format$(Date, "mmmm d, yyyy")
  FillField WordDoc, "SaleDate", Format$(d!Sale, "mmmm d, yyyy")
  FillField WordDoc, "SaleTime", Format(d!SaleTime, "h:mm ampm")
  FillField WordDoc, "JudgmentEnteredDate", Format$(d!JudgmentEntered, "mmmm d, yyyy")
  FillField WordDoc, "SalePric", Format$(d!SalePrice, "Currency")
  FillField WordDoc, "Noticesent", Format$(d!Notices, "mmmm d, yyyy")
  FillField WordDoc, "FirstPub", Format$(d!FirstPub, "mmmm d, yyyy")

 Fnum = d![CaseList.FileNumber]
Else
    Exit Sub
End If

d.Close
rs.Close
N.Close
Set d = Nothing
Set rs = Nothing
Set N = Nothing
WordObj.Selection.HomeKey wdStory, wdMove

'uploade word doc to Rosie 5/20/16

'If check = True Then
'
'Dim Fname, ct As String
'    ct = Format$(Now(), "yyyymmdd hhnnss")
'    Fname = "DC Trustees Affidavit for ROS" & "_" & ct & ".doc"
'    Call UploadWordDoc(Fnum, "" & Fname & "")
'    Call SaveDocNew(WordDoc, Fnum, "" & Fname & "")
'    'Forms![case list].Requery
'End If
'
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
DoCmd.Close acForm, "GetDocType"

End Sub

Public Sub Doc_MotiontoRatifySale(KeepOpen As Boolean, Optional NewLine As String = vbNewLine)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rs, N, rsSelected, rsStaff As Recordset   ' data
Dim itemsFields As String
Dim TotalItems As Currency
Dim i, j, t, cnt As Integer
Dim Fnum As Long
Dim TimeDoc As String

TimeDoc = Format$(Now(), "yyyymmdd hhnnss")

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation].Column(0)) Then
    i = 2
Else
    i = Forms!foreclosurePrint![cboOfficeLocation].Column(0)
End If
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCReportOFSale WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("SELECT * FROM Rosenberg WHERE ID = " & i, dbOpenSnapshot)
Set N = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE Defendant = True and FileNumber = " & [Forms]![case list]![FileNumber], dbOpenSnapshot)
'Set rsSelected = CurrentDb.OpenRecordset("select * from DC_CompSelectedAtty where filenumber = " & Forms![case list]!FileNumber, dbOpenDynaset, dbSeeChanges)
Set rsStaff = CurrentDb.OpenRecordset("select * from Staff", dbOpenDynaset, dbSeeChanges)

If d!Disposition = 1 Or d!Disposition = 2 Then
If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If N.EOF Then
    MsgBox ("Please check a defendant in the Name tap")
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")

Dim check As Boolean
check = False

Select Case Forms!GetDocType!Frame1

Case 1

    If DLookup("disposition", "qryDCReportOFSale", "caselist.Filenumber = " & [Forms]![case list]![FileNumber]) = 1 Then
    
        Call SaveNewDocInRosie("DC Motion to Ratify Sale_Buyin", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Motion to Ratify Sale_Buyin" & " " & TimeDoc & ".doc", False)

    ElseIf DLookup("disposition", "qryDCReportOFSale", "caselist.Filenumber = " & [Forms]![case list]![FileNumber]) = 2 Then
        
        
        Call SaveNewDocInRosie("DC Motion to Ratify Sale_ThirdParty", d![CaseList.FileNumber], 1600, TimeDoc)
        Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Motion to Ratify Sale_ThirdParty" & " " & TimeDoc & ".doc", False)

            
    End If

    check = True
Case 2

    If DLookup("disposition", "qryDCReportOFSale", "caselist.Filenumber = " & [Forms]![case list]![FileNumber]) = 1 Then
        Call OpenDocAsSaved("DC Motion to Ratify Sale_Buyin")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Motion to Ratify Sale_Buyin.doc", False)
    ElseIf DLookup("disposition", "qryDCReportOFSale", "caselist.Filenumber = " & [Forms]![case list]![FileNumber]) = 2 Then
        Call OpenDocAsSaved("DC Motion to Ratify Sale_ThirdParty")
        Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Motion to Ratify Sale_ThirdParty.doc", ReadOnly:=True)
    End If
    
    check = False
End Select
    
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("Address").Select
WordDoc.Bookmarks("Address").Range.Text = rs!Address
WordDoc.Bookmarks("Unit").Select
WordDoc.Bookmarks("Unit").Range.Text = rs!Unit
WordDoc.Bookmarks("Cityline").Select
WordDoc.Bookmarks("Cityline").Range.Text = rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
WordDoc.Bookmarks("PropAddress").Select
WordDoc.Bookmarks("PropAddress").Range.Text = d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", "," & vbNewLine & d![Fair Debt]) '& ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("PropCityline").Select
WordDoc.Bookmarks("PropCityline").Range.Text = d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]

If Not N.EOF Then
   N.MoveLast
   If N.RecordCount > 1 Then
        FillField WordDoc, "et", ", et al."
   Else
        FillField WordDoc, "et", ""
   End If
End If

If Not N.EOF Then
    Dim PrimaryDefNameCaption As String
    Dim flag As Boolean
    flag = False
    N.MoveFirst
    Do Until N.EOF
    
        If N![First] & " " & N![Last] = d![PrimaryDefName] And N!Owner = True And N!Mortgagor = True And N!Deceased = True Then
            PrimaryDefNameCaption = "Estate of " & d![PrimaryDefName] & ""
            flag = True
        Else
            'PrimaryDefNameCaption = d![PrimaryDefName]
        End If
    N.MoveNext
    Loop
End If

  FillField WordDoc, "PrimDefendant", IIf(flag = True, UCase(PrimaryDefNameCaption), UCase(d!PrimaryDefName))
  FillField WordDoc, "Judge", Nz(d!Judge)
  FillField WordDoc, "NextEvent", IIf(IsNull(Forms!foreclosurePrint!sfrmDCEvent!Event), "", Forms!foreclosurePrint!sfrmDCEvent!Event.Column(1))
  FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
  FillField WordDoc, "EventDate", IIf(IsNull(Forms!foreclosurePrint!txtNextEventDate), "", Format$(Forms!foreclosurePrint!txtNextEventDate, "mmmm d, yyyy"))
  FillField WordDoc, "Investor", UCase(Nz(d!Investor))
  FillField WordDoc, "Purchaser", Nz(d!Purchaser)
  FillField WordDoc, "Defendant", DefendantNames(d![CaseList.FileNumber], 2)
  FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
  FillField WordDoc, "SignAtty", IIf(IsNull(Forms!foreclosurePrint!Attorney.Column(1)), "", Forms!foreclosurePrint!Attorney.Column(1))
  FillField WordDoc, "AddressLine", rs!AddressLine
  FillField WordDoc, "Cityline", rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
  FillField WordDoc, "CurrentDate", Format$(Date, "mmmm d, yyyy")
  FillField WordDoc, "COSDefendants", COSNamesAddress(d![CaseList.FileNumber])
  FillField WordDoc, "SaleDate", Format$(d!Sale, "mmmm d, yyyy")
  FillField WordDoc, "SaleTime", Format(d!SaleTime, "h:mm ampm")
  FillField WordDoc, "JudgmentEnteredDate", Format$(d!JudgmentEntered, "mmmm d, yyyy")

  FillField WordDoc, "SalePric", Format$(d!SalePrice, "Currency")
  FillField WordDoc, "ReportOfSale", Format$(d!Report, "mmmm d, yyyy")
  
Fnum = d![CaseList.FileNumber]
Else
    Exit Sub
End If

d.Close
rs.Close
N.Close
Set d = Nothing
Set rs = Nothing
Set N = Nothing

WordObj.Selection.HomeKey wdStory, wdMove
Set WordObj = Nothing
DoCmd.Close acForm, "GetDocType"

End Sub

Public Sub Doc_PraecipeofDismissal(KeepOpen As Boolean, Optional NewLine As String = vbNewLine)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rs, N, rsSelected, rsStaff As Recordset   ' data
Dim itemsFields As String
Dim TotalItems As Currency
Dim i, j, t, cnt As Integer
Dim Fnum As Long
Dim TimeDoc As String

TimeDoc = Format$(Now(), "yyyymmdd hhnnss")
Fnum = [Forms]![case list]![FileNumber]

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation].Column(0)) Then
    i = 2
Else
    i = Forms!foreclosurePrint![cboOfficeLocation].Column(0)
End If

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCReportOFSale WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("SELECT * FROM Rosenberg WHERE ID = " & i, dbOpenSnapshot)
Set N = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE Defendant = True and FileNumber = " & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rsStaff = CurrentDb.OpenRecordset("select * from Staff", dbOpenDynaset, dbSeeChanges)

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("DC Praecipe of Dismissal")
Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Praecipe of Dismissal.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("Address").Select
WordDoc.Bookmarks("Address").Range.Text = rs!Address
WordDoc.Bookmarks("Unit").Select
WordDoc.Bookmarks("Unit").Range.Text = rs!Unit
WordDoc.Bookmarks("Cityline").Select
WordDoc.Bookmarks("Cityline").Range.Text = rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
WordDoc.Bookmarks("PropAddress").Select
WordDoc.Bookmarks("PropAddress").Range.Text = d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", "," & vbNewLine & d![Fair Debt]) '& ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("PropCityline").Select
WordDoc.Bookmarks("PropCityline").Range.Text = d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]

If Not N.EOF Then
   N.MoveLast
   If N.RecordCount > 1 Then
        FillField WordDoc, "et", ", et al."
   Else
        FillField WordDoc, "et", ""
   End If
Else
        FillField WordDoc, "et", ""
End If

If Not N.EOF Then
    Dim PrimaryDefNameCaption As String
    Dim flag As Boolean
    flag = False
    N.MoveFirst
    Do Until N.EOF
    
        If N![First] & " " & N![Last] = d![PrimaryDefName] And N!Owner = True And N!Mortgagor = True And N!Deceased = True Then
            PrimaryDefNameCaption = "Estate of " & d![PrimaryDefName] & ""
            flag = True
        Else
            'PrimaryDefNameCaption = d![PrimaryDefName]
        End If
    N.MoveNext
    Loop
End If

    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then
        FillField WordDoc, "firmAddress", "Rosenberg & Associates, LLC" & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then   'MD
        FillField WordDoc, "firmAddress", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "firmAddress", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
  FillField WordDoc, "PrimDefendant", IIf(flag = True, UCase(PrimaryDefNameCaption), UCase(d!PrimaryDefName))
  FillField WordDoc, "Judge", Nz(d!Judge)
  FillField WordDoc, "NextEvent", IIf(IsNull(Forms!foreclosurePrint!sfrmDCEvent!Event), "", Forms!foreclosurePrint!sfrmDCEvent!Event.Column(1))
  FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
  FillField WordDoc, "EventDate", IIf(IsNull(Forms!foreclosurePrint!txtNextEventDate), "", Format$(Forms!foreclosurePrint!txtNextEventDate, "mmmm d, yyyy"))
  FillField WordDoc, "Investor", UCase(Nz(d!Investor))
  FillField WordDoc, "Purchaser", Nz(d!Purchaser)
  FillField WordDoc, "Defendant", DefendantNames(d![CaseList.FileNumber], 2)
  FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
  FillField WordDoc, "SignAtty", IIf(IsNull(Forms!foreclosurePrint!Attorney.Column(1)), "_____________________" & ", Esq.", Forms!foreclosurePrint!Attorney.Column(1)) & ", Esq."
  Dim sAttnyID As Integer
      sAttnyID = IIf(IsNull(Forms!foreclosurePrint!Attorney.Column(0)), 0, Forms!foreclosurePrint!Attorney.Column(0))
  FillField WordDoc, "DCBar", IIf(sAttnyID = 0, "", "(D.C. Bar# " & DLookup("DCBar", "Staff", "ID=" & sAttnyID)) & ")"
  FillField WordDoc, "DCAttny", GetDCAttorneyname(0)
  FillField WordDoc, "SignAttyEmail", DLookup("Email", "Staff", "ID=" & sAttnyID)
  FillField WordDoc, "DCAttnyEmail", GetDCAttorneyname(1)
  FillField WordDoc, "AddressLine", rs!AddressLine
  FillField WordDoc, "Cityline", rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
  FillField WordDoc, "CurrentDate", Format$(Date, "mmmm d, yyyy")
  FillField WordDoc, "COSDefendants", COSNamesAddress(d![CaseList.FileNumber])
  FillField WordDoc, "SaleDate", Format$(d!Sale, "mmmm d, yyyy")
  FillField WordDoc, "SaleTime", Format(d!SaleTime, "h:mm ampm")
  FillField WordDoc, "JudgmentEnteredDate", Format$(d!JudgmentEntered, "mmmm d, yyyy")

  FillField WordDoc, "SalePric", Format$(d!SalePrice, "Currency")
  FillField WordDoc, "ReportOfSale", Format$(d!Report, "mmmm d, yyyy")
  
Fnum = d![CaseList.FileNumber]

d.Close
rs.Close
N.Close
Set d = Nothing
Set rs = Nothing
Set N = Nothing

WordObj.Selection.HomeKey wdStory, wdMove

'uploade word doc to Rosie 5/20/16
            
'If check = True Then
'Dim Fname, ct As String
'    ct = Format$(Now(), "yyyymmdd hhnnss")
'    Fname = "DC Motion to Ratify Sale" & "_" & ct & ".doc"
'    Call UploadWordDoc(Fnum, "" & Fname & "")
'    Call SaveDocNew(WordDoc, Fnum, "" & Fname & "")
'    'Forms![case list].Requery
'End If
'
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
DoCmd.Close acForm, "GetDocType"

End Sub

Public Sub Doc_MotiontoDismiss(KeepOpen As Boolean, Optional NewLine As String = vbNewLine)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rs, N, rsSelected, rsStaff As Recordset   ' data
Dim itemsFields As String
Dim TotalItems As Currency
Dim i, j, t, cnt As Integer
Dim Fnum As Long
Dim TimeDoc As String

TimeDoc = Format$(Now(), "yyyymmdd hhnnss")
Fnum = [Forms]![case list]![FileNumber]

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation].Column(0)) Then
    i = 2
Else
    i = Forms!foreclosurePrint![cboOfficeLocation].Column(0)
End If

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCMotiontoDismiss WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("SELECT * FROM Rosenberg WHERE ID = " & i, dbOpenSnapshot)
Set N = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE Defendant = True and FileNumber = " & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rsStaff = CurrentDb.OpenRecordset("select * from Staff", dbOpenDynaset, dbSeeChanges)

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("DC Motion to Dismiss")
Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Motion to Dismiss.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
WordDoc.Bookmarks("Address").Select
WordDoc.Bookmarks("Address").Range.Text = rs!Address
WordDoc.Bookmarks("Unit").Select
WordDoc.Bookmarks("Unit").Range.Text = rs!Unit
WordDoc.Bookmarks("Cityline").Select
WordDoc.Bookmarks("Cityline").Range.Text = rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
WordDoc.Bookmarks("PropAddress").Select
WordDoc.Bookmarks("PropAddress").Range.Text = d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", "," & vbNewLine & d![Fair Debt]) '& ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("PropCityline").Select
WordDoc.Bookmarks("PropCityline").Range.Text = d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]

If Not N.EOF Then
   N.MoveLast
   If N.RecordCount > 1 Then
        FillField WordDoc, "et", ", et al."
   Else
        FillField WordDoc, "et", ""
   End If
Else
        FillField WordDoc, "et", ""
End If

If Not N.EOF Then
    Dim PrimaryDefNameCaption As String
    Dim flag As Boolean
    flag = False
    N.MoveFirst
    Do Until N.EOF
    
        If N![First] & " " & N![Last] = d![PrimaryDefName] And N!Owner = True And N!Mortgagor = True And N!Deceased = True Then
            PrimaryDefNameCaption = "Estate of " & d![PrimaryDefName] & ""
            flag = True
        Else
            'PrimaryDefNameCaption = d![PrimaryDefName]
        End If
    N.MoveNext
    Loop
End If

    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then
        FillField WordDoc, "firmAddress", "Rosenberg & Associates, LLC" & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then   'MD
        FillField WordDoc, "firmAddress", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "firmAddress", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
  FillField WordDoc, "PrimDefendant", IIf(flag = True, UCase(PrimaryDefNameCaption), UCase(d!PrimaryDefName))
  FillField WordDoc, "Judge", Nz(d!Judge)
  FillField WordDoc, "NextEvent", IIf(IsNull(Forms!foreclosurePrint!sfrmDCEvent!Event), "", Forms!foreclosurePrint!sfrmDCEvent!Event.Column(1))
  FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
  FillField WordDoc, "EventDate", IIf(IsNull(Forms!foreclosurePrint!txtNextEventDate), "", Format$(Forms!foreclosurePrint!txtNextEventDate, "mmmm d, yyyy"))
  FillField WordDoc, "Investor", UCase(Nz(d!Investor))
  FillField WordDoc, "FileDate", IIf(IsNull(d!ComplaintFiled), "______________________", Format$(d!ComplaintFiled, "mmmm dd, yyyy"))
  FillField WordDoc, "BServedDate", IIf(IsNull(d!AllBorrowerServed), "______________________", Format$(d!AllBorrowerServed, "mmmm dd, yyyy"))
  FillField WordDoc, "AFiledDate", IIf(IsNull(d!AnswerFiled), "______________________", Format$(d!AnswerFiled, "mmmm dd, yyyy"))
'  FillField WordDoc, "Purchaser", Nz(d!Purchaser)
  FillField WordDoc, "Defendant", DefendantNames(d![FileNumber], 2)
  FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
  FillField WordDoc, "SignAtty", IIf(IsNull(Forms!foreclosurePrint!Attorney.Column(1)), "_____________________" & ", Esq.", Forms!foreclosurePrint!Attorney.Column(1)) & ", Esq."
  Dim sAttnyID As Integer
      sAttnyID = IIf(IsNull(Forms!foreclosurePrint!Attorney.Column(0)), 0, Forms!foreclosurePrint!Attorney.Column(0))
  FillField WordDoc, "DCBar", IIf(sAttnyID = 0, "", "(D.C. Bar# " & DLookup("DCBar", "Staff", "ID=" & sAttnyID)) & ")"
  'FillField WordDoc, "DCAttny", GetDCAttorneyname(0)
  FillField WordDoc, "SignAttyEmail", DLookup("Email", "Staff", "ID=" & sAttnyID)
  'FillField WordDoc, "DCAttnyEmail", GetDCAttorneyname(1)
  FillField WordDoc, "AddressLine", rs!AddressLine
  FillField WordDoc, "Cityline", rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
  FillField WordDoc, "CurrentDate", Format$(Date, "mmmm d, yyyy")
  FillField WordDoc, "COSDefendants", COSNamesAddress(d![FileNumber])
'  FillField WordDoc, "SaleDate", Format$(d!Sale, "mmmm d, yyyy")
'  FillField WordDoc, "SaleTime", Format(d!SaleTime, "h:mm ampm")
'  FillField WordDoc, "JudgmentEnteredDate", Format$(d!JudgmentEntered, "mmmm d, yyyy")
'
'  FillField WordDoc, "SalePric", Format$(d!SalePrice, "Currency")
'  FillField WordDoc, "ReportOfSale", Format$(d!Report, "mmmm d, yyyy")
'
Fnum = d![FileNumber]

d.Close
rs.Close
N.Close
Set d = Nothing
Set rs = Nothing
Set N = Nothing

WordObj.Selection.HomeKey wdStory, wdMove

'uploade word doc to Rosie 5/20/16
            
'If check = True Then
'Dim Fname, ct As String
'    ct = Format$(Now(), "yyyymmdd hhnnss")
'    Fname = "DC Motion to Ratify Sale" & "_" & ct & ".doc"
'    Call UploadWordDoc(Fnum, "" & Fname & "")
'    Call SaveDocNew(WordDoc, Fnum, "" & Fname & "")
'    'Forms![case list].Requery
'End If
'
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
DoCmd.Close acForm, "GetDocType"

End Sub
Public Sub Doc_NoticeofStay(KeepOpen As Boolean, Optional NewLine As String = vbNewLine)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim FileNo As String
Dim IsOpen As Boolean
Dim d As Recordset

If CurrentProject.AllForms("foreclosurePrint").IsLoaded = True Then
        IsOpen = True
    Else
        IsOpen = False
    End If


FileNo = Forms![case list]!FileNumber
'Set d = CurrentDb.OpenRecordset("SELECT * FROM qryNoticeofStayWord WHERE FileNumber=" & Forms![Case List]!FileNumber, dbOpenSnapshot)
Set d = CurrentDb.OpenRecordset("SELECT * FROM qryNoticeofStayWord WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)

If d.EOF Then
    MsgBox "No bankruptcy information is available to merge into this document."
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
    Call OpenDocAsSaved("Notice of Stay")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "Notice of Stay.doc", False)
    WordObj.Visible = True
    
WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = IIf(d!ClientID = 575, "", "File Number: " & d![FileNumber])
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]
WordDoc.Bookmarks("PropertyAddress").Select
WordDoc.Bookmarks("PropertyAddress").Range.Text = d![PropertyAddress] & IIf(IsNull(d![Fair Debt]), " ", ", " & d![Fair Debt] & ", " & vbCr & d!City & ", " & d!State & " " & FormatZip(d!ZipCode))

If CurrentProject.AllForms("bankruptcyPrint").IsLoaded = True Then
    If ([Forms]![BankruptcyPrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![BankruptcyPrint]![cboOfficeLocation])) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![BankruptcyPrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
Else

    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or (IsNull([Forms]![foreclosurePrint]![cboOfficeLocation])) Then   'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
End If
FillField WordDoc, "UpperJurisdiction", UCase$(d!Jurisdiction & ", " & d!LongState)
FillField WordDoc, "TrusteeNames", trusteeNames(Nz(FileNo), 3)
FillField WordDoc, "TrusteeNames1", trusteeNames(Nz(FileNo), 2)
FillField WordDoc, "TrusteeWord", TrusteeWord(Nz(FileNo), 0)
FillField WordDoc, "MortgagorNames", MortgagorNamesBK(0, 3)
FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
FillField WordDoc, "TrusteeNames2", trusteeNamesCPTF(Nz(FileNo), 3)
FillField WordDoc, "SaleDate", Format$(d!Sale, "mmmm, dd, yyyy")
FillField WordDoc, "SaleTime", Format$(d![SaleTime], "h:nn am/pm")
FillField WordDoc, "Chapter", Nz(d!Chapter)
FillField WordDoc, "Districts", d!Name
FillField WordDoc, "Location", d!Location
FillField WordDoc, "DateOfFiling", Format$(d![DateofFiling], "mmmm d"", ""yyyy")
FillField WordDoc, "CourtCaseNo", Nz(d!CaseNo)
FillField WordDoc, "TrusteeNames2", trusteeNamesCPTF(0, 3)
FillField WordDoc, "FirmAddressPhone", FirmAddressPhone()
FillField WordDoc, "Jurisdiction", d!Jurisdiction
FillField WordDoc, "LongState", Nz(d!LongState)

If IsOpen Then
    FillField WordDoc, "SignAttny", Forms!foreclosurePrint!Attorney.Column(1) & ", Esq"
Else
    FillField WordDoc, "SignAttny", [Forms]![BankruptcyPrint]![cbxAttorney].Column(0)
End If

FillField WordDoc, "FirmAddress", FirmAddress()
FillField WordDoc, "AttName", IIf(IsNull(d![AttorneyLastName]), "", d![AttorneyFirstName] & " " & d![AttorneyLastName] & IIf(IsNull(d![AttorneyFirm]), "", _
vbCr & d![AttorneyFirm]) & vbCr & d![AttorneyAddress])

d.Close
Set d = Nothing
WordObj.Selection.HomeKey wdStory, wdMove
Set WordObj = Nothing
End Sub

Public Sub Doc_OrdertoVacate(KeepOpen As Boolean, Optional NewLine As String = vbNewLine)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rs, N, rsStaff As Recordset
Dim Fnum As Long
Dim i As Integer

Fnum = [Forms]![case list]![FileNumber]

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation].Column(0)) Then
    i = 2
Else
    i = Forms!foreclosurePrint![cboOfficeLocation].Column(0)
End If

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCMotiontoDismiss WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("SELECT * FROM Rosenberg WHERE ID = " & i, dbOpenSnapshot)
Set N = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE Defendant = True and FileNumber = " & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rsStaff = CurrentDb.OpenRecordset("select * from Staff", dbOpenDynaset, dbSeeChanges)

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("DC Order to Vacate and Dismiss")
Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Order to Vacate and Dismiss.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
WordDoc.Bookmarks("Address").Select
WordDoc.Bookmarks("Address").Range.Text = rs!Address
WordDoc.Bookmarks("Unit").Select
WordDoc.Bookmarks("Unit").Range.Text = rs!Unit
WordDoc.Bookmarks("Cityline").Select
WordDoc.Bookmarks("Cityline").Range.Text = rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
WordDoc.Bookmarks("PropAddress").Select
WordDoc.Bookmarks("PropAddress").Range.Text = d!PropertyAddress & IIf(IsNull(d![Fair Debt]), "", vbNewLine & d![Fair Debt]) & _
                vbNewLine & d!FCCity & ", " & d!State & " " & FormatZip(d!FCZipCode)
'WordDoc.Bookmarks("PropCityline").Select
'WordDoc.Bookmarks("PropCityline").Range.Text = d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]

If Not N.EOF Then
   N.MoveLast
   If N.RecordCount > 1 Then
        FillField WordDoc, "et", ", et al."
   Else
        FillField WordDoc, "et", ""
   End If
Else
        FillField WordDoc, "et", ""
End If

If Not N.EOF Then
    Dim PrimaryDefNameCaption As String
    Dim flag As Boolean
    flag = False
    N.MoveFirst
    Do Until N.EOF
    
        If N![First] & " " & N![Last] = d![PrimaryDefName] And N!Owner = True And N!Mortgagor = True And N!Deceased = True Then
            PrimaryDefNameCaption = "Estate of " & d![PrimaryDefName] & ""
            flag = True
        Else
            'PrimaryDefNameCaption = d![PrimaryDefName]
        End If
    N.MoveNext
    Loop
End If

 FillField WordDoc, "PrimDefendant", IIf(flag = True, UCase(PrimaryDefNameCaption), UCase(d!PrimaryDefName))
  FillField WordDoc, "Judge", Nz(d!Judge)
  FillField WordDoc, "NextEvent", IIf(IsNull(Forms!foreclosurePrint!sfrmDCEvent!Event), "", Forms!foreclosurePrint!sfrmDCEvent!Event.Column(1))
  FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
  FillField WordDoc, "EventDate", IIf(IsNull(Forms!foreclosurePrint!txtNextEventDate), "", Format$(Forms!foreclosurePrint!txtNextEventDate, "mmmm d, yyyy"))
  FillField WordDoc, "Investor", UCase(Nz(d!Investor))
  FillField WordDoc, "JudgmentEntered", Nz(d!JudgmentEntered, "_______________________")
  FillField WordDoc, "SignAttny", IIf(IsNull(Forms!foreclosurePrint!Attorney.Column(1)), "_____________________", Forms!foreclosurePrint!Attorney.Column(1))
  FillField WordDoc, "COS", COSNamesAddress(d![FileNumber])

d.Close
rs.Close
N.Close
Set d = Nothing
Set rs = Nothing
Set N = Nothing

WordObj.Selection.HomeKey wdStory, wdMove
Set WordObj = Nothing
'DoCmd.Close acForm, "GetDocType"

End Sub
Public Sub Doc_OrdertoDismiss(KeepOpen As Boolean, Optional NewLine As String = vbNewLine)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rs, N, rsSelected, rsStaff As Recordset   ' data
Dim itemsFields As String
Dim TotalItems As Currency
Dim i, j, t, cnt As Integer
Dim Fnum As Long
Dim TimeDoc As String

TimeDoc = Format$(Now(), "yyyymmdd hhnnss")
Fnum = [Forms]![case list]![FileNumber]

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation].Column(0)) Then
    i = 2
Else
    i = Forms!foreclosurePrint![cboOfficeLocation].Column(0)
End If

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCMotiontoDismiss WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("SELECT * FROM Rosenberg WHERE ID = " & i, dbOpenSnapshot)
Set N = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE Defendant = True and FileNumber = " & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rsStaff = CurrentDb.OpenRecordset("select * from Staff", dbOpenDynaset, dbSeeChanges)

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("DC Order to Dismiss")
Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Order to Dismiss.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
WordDoc.Bookmarks("Address").Select
WordDoc.Bookmarks("Address").Range.Text = rs!Address
WordDoc.Bookmarks("Unit").Select
WordDoc.Bookmarks("Unit").Range.Text = rs!Unit
WordDoc.Bookmarks("Cityline").Select
WordDoc.Bookmarks("Cityline").Range.Text = rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
WordDoc.Bookmarks("PropAddress").Select
WordDoc.Bookmarks("PropAddress").Range.Text = d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", "," & vbNewLine & d![Fair Debt]) '& ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("PropCityline").Select
WordDoc.Bookmarks("PropCityline").Range.Text = d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]

If Not N.EOF Then
   N.MoveLast
   If N.RecordCount > 1 Then
        FillField WordDoc, "et", ", et al."
   Else
        FillField WordDoc, "et", ""
   End If
Else
        FillField WordDoc, "et", ""
End If

If Not N.EOF Then
    Dim PrimaryDefNameCaption As String
    Dim flag As Boolean
    flag = False
    N.MoveFirst
    Do Until N.EOF
    
        If N![First] & " " & N![Last] = d![PrimaryDefName] And N!Owner = True And N!Mortgagor = True And N!Deceased = True Then
            PrimaryDefNameCaption = "Estate of " & d![PrimaryDefName] & ""
            flag = True
        Else
            'PrimaryDefNameCaption = d![PrimaryDefName]
        End If
    N.MoveNext
    Loop
End If

    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then
        FillField WordDoc, "firmAddress", "Rosenberg & Associates, LLC" & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then   'MD
        FillField WordDoc, "firmAddress", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "firmAddress", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
  FillField WordDoc, "PrimDefendant", IIf(flag = True, UCase(PrimaryDefNameCaption), UCase(d!PrimaryDefName))
  FillField WordDoc, "Judge", Nz(d!Judge)
  FillField WordDoc, "NextEvent", IIf(IsNull(Forms!foreclosurePrint!sfrmDCEvent!Event), "", Forms!foreclosurePrint!sfrmDCEvent!Event.Column(1))
  FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
  FillField WordDoc, "EventDate", IIf(IsNull(Forms!foreclosurePrint!txtNextEventDate), "", Format$(Forms!foreclosurePrint!txtNextEventDate, "mmmm d, yyyy"))
  FillField WordDoc, "Investor", UCase(Nz(d!Investor))
'  FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
  FillField WordDoc, "SignAttny", IIf(IsNull(Forms!foreclosurePrint!Attorney.Column(1)), "_____________________", Forms!foreclosurePrint!Attorney.Column(1))
  FillField WordDoc, "COS", COSNamesAddress(d![FileNumber])

Fnum = d![FileNumber]

d.Close
rs.Close
N.Close
Set d = Nothing
Set rs = Nothing
Set N = Nothing

WordObj.Selection.HomeKey wdStory, wdMove

'uploade word doc to Rosie 5/20/16
            
'If check = True Then
'Dim Fname, ct As String
'    ct = Format$(Now(), "yyyymmdd hhnnss")
'    Fname = "DC Motion to Ratify Sale" & "_" & ct & ".doc"
'    Call UploadWordDoc(Fnum, "" & Fname & "")
'    Call SaveDocNew(WordDoc, Fnum, "" & Fname & "")
'    'Forms![case list].Requery
'End If
'
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
DoCmd.Close acForm, "GetDocType"
End Sub
Public Sub Doc_STIPULATIONOFDISMISSAL(KeepOpen As Boolean, Optional NewLine As String = vbNewLine)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rs, N, rsSelected, rsStaff As Recordset
Dim Fnum As Long
Dim i As Integer

Fnum = [Forms]![case list]![FileNumber]

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation].Column(0)) Then
    i = 2
Else
    i = Forms!foreclosurePrint![cboOfficeLocation].Column(0)
End If

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCMotiontoDismiss WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("SELECT * FROM Rosenberg WHERE ID = " & i, dbOpenSnapshot)
Set N = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE Defendant = True and FileNumber = " & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rsStaff = CurrentDb.OpenRecordset("select * from Staff", dbOpenDynaset, dbSeeChanges)

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("DC Stipulation of Dismissal")
Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Stipulation of Dismissal.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
WordDoc.Bookmarks("Address").Select
WordDoc.Bookmarks("Address").Range.Text = rs!Address
WordDoc.Bookmarks("Unit").Select
WordDoc.Bookmarks("Unit").Range.Text = rs!Unit
WordDoc.Bookmarks("Cityline").Select
WordDoc.Bookmarks("Cityline").Range.Text = rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
WordDoc.Bookmarks("PropAddress").Select
WordDoc.Bookmarks("PropAddress").Range.Text = d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", "," & vbNewLine & d![Fair Debt]) '& ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("PropCityline").Select
WordDoc.Bookmarks("PropCityline").Range.Text = d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]

If Not N.EOF Then
   N.MoveLast
   If N.RecordCount > 1 Then
        FillField WordDoc, "et", ", et al."
   Else
        FillField WordDoc, "et", ""
   End If
Else
        FillField WordDoc, "et", ""
End If

If Not N.EOF Then
    Dim PrimaryDefNameCaption As String
    Dim flag As Boolean
    flag = False
    N.MoveFirst
    Do Until N.EOF
    
        If N![First] & " " & N![Last] = d![PrimaryDefName] And N!Owner = True And N!Mortgagor = True And N!Deceased = True Then
            PrimaryDefNameCaption = "Estate of " & d![PrimaryDefName] & ""
            flag = True
        Else
            'PrimaryDefNameCaption = d![PrimaryDefName]
        End If
    N.MoveNext
    Loop
End If

    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then
        FillField WordDoc, "firmAddress", "Rosenberg & Associates, LLC" & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then   'MD
        FillField WordDoc, "firmAddress", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "firmAddress", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
  FillField WordDoc, "PrimDefendant", IIf(flag = True, UCase(PrimaryDefNameCaption), UCase(d!PrimaryDefName))
  FillField WordDoc, "Judge", Nz(d!Judge)
  FillField WordDoc, "NextEvent", IIf(IsNull(Forms!foreclosurePrint!sfrmDCEvent!Event), "", Forms!foreclosurePrint!sfrmDCEvent!Event.Column(1))
  FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
  FillField WordDoc, "EventDate", IIf(IsNull(Forms!foreclosurePrint!txtNextEventDate), "", Format$(Forms!foreclosurePrint!txtNextEventDate, "mmmm d, yyyy"))
  FillField WordDoc, "Investor", UCase(Nz(d!Investor))
  FillField WordDoc, "FileDate", IIf(IsNull(d!ComplaintFiled), "______________________", Format$(d!ComplaintFiled, "mmmm dd, yyyy"))
  FillField WordDoc, "MotionFiledDate", IIf(IsNull(d!JudgmentMotionFiled), "______________________", Format$(d!JudgmentMotionFiled, "mmmm dd, yyyy"))
  FillField WordDoc, "JudgmntDate", IIf(IsNull(d!JudgmentEntered), "______________________", Format$(d!JudgmentEntered, "mmmm dd, yyyy"))
'  FillField WordDoc, "Purchaser", Nz(d!Purchaser)
  FillField WordDoc, "Defendant", DefendantNames(d![FileNumber], 2)
  FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
  FillField WordDoc, "SignAtty", IIf(IsNull(Forms!foreclosurePrint!Attorney.Column(1)), "_____________________" & ", Esq.", Forms!foreclosurePrint!Attorney.Column(1)) & ", Esq."
  Dim sAttnyID As Integer
      sAttnyID = IIf(IsNull(Forms!foreclosurePrint!Attorney.Column(0)), 0, Forms!foreclosurePrint!Attorney.Column(0))
  FillField WordDoc, "DCBar", IIf(sAttnyID = 0, "", "(D.C. Bar# " & DLookup("DCBar", "Staff", "ID=" & sAttnyID)) & ")"
  'FillField WordDoc, "DCAttny", GetDCAttorneyname(0)
  FillField WordDoc, "SignAttyEmail", DLookup("Email", "Staff", "ID=" & sAttnyID)
  'FillField WordDoc, "DCAttnyEmail", GetDCAttorneyname(1)
  FillField WordDoc, "AddressLine", rs!AddressLine
  FillField WordDoc, "Cityline", rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
  FillField WordDoc, "CurrentDate", ThisDate(Date)
  FillField WordDoc, "COSDefendants", COSNamesAddress(d![FileNumber])
  FillField WordDoc, "BorrowerAttny", GetBorrowerAttorney(d!FileNumber, 3)
  
  d.Close
rs.Close
N.Close
Set d = Nothing
Set rs = Nothing
Set N = Nothing

WordObj.Selection.HomeKey wdStory, wdMove
Set WordObj = Nothing
DoCmd.Close acForm, "GetDocType"

End Sub

Public Sub Doc_MotiontoVacate(KeepOpen As Boolean, Optional NewLine As String = vbNewLine)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rs, N, rsSelected, rsStaff As Recordset   ' data
Dim itemsFields As String
Dim TotalItems As Currency
Dim i, j, t, cnt As Integer
Dim Fnum As Long
Dim TimeDoc As String

TimeDoc = Format$(Now(), "yyyymmdd hhnnss")
Fnum = [Forms]![case list]![FileNumber]

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation].Column(0)) Then
    i = 2
Else
    i = Forms!foreclosurePrint![cboOfficeLocation].Column(0)
End If

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCMotiontoDismiss WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("SELECT * FROM Rosenberg WHERE ID = " & i, dbOpenSnapshot)
Set N = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE Defendant = True and FileNumber = " & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rsStaff = CurrentDb.OpenRecordset("select * from Staff", dbOpenDynaset, dbSeeChanges)

Set WordObj = CreateObject("Word.Application")
Call OpenDocAsSaved("DC Motion to Vacate and Dismiss")
Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Motion to Vacate and Dismiss.doc", False)
WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select
WordDoc.Bookmarks("FileNumber").Range.Text = d![FileNumber]
WordDoc.Bookmarks("Address").Select
WordDoc.Bookmarks("Address").Range.Text = rs!Address
WordDoc.Bookmarks("Unit").Select
WordDoc.Bookmarks("Unit").Range.Text = rs!Unit
WordDoc.Bookmarks("Cityline").Select
WordDoc.Bookmarks("Cityline").Range.Text = rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
WordDoc.Bookmarks("PropAddress").Select
WordDoc.Bookmarks("PropAddress").Range.Text = d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", "," & vbNewLine & d![Fair Debt]) '& ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("PropCityline").Select
WordDoc.Bookmarks("PropCityline").Range.Text = d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]

If Not N.EOF Then
   N.MoveLast
   If N.RecordCount > 1 Then
        FillField WordDoc, "et", ", et al."
   Else
        FillField WordDoc, "et", ""
   End If
Else
        FillField WordDoc, "et", ""
End If

If Not N.EOF Then
    Dim PrimaryDefNameCaption As String
    Dim flag As Boolean
    flag = False
    N.MoveFirst
    Do Until N.EOF
    
        If N![First] & " " & N![Last] = d![PrimaryDefName] And N!Owner = True And N!Mortgagor = True And N!Deceased = True Then
            PrimaryDefNameCaption = "Estate of " & d![PrimaryDefName] & ""
            flag = True
        Else
            'PrimaryDefNameCaption = d![PrimaryDefName]
        End If
    N.MoveNext
    Loop
End If

    If [Forms]![foreclosurePrint]![cboOfficeLocation] = 2 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then
        FillField WordDoc, "firmAddress", "Rosenberg & Associates, LLC" & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Then   'MD
        FillField WordDoc, "firmAddress", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "firmAddress", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
  FillField WordDoc, "PrimDefendant", IIf(flag = True, UCase(PrimaryDefNameCaption), UCase(d!PrimaryDefName))
  FillField WordDoc, "Judge", Nz(d!Judge)
  FillField WordDoc, "NextEvent", IIf(IsNull(Forms!foreclosurePrint!sfrmDCEvent!Event), "", Forms!foreclosurePrint!sfrmDCEvent!Event.Column(1))
  FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
  FillField WordDoc, "EventDate", IIf(IsNull(Forms!foreclosurePrint!txtNextEventDate), "", Format$(Forms!foreclosurePrint!txtNextEventDate, "mmmm d, yyyy"))
  FillField WordDoc, "Investor", UCase(Nz(d!Investor))
  FillField WordDoc, "FileDate", IIf(IsNull(d!ComplaintFiled), "______________________", Format$(d!ComplaintFiled, "mmmm dd, yyyy"))
  FillField WordDoc, "MotionFiledDate", IIf(IsNull(d!JudgmentMotionFiled), "______________________", Format$(d!JudgmentMotionFiled, "mmmm dd, yyyy"))
  FillField WordDoc, "JudgmntDate", IIf(IsNull(d!JudgmentEntered), "______________________", Format$(d!JudgmentEntered, "mmmm dd, yyyy"))
'  FillField WordDoc, "Purchaser", Nz(d!Purchaser)
  FillField WordDoc, "Defendant", DefendantNames(d![FileNumber], 2)
  FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
  FillField WordDoc, "SignAtty", IIf(IsNull(Forms!foreclosurePrint!Attorney.Column(1)), "_____________________" & ", Esq.", Forms!foreclosurePrint!Attorney.Column(1)) & ", Esq."
  Dim sAttnyID As Integer
      sAttnyID = IIf(IsNull(Forms!foreclosurePrint!Attorney.Column(0)), 0, Forms!foreclosurePrint!Attorney.Column(0))
  FillField WordDoc, "DCBar", IIf(sAttnyID = 0, "", "(D.C. Bar# " & DLookup("DCBar", "Staff", "ID=" & sAttnyID)) & ")"
  'FillField WordDoc, "DCAttny", GetDCAttorneyname(0)
  FillField WordDoc, "SignAttyEmail", DLookup("Email", "Staff", "ID=" & sAttnyID)
  'FillField WordDoc, "DCAttnyEmail", GetDCAttorneyname(1)
  FillField WordDoc, "AddressLine", rs!AddressLine
  FillField WordDoc, "Cityline", rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
  FillField WordDoc, "CurrentDate", ThisDate(Date)
  FillField WordDoc, "COSDefendants", COSNamesAddress(d![FileNumber])
'  FillField WordDoc, "SaleDate", Format$(d!Sale, "mmmm d, yyyy")
'  FillField WordDoc, "SaleTime", Format(d!SaleTime, "h:mm ampm")
'  FillField WordDoc, "JudgmentEnteredDate", Format$(d!JudgmentEntered, "mmmm d, yyyy")
'
'  FillField WordDoc, "SalePric", Format$(d!SalePrice, "Currency")
'  FillField WordDoc, "ReportOfSale", Format$(d!Report, "mmmm d, yyyy")
'
Fnum = d![FileNumber]

d.Close
rs.Close
N.Close
Set d = Nothing
Set rs = Nothing
Set N = Nothing

WordObj.Selection.HomeKey wdStory, wdMove

'uploade word doc to Rosie 5/20/16
            
'If check = True Then
'Dim Fname, ct As String
'    ct = Format$(Now(), "yyyymmdd hhnnss")
'    Fname = "DC Motion to Ratify Sale" & "_" & ct & ".doc"
'    Call UploadWordDoc(Fnum, "" & Fname & "")
'    Call SaveDocNew(WordDoc, Fnum, "" & Fname & "")
'    'Forms![case list].Requery
'End If
'
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges
Set WordObj = Nothing
DoCmd.Close acForm, "GetDocType"

End Sub

Public Sub Doc_MTCWaitingonRatification(KeepOpen As Boolean, Optional reportNM As String)
 Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rsStaff As Recordset

If reportNM = "MTC Active BK" Then
    Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRptMTCBK WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Else
    Set d = CurrentDb.OpenRecordset("SELECT * FROM qryRptMTC WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
End If
If d.EOF Then
    MsgBox "The file returns no data."
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")
If reportNM = "MTC Waiting on Ratification" Then
    Call OpenDocAsSaved("MTC Waiting on Ratification")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "MTC Waiting on Ratification.doc", False)
ElseIf reportNM = "MTC Sale date set" Then
    Call OpenDocAsSaved("MTC Sale date set")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "MTC Sale date set.doc", False)
ElseIf reportNM = "MTC Active BK" Then
    Call OpenDocAsSaved("MTC Active BK")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "MTC Active BK.doc", False)
ElseIf reportNM = "MTC Deed not recorded" Then
    Call OpenDocAsSaved("MTC Deed not recorded")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "MTC Deed not recorded.doc", False)
ElseIf reportNM = "MTC Loss Mitigation Review Hold" Then
    Call OpenDocAsSaved("MTC Loss Mitigation Review Hold")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "MTC Loss Mitigation Review Hold.doc", False)
ElseIf reportNM = "MTC Short-Sale" Then
    Call OpenDocAsSaved("MTC Short-Sale")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "MTC Short-Sale.doc", False)
ElseIf reportNM = "MTC Trial Loan Mod" Then
    Call OpenDocAsSaved("MTC Trial Loan Mod")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "MTC Trial Loan Mod.doc", False)
End If

WordObj.Visible = True

Dim FileNo As String
FileNo = Forms![case list]!FileNumber

'WordDoc.Bookmarks("FileNumber").Select
'WordDoc.Bookmarks("FileNumber").Range.Text = fileNo
'WordDoc.Bookmarks("PropertyAddress").Select
'WordDoc.Bookmarks("PropertyAddress").Range.Text = d!PropertyAddress & IIf(IsNull(d![Fair Debt]), vbNewLine, "," & vbNewLine & d![Fair Debt]) & d!City & ", " & d![FCdetails.State] & " " & FormatZip(d!ZipCode)
'WordDoc.Bookmarks("ProName").Select
'WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]

    If ([Forms]![foreclosurePrint]![cboOfficeLocation] = 2) Then
        FillField WordDoc, "mFirmAddr", "Commonwealth Trustees, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 2") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 2") & ", " & DLookup("State", "Rosenberg", "ID = 2") & " " & DLookup("Zip", "Rosenberg", "ID = 2")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 1 Or IsNull([Forms]![foreclosurePrint]![cboOfficeLocation]) Then    'MD
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 1") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 1") & ", " & DLookup("State", "Rosenberg", "ID = 1") & " " & DLookup("Zip", "Rosenberg", "ID = 1")
    ElseIf [Forms]![foreclosurePrint]![cboOfficeLocation] = 3 Then   'chespk
        FillField WordDoc, "mFirmAddr", "Rosenberg & Associates, LLC " & vbCr & DLookup("AddressLine", "Rosenberg", "ID = 3") & vbCr & _
             DLookup("City", "Rosenberg", "ID = 3") & ", " & DLookup("State", "Rosenberg", "ID = 3") & " " & DLookup("Zip", "Rosenberg", "ID = 3")
    End If
FillField WordDoc, "FileNumber", FileNo
FillField WordDoc, "UpperJurisdiction", UCase$(d![Jurisdiction] & IIf(IsNull(d![LongState]), "", ", " & d![LongState]))
FillField WordDoc, "Defendant", d!PrimaryFirstName & " " & d!PrimaryLastName
FillField WordDoc, "StatusHearing", Nz(Format$(d![StatusHearing], "mmmm"" ""dd"", ""yyyy"), "____________")
FillField WordDoc, "StatusHearingTime", Nz(d!StatusHearingTime)
If reportNM = "MTC Active BK" Then
    FillField WordDoc, "chapter", Nz([Forms]![frmMTCBK]![cmbChapter], "")
    FillField WordDoc, "FileDate", Nz(Format$([Forms]![frmMTCBK]![txtDOF], "mmmm dd, yyyy"), "____________")
    FillField WordDoc, "caseNo", Nz([Forms]![frmMTCBK]![txtCaseNo], "")
Else
    FillField WordDoc, "SaleDate", Nz(Format$(d![Sale], "mmmm"" ""dd"", ""yyyy"), "____________")
    FillField WordDoc, "SaleRat", Nz(Format$(d![SaleRat], "mmmm"" ""dd"", ""yyyy"), "____________")
    FillField WordDoc, "AuditFile", Nz(Format$(d![AuditFile], "mmmm"" ""dd"", ""yyyy"), "____________")
    FillField WordDoc, "reportDate", Nz(Format$(d![Report], "mmmm"" ""dd"", ""yyyy"), "____________")
End If

If reportNM = "MTC Loss Mitigation Review Hold" Then
    FillField WordDoc, "Docket", Nz(Format$(d!Docket, "mmmm dd, yyyy"), "")
    FillField WordDoc, "BorrowerServed", Nz(Format$(d!BorrowerServed, "mmmm dd, yyyy"), "____________")
End If

FillField WordDoc, "AttorneywithCPTF", Replace([Forms]![foreclosurePrint]![Attorney].Column(1), "Vice President", "Esquire") & " " & _
                "CPTF# " & DLookup("MDBar", "Staff", "ID =" & [Forms]![foreclosurePrint]![Attorney].Column(0))
FillField WordDoc, "FirmShortAddr", FirmShortAddress()
FillField WordDoc, "FirmPhone", FirmPhone()
FillField WordDoc, "GetAddress", GetAddresses(0, 5, "COS = true ")
FillField WordDoc, "CourtCaseNumber", d!CourtCaseNumber

d.Close
Set d = Nothing

WordObj.Selection.HomeKey wdStory, wdMove
Set WordObj = Nothing
DoCmd.Close acForm, "GetDocType"

End Sub

Public Sub Doc_ProposedOrdertoRatify(KeepOpen As Boolean, Optional NewLine As String = vbNewLine)
Dim WordObj As Word.Application, WordDoc As Word.Document, WordRange As Word.Range
Dim d, rs, N, rsSelected, rsStaff As Recordset   ' data
Dim itemsFields As String
Dim TotalItems As Currency
Dim i, j, t, cnt As Integer
Dim Fnum As Long
Dim TimeDoc As String

TimeDoc = Format$(Now(), "yyyymmdd hhnnss")

If IsNull([Forms]![foreclosurePrint]![cboOfficeLocation].Column(0)) Then
    i = 2
Else
    i = Forms!foreclosurePrint![cboOfficeLocation].Column(0)
End If

Set d = CurrentDb.OpenRecordset("SELECT * FROM qryDCReportOFSale WHERE CaseList.FileNumber=" & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("SELECT * FROM Rosenberg WHERE ID = " & i, dbOpenSnapshot)
Set N = CurrentDb.OpenRecordset("SELECT * FROM Names WHERE Defendant = True and FileNumber = " & [Forms]![case list]![FileNumber], dbOpenSnapshot)
Set rsStaff = CurrentDb.OpenRecordset("select * from Staff", dbOpenDynaset, dbSeeChanges)

If d.EOF Then
    MsgBox "The file might missing data, please check all the data required or contact programmers"
    Exit Sub
End If

If N.EOF Then
    MsgBox ("Please check a defendant in the Name tap")
    Exit Sub
End If

Set WordObj = CreateObject("Word.Application")

Dim check As Boolean
check = False

Select Case Forms!GetDocType!Frame1
Case 1

       Call SaveNewDocInRosie("DC Proposed Order to Ratify", d![CaseList.FileNumber], 1600, TimeDoc)
       Set WordDoc = WordObj.Documents.Open(DocLocation & DocBucket(d![CaseList.FileNumber]) & "\" & d![CaseList.FileNumber] & "\" & "DC Proposed Order to Ratify" & " " & TimeDoc & ".doc", False)
       check = True
Case 2
    Call OpenDocAsSaved("DC Proposed Order to Ratify")
    Set WordDoc = WordObj.Documents.Open(EMailPath & "DC Proposed Order to Ratify.doc", False)

    check = False
End Select

WordObj.Visible = True

WordDoc.Bookmarks("FileNumber").Select      ' use this method for bookmarks in header/footer
WordDoc.Bookmarks("FileNumber").Range.Text = d![CaseList.FileNumber]
WordDoc.Bookmarks("Address").Select
WordDoc.Bookmarks("Address").Range.Text = rs!Address
WordDoc.Bookmarks("Unit").Select
WordDoc.Bookmarks("Unit").Range.Text = rs!Unit
WordDoc.Bookmarks("Cityline").Select
WordDoc.Bookmarks("Cityline").Range.Text = rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)

WordDoc.Bookmarks("PropAddress").Select
WordDoc.Bookmarks("PropAddress").Range.Text = d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", "," & vbNewLine & "               " & d![Fair Debt]) '& ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)

WordDoc.Bookmarks("PropCityline").Select
WordDoc.Bookmarks("PropCityline").Range.Text = d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
WordDoc.Bookmarks("ProName").Select
WordDoc.Bookmarks("ProName").Range.Text = d![PrimaryDefName]

If Not N.EOF Then
    N.MoveLast
   If N.RecordCount > 1 Then
     FillField WordDoc, "et", ", et al."
    
   Else
    FillField WordDoc, "et", ""
   End If
End If

If Not N.EOF Then
    Dim PrimaryDefNameCaption As String
    Dim flag As Boolean
    flag = False
    N.MoveFirst
    Do Until N.EOF
    
        If N![First] & " " & N![Last] = d![PrimaryDefName] And N!Owner = True And N!Mortgagor = True And N!Deceased = True Then
            PrimaryDefNameCaption = "Estate of " & d![PrimaryDefName] & ""
            flag = True
        Else
            
        End If
    N.MoveNext
    Loop
End If

  FillField WordDoc, "PrimDefendant", IIf(flag = True, UCase(PrimaryDefNameCaption), UCase(d!PrimaryDefName))
  FillField WordDoc, "Judge", Nz(d!Judge)
  FillField WordDoc, "NextEvent", IIf(IsNull(Forms!foreclosurePrint!sfrmDCEvent!Event), "", Forms!foreclosurePrint!sfrmDCEvent!Event.Column(1))
  FillField WordDoc, "CourtCaseNumber", Nz(d!CourtCaseNumber)
  FillField WordDoc, "EventDate", IIf(IsNull(Forms!foreclosurePrint!txtNextEventDate), "", Format$(Forms!foreclosurePrint!txtNextEventDate, "mmmm d, yyyy"))

  FillField WordDoc, "Investor", UCase(Nz(d!Investor))
  FillField WordDoc, "Purchaser", Nz(d!Purchaser)

  FillField WordDoc, "Defendant", DefendantNames(d![CaseList.FileNumber], 2)
  FillField WordDoc, "PropertyAddress", d!PropertyAddress & IIf(Len(d![Fair Debt] & "") = 0, "", ", " & d![Fair Debt]) & ", " & d!FCCity & ", " & d!FCState & " " & FormatZip(d!FCZipCode)
  
  FillField WordDoc, "AddressLine", rs!AddressLine
  FillField WordDoc, "Cityline", rs!City & ", " & rs!State & " " & FormatZip(rs!Zip)
  FillField WordDoc, "CurrentDate", Format$(Date, "mmmm d, yyyy")
  FillField WordDoc, "COSDefendants", COSNamesAddress(d![CaseList.FileNumber])
  
  FillField WordDoc, "SaleDate", Format$(d!Sale, "mmmm d, yyyy")
  FillField WordDoc, "JudgmentEnteredDate", Format$(d!JudgmentEntered, "mmmm d, yyyy")

Fnum = d![CaseList.FileNumber]

d.Close
rs.Close
N.Close
Set d = Nothing
Set rs = Nothing
Set N = Nothing

WordObj.Selection.HomeKey wdStory, wdMove

'uploade word doc to Rosie 5/20/16
        
'If check = True Then
'Dim Fname, ct As String
'    ct = Format$(Now(), "yyyymmdd hhnnss")
'    Fname = "DC Proposed Order to Ratify" & "_" & ct & ".doc"
'    Call UploadWordDoc(Fnum, "" & Fname & "")
'    Call SaveDocNew(WordDoc, Fnum, "" & Fname & "")
'    'Forms![case list].Requery
'End If
'
'If Not Keepopen Then WordObj.Quit SaveChanges:=wdDoNotSaveChanges

Set WordObj = Nothing

DoCmd.Close acForm, "GetDocType"

End Sub