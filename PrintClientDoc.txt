Version =20
VersionRequired =20
Checksum =-271234570
Begin Form
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =6120
    DatasheetFontHeight =10
    ItemSuffix =61
    Left =8745
    Top =2925
    Right =14625
    Bottom =6090
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0xe648a319b221e540
    End
    GUID = Begin
        0x84746ab75357ae4a9def4681a1049fe7
    End
    Caption ="Print Substitution of Trustee"
    OnCurrent ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c001c031f77000001000100ea0a6f08640001000700580201000100 ,
        0x5802030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200e0001c030000371223e70000000000000000000000000000000000000000 ,
        0x0000000000000000080000000100000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000010000000000000000000000e0000000534d544a ,
        0x000000001000d0004800500020004c0061007300650072004a00650074002000 ,
        0x3100310030003000200028004d00530029000000496e70757442696e004f7074 ,
        0x696f6e3100524553444c4c00556e69726573444c4c004f7269656e746174696f ,
        0x6e00504f525452414954005265736f6c7574696f6e004f7074696f6e31005061 ,
        0x70657253697a65004c45545445520045636f6e6f6d6f6465004f7074696f6e31 ,
        0x00524554004f7074696f6e310048616c66746f6e650048545f50415453495a45 ,
        0x5f4155544f00000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001e004b000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000545330303100
    End
    FilterOnLoad =255
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =0
    AllowLayoutView =0
    DatasheetGridlinesColor12 =12632256
    Begin
        Begin Label
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            FontSize = 11			'Mei 9/7/18
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            SpecialEffect =3
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            SpecialEffect =2
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ComboBox
            SpecialEffect =2
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Section
            CanGrow = NotDefault
            Height =3420
            BackColor =-2147483633
            Name ="Detail"
            GUID = Begin
                0xc523bb57dcb0194f87d569b0b9d39f33
            End
            Begin
                Begin CommandButton
                    Cancel = NotDefault
                    OverlapFlags =85
                    Left =4500
                    Top =2940
                    Width =1020
                    Height =405
                    TabIndex =4
                    Name ="cmdCancel"
                    Caption ="Cancel"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xaa0735f2cad6054f8dcd26d109e4ba9f
                    End

                End
                Begin CommandButton
                    Default = NotDefault
                    OverlapFlags =85
                    Left =3240
                    Top =2940
                    Width =1020
                    Height =405
                    TabIndex =3
                    Name ="cmdOK"
                    Caption ="OK"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x22780231f4d09d438d6521ad48949c0d
                    End

                End
                Begin TextBox
                    Visible = NotDefault
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =3540
                    Top =60
                    Width =900
                    Name ="FileNumber"
                    GUID = Begin
                        0x0ec4c33670242b44bcfc8833b52e6698
                    End

                End
                Begin TextBox
                    Visible = NotDefault
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =4500
                    Top =60
                    Width =720
                    TabIndex =1
                    Name ="ClientID"
                    StatusBarText ="Client's Name"
                    FontName ="Tahoma"
                    GUID = Begin
                        0x76fa8a1f1f630549973401c48f2e0530
                    End

                End
                Begin ListBox
                    OverlapFlags =215
                    IMESentenceMode =3
                    ColumnCount =4
                    Left =480
                    Top =960
                    Width =5520
                    Height =1080
                    TabIndex =2
                    Name ="lstContacts"
                    RowSourceType ="Table/Query"
                    ColumnWidths ="0;2520;1440;0"
                    GUID = Begin
                        0x5c5ad61bde15304da7c304fbb11960a6
                    End

                End
                Begin Label
                    OverlapFlags =85
                    Left =60
                    Top =2940
                    Width =2880
                    Height =420
                    Name ="Label45"
                    Caption ="Hint: To add names to the list, add the name to the Other Contacts in Clients."
                    GUID = Begin
                        0x58c63cd7e184444387623b785172fd27
                    End
                End
                Begin Label
                    OverlapFlags =93
                    Left =120
                    Top =420
                    Width =5520
                    Height =245
                    Name ="lblWho"
                    Caption ="Who will sign the Substitution of Trustee?"
                    GUID = Begin
                        0xc9ef90773f3e5747a3630faf9e8d68bc
                    End
                    LayoutCachedLeft =120
                    LayoutCachedTop =420
                    LayoutCachedWidth =5640
                    LayoutCachedHeight =665
                End
                Begin OptionGroup
                    OverlapFlags =223
                    Left =120
                    Top =420
                    Width =5942
                    Height =2398
                    TabIndex =5
                    Name ="optSign"
                    DefaultValue ="2"
                    GUID = Begin
                        0x5cfbc19a5b14dd4b806a66bb8cbae719
                    End

                    Begin
                        Begin OptionButton
                            OverlapFlags =87
                            Left =306
                            Top =658
                            OptionValue =1
                            Name ="Option55"
                            GUID = Begin
                                0xf0a38eb1f6f39845808a95384b6cd003
                            End
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =536
                                    Top =630
                                    Width =1065
                                    Height =240
                                    Name ="Label56"
                                    Caption ="Client Contact"
                                    GUID = Begin
                                        0xfaa99c39a90c3f47a03451b14a957a0d
                                    End
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =300
                            Top =2188
                            OptionValue =2
                            Name ="Option57"
                            GUID = Begin
                                0xe6f6a89c10297b458f519f116f293d91
                            End
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =530
                                    Top =2160
                                    Width =765
                                    Height =240
                                    Name ="Label58"
                                    Caption ="Unknown"
                                    GUID = Begin
                                        0x6ce4740de2a3234cb51888db6374ad94
                                    End
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =300
                            Top =2518
                            OptionValue =3
                            Name ="Option59"
                            GUID = Begin
                                0xe04954d343d4504596280fec9358bfbe
                            End
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =530
                                    Top =2490
                                    Width =1515
                                    Height =240
                                    Name ="Label60"
                                    Caption ="Designated Attorney"
                                    GUID = Begin
                                        0x966d1c1cdb2f524eaf76779536abd364
                                    End
                                End
                            End
                        End
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database		
Option Explicit				'Mei change from local, 2nd change from local
Dim args() As String

Private Sub cmdCancel_Click()

On Error GoTo Err_cmdCancel_Click
DoCmd.Close

Exit_cmdCancel_Click:
    Exit Sub

Err_cmdCancel_Click:
    MsgBox Err.Description
    Resume Exit_cmdCancel_Click
    
End Sub

Private Sub cmdOK_Click()

Forms!foreclosurePrint!txtDesignator = 0
Forms!foreclosurePrint!txtDesignatedAttorney = 0
Forms!foreclosurePrint!txtClientContact = 0

Dim Name As String, Title As String
Dim EffectiveDate As String
Dim AmendedPB As Integer
Dim LoanMod As Boolean
On Error GoTo Err_cmdOK_Click

If CurrentProject.AllForms("ForeclosureDetails").IsLoaded Then
        Forms!foreclosurePrint!txtDesignator = 0
        Forms!foreclosurePrint!txtDesignatedAttorney = 0
Else
End If

If (optSign = 1) Then
  If (IsNull(lstContacts)) Then
    MsgBox "Select client contact.", vbExclamation
    Exit Sub
  End If
  If ClientID = 593 Then
    Forms!foreclosurePrint!txtClientContact = lstContacts.Column(1)
    Forms!foreclosurePrint!txtDesignator = 1
  End If
End If


If optSign = 2 Then
      Name = "_____________________________"
      Title = "___________________________"
ElseIf optSign = 3 Then
    
    If CurrentProject.AllForms("ForeclosureDetails").IsLoaded Then
        Forms!foreclosurePrint!txtDesignator = optSign
         Forms!foreclosurePrint!txtDesignatedAttorney = optSign
    Else
        
    End If
    
    
    If (IsNull(Forms!foreclosurePrint!Attorney)) Then
      MsgBox "Select designated attorney.", vbExclamation
      Exit Sub
    End If
    Select Case Forms!ForeclosureDetails!State
        Case "VA"
            Name = DLookup("Name", "Staff", "[ID] = " & Forms!foreclosurePrint!Attorney)
            Title = Nz(DLookup("CommonWealthTitle", "Staff", "[ID] = " & Forms!foreclosurePrint!Attorney))
        Case "DC"
            Name = trusteeNames(0, 3)
        '    If Forms!ForeclosureDetails!optSubstituteTrustees Then
                Title = "Substitute Trustee"
        '        Title = "Trustee"
        '     End If
        Case "MD"
            If Forms!foreclosurePrint!chMilitaryAffidavitActive Then
                  Name = trusteeNames(0, 3)
                  Title = "Substitute Trustee"
            ElseIf Forms!foreclosurePrint!chNoteOwnership Then
                  Name = trusteeNames(0, 3)
                  Title = "Substitute Trustee"
            ElseIf Forms!foreclosurePrint!chAffMD7105 Then      'NOI aff.
                   Name = trusteeNamesCPTF(0, 3)
                  Title = "Substitute Trustee" & vbNewLine & "info@rosenberg-assoc.com"
            Else
                Name = Forms!foreclosurePrint!Attorney.Column(1)
                Title = "Substitute Trustee"
            End If
    End Select
    If Left(args(0), 8) = "Military" Then
Dim rstqueue As Recordset
Set rstqueue = CurrentDb.OpenRecordset("Select * FROM wizardqueuestats where filenumber=" & FileNumber & " and current=true", dbOpenDynaset, dbSeeChanges)
With rstqueue
.Edit
!SCRAQueue9 = Date
.Update
End With
rstqueue.Close
End If
Else
    Name = lstContacts.Column(1)
    Title = lstContacts.Column(2)
End If

'If (args(1) = "Statement of Debt with Figures" Or args(1) = "Statement of Debt") Then
'If MsgBox("Is There A Loan Mod? ", vbYesNo) = vbYes Then
'EffectiveDate = InputBox("Agreement effective Date")
'AmendedPB = InputBox("Amended pricipal balance")
'ReportArgs = Name & "|" & Title & "|" & optSign & "|" & LoanMod & "|" & EffectiveDate & "|" & AmendedPB
'Else
'ReportArgs = Name & "|" & Title & "|" & optSign & "|" & LoanMod
'End If
'Else
ReportArgs = Name & "|" & Title & "|" & optSign
'End If


DoCmd.Close acForm, Me.Name
'print coversheet for SOD w/figures,ANO, and NOI if client is New Penn  3/30/18 Mei
If (Forms!foreclosurePrint!chSOD2 Or Forms!foreclosurePrint!chNoteOwnership Or Forms!foreclosurePrint!chAffMD7105) And Forms![case list]!ClientID = 605 Then
   Call DoReport("Shellpoint Coversheet", (args(2)))
End If

'PDFS
If (args(2)) = -2 And Forms!foreclosurePrint!txtDesignatedAttorney = 3 And args(1) = "45 Day Notice Affidavit Wells" Then
    Call DoReport("45 Day Notice Affidavit", (args(2)))
ElseIf (args(2)) = -2 And Forms!foreclosurePrint!txtDesignatedAttorney = 3 And args(1) = "45 Day Notice Affidavit BOA" Then
     Call DoReport("45 Day Notice Affidavit", (args(2)))
ElseIf (args(2)) = -2 And Forms!foreclosurePrint!txtDesignatedAttorney = 3 And args(1) = "45 Day Notice Affidavit Chase" Then
    Call DoReport("45 Day Notice Affidavit", (args(2)))
ElseIf (args(2)) = -2 And Forms!foreclosurePrint!txtDesignatedAttorney = 3 And args(1) = "45 Day Notice Affidavit" Then
     Call DoReport("45 Day Notice Affidavit", (args(2)))
'Word Docs
ElseIf (args(2)) = -1 And Forms!foreclosurePrint!txtDesignatedAttorney = 3 And args(1) = "45 Day Notice Affidavit Wells" Then
    Call DoReport("45 Day Notice Affidavit", (args(2)))
ElseIf (args(2)) = -1 And Forms!foreclosurePrint!txtDesignatedAttorney = 3 And args(1) = "45 Day Notice Affidavit BOA" Then
     Call DoReport("45 Day Notice Affidavit", (args(2)))
ElseIf (args(2)) = -1 And Forms!foreclosurePrint!txtDesignatedAttorney = 3 And args(1) = "45 Day Notice Affidavit Chase" Then
    Call DoReport("45 Day Notice Affidavit", (args(2)))
ElseIf (args(2)) = -1 And Forms!foreclosurePrint!txtDesignatedAttorney = 3 And args(1) = "45 Day Notice Affidavit" Then
     Call DoReport("45 Day Notice Affidavit", (args(2)))
'Views
ElseIf (args(2)) = 2 And Forms!foreclosurePrint!txtDesignatedAttorney = 3 And args(1) = "45 Day Notice Affidavit Wells" Then
    Call DoReport("45 Day Notice Affidavit", (args(2)))
ElseIf (args(2)) = 2 And Forms!foreclosurePrint!txtDesignatedAttorney = 3 And args(1) = "45 Day Notice Affidavit BOA" Then
     Call DoReport("45 Day Notice Affidavit", (args(2)))
ElseIf (args(2)) = 2 And Forms!foreclosurePrint!txtDesignatedAttorney = 3 And args(1) = "45 Day Notice Affidavit Chase" Then
    Call DoReport("45 Day Notice Affidavit", (args(2)))
ElseIf (args(2)) = 2 And Forms!foreclosurePrint!txtDesignatedAttorney = 3 And args(1) = "45 Day Notice Affidavit" Then
     Call DoReport("45 Day Notice Affidavit", (args(2)))
Else 'Normal
Call DoReport(args(1), (args(2)))
If Forms![case list]!ClientID = 559 Then
    If Forms!foreclosurePrint!txtSOD2 = 0 Or IsNull(Forms!foreclosurePrint!txtSOD2) Then Forms!foreclosurePrint!txtSOD2 = "n/a"
    Call DoReport("Fay Cover Letter", (args(2)))  'added on 7/16/18 Mei
    Forms!foreclosurePrint!txtSOD2 = "n/a"
End If
End If

DoEvents


Exit_cmdOK_Click:
    Exit Sub

Err_cmdOK_Click:
    MsgBox Err.Description
    Resume Exit_cmdOK_Click
    
End Sub

Private Sub Form_Current()

If Len(Me.OpenArgs) > 0 Then
    args = Split(Me.OpenArgs, "|")
    lblWho.Caption = "Who will sign the " & args(0) & "?"
    Me.Caption = "Print " & args(0)
End If
End Sub

Private Sub Form_Open(Cancel As Integer)

'Forms!PrintClientDoc!lstContacts.RowSource = "SELECT ID, Trim$(FirstName" & " " & "LastName) AS Name, Title, Description From ClientContacts WHERE ClientID= " & 385 & " ORDER BY LastName, FirstName;"
   Me.lstContacts.RowSource = "SELECT ID,  [FirstName] & "" "" & [LastName] As Name , Title, Description From ClientContacts WHERE ClientID= " & Forms![case list]!ClientID & " ORDER BY LastName, FirstName;"
   Me.FileNumber = Forms![case list]!FileNumber
   Me.ClientID = Forms![case list]!ClientID
   
End Sub
